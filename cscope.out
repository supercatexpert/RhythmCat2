cscope 15 $HOME/Project/RhythmCat/Sources2 -q 0000004687 0000945878
	@config.h

6 
	#ENABLE_NLS
 1

	)

9 
	#GETTEXT_PACKAGE
 "RhythmC2"

	)

12 
	#HAVE_BIND_TEXTDOMAIN_CODESET
 1

	)

15 
	#HAVE_BZERO
 1

	)

27 
	#HAVE_DCGETTEXT
 1

	)

30 
	#HAVE_DLFCN_H
 1

	)

33 
	#HAVE_FORK
 1

	)

36 
	#HAVE_GETTEXT
 1

	)

42 
	#HAVE_INTTYPES_H
 1

	)

45 
	#HAVE_LC_MESSAGES
 1

	)

48 
	#HAVE_LIMITS_H
 1

	)

51 
	#HAVE_LOCALE_H
 1

	)

54 
	#HAVE_MEMORY_H
 1

	)

57 
	#HAVE_MEMSET
 1

	)

60 
	#HAVE_REALPATH
 1

	)

63 
	#HAVE_SIGNAL_H
 1

	)

66 
	#HAVE_STDINT_H
 1

	)

69 
	#HAVE_STDIO_H
 1

	)

72 
	#HAVE_STDLIB_H
 1

	)

75 
	#HAVE_STRINGS_H
 1

	)

78 
	#HAVE_STRING_H
 1

	)

81 
	#HAVE_STRRCHR
 1

	)

84 
	#HAVE_STRSTR
 1

	)

87 
	#HAVE_SYS_STAT_H
 1

	)

90 
	#HAVE_SYS_TYPES_H
 1

	)

93 
	#HAVE_UNISTD_H
 1

	)

96 
	#HAVE_VFORK
 1

	)

102 
	#HAVE_WORKING_FORK
 1

	)

105 
	#HAVE_WORKING_VFORK
 1

	)

109 
	#LT_OBJDIR
 ".libs/"

	)

112 
	#PACKAGE
 "RhythmC"

	)

115 
	#PACKAGE_BUGREPORT
 "hps://ghub.com/surx/RhythmC2/issues/"

	)

118 
	#PACKAGE_NAME
 "RhythmC"

	)

121 
	#PACKAGE_STRING
 "RhythmC 1.9.4"

	)

124 
	#PACKAGE_TARNAME
 "rhythmt"

	)

127 
	#PACKAGE_URL
 ""

	)

130 
	#PACKAGE_VERSION
 "1.9.4"

	)

133 
	#RC_MAJOR_VERSION
 1

	)

136 
	#RC_MICRO_VERSION
 4

	)

139 
	#RC_MINOR_VERSION
 9

	)

142 
	#STDC_HEADERS
 1

	)

145 
	#VERSION
 "1.9.4"

	)

	@gettext.h

19 #ide
_LIBGETTEXT_H


20 
	#_LIBGETTEXT_H
 1

	)

23 #i
ENABLE_NLS


26 
	~<lib.h
>

31 #ifde
DEFAULT_TEXT_DOMAIN


32 #unde
gxt


33 
	#gxt
(
Msgid
) \

34 
	`dgxt
 (
DEFAULT_TEXT_DOMAIN
, 
Msgid
)

	)

35 #unde
ngxt


36 
	#ngxt
(
Msgid1
, 
Msgid2
, 
N
) \

37 
	`dngxt
 (
DEFAULT_TEXT_DOMAIN
, 
Msgid1
, 
Msgid2
, 
N
)

	)

48 #i
defed
(
__sun
)

49 
	~<lo.h
>

55 #i
defed
(
__lulus
&& defed(
__GNUG__
&& (
__GNUC__
 >= 3)

56 
	~<cdlib
>

57 #i(
__GLIBC__
 >2|| 
_GLIBCXX_HAVE_LIBINTL_H


58 
	~<lib.h
>

67 #unde
gxt


68 
	#gxt
(
Msgid
((cڡ *(Msgid))

	)

69 #unde
dgxt


70 
	#dgxt
(
Domame
, 
Msgid
(((Domame), 
	`gxt
 (Msgid))

	)

71 #unde
dcgxt


72 
	#dcgxt
(
Domame
, 
Msgid
, 
Cegy
) \

73 (((
Cegy
), 
	`dgxt
 (
Domame
, 
Msgid
))

	)

74 #unde
ngxt


75 
	#ngxt
(
Msgid1
, 
Msgid2
, 
N
) \

76 ((
N
) == 1 \

77 ? (((
Msgid2
), (cڡ *(
Msgid1
)) \

78 : (((
Msgid1
), (cڡ *(
Msgid2
)))

	)

79 #unde
dngxt


80 
	#dngxt
(
Domame
, 
Msgid1
, 
Msgid2
, 
N
) \

81 (((
Domame
), 
	`ngxt
 (
Msgid1
, 
Msgid2
, 
N
))

	)

82 #unde
dgxt


83 
	#dgxt
(
Domame
, 
Msgid1
, 
Msgid2
, 
N
, 
Cegy
) \

84 (((
Cegy
), 
	`dngxt
(
Domame
, 
Msgid1
, 
Msgid2
, 
N
))

	)

85 #unde
xtdoma


86 
	#xtdoma
(
Domame
((cڡ *(Domame))

	)

87 #unde
bdxtdoma


88 
	#bdxtdoma
(
Domame
, 
Dme
) \

89 (((
Domame
), (cڡ *(
Dme
))

	)

90 #unde
bd_xtdoma_codet


91 
	#bd_xtdoma_codet
(
Domame
, 
Codet
) \

92 (((
Domame
), (cڡ *(
Codet
))

	)

103 
	#gxt_no
(
Sg

	)
Sg

106 
	#GETTEXT_CONTEXT_GLUE
 "\004"

	)

112 #ifde
DEFAULT_TEXT_DOMAIN


113 
	#pgxt
(
Msgxt
, 
Msgid
) \

114 
	`pgxt_aux
 (
DEFAULT_TEXT_DOMAIN
, 
Msgxt
 
GETTEXT_CONTEXT_GLUE
 
Msgid
, Msgid, 
LC_MESSAGES
)

	)

116 
	#pgxt
(
Msgxt
, 
Msgid
) \

117 
	`pgxt_aux
 (
NULL
, 
Msgxt
 
GETTEXT_CONTEXT_GLUE
 
Msgid
, Msgid, 
LC_MESSAGES
)

	)

119 
	#dpgxt
(
Domame
, 
Msgxt
, 
Msgid
) \

120 
	`pgxt_aux
 (
Domame
, 
Msgxt
 
GETTEXT_CONTEXT_GLUE
 
Msgid
, Msgid, 
LC_MESSAGES
)

	)

121 
	#dgxt
(
Domame
, 
Msgxt
, 
Msgid
, 
Cegy
) \

122 
	`pgxt_aux
 (
Domame
, 
Msgxt
 
GETTEXT_CONTEXT_GLUE
 
Msgid
, Msgid, 
Cegy
)

	)

123 #ifde
DEFAULT_TEXT_DOMAIN


124 
	#gxt
(
Msgxt
, 
Msgid
, 
MsgidPlul
, 
N
) \

125 
	`gxt_aux
 (
DEFAULT_TEXT_DOMAIN
, 
Msgxt
 
GETTEXT_CONTEXT_GLUE
 
Msgid
, Msgid, 
MsgidPlul
, 
N
, 
LC_MESSAGES
)

	)

127 
	#gxt
(
Msgxt
, 
Msgid
, 
MsgidPlul
, 
N
) \

128 
	`gxt_aux
 (
NULL
, 
Msgxt
 
GETTEXT_CONTEXT_GLUE
 
Msgid
, Msgid, 
MsgidPlul
, 
N
, 
LC_MESSAGES
)

	)

130 
	#dgxt
(
Domame
, 
Msgxt
, 
Msgid
, 
MsgidPlul
, 
N
) \

131 
	`gxt_aux
 (
Domame
, 
Msgxt
 
GETTEXT_CONTEXT_GLUE
 
Msgid
, Msgid, 
MsgidPlul
, 
N
, 
LC_MESSAGES
)

	)

132 
	#dpgxt
(
Domame
, 
Msgxt
, 
Msgid
, 
MsgidPlul
, 
N
, 
Cegy
) \

133 
	`gxt_aux
 (
Domame
, 
Msgxt
 
GETTEXT_CONTEXT_GLUE
 
Msgid
, Msgid, 
MsgidPlul
, 
N
, 
Cegy
)

	)

135 #ifde
__GNUC__


136 
	g__le


138 #ifde
__lulus


139 
	gle


143 
	$pgxt_aux
 (cڡ *
doma
,

144 cڡ *
msg_xt_id
, cڡ *
msgid
,

145 
gy
)

147 cڡ *
i
 = 
	`dcgxt
 (
doma
, 
msg_xt_id
, 
gy
);

148 i(
i
 =
msg_xt_id
)

149  
msgid
;

151  
i
;

152 
	}
}

154 #ifde
__GNUC__


155 
	g__le


157 #ifde
__lulus


158 
	gle


162 
	$gxt_aux
 (cڡ *
doma
,

163 cڡ *
msg_xt_id
, cڡ *
msgid
,

164 cڡ *
msgid_ul
, 
n
,

165 
gy
)

167 cڡ *
i
 =

168 
	`dgxt
 (
doma
, 
msg_xt_id
, 
msgid_ul
, 
n
, 
gy
);

169 i(
i
 =
msg_xt_id
 ||ni =
msgid_ul
)

170  (
n
 =1 ? 
msgid
 : 
msgid_ul
);

172  
i
;

173 
	}
}

179 
	~<rg.h
>

181 
	#_LIBGETTEXT_HAVE_VARIABLE_SIZE_ARRAYS
 \

182 (((
__GNUC__
 >3 || 
__GNUG__
 >2&& !
__STRICT_ANSI__
) \

183  )

	)

185 #i!
_LIBGETTEXT_HAVE_VARIABLE_SIZE_ARRAYS


186 
	~<dlib.h
>

189 
	#pgxt_ex
(
Msgxt
, 
Msgid
) \

190 
	`dgxt_ex
 (
NULL
, 
Msgxt
, 
Msgid
, 
LC_MESSAGES
)

	)

191 
	#dpgxt_ex
(
Domame
, 
Msgxt
, 
Msgid
) \

192 
	`dgxt_ex
 (
Domame
, 
Msgxt
, 
Msgid
, 
LC_MESSAGES
)

	)

194 #ifde
__GNUC__


195 
	g__le


197 #ifde
__lulus


198 
	gle


202 
	$dgxt_ex
 (cڡ *
doma
,

203 cڡ *
msgxt
, cڡ *
msgid
,

204 
gy
)

206 
size_t
 
msgxt_n
 = 
	`
 (
msgxt
) + 1;

207 
size_t
 
msgid_n
 = 
	`
 (
msgid
) + 1;

208 cڡ *
i
;

209 #i
_LIBGETTEXT_HAVE_VARIABLE_SIZE_ARRAYS


210 
msg_xt_id
[
msgxt_n
 + 
msgid_n
];

212 
buf
[1024];

213 *
msg_xt_id
 =

214 (
msgxt_n
 + 
msgid_n
 < (
buf
)

215 ? 
buf


216 : (*
	`mloc
 (
msgxt_n
 + 
msgid_n
));

217 i(
msg_xt_id
 !
NULL
)

220 
	`memy
 (
msg_xt_id
, 
msgxt
, 
msgxt_n
 - 1);

221 
msg_xt_id
[
msgxt_n
 - 1] = '\004';

222 
	`memy
 (
msg_xt_id
 + 
msgxt_n
, 
msgid
, 
msgid_n
);

223 
i
 = 
	`dcgxt
 (
doma
, 
msg_xt_id
, 
gy
);

224 #i!
_LIBGETTEXT_HAVE_VARIABLE_SIZE_ARRAYS


225 i(
msg_xt_id
 !
buf
)

226 
	`
 (
msg_xt_id
);

228 i(
i
 !
msg_xt_id
)

229  
i
;

231  
msgid
;

232 
	}
}

234 
	#gxt_ex
(
Msgxt
, 
Msgid
, 
MsgidPlul
, 
N
) \

235 
	`dpgxt_ex
 (
NULL
, 
Msgxt
, 
Msgid
, 
MsgidPlul
, 
N
, 
LC_MESSAGES
)

	)

236 
	#dgxt_ex
(
Domame
, 
Msgxt
, 
Msgid
, 
MsgidPlul
, 
N
) \

237 
	`dpgxt_ex
 (
Domame
, 
Msgxt
, 
Msgid
, 
MsgidPlul
, 
N
, 
LC_MESSAGES
)

	)

239 #ifde
__GNUC__


240 
	g__le


242 #ifde
__lulus


243 
	gle


247 
	$dpgxt_ex
 (cڡ *
doma
,

248 cڡ *
msgxt
, cڡ *
msgid
,

249 cڡ *
msgid_ul
, 
n
,

250 
gy
)

252 
size_t
 
msgxt_n
 = 
	`
 (
msgxt
) + 1;

253 
size_t
 
msgid_n
 = 
	`
 (
msgid
) + 1;

254 cڡ *
i
;

255 #i
_LIBGETTEXT_HAVE_VARIABLE_SIZE_ARRAYS


256 
msg_xt_id
[
msgxt_n
 + 
msgid_n
];

258 
buf
[1024];

259 *
msg_xt_id
 =

260 (
msgxt_n
 + 
msgid_n
 < (
buf
)

261 ? 
buf


262 : (*
	`mloc
 (
msgxt_n
 + 
msgid_n
));

263 i(
msg_xt_id
 !
NULL
)

266 
	`memy
 (
msg_xt_id
, 
msgxt
, 
msgxt_n
 - 1);

267 
msg_xt_id
[
msgxt_n
 - 1] = '\004';

268 
	`memy
 (
msg_xt_id
 + 
msgxt_n
, 
msgid
, 
msgid_n
);

269 
i
 = 
	`dgxt
 (
doma
, 
msg_xt_id
, 
msgid_ul
, 
n
, 
gy
);

270 #i!
_LIBGETTEXT_HAVE_VARIABLE_SIZE_ARRAYS


271 i(
msg_xt_id
 !
buf
)

272 
	`
 (
msg_xt_id
);

274 i(!(
i
 =
msg_xt_id
 ||ni =
msgid_ul
))

275  
i
;

277  (
n
 =1 ? 
msgid
 : 
msgid_ul
);

278 
	}
}

	@lib/rclib-album.c

26 
	~"rib-bum.h
"

27 
	~"rib-comm.h
"

28 
	~"rib-ce.h
"

29 
	~"rib-db.h
"

30 
	~"rib-ut.h
"

31 
	~"rib-msh.h
"

44 
	s_RCLibAlbumPrive


46 
RCLibAlbumTy
 
	mty
;

47 
gpor
 
	mbum_da
;

48 
gulg
 
	mg_found_hdr
;

49 
gulg
 
	muri_chged_hdr
;

54 
	mSIGNAL_ALBUM_FOUND
,

55 
	mSIGNAL_ALBUM_NONE
,

56 
	mSIGNAL_LAST


59 
GObje
 *
	gbum_
 = 
NULL
;

60 
gpor
 
	grib_bum__ass
 = 
NULL
;

61 
gt
 
	gbum_sigls
[
SIGNAL_LAST
] = {0};

63 
	$rib_bum_g_found_cb
(
RCLibCe
 *
ce
,

64 cڡ 
RCLibCeMada
 *
mada
, cڡ 
gch
 *
uri
, 
gpor
 
da
)

66 
gch
 *
fame
;

67 
gboޗn
 
ag
 = 
TRUE
;

68 
RCLibAlbumPrive
 *
iv
 = (RCLibAlbumPriv*)
da
;

69 if(
da
==
NULL
) ;

70 if(
iv
->
bum_da
!=
NULL
) ;

71 
fame
 = 
	`rib_ut_ch_cov
(
uri
, 
mada
->
t
,

72 
mada
->
ti
, mada->
bum
);

73 if(
fame
!=
NULL
 && 
	`g_fe_
(fame, 
G_FILE_TEST_EXISTS
))

75 
	`g_sigl_em
(
bum_
, 
bum_sigls
[
SIGNAL_ALBUM_FOUND
], 0,

76 
RCLIB_ALBUM_TYPE_FILENAME
, 
fame
, &
ag
);

77 if(
ag
)

79 
iv
->
ty
 = 
RCLIB_ALBUM_TYPE_FILENAME
;

80 
iv
->
bum_da
 = (
gpor
)
	`g_rdup
(
fame
);

83 if(
mada
->
image
!=
NULL
)

85 
	`g_sigl_em
(
bum_
, 
bum_sigls
[
SIGNAL_ALBUM_FOUND
], 0,

86 
RCLIB_ALBUM_TYPE_BUFFER
, 
mada
->
image
, &
ag
);

87 if(
ag
)

89 
iv
->
ty
 = 
RCLIB_ALBUM_TYPE_BUFFER
;

90 
iv
->
bum_da
 = 
	`g_bufr_f
(
mada
->
image
);

93 
	}
}

95 
	$rib_bum_uri_chged_cb
(
RCLibCe
 *
ce
, cڡ 
gch
 *
uri
,

96 
gpor
 
da
)

98 
GSequIr
 *
n
;

99 
gch
 *
fame
 = 
NULL
;

100 
gboޗn
 
ag
 = 
TRUE
;

101 
RCLibAlbumPrive
 *
iv
 = (RCLibAlbumPriv*)
da
;

102 if(
da
==
NULL
) ;

103 if(
iv
->
bum_da
!=
NULL
)

105 if(
iv
->
ty
==
RCLIB_ALBUM_TYPE_BUFFER
)

106 
	`g_bufr_uef
((
GBufr
 *)
iv
->
bum_da
);

108 
	`g_
(
iv
->
bum_da
);

109 
iv
->
bum_da
 = 
NULL
;

111 
n
 = 
	`rib_ce_g_db_n
();

112 if(
n
!=
NULL
)

113 
fame
 = 
	`g_rdup
(
	`rib_db_ayli_g_bum_bd
(
n
));

114 if(
fame
==
NULL
)

115 
fame
 = 
	`rib_ut_ch_cov
(
uri
, 
NULL
, NULL, NULL);

116 if(
fame
!=
NULL
 && 
	`g_fe_
(fame, 
G_FILE_TEST_EXISTS
))

118 
	`g_sigl_em
(
bum_
, 
bum_sigls
[
SIGNAL_ALBUM_FOUND
], 0,

119 
RCLIB_ALBUM_TYPE_FILENAME
, 
fame
, &
ag
);

120 if(
ag
)

122 
iv
->
ty
 = 
RCLIB_ALBUM_TYPE_FILENAME
;

123 
iv
->
bum_da
 = (
gpor
)
	`g_rdup
(
fame
);

127 
	`g_sigl_em
(
bum_
, 
bum_sigls
[
SIGNAL_ALBUM_NONE
], 0);

128 
	`g_
(
fame
);

129 
	}
}

131 
	$rib_bum_fize
(
GObje
 *
obje
)

133 
RCLibAlbumPrive
 *
iv
 = 
	`RCLIB_ALBUM
(
obje
)->priv;

134 if(
iv
->
g_found_hdr
>0)

135 
	`rib_ce_sigl_disc
(
iv
->
g_found_hdr
);

136 if(
iv
->
uri_chged_hdr
>0)

137 
	`rib_ce_sigl_disc
(
iv
->
uri_chged_hdr
);

138 
	`G_OBJECT_CLASS
(
rib_bum__ass
)->
	`fize
(
obje
);

139 
	}
}

141 
GObje
 *
	$rib_bum_cڡru
(
GTy
 
ty
, 
gut
 
n_cڡru_ms
,

142 
GObjeCڡruPam
 *
cڡru_ms
)

144 
GObje
 *
tv
;

145 if(
bum_
!=
NULL
) lbum_instance;

146 
tv
 = 
	`G_OBJECT_CLASS
(
rib_bum__ass
)->
cڡru


147 (
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

148 
bum_
 = 
tv
;

149 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
bum_
);

150  
tv
;

151 
	}
}

153 
	$rib_bum_ass_
(
RCLibAlbumCss
 *
kss
)

155 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

156 
rib_bum__ass
 = 
	`g_ty_ass_ek_
(
kss
);

157 
obje_ass
->
fize
 = 
rib_bum_fize
;

158 
obje_ass
->
cڡru
 = 
rib_bum_cڡru
;

159 
	`g_ty_ass_add_ive
(
kss
, (
RCLibAlbumPrive
));

173 
bum_sigls
[
SIGNAL_ALBUM_FOUND
] = 
	`g_sigl_w
("album-found",

174 
RCLIB_TYPE_ALBUM
, 
G_SIGNAL_RUN_LAST
,

175 
	`G_STRUCT_OFFSET
(
RCLibAlbumCss
, 
bum_found
), 
NULL
, NULL,

176 
rib_msh_BOOLEAN__UINT_POINTER
, 
G_TYPE_BOOLEAN
, 2, 
G_TYPE_UINT
,

177 
G_TYPE_POINTER
, 
NULL
);

186 
bum_sigls
[
SIGNAL_ALBUM_NONE
] = 
	`g_sigl_w
("album-none",

187 
RCLIB_TYPE_ALBUM
, 
G_SIGNAL_RUN_FIRST
,

188 
	`G_STRUCT_OFFSET
(
RCLibAlbumCss
, 
bum_ne
), 
NULL
, NULL,

189 
g_cosu_msh_VOID__VOID
, 
G_TYPE_NONE
, 0, G_TYPE_NONE, 
NULL
);

190 
	}
}

192 
	$rib_bum__
(
RCLibAlbum
 *
bum
)

194 
RCLibAlbumPrive
 *
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
bum
,

195 
RCLIB_TYPE_ALBUM
, 
RCLibAlbumPrive
);

196 
bum
->
iv
 =riv;

197 
iv
->
g_found_hdr
 = 
	`rib_ce_sigl_c
("tag-found",

198 
	`G_CALLBACK
(
rib_bum_g_found_cb
), 
iv
);

199 
iv
->
uri_chged_hdr
 = 
	`rib_ce_sigl_c
("uri-changed",

200 
	`G_CALLBACK
(
rib_bum_uri_chged_cb
), 
iv
);

201 
	}
}

203 
GTy
 
	$rib_bum_g_ty
()

205 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

206 
GTy
 
g_defe_ty_id
;

207 cڡ 
GTyInfo
 
bum_fo
 = {

208 .
ass_size
 = (
RCLibAlbumCss
),

209 .
ba_
 = 
NULL
,

210 .
ba_fize
 = 
NULL
,

211 .
ass_
 = (
GCssInFunc
)
rib_bum_ass_
,

212 .
ass_fize
 = 
NULL
,

213 .
ass_da
 = 
NULL
,

214 .
_size
 = (
RCLibAlbum
),

215 .
n_ocs
 = 0,

216 .
_
 = (
GInInFunc
)
rib_bum__


218 if(
	`g___r
(&
g_defe_ty_id__vީe
))

220 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
G_TYPE_OBJECT
,

221 
	`g__ic_rg
("RCLibAlbum"), &
bum_fo
, 0);

222 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

224  
g_defe_ty_id__vީe
;

225 
	}
}

233 
	$rib_bum_
()

235 
	`g_mesge
("Loadinglbum imagerocessor....");

236 
bum_
 = 
	`g_obje_w
(
RCLIB_TYPE_ALBUM
, 
NULL
);

237 
	`g_mesge
("Albumrocessoroaded.");

238 
	}
}

246 
	$rib_bum_ex
()

248 if(
bum_
!=
NULL

	`g_obje_uef
(album_instance);

249 
bum_
 = 
NULL
;

250 
	`g_mesge
("Albumrocessorxited.");

251 
	}
}

261 
GObje
 *
	$rib_bum_g_
()

263  
bum_
;

264 
	}
}

278 
gulg
 
	$rib_bum_sigl_c
(cڡ 
gch
 *
me
,

279 
GClback
 
back
, 
gpor
 
da
)

281 if(
bum_
==
NULL
)  0;

282  
	`g_sigl_c
(
bum_
, 
me
, 
back
, 
da
);

283 
	}
}

295 
	$rib_bum_sigl_disc
(
gulg
 
hdr_id
)

297 if(
bum_
==
NULL
) ;

298 
	`g_sigl_hdr_disc
(
bum_
, 
hdr_id
);

299 
	}
}

311 
gboޗn
 
	$rib_bum_g_bum_da
(
RCLibAlbumTy
 *
ty
, 
gpor
 *
da
)

313 
RCLibAlbumPrive
 *
iv
;

314 if(
bum_
==
NULL
 
FALSE
;

315 
iv
 = 
	`RCLIB_ALBUM
(
bum_
)->priv;

316 if(
iv
==
NULL
 
FALSE
;

317 if(
iv
->
bum_da
==
NULL
 
FALSE
;

318 if(
ty
!=
NULL
*ty = 
iv
->type;

319 if(
da
!=
NULL
*d
iv
->
bum_da
;

320  
TRUE
;

321 
	}
}

332 
gboޗn
 
	$rib_bum_ve_fe
(cڡ 
gch
 *
fame
)

334 
RCLibAlbumPrive
 *
iv
;

335 
GE
 *
r
 = 
NULL
;

336 
GBufr
 *
bufr
;

337 
GFe
 *
fe_c
, *
fe_d
;

338 
gboޗn
 
ag
;

339 if(
bum_
==
NULL
 
FALSE
;

340 
iv
 = 
	`RCLIB_ALBUM
(
bum_
)->priv;

341 if(
iv
==
NULL
 
FALSE
;

342 if(
iv
->
bum_da
==
NULL
 
FALSE
;

343 if(
iv
->
ty
==
RCLIB_ALBUM_TYPE_BUFFER
)

345 
bufr
 = (
GBufr
 *)
iv
->
bum_da
;

346 
ag
 =
	`g_fe_t_cڋs
(
fame
, (cڡ 
gch
 *)
bufr
->
da
,

347 
bufr
->
size
, &
r
);

348 if(!
ag
)

350 
	`g_wng
("Cn savbum da: %s", 
r
->
mesge
);

351 
	`g_r_
(
r
);

353  
ag
;

355 if(
iv
->
ty
==
RCLIB_ALBUM_TYPE_FILENAME
)

357 
fe_c
 = 
	`g_fe_w_f_th
((cڡ 
gch
 *)
iv
->
bum_da
);

358 
fe_d
 = 
	`g_fe_w_f_th
((cڡ 
gch
 *)
fame
);

359 if(
fe_c
==
NULL
 || 
fe_d
==NULL)

361 if(
fe_c
!=
NULL

	`g_obje_uef
(file_src);

362 if(
fe_d
!=
NULL

	`g_obje_uef
(file_dst);

363  
FALSE
;

365 
ag
 = 
	`g_fe_cy
(
fe_c
, 
fe_d
, 
G_FILE_COPY_OVERWRITE
, 
NULL
,

366 
NULL
, NULL, &
r
);

367 if(!
ag
)

369 
	`g_wng
("Cn savbum fe: %s", 
r
->
mesge
);

370 
	`g_r_
(
r
);

372  
ag
;

374  
FALSE
;

375 
	}
}

	@lib/rclib-album.h

25 #ide
HAVE_RCLIB_ALBUM_H


26 
	#HAVE_RCLIB_ALBUM_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<gio/gio.h
>

32 
	gG_BEGIN_DECLS


34 
	#RCLIB_TYPE_ALBUM
 (
	`rib_bum_g_ty
())

	)

35 
	#RCLIB_ALBUM
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

36 
RCLIB_TYPE_ALBUM
, 
RCLibAlbum
))

	)

37 
	#RCLIB_ALBUM_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_CAST
((k), \

38 
RCLIB_TYPE_ALBUM
, 
RCLibAlbumCss
))

	)

39 
	#RCLIB_IS_ALBUM
(
o
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((o), \

40 
RCLIB_TYPE_ALBUM
))

	)

41 
	#RCLIB_IS_ALBUM_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_TYPE
((k), \

42 
RCLIB_TYPE_ALBUM
))

	)

43 
	#RCLIB_ALBUM_GET_CLASS
(
o
(
	`G_TYPE_INSTANCE_GET_CLASS
((o), \

44 
RCLIB_TYPE_ALBUM
, 
RCLibAlbumCss
))

	)

55 
	mRCLIB_ALBUM_TYPE_FILENAME
,

56 
	mRCLIB_ALBUM_TYPE_BUFFER


57 }
	tRCLibAlbumTy
;

59 
_RCLibAlbum
 
	tRCLibAlbum
;

60 
_RCLibAlbumCss
 
	tRCLibAlbumCss
;

61 
_RCLibAlbumPrive
 
	tRCLibAlbumPrive
;

70 
	s_RCLibAlbum
 {

72 
GObje
 
	m
;

73 
RCLibAlbumPrive
 *
	miv
;

82 
	s_RCLibAlbumCss
 {

84 
GObjeCss
 
	m_ass
;

85 (*
	mbum_found
)(
RCLibAlbum
 *
	mbum
, 
gut
 
	mty
, 
gpor
 
	mbum_da
);

86 (*
	mbum_ne
)(
RCLibAlbum
 *
	mbum
);

90 
GTy
 
rib_bum_g_ty
();

93 
rib_bum_
();

94 
rib_bum_ex
();

95 
GObje
 *
rib_bum_g_
();

96 
gulg
 
rib_bum_sigl_c
(cڡ 
gch
 *
me
,

97 
GClback
 
back
, 
gpor
 
da
);

98 
rib_bum_sigl_disc
(
gulg
 
hdr_id
);

99 
gboޗn
 
rib_bum_g_bum_da
(
RCLibAlbumTy
 *
ty
, 
gpor
 *
da
);

100 
gboޗn
 
rib_bum_ve_fe
(cڡ 
gch
 *
fame
);

102 
	gG_END_DECLS


	@lib/rclib-common.h

25 #ide
HAVE_RCLIB_COMMON_H


26 
	#HAVE_RCLIB_COMMON_H


	)

28 
	~<glib.h
>

29 
	~<glib/gi18n.h
>

31 
	gG_BEGIN_DECLS


33 #ifde
G_LOG_DOMAIN


34 #unde
G_LOG_DOMAIN


37 
	#G_LOG_DOMAIN
 "LibRhythmC2"

	)

38 
	#GETTEXT_PACKAGE
 "RhythmC2"

	)

39 
	#PACKAGE
 "RhythmC2"

	)

41 
	gG_END_DECLS


	@lib/rclib-core.c

26 
	~"rib-ce.h
"

27 
	~"rib-comm.h
"

28 
	~"rib-msh.h
"

29 
	~"rib-db.h
"

30 
	~"rib-cue.h
"

31 
	~"rib-g.h
"

43 
	#RCLIB_CORE_ERROR
 
	`rib_ce_r_quk
()

	)

47 
	mGST_PLAY_FLAG_VIDEO
 = (1 << 0),

48 
	mGST_PLAY_FLAG_AUDIO
 = (1 << 1),

49 
	mGST_PLAY_FLAG_TEXT
 = (1 << 2),

50 
	mGST_PLAY_FLAG_VIS
 = (1 << 3),

51 
	mGST_PLAY_FLAG_SOFT_VOLUME
 = (1 << 4),

52 
	mGST_PLAY_FLAG_NATIVE_AUDIO
 = (1 << 5),

53 
	mGST_PLAY_FLAG_NATIVE_VIDEO
 = (1 << 6),

54 
	mGST_PLAY_FLAG_DOWNLOAD
 = (1 << 7),

55 
	mGST_PLAY_FLAG_BUFFERING
 = (1 << 8),

56 
	mGST_PLAY_FLAG_DEINTERLACE
 = (1 << 9)

57 }
	tGPyFgs
;

59 
	s_RCLibCePrive


61 
GEmt
 *
	mayb
;

62 
GEmt
 *
	maudiosk
;

63 
GEmt
 *
	mvideosk
;

64 
GEmt
 *
	midty
;

65 
GEmt
 *
	mefb
;

66 
GEmt
 *
	mb_ug
;

67 
GEmt
 *
	meq_ug
;

68 
GBus
 *
	mbus
;

69 
GPad
 *
	mquy_d
;

70 
GLi
 *
	mexa_ug_li
;

71 
GE
 *
	mr
;

72 
gch
 *
	muri
;

73 
RCLibCeSourTy
 
	mty
;

74 
GS
 
	mϡ_e
;

75 
gt64
 
	mt_time
;

76 
gt64
 
	md_time
;

77 
RCLibCeMada
 
	mmada
;

78 
gt64
 
	mduti
;

79 
gt
 
	mme_
;

80 
gt
 
	mchls
;

81 
gt
 
	mdth
;

82 
RCLibCeEQTy
 
	meq_ty
;

83 
GSequIr
 *
	mdb_n
;

84 
GSequIr
 *
	mdb_n_e
;

85 
gpor
 
	mext_n
;

86 
gpor
 
	mext_n_e
;

87 
gch
 *
	mext_cook
;

88 
gch
 *
	mext_cook_e
;

89 
GAsyncQueue
 *
	mg_upde_queue
;

90 
gboޗn
 
	mg_sigl_emd
;

91 
gulg
 
	midty_id
;

92 
gulg
 
	mmesge_id
;

93 
gulg
 
	mvume_id
;

94 
gulg
 
	maudio_g_chged_id
;

95 
gulg
 
	msour_id
;

96 
gut
 
	mg_upde_id
;

101 
	mSIGNAL_STATE_CHANGED
,

102 
	mSIGNAL_EOS
,

103 
	mSIGNAL_TAG_FOUND
,

104 
	mSIGNAL_NEW_DURATION
,

105 
	mSIGNAL_URI_CHANGED
,

106 
	mSIGNAL_VOLUME_CHANGED
,

107 
	mSIGNAL_EQ_CHANGED
,

108 
	mSIGNAL_BALANCE_CHANGED
,

109 
	mSIGNAL_BUFFERING
,

110 
	mSIGNAL_BUFFER_PROBE
,

111 
	mSIGNAL_ERROR
,

112 
	mSIGNAL_LAST


115 
	sRCLibCeEQDa


117 cڡ 
gch
 *
	mme
;

118 
gdoub
 
	mda
[10];

119 }
	gce_eq_da
[
RCLIB_CORE_EQ_TYPE_CUSTOM
] =

121 {.
me
 = 
N_
("None"),

122 .
	gda
 = { 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}},

123 {.
	gme
 = 
N_
("Pop"),

124 .
	gda
 = { 3.0, 1.0, 0.0,-2.0,-4.0,-4.0,-2.0, 0.0, 1.0, 2.0}},

125 {.
	gme
 = 
N_
("Rock"),

126 .
	gda
 = {-2.0, 0.0, 2.0, 4.0,-2.0,-2.0, 0.0, 0.0, 4.0, 4.0}},

127 {.
	gme
 = 
N_
("Metal"),

128 .
	gda
 = {-6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0}},

129 {.
	gme
 = 
N_
("Dance"),

130 .
	gda
 = {-2.0, 3.0, 4.0, 1.0,-2.0,-2.0, 0.0, 0.0, 4.0, 4.0}},

131 {.
	gme
 = 
N_
("Electronic"),

132 .
	gda
 = {-6.0, 1.0, 4.0,-2.0,-2.0,-4.0, 0.0, 0.0, 6.0, 6.0}},

133 {.
	gme
 = 
N_
("Jazz"),

134 .
	gda
 = { 0.0, 0.0, 0.0, 4.0, 4.0, 4.0, 0.0, 2.0, 3.0, 4.0}},

135 {.
	gme
 = 
N_
("Classical"),

136 .
	gda
 = { 0.0, 5.0, 5.0, 4.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0}},

137 {.
	gme
 = 
N_
("Blues"),

138 .
	gda
 = {-2.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0,-2.0,-4.0}},

139 {.
	gme
 = 
N_
("Vocal"),

140 .
	gda
 = {-4.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0,-4.0,-6.0}}

143 
GObje
 *
	gce_
 = 
NULL
;

144 
gpor
 
	grib_ce__ass
 = 
NULL
;

145 
gt
 
	gce_sigls
[
SIGNAL_LAST
] = {0};

147 
GQuk
 
	$rib_ce_r_quk
()

149  
	`g_quk_om_ic_rg
("rclib-core-error-quark");

150 
	}
}

152 
	$rib_ce_mada_
(
RCLibCeMada
 *
mada
)

154 if(
mada
==
NULL
) ;

155 if(
mada
->
image
!=
NULL

	`g_bufr_uef
(metadata->image);

156 
	`g_
(
mada
->
t
);

157 
	`g_
(
mada
->
ti
);

158 
	`g_
(
mada
->
bum
);

159 
	`g_
(
mada
->
y
);

160 
	`memt
(
mada
, 0, (
RCLibCeMada
));

161 
	}
}

163 
le
 
gboޗn
 
	$rib_ce_r_mada
(cڡ 
GTagLi
 *
gs
,

164 
RCLibCeMada
 *
mada
, 
gut64
 
t_time
,

165 
gut64
 
d_time
)

167 
gch
 *
rg
 = 
NULL
;

168 
gboޗn
 
upde
 = 
FALSE
;

169 
GBufr
 *
bufr
 = 
NULL
;

170 
GDe
 *
de
 = 
NULL
;

171 
gut
 
vue
 = 0;

172 
gt
 
tv
 = 0;

173 if(
	`g_g_li_g_rg
(
gs
, 
GST_TAG_TITLE
, &
rg
))

175 if(
	`g_rcmp0
(
rg
, 
mada
->
t
)!=0)

177 
	`g_
(
mada
->
t
);

178 
mada
->
t
 = 
	`g_rdup
(
rg
);

179 
upde
 = 
TRUE
;

181 
	`g_
(
rg
);

183 if(
	`g_g_li_g_rg
(
gs
, 
GST_TAG_ARTIST
, &
rg
))

185 if(
	`g_rcmp0
(
rg
, 
mada
->
ti
)!=0)

187 
	`g_
(
mada
->
ti
);

188 
mada
->
ti
 = 
	`g_rdup
(
rg
);

189 
upde
 = 
TRUE
;

191 
	`g_
(
rg
);

193 if(
	`g_g_li_g_rg
(
gs
, 
GST_TAG_ALBUM
, &
rg
))

195 if(
	`g_rcmp0
(
rg
, 
mada
->
bum
)!=0)

197 
	`g_
(
mada
->
bum
);

198 
mada
->
bum
 = 
	`g_rdup
(
rg
);

199 
upde
 = 
TRUE
;

201 
	`g_
(
rg
);

203 if(
	`g_g_li_g_rg
(
gs
, 
GST_TAG_AUDIO_CODEC
, &
rg
))

205 if(
	`g_rcmp0
(
rg
, 
mada
->
y
)!=0)

207 
	`g_
(
mada
->
y
);

208 
mada
->
y
 = 
	`g_rdup
(
rg
);

209 
upde
 = 
TRUE
;

211 
	`g_
(
rg
);

213 if(
	`g_g_li_g_bufr
(
gs
, 
GST_TAG_IMAGE
, &
bufr
))

215 if(
mada
->
image
==
NULL
)

217 
mada
->
image
 = 
	`g_bufr_f
(
bufr
);

218 
upde
 = 
TRUE
;

220 
	`g_bufr_uef
(
bufr
);

222 if(
	`g_g_li_g_bufr
(
gs
, 
GST_TAG_PREVIEW_IMAGE
, &
bufr
))

224 if(
mada
->
image
==
NULL
)

226 
mada
->
image
 = 
	`g_bufr_f
(
bufr
);

227 
upde
 = 
TRUE
;

229 
	`g_bufr_uef
(
bufr
);

231 if(
	`g_g_li_g_ut
(
gs
, 
GST_TAG_NOMINAL_BITRATE
, &
vue
))

233 if(
mada
->
b
==0 && 
vue
>0)

235 
mada
->
b
 = 
vue
;

236 
upde
 = 
TRUE
;

239 if(
	`g_g_li_g_ut
(
gs
, 
GST_TAG_TRACK_NUMBER
, &
vue
))

241 if(
mada
->
ack
!=
vue
)

243 
mada
->
ack
 = 
vue
;

244 
upde
 = 
TRUE
;

247 if(
	`g_g_li_g_de
(
gs
, 
GST_TAG_DATE
, &
de
))

249 
tv
 = 
	`g_de_g_yr
(
de
);

250 
	`g_de_
(
de
);

251 if(
mada
->
yr
!=
tv
)

253 
mada
->
yr
 = 
tv
;

254 
upde
 = 
TRUE
;

257  
upde
;

258 
	}
}

261 
	$rib_ce_fize
(
GObje
 *
obje
)

263 
RCLibCePrive
 *
iv
 = 
	`RCLIB_CORE
(
obje
)->priv;

264 if(
iv
->
quy_d
!=
NULL
)

266 
	`g_obje_uef
(
iv
->
quy_d
);

268 if(
iv
->
bus
!=
NULL
)

270 if(
iv
->
mesge_id
>0)

271 
	`g_sigl_hdr_disc
(
iv
->
bus
,riv->
mesge_id
);

272 
	`g_obje_uef
(
iv
->
bus
);

274 if(
iv
->
g_upde_id
!=0)

275 
	`g_sour_move
(
iv
->
g_upde_id
);

276 if(
iv
->
idty
!=
NULL
 &&riv->
idty_id
>0)

277 
	`g_sigl_hdr_disc
(
iv
->
idty
,riv->
idty_id
);

278 if(
iv
->
ayb
!=
NULL
)

280 if(
iv
->
vume_id
>0)

281 
	`g_sigl_hdr_disc
(
iv
->
ayb
,riv->
vume_id
);

282 if(
iv
->
audio_g_chged_id
>0)

284 
	`g_sigl_hdr_disc
(
iv
->
ayb
,

285 
iv
->
audio_g_chged_id
);

287 if(
iv
->
sour_id
>0)

288 
	`g_sigl_hdr_disc
(
iv
->
ayb
,riv->
sour_id
);

289 
	`g_emt_t_e
(
iv
->
ayb
, 
GST_STATE_NULL
);

291 if(
iv
->
g_upde_queue
!=
NULL
)

292 
	`g_async_queue_uef
(
iv
->
g_upde_queue
);

293 if(
iv
->
exa_ug_li
!=
NULL
)

294 
	`g_li_
(
iv
->
exa_ug_li
);

295 if(
iv
->
ayb
!=
NULL
)

296 
	`g_obje_uef
(
iv
->
ayb
);

297 
	`G_OBJECT_CLASS
(
rib_ce__ass
)->
	`fize
(
obje
);

298 
	}
}

300 
GObje
 *
	$rib_ce_cڡru
(
GTy
 
ty
, 
gut
 
n_cڡru_ms
,

301 
GObjeCڡruPam
 *
cڡru_ms
)

303 
GObje
 *
tv
;

304 if(
ce_
!=
NULL
)  core_instance;

305 
tv
 = 
	`G_OBJECT_CLASS
(
rib_ce__ass
)->
cڡru


306 (
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

307 
ce_
 = 
tv
;

308 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
ce_
);

309  
tv
;

310 
	}
}

313 
	$rib_ce_ass_
(
RCLibCeCss
 *
kss
)

315 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

316 
rib_ce__ass
 = 
	`g_ty_ass_ek_
(
kss
);

317 
obje_ass
->
fize
 = 
rib_ce_fize
;

318 
obje_ass
->
cڡru
 = 
rib_ce_cڡru
;

319 
	`g_ty_ass_add_ive
(
kss
, (
RCLibCePrive
));

329 
ce_sigls
[
SIGNAL_STATE_CHANGED
] = 
	`g_sigl_w
("state-changed",

330 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

331 
e_chged
), 
NULL
, NULL, 
g_cosu_msh_VOID__INT
,

332 
G_TYPE_NONE
, 1, 
G_TYPE_INT
, 
NULL
);

341 
ce_sigls
[
SIGNAL_EOS
] = 
	`g_sigl_w
("eos", 
RCLIB_TYPE_CORE
,

342 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
, 
eos
),

343 
NULL
, NULL, 
g_cosu_msh_VOID__VOID
,

344 
G_TYPE_NONE
, 0, G_TYPE_NONE, 
NULL
);

356 
ce_sigls
[
SIGNAL_TAG_FOUND
] = 
	`g_sigl_w
("tag-found",

357 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

358 
g_found
), 
NULL
, NULL, 
rib_msh_VOID__POINTER_STRING
,

359 
G_TYPE_NONE
, 2, 
G_TYPE_POINTER
, 
G_TYPE_STRING
, 
NULL
);

369 
ce_sigls
[
SIGNAL_NEW_DURATION
] = 
	`g_sigl_w
("new-duration",

370 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

371 
w_duti
), 
NULL
, NULL, 
rib_msh_VOID__INT64
,

372 
G_TYPE_NONE
, 1, 
G_TYPE_INT64
, 
NULL
);

381 
ce_sigls
[
SIGNAL_URI_CHANGED
] = 
	`g_sigl_w
("uri-changed",

382 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

383 
uri_chged
), 
NULL
, NULL, 
g_cosu_msh_VOID__STRING
,

384 
G_TYPE_NONE
, 1, 
G_TYPE_STRING
, 
NULL
);

393 
ce_sigls
[
SIGNAL_VOLUME_CHANGED
] = 
	`g_sigl_w
("volume-changed",

394 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

395 
vume_chged
), 
NULL
, NULL, 
g_cosu_msh_VOID__DOUBLE
,

396 
G_TYPE_NONE
, 1, 
G_TYPE_DOUBLE
, 
NULL
);

407 
ce_sigls
[
SIGNAL_EQ_CHANGED
] = 
	`g_sigl_w
("eq-changed",

408 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

409 
eq_chged
), 
NULL
, NULL, 
g_cosu_msh_VOID__UINT_POINTER
,

410 
G_TYPE_NONE
, 2, 
G_TYPE_UINT
, 
G_TYPE_POINTER
, 
NULL
);

419 
ce_sigls
[
SIGNAL_BALANCE_CHANGED
] = 
	`g_sigl_w
("balance-changed",

420 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

421 
b_chged
), 
NULL
, NULL, 
g_cosu_msh_VOID__FLOAT
,

422 
G_TYPE_NONE
, 1, 
G_TYPE_FLOAT
, 
NULL
);

431 
ce_sigls
[
SIGNAL_BUFFERING
] = 
	`g_sigl_w
("buffering",

432 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

433 
bufrg
), 
NULL
, NULL, 
g_cosu_msh_VOID__INT
, 
G_TYPE_NONE
,

434 1, 
G_TYPE_INT
, 
NULL
);

445 
ce_sigls
[
SIGNAL_BUFFER_PROBE
] = 
	`g_sigl_w
("buffer-probe",

446 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

447 
bufr_obe
), 
NULL
, NULL, 
g_cosu_msh_VOID__POINTER
,

448 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
, 
NULL
);

456 
ce_sigls
[
SIGNAL_ERROR
] = 
	`g_sigl_w
("error",

457 
RCLIB_TYPE_CORE
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibCeCss
,

458 
r
), 
NULL
, NULL, 
g_cosu_msh_VOID__STRING
,

459 
G_TYPE_NONE
, 1, 
G_TYPE_STRING
, 
NULL
);

460 
	}
}

462 
gboޗn
 
	$rib_ce_ef_add_emt_
(
GEmt
 *
efb
,

463 
GEmt
 *
w_emt
, 
gboޗn
 
block
)

465 
GPad
 *
bskd
;

466 
GPad
 *
bad
;

467 
GPad
 *
d
;

468 
GPad
 *
evd
;

469 
GPad
 *
ad
, *
blockd
;

470 
GEmt
 *
b
 = 
NULL
;

471 
GEmt
 *
idty
 = 
NULL
;

472 
GEmt
 *
audiocvt
 = 
NULL
;

473 
GEmt
 *
audiocvt2
 = 
NULL
;

474 
GPadLkRu
 
lk
;

475 
gboޗn
 
ag
 = 
FALSE
;

476 
G_STMT_START


478 
audiocvt
 = 
	`g_emt_y_make
("audiocvt", 
NULL
);

479 if(
audiocvt
==
NULL
) ;

480 
audiocvt2
 = 
	`g_emt_y_make
("audiocvt", 
NULL
);

481 if(
audiocvt2
==
NULL
) ;

482 
b
 = 
	`g_b_w
(
NULL
);

483 if(
b
==
NULL
) ;

484 
	`g_b_add_my
(
	`GST_BIN
(
b
), 
audiocvt
, 
w_emt
,

485 
audiocvt2
, 
NULL
);

486 if(!
	`g_emt_lk_my
(
audiocvt
, 
w_emt
, 
audiocvt2
,

487 
NULL
))

489 
ag
 = 
TRUE
;

491 
G_STMT_END
;

492 if(!
ag
)

494 if(
b
!=
NULL
)

495 
	`g_obje_uef
(
b
);

498 if(
audiocvt
!=
NULL

	`g_obje_uef
(audioconvert);

499 if(
audiocvt2
!=
NULL

	`g_obje_uef
(audioconvert2);

501  
FALSE
;

503 if(
block
)

505 
ad
 = 
	`g_emt_g_ic_d
(
efb
, "sink");

506 
blockd
 = 
	`g_d_g_
(
ad
);

507 
	`g_obje_uef
(
ad
);

508 
	`g_d_t_blocked
(
blockd
, 
TRUE
);

509 
	`g_obje_uef
(
blockd
);

511 
d
 = 
	`g_emt_g_ic_d
(
audiocvt
, "sink");

512 
bskd
 = 
	`g_gho_d_w
("sk", 
d
);

513 
	`g_emt_add_d
(
b
, 
bskd
);

514 
	`g_obje_uef
(
d
);

515 
d
 = 
	`g_emt_g_ic_d
(
audiocvt2
, "src");

516 
bad
 = 
	`g_gho_d_w
("c", 
d
);

517 
	`g_emt_add_d
(
b
, 
bad
);

518 
	`g_obje_uef
(
d
);

519 
	`g_b_add
(
	`GST_BIN
(
efb
), 
b
);

520 
idty
 = 
	`g_b_g_by_me
(
	`GST_BIN
(
efb
), "effect-identity");

521 
d
 = 
	`g_emt_g_ic_d
(
idty
, "sink");

522 
evd
 = 
	`g_d_g_
(
d
);

523 
	`g_obje_uef
(
idty
);

524 
	`g_d_uƚk
(
evd
, 
d
);

525 
lk
 = 
	`g_d_lk
(
evd
, 
bskd
);

526 
	`g_obje_uef
(
evd
);

527 if(
lk
!=
GST_PAD_LINK_OK
)

529 
	`g_d_lk
(
evd
, 
d
);

530 if(
block
)

532 
ad
 = 
	`g_emt_g_ic_d
(
efb
, "sink");

533 
blockd
 = 
	`g_d_g_
(
ad
);

534 
	`g_obje_uef
(
ad
);

535 
	`g_d_t_blocked
(
blockd
, 
FALSE
);

536 
	`g_obje_uef
(
blockd
);

538 
	`g_obje_uef
(
d
);

539 
	`g_b_move
(
	`GST_BIN
(
efb
), 
b
);

540  
FALSE
;

542 
lk
 = 
	`g_d_lk
(
bad
, 
d
);

543 
	`g_obje_uef
(
d
);

544 if(
lk
!=
GST_PAD_LINK_OK
)

546 if(
block
)

548 
ad
 = 
	`g_emt_g_ic_d
(
efb
, "sink");

549 
blockd
 = 
	`g_d_g_
(
ad
);

550 
	`g_obje_uef
(
ad
);

551 
	`g_d_t_blocked
(
blockd
, 
FALSE
);

552 
	`g_obje_uef
(
blockd
);

554  
FALSE
;

556 
	`g_emt_sync_e_wh_
(
b
);

557 if(
block
)

559 
ad
 = 
	`g_emt_g_ic_d
(
efb
, "sink");

560 
blockd
 = 
	`g_d_g_
(
ad
);

561 
	`g_obje_uef
(
ad
);

562 
	`g_d_t_blocked
(
blockd
, 
FALSE
);

563 
	`g_obje_uef
(
blockd
);

565  
TRUE
;

566 
	}
}

568 
	$rib_ce_ef_move_emt_
(
GEmt
 *
efb
,

569 
GEmt
 *
emt
, 
gboޗn
 
block
)

571 
GPad
 *
myd
;

572 
GPad
 *
evd
, *
xad
;

573 
GPad
 *
ad
, *
blockd
;

574 
GEmt
 *
b
;

575 
b
 = 
	`GST_ELEMENT
(
	`g_emt_g_
(
emt
));

576 if(
b
==
NULL
) ;

577 
	`g_obje_uef
(
b
);

578 
	`g_emt_t_e
(
b
, 
GST_STATE_NULL
);

579 if(
block
)

581 
ad
 = 
	`g_emt_g_ic_d
(
efb
, "sink");

582 
blockd
 = 
	`g_d_g_
(
ad
);

583 
	`g_obje_uef
(
ad
);

584 
	`g_d_t_blocked
(
blockd
, 
TRUE
);

585 
	`g_obje_uef
(
blockd
);

587 
myd
 = 
	`g_emt_g_ic_d
(
b
, "sink");

588 
evd
 = 
	`g_d_g_
(
myd
);

589 
	`g_d_uƚk
(
evd
, 
myd
);

590 
	`g_obje_uef
(
myd
);

591 
myd
 = 
	`g_emt_g_ic_d
(
b
, "src");

592 
xad
 = 
	`g_d_g_
(
myd
);

593 
	`g_d_uƚk
(
myd
, 
xad
);

594 
	`g_obje_uef
(
myd
);

595 
	`g_d_lk
(
evd
, 
xad
);

596 
	`g_obje_uef
(
evd
);

597 
	`g_obje_uef
(
xad
);

598 if(
block
)

600 
ad
 = 
	`g_emt_g_ic_d
(
efb
, "sink");

601 
blockd
 = 
	`g_d_g_
(
ad
);

602 
	`g_obje_uef
(
ad
);

603 
	`g_d_t_blocked
(
blockd
, 
FALSE
);

604 
	`g_obje_uef
(
blockd
);

606 
	`g_b_move
(
	`GST_BIN
(
efb
), 
b
);

607 
	}
}

609 
	$rib_ce_bus_back
(
GBus
 *
bus
, 
GMesge
 *
msg
,

610 
gpor
 
da
)

612 
RCLibCePrive
 *
iv
 = 
NULL
;

613 
GObje
 *
obje
 = 
	`G_OBJECT
(
da
);

614 if(
obje
==
NULL
) ;

615 
iv
 = 
	`RCLIB_CORE
(
obje
)->priv;

616 
	`GST_MESSAGE_TYPE
(
msg
))

618 
GST_MESSAGE_EOS
:

620 
	`g_emt_t_e
(
iv
->
ayb
, 
GST_STATE_NULL
);

621 
	`g_emt_t_e
(
iv
->
ayb
, 
GST_STATE_READY
);

622 
	`g_sigl_em
(
obje
, 
ce_sigls
[
SIGNAL_EOS
], 0);

625 
GST_MESSAGE_TAG
:

633 
GST_MESSAGE_STATE_CHANGED
:

635 
GS
 
d_e
, 
e
, 
ndg
;

636 if(
iv
==
NULL
) ;

637 if(
	`GST_MESSAGE_SRC
(
msg
)!=
	`GST_OBJECT
(
iv
->
ayb
))

639 
	`g_mesge_r_e_chged
(
msg
, &
d_e
, &
e
,

640 &
ndg
);

641 if(
ndg
!=
GST_STATE_VOID_PENDING
) ;

642 
iv
->
ϡ_e
 = 
e
;

643 
	`g_sigl_em
(
obje
, 
ce_sigls
[
SIGNAL_STATE_CHANGED
],

644 0, 
e
);

645 
	`g_debug
("Core state changed from %so %s",

646 
	`g_emt_e_g_me
(
d_e
),

647 
	`g_emt_e_g_me
(
e
));

650 
GST_MESSAGE_DURATION
:

654 
GST_MESSAGE_ASYNC_DONE
:

656 
gt64
 
duti
;

657 
GCs
 *
ps
;

658 
gt
 
tv
;

659 
GSuu
 *
ruu
;

660 
duti
 = 
	`rib_ce_quy_duti
();

661 if(
duti
>0)

663 
	`g_sigl_em
(
obje
, 
ce_sigls
[
SIGNAL_NEW_DURATION
], 0,

664 
duti
);

666 if(
iv
->
quy_d
!=
NULL
)

668 
ps
 = 
	`g_d_g_gٟd_ps
(
iv
->
quy_d
);

669 
ruu
 = 
	`g_ps_g_ruu
(
ps
, 0);

670 if(
	`g_ruu_g_t
(
ruu
, "", &
tv
))

672 
iv
->
me_
 = 
tv
;

674 if(
	`g_ruu_g_t
(
ruu
, "chls", &
tv
))

676 
iv
->
chls
 = 
tv
;

678 if(
	`g_ruu_g_t
(
ruu
, "dth", &
tv
))

680 
iv
->
dth
 = 
tv
;

682 
	`g_ps_uef
(
ps
);

686 
GST_MESSAGE_BUFFERING
:

688 
gt
 
bufrg
 = 0;

689 
gt64
 
bufrg_
 = 0;

690 
GBufrgMode
 
mode
;

691 
	`g_mesge_r_bufrg_s
(
msg
, &
mode
, 
NULL
, NULL,

692 &
bufrg_
);

693 
	`g_sigl_em
(
obje
, 
ce_sigls
[
SIGNAL_BUFFERING
], 0,

694 
bufrg
);

697 
GST_MESSAGE_NEW_CLOCK
:

699 
gt64
 
duti
 = 0;

700 
	`g_debug
("Aew clock was selected.");

701 if(
iv
->
t_time
>0)

703 if(
iv
->
d_time
>0 && (iv->d_tim-riv->
t_time
>0))

705 
	`g_emt_ek
(
iv
->
ayb
, 1.0, 
GST_FORMAT_TIME
,

706 
GST_SEEK_FLAG_FLUSH
 | 
GST_SEEK_FLAG_KEY_UNIT
,

707 
GST_SEEK_TYPE_SET
, 
iv
->
t_time
,

708 
GST_SEEK_TYPE_SET
, 
iv
->
d_time
);

712 
	`g_emt_ek_sime
(
iv
->
ayb
, 
GST_FORMAT_TIME
,

713 
GST_SEEK_FLAG_FLUSH
 | 
GST_SEEK_FLAG_KEY_UNIT
,

714 
iv
->
t_time
);

717 if(
iv
->
d_time
>0)

719 
	`g_emt_ek
(
iv
->
ayb
, 1.0, 
GST_FORMAT_TIME
,

720 
GST_SEEK_FLAG_FLUSH
 | 
GST_SEEK_FLAG_KEY_UNIT
,

721 
GST_SEEK_TYPE_NONE
, 0,

722 
GST_SEEK_TYPE_SET
, 
iv
->
d_time
);

724 
duti
 = 
	`rib_ce_quy_duti
();

725 if(
duti
>0)

726 
	`g_sigl_em
(
obje
, 
ce_sigls
[
SIGNAL_NEW_DURATION
], 0,

727 
duti
);

730 
GST_MESSAGE_ELEMENT
:

734 
GST_MESSAGE_ERROR
:

736 
GE
 *
r
 = 
NULL
;

737 
gch
 *
r_msg
 = 
NULL
;

738 
	`g_mesge_r_r
(
msg
, &
r
, &
r_msg
);

739 
	`g_wng
("%s\nDEBUG: %s", 
r
->
mesge
, 
r_msg
);

740 
	`g_r_
(
r
);

741 
	`g_sigl_em
(
obje
, 
ce_sigls
[
SIGNAL_ERROR
], 0, 
r_msg
);

742 
	`g_
(
r_msg
);

743 if(!
	`g_emt_po_mesge
(
iv
->
ayb
,

744 
	`g_mesge_w_eos
(
	`GST_OBJECT
(
iv
->
ayb
))))

745 
	`rib_ce_
();

748 
GST_MESSAGE_WARNING
:

750 
GE
 *
r
 = 
NULL
;

751 
gch
 *
r_msg
 = 
NULL
;

752 
	`g_mesge_r_wng
(
msg
, &
r
, &
r_msg
);

753 
	`g_wng
("%s\nDEBUG: %s", 
r
->
mesge
, 
r_msg
);

754 
	`g_r_
(
r
);

755 
	`g_
(
r_msg
);

762 
	}
}

764 
	$rib_ce_idty_bufr_cb
(
GEmt
 *
idty
,

765 
GBufr
 *
buf
, 
gpor
 
da
)

768 
gt
 

 = 0;

769 
gt
 
chls
 = 0;

770 
gt
 
width
 = 0;

771 
gt
 
dth
 = 0;

772 
GCs
 *
ps
;

773 
GSuu
 *
ruu
;

774 
RCLibCePrive
 *
iv
 = 
NULL
;

775 
GObje
 *
obje
 = 
	`G_OBJECT
(
da
);

776 if(
obje
==
NULL
) ;

777 
iv
 = 
	`RCLIB_CORE
(
obje
)->priv;

778 if(
iv
==
NULL
) ;

803 
	`g_sigl_em
(
obje
, 
ce_sigls
[
SIGNAL_BUFFER_PROBE
], 0, 
buf
);

804 
ps
 = 
	`g_bufr_g_ps
(
buf
);

805 if(
ps
==
NULL
) ;

806 
ruu
 = 
	`g_ps_g_ruu
(
ps
, 0);

807 
	`g_ruu_g_t
(
ruu
, "", &

);

808 
	`g_ruu_g_t
(
ruu
, "chls", &
chls
);

809 
	`g_ruu_g_t
(
ruu
, "width", &
width
);

810 
	`g_ruu_g_t
(
ruu
, "dth", &
dth
);

811 
	`g_ps_uef
(
ps
);

812 if(
dth
==0dth = 
width
;

813 if(

==0 || 
width
==0 || 
chls
==0) ;

814 
iv
->
me_
 = 

;

815 
iv
->
chls
 = channels;

816 
iv
->
dth
 = depth;

817 
	}
}

819 
gboޗn
 
	$rib_ce_vume_chged_id
(
GObje
 *
obje
)

821 
gdoub
 
vume
;

822 
	`g_obje_g
(
	`G_OBJECT
(
obje
), "vume", &
vume
, 
NULL
);

823 
	`g_sigl_em
(
ce_
, 
ce_sigls
[
SIGNAL_VOLUME_CHANGED
], 0,

824 
vume
);

825  
FALSE
;

826 
	}
}

828 
	$rib_ce_vume_nify_cb
(
GObje
 *
obje
, 
GPamSc
 *
ec
,

829 
gpor
 
da
)

835 
	`g_id_add
((
GSourFunc
)
rib_ce_vume_chged_id
, 
obje
);

836 
	}
}

838 
	$rib_ce_sour_nify_cb
(
GObje
 *
obje
, 
GPamSc
 *
ec
,

839 
gpor
 
da
)

842 
	}
}

844 
gboޗn
 
	$rib_ce_audio_gs_chged_id_cb
(
gpor
 
da
)

847 
RCLibCePrive
 *
iv
 = (RCLibCePriv*)
da
;

848 
GTagLi
 *
gs
;

849 
GTagLi
 *
mged_gs
 = 
NULL
;

850 
gboޗn
 
ag
 = 
FALSE
;

851 if(
da
==
NULL
 
FALSE
;

852 if(
iv
->
g_upde_queue
==
NULL
 
FALSE
;

853 
	`g_async_queue_lock
(
iv
->
g_upde_queue
);

854 (
gs
=
	`g_async_queue_y_p_uocked
(
iv
->
g_upde_queue
))!=

855 
NULL
)

857 if(
mged_gs
==
NULL
)

858 
mged_gs
 = 
	`g_g_li_cy
(
gs
);

860 
	`g_g_li_
(
mged_gs
, 
gs
, 
GST_TAG_MERGE_REPLACE
);

861 
	`g_g_li_
(
gs
);

863 
iv
->
g_upde_id
 = 0;

864 
	`g_async_queue_uock
(
iv
->
g_upde_queue
);

865 if(
mged_gs
==
NULL
 
FALSE
;

866 
ag
 = 
	`rib_ce_r_mada
(
mged_gs
, &(
iv
->
mada
),

867 
iv
->
t_time
,riv->
d_time
);

868 
	`g_g_li_
(
mged_gs
);

869 if(!
ag
 
FALSE
;

870 
	`g_sigl_em
(
ce_
, 
ce_sigls
[
SIGNAL_TAG_FOUND
], 0,

871 &(
iv
->
mada
),riv->
uri
);

872 
iv
->
g_sigl_emd
 = 
TRUE
;

873  
FALSE
;

874 
	}
}

876 
	$rib_ce_audio_gs_chged_cb
(
GEmt
 *
ayb2
,

877 
gt
 
am_id
, 
gpor
 
da
)

880 
RCLibCePrive
 *
iv
 = (RCLibCePriv*)
da
;

881 
GTagLi
 *
gs
 = 
NULL
;

882 
gt
 
cut_am_id
 = 0;

883 
GPad
 *
d
;

884 
GCs
 *
ps
;

885 
gt
 
tv
;

886 
GSuu
 *
ruu
;

887 if(
da
==
NULL
) ;

888 if(
iv
->
g_upde_queue
==
NULL
) ;

889 
	`g_obje_g
(
ayb2
, "cut-audio", &
cut_am_id
, 
NULL
);

890 if(
cut_am_id
!=
am_id
) ;

891 
	`g_sigl_em_by_me
(
ayb2
, "g-audio-gs", 
am_id
, &
gs
);

892 if(
gs
!=
NULL
)

894 
	`g_async_queue_lock
(
iv
->
g_upde_queue
);

895 
	`g_async_queue_push_uocked
(
iv
->
g_upde_queue
, 
gs
);

896 if(
iv
->
g_upde_id
==0)

898 
iv
->
g_upde_id
 = 
	`g_id_add
((
GSourFunc
)

899 
rib_ce_audio_gs_chged_id_cb
, 
iv
);

901 
	`g_async_queue_uock
(
iv
->
g_upde_queue
);

903 
	`g_sigl_em_by_me
(
ayb2
, "g-audio-d", 
am_id
, &
d
);

904 if(
d
!=
NULL
)

906 
ps
 = 
	`g_d_g_gٟd_ps
(
d
);

907 if(
ps
!=
NULL
)

909 
ruu
 = 
	`g_ps_g_ruu
(
ps
, 0);

910 if(
ruu
!=
NULL
)

912 if(
	`g_ruu_g_t
(
ruu
, "", &
tv
))

914 if(
tv
>0
iv
->
me_
 = intv;

916 if(
	`g_ruu_g_t
(
ruu
, "chls", &
tv
))

918 if(
tv
>0
iv
->
chls
 = intv;

920 if(
	`g_ruu_g_t
(
ruu
, "dth", &
tv
))

922 if(
tv
>0
iv
->
dth
 = intv;

926 
	`g_obje_uef
(
d
);

928 
	}
}

930 
	$rib_ce__
(
RCLibCe
 *
ce
)

932 
GEmt
 *
ayb
 = 
NULL
;

933 
GEmt
 *
audiob
 = 
NULL
;

934 
GEmt
 *
efb
 = 
NULL
;

935 
GEmt
 *
audiosk
 = 
NULL
;

936 
GEmt
 *
videosk
 = 
NULL
;

937 
GEmt
 *
audiocvt
 = 
NULL
;

938 
GEmt
 *
effidty
 = 
NULL
;

939 
GEmt
 *
idty
 = 
NULL
;

940 
GE
 *
r
 = 
NULL
;

941 
GPad
 *
d
;

942 
GBus
 *
bus
;

943 
RCLibCePrive
 *
iv
;

944 
gboޗn
 
ag
;

945 
ag
 = 
FALSE
;

946 
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
ce
, 
RCLIB_TYPE_CORE
,

947 
RCLibCePrive
);

948 
ce
->
iv
 =riv;

949 
GPyFgs
 
ags
;

950 
G_STMT_START


952 
ayb
 = 
	`g_emt_y_make
("playbin2", "rclib-playbin");

953 if(
ayb
==
NULL
)

955 
	`g_wng
("Cannotoadecessarylugin: %s", "playbin2");

956 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

957 
RCLIB_CORE_ERROR_MISSING_CORE_PLUGIN
,

958 
	`_
("Cannotoadecessarylugin: %s"), "playbin2");

961 
videosk
 = 
	`g_emt_y_make
("fakesink", "rclib-videosink");

962 if(
videosk
==
NULL
)

964 
	`g_wng
("Cannotoadecessarylugin: %s", "fakesink");

965 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

966 
RCLIB_CORE_ERROR_MISSING_CORE_PLUGIN
,

967 
	`_
("Cannotoadecessarylugin: %s"), "fakesink");

970 
audiosk
 = 
	`g_emt_y_make
("autoaudiosink",

972 if(
audiosk
==
NULL
)

974 
	`g_wng
("Cannotoadecessarylugin: %s", "autoaudiosink");

975 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

976 
RCLIB_CORE_ERROR_MISSING_CORE_PLUGIN
,

977 
	`_
("Cannotoadecessarylugin: %s"), "autoaudiosink");

980 
audiocvt
 = 
	`g_emt_y_make
("audioconvert",

982 if(
audiocvt
==
NULL
)

984 
	`g_wng
("Cannotoadecessarylugin: %s", "audioconvert");

985 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

986 
RCLIB_CORE_ERROR_MISSING_CORE_PLUGIN
,

987 
	`_
("Cannotoadecessarylugin: %s"), "audioconvert");

990 
idty
 = 
	`g_emt_y_make
("identity",

992 if(
idty
==
NULL
)

994 
	`g_wng
("Cannotoadecessarylugin: %s", "identify");

995 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

996 
RCLIB_CORE_ERROR_MISSING_CORE_PLUGIN
,

997 
	`_
("Cannotoadecessarylugin: %s"), "identity");

1000 
effidty
 = 
	`g_emt_y_make
("identity",

1002 if(
effidty
==
NULL
)

1004 
	`g_wng
("Cannotoadecessarylugin: %s", "identify");

1005 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

1006 
RCLIB_CORE_ERROR_MISSING_CORE_PLUGIN
,

1007 
	`_
("Cannotoadecessarylugin: %s"), "identity");

1010 
efb
 = 
	`g_b_w
("rclib-effectbin");

1011 if(
efb
==
NULL
)

1013 
	`g_wng
("Cannot create bin: %s", "effectbin");

1014 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

1015 
RCLIB_CORE_ERROR_CREATE_BIN_FAILED
,

1016 
	`_
("Cannot create bin: %s"), "effectbin");

1019 
	`g_b_add_my
(
	`GST_BIN
(
efb
), 
audiocvt
, 
effidty
, 
NULL
);

1020 if(!
	`g_emt_lk
(
audiocvt
, 
effidty
))

1022 
	`g_wng
("Cannotinklements!");

1023 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

1024 
RCLIB_CORE_ERROR_LINK_FAILED
,

1025 
	`_
("Cannotinklements!"));

1028 
d
 = 
	`g_emt_g_ic_d
(
audiocvt
, "sink");

1029 
	`g_emt_add_d
(
efb
, 
	`g_gho_d_w
("sk", 
d
));

1030 
	`g_obje_uef
(
d
);

1031 
d
 = 
	`g_emt_g_ic_d
(
effidty
, "src");

1032 
	`g_emt_add_d
(
efb
, 
	`g_gho_d_w
("c", 
d
));

1033 
	`g_obje_uef
(
d
);

1034 
audiob
 = 
	`g_b_w
("rclib-audiobin");

1035 if(
audiob
==
NULL
)

1037 
	`g_wng
("Cannot create bin: %s", "audiobin");

1038 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

1039 
RCLIB_CORE_ERROR_CREATE_BIN_FAILED
,

1040 
	`_
("Cannot create bin: %s"), "audiobin");

1043 
	`g_b_add_my
(
	`GST_BIN
(
audiob
), 
idty
, 
efb
,

1044 
audiosk
, 
NULL
);

1045 if(!
	`g_emt_lk_my
(
idty
, 
efb
, 
audiosk
, 
NULL
))

1047 
	`g_wng
("Cannotink identity ->ffectbin ->udiosink!");

1048 
	`g_t_r
(&
r
, 
RCLIB_CORE_ERROR
,

1049 
RCLIB_CORE_ERROR_LINK_FAILED
,

1050 
	`_
("Cannotinklements!"));

1053 
d
 = 
	`g_emt_g_ic_d
(
idty
, "sink");

1054 
	`g_emt_add_d
(
audiob
, 
	`g_gho_d_w
(
NULL
, 
d
));

1055 
	`g_obje_uef
(
d
);

1056 
ag
 = 
TRUE
;

1058 
G_STMT_END
;

1059 if(!
ag
)

1061 if(
ayb
!=
NULL

	`g_obje_uef
(playbin);

1062 if(
videosk
!=
NULL

	`g_obje_uef
(videosink);

1063 if(
audiob
!=
NULL
)

1064 
	`g_obje_uef
(
audiob
);

1067 if(
audiosk
!=
NULL

	`g_obje_uef
(audiosink);

1068 if(
idty
!=
NULL

	`g_obje_uef
(identity);

1069 if(
efb
!=
NULL
)

1070 
	`g_obje_uef
(
efb
);

1073 if(
audiocvt
!=
NULL

	`g_obje_uef
(audioconvert);

1074 if(
effidty
!=
NULL

	`g_obje_uef
(effidentity);

1077 
iv
->
r
 =rror;

1080 
	`g_obje_t
(
idty
, "sigl-hdoffs", 
TRUE
, 
NULL
);

1081 
	`g_obje_t
(
videosk
, "sync", 
TRUE
, 
NULL
);

1082 
	`g_obje_t
(
ayb
, "audio-sk", 
audiob
, "video-sink",

1083 
videosk
, 
NULL
);

1084 
	`g_obje_g
(
ayb
, "ags", &
ags
, 
NULL
);

1085 
ags
 |
GST_PLAY_FLAG_DOWNLOAD
;

1086 
ags
 |
GST_PLAY_FLAG_BUFFERING
;

1087 
ags
 &~
GST_PLAY_FLAG_VIDEO
;

1088 
ags
 &~
GST_PLAY_FLAG_TEXT
;

1089 
	`g_obje_t
(
ayb
, "ags", 
ags
, 
NULL
);

1090 
	`memt
(&(
iv
->
mada
), 0, (
RCLibCeMada
));

1091 
iv
->
ayb
 =laybin;

1092 
iv
->
efb
 =ffectbin;

1093 
iv
->
audiosk
 =udiosink;

1094 
iv
->
videosk
 = videosink;

1095 
iv
->
eq_ug
 = 
	`g_emt_y_make
("equalizer-10bands",

1097 
iv
->
b_ug
 = 
	`g_emt_y_make
("audiopanorama",

1099 if(
iv
->
eq_ug
!=
NULL
)

1100 
	`rib_ce_ef_add_emt_
(
efb
, 
iv
->
eq_ug
,

1101 
FALSE
);

1102 if(
iv
->
b_ug
!=
NULL
)

1104 
	`g_obje_t
(
iv
->
b_ug
, "mhod", 1, 
NULL
);

1105 
	`rib_ce_ef_add_emt_
(
efb
, 
iv
->
b_ug
,

1106 
FALSE
);

1108 
iv
->
exa_ug_li
 = 
NULL
;

1109 
iv
->
g_upde_id
 = 0;

1110 
iv
->
g_upde_queue
 = 
	`g_async_queue_w_fu
((
GDeroyNify
)

1111 
g_g_li_
);

1112 
bus
 = 
	`g_emt_g_bus
(
ayb
);

1113 
	`g_bus_add_sigl_wch
(
bus
);

1114 
iv
->
mesge_id
 = 
	`g_sigl_c
(
bus
, "message",

1115 
	`G_CALLBACK
(
rib_ce_bus_back
), 
ce
);

1116 
iv
->
bus
 = bus;

1117 
d
 = 
	`g_emt_g_ic_d
(
audiocvt
, "sink");

1118 
iv
->
quy_d
 = 
d
;

1119 
iv
->
idty_id
 = 
	`g_sigl_c
(
idty
, "handoff",

1120 
	`G_CALLBACK
(
rib_ce_idty_bufr_cb
), 
ce
);

1121 
iv
->
vume_id
 = 
	`g_sigl_c
riv->
ayb
, "notify::volume",

1122 
	`G_CALLBACK
(
rib_ce_vume_nify_cb
), 
iv
);

1123 
iv
->
sour_id
 = 
	`g_sigl_c
riv->
ayb
, "notify::source",

1124 
	`G_CALLBACK
(
rib_ce_sour_nify_cb
), 
iv
);

1125 
iv
->
audio_g_chged_id
 = 
	`g_sigl_c
riv->
ayb
,

1126 "audio-gs-chged", 
	`G_CALLBACK
(
rib_ce_audio_gs_chged_cb
),

1127 
iv
);

1128 
	`g_emt_t_e
(
ayb
, 
GST_STATE_NULL
);

1129 
	`g_emt_t_e
(
ayb
, 
GST_STATE_READY
);

1130 
	}
}

1132 
GTy
 
	$rib_ce_g_ty
()

1134 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

1135 
GTy
 
g_defe_ty_id
;

1136 cڡ 
GTyInfo
 
ce_fo
 = {

1137 .
ass_size
 = (
RCLibCeCss
),

1138 .
ba_
 = 
NULL
,

1139 .
ba_fize
 = 
NULL
,

1140 .
ass_
 = (
GCssInFunc
)
rib_ce_ass_
,

1141 .
ass_fize
 = 
NULL
,

1142 .
ass_da
 = 
NULL
,

1143 .
_size
 = (
RCLibCe
),

1144 .
n_ocs
 = 0,

1145 .
_
 = (
GInInFunc
)
rib_ce__


1147 if(
	`g___r
(&
g_defe_ty_id__vީe
))

1149 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
G_TYPE_OBJECT
,

1150 
	`g__ic_rg
("RCLibCe"), &
ce_fo
, 0);

1151 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

1153  
g_defe_ty_id__vީe
;

1154 
	}
}

1166 
gboޗn
 
	$rib_ce_
(
GE
 **
r
)

1168 
RCLibCePrive
 *
iv
;

1169 
	`g_mesge
("Loading core....");

1170 if(
ce_
!=
NULL
)

1172 
	`g_wng
("The core islready initialized!");

1173 
	`g_t_r
(
r
, 
RCLIB_CORE_ERROR
, 
RCLIB_CORE_ERROR_ALREADY_INIT
,

1174 
	`_
("The core islready initialized!"));

1175  
FALSE
;

1177 
ce_
 = 
	`g_obje_w
(
RCLIB_TYPE_CORE
, 
NULL
);

1178 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1179 if(
iv
->
ayb
==
NULL
)

1181 if(
r
!=
NULL
*r = 
iv
->error;

1182 
	`g_obje_uef
(
ce_
);

1183 
ce_
 = 
NULL
;

1184  
FALSE
;

1186 
	`g_mesge
("Coreoaded.");

1187  
TRUE
;

1188 
	}
}

1196 
	$rib_ce_ex
()

1198 if(
ce_
!=
NULL

	`g_obje_uef
(core_instance);

1199 
ce_
 = 
NULL
;

1200 
	`g_mesge
("Corexited.");

1201 
	}
}

1211 
GObje
 *
	$rib_ce_g_
()

1213  
ce_
;

1214 
	}
}

1228 
gulg
 
	$rib_ce_sigl_c
(cڡ 
gch
 *
me
,

1229 
GClback
 
back
, 
gpor
 
da
)

1231 if(
ce_
==
NULL
)  0;

1232  
	`g_sigl_c
(
ce_
, 
me
, 
back
, 
da
);

1233 
	}
}

1245 
	$rib_ce_sigl_disc
(
gulg
 
hdr_id
)

1247 if(
ce_
==
NULL
) ;

1248 
	`g_sigl_hdr_disc
(
ce_
, 
hdr_id
);

1249 
	}
}

1251 
le
 
	$rib_ce_t_uri_
(cڡ 
gch
 *
uri
,

1252 
GSequIr
 *
db_f
, cڡ 
gch
 *
cook
,

1253 
GSequIr
 *
ex_f
)

1255 
RCLibCePrive
 *
iv
;

1256 
gch
 *
scheme
;

1257 
gch
 *
cue_uri
;

1258 
gt
 
ack
 = 0;

1259 
RCLibTagMada
 *
cue_mmd
;

1260 
RCLibCueDa
 
cue_da
;

1261 
gboޗn
 
cue_ag
 = 
FALSE
;

1262 
gboޗn
 
emb_cue_ag
 = 
FALSE
;

1263 if(
ce_
==
NULL
 || 
uri
==NULL) ;

1264 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1265 
	`rib_ce_
();

1266 
	`g_
(
iv
->
uri
);

1267 
iv
->
uri
 = 
NULL
;

1268 
iv
->
db_n
 = 
NULL
;

1269 
iv
->
ext_n
 = 
NULL
;

1270 
	`g_
(
iv
->
ext_cook
);

1271 
iv
->
ext_cook
 = 
NULL
;

1272 
scheme
 = 
	`g_uri_r_scheme
(
uri
);

1274 if(
	`g_rcmp0
(
scheme
, "file")==0)

1276 if(
	`rib_cue_g_ack_num
(
uri
, &
cue_uri
, &
ack
))

1278 if(
	`g_gex_mch_sime
("(.CUE)$", 
cue_uri
, 
G_REGEX_CASELESS
,

1281 if(
	`rib_cue_ad_da
(
cue_uri
, 
RCLIB_CUE_INPUT_URI
,

1282 &
cue_da
)>0)

1284 
cue_ag
 = 
TRUE
;

1289 
cue_mmd
 = 
	`rib_g_ad_mada
(
cue_uri
);

1290 if(
cue_mmd
!=
NULL
 && cue_mmd->
audio_ag
 &&

1291 
cue_mmd
->
emb_cue
!=
NULL
)

1293 if(
	`rib_cue_ad_da
(
cue_mmd
->
emb_cue
,

1294 
RCLIB_CUE_INPUT_EMBEDDED
, &
cue_da
)>0)

1296 
cue_ag
 = 
TRUE
;

1297 
emb_cue_ag
 = 
TRUE
;

1298 
cue_da
.
fe
 = 
	`g_rdup
(
cue_uri
);

1301 if(
cue_mmd
!=
NULL

	`rib_g_
(cue_mmd);

1303 
	`g_
(
cue_uri
);

1306 
	`g_
(
scheme
);

1307 
iv
->
g_sigl_emd
 = 
FALSE
;

1308 if(
cue_ag
)

1310 
iv
->
t_time
 = 
cue_da
.
ack
[ack-1].
time1
;

1311 if(
ack
!=
cue_da
.
ngth
)

1312 
iv
->
d_time
 = 
cue_da
.
ack
[ack].
time1
;

1314 
iv
->
d_time
 = 0;

1315 if(
cue_da
.
ack
[ack-1].
t
!=
NULL
)

1316 
iv
->
mada
.
t
 =

1317 
	`g_rdup
(
cue_da
.
ack
[ack-1].
t
);

1318 if(
cue_da
.
ack
[ack-1].
rfm
!=
NULL
)

1319 
iv
->
mada
.
ti
 =

1320 
	`g_rdup
(
cue_da
.
ack
[ack-1].
rfm
);

1321 if(
cue_da
.
t
!=
NULL
)

1322 
iv
->
mada
.
bum
 = 
	`g_rdup
(
cue_da
.
t
);

1323 
	`g_obje_t
(
iv
->
ayb
, "uri", 
cue_da
.
fe
, 
NULL
);

1324 
iv
->
uri
 = 
	`g_rdup
(
cue_da
.
fe
);

1325 
	`rib_cue_
(&
cue_da
);

1326 if(
emb_cue_ag
)

1327 
iv
->
ty
 = 
RCLIB_CORE_SOURCE_EMBEDDED_CUE
;

1329 
iv
->
ty
 = 
RCLIB_CORE_SOURCE_CUE
;

1333 
iv
->
t_time
 = 0;

1334 
iv
->
d_time
 = 0;

1335 
iv
->
ty
 = 
RCLIB_CORE_SOURCE_NORMAL
;

1336 
	`g_obje_t
(
iv
->
ayb
, "uri", 
uri
, 
NULL
);

1337 
iv
->
uri
 = 
	`g_rdup
(uri);

1339 
iv
->
db_n
 = 
db_f
;

1340 
iv
->
ext_cook
 = 
	`g_rdup
(
cook
);

1341 
iv
->
ext_n
 = 
ex_f
;

1342 
	`g_emt_t_e
(
iv
->
ayb
, 
GST_STATE_PAUSED
);

1343 
	`g_sigl_em
(
ce_
, 
ce_sigls
[
SIGNAL_URI_CHANGED
], 0,

1344 
iv
->
uri
);

1345 
	}
}

1354 
	$rib_ce_t_uri
(cڡ 
gch
 *
uri
)

1356 
	`rib_ce_t_uri_
(
uri
, 
NULL
, NULL, NULL);

1357 
	}
}

1368 
	$rib_ce_t_uri_wh_db_f
(cڡ 
gch
 *
uri
,

1369 
GSequIr
 *
db_f
)

1371 
	`rib_ce_t_uri_
(
uri
, 
db_f
, 
NULL
, NULL);

1372 
	}
}

1384 
	$rib_ce_t_uri_wh_ext_f
(cڡ 
gch
 *
uri
, cڡ gch *
cook
,

1385 
GSequIr
 *
ex_f
)

1387 
	`rib_ce_t_uri_
(
uri
, 
NULL
, 
cook
, 
ex_f
);

1388 
	}
}

1398 
	$rib_ce_upde_db_n
(
GSequIr
 *
w_f
)

1400 
RCLibCePrive
 *
iv
;

1401 if(
ce_
==
NULL
) ;

1402 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1403 if(
iv
==
NULL
) ;

1404 
iv
->
db_n
 = 
w_f
;

1405 
	}
}

1415 
	$rib_ce_upde_ex_n
(cڡ 
gch
 *
cook
,

1416 
gpor
 
w_f
)

1418 
RCLibCePrive
 *
iv
;

1419 if(
ce_
==
NULL
) ;

1420 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1421 if(
iv
==
NULL
 ||riv->
db_n
!=NULL) ;

1422 if(
	`g_rcmp0
(
iv
->
ext_cook
, 
cook
)!=0) ;

1423 
iv
->
ext_n
 = 
w_f
;

1424 
	}
}

1434 
gch
 *
	$rib_ce_g_uri
()

1436 
RCLibCePrive
 *
iv
;

1437 
gch
 *
uri
 = 
NULL
;

1438 if(
ce_
==
NULL
)  NULL;

1439 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1440 if(
iv
==
NULL
)  NULL;

1441 
	`g_obje_g
(
	`G_OBJECT
(
iv
->
ayb
), "uri", &
uri
, 
NULL
);

1442  
uri
;

1443 
	}
}

1453 
GSequIr
 *
	$rib_ce_g_db_n
()

1455 
RCLibCePrive
 *
iv
;

1456 if(
ce_
==
NULL
 
FALSE
;

1457 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1458 if(
iv
==
NULL
)  NULL;

1459  
iv
->
db_n
;

1460 
	}
}

1472 
gboޗn
 
	$rib_ce_g_ex_n
(
gch
 **
cook
, 
gpor
 *
f
)

1474 
RCLibCePrive
 *
iv
;

1475 if(
ce_
==
NULL
 
FALSE
;

1476 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1477 if(
iv
==
NULL
 
FALSE
;

1478 if(
iv
->
ext_cook
==
NULL
 ||riv->
ext_n
==NULL)

1479  
FALSE
;

1480 if(
cook
!=
NULL
)

1482 *
cook
 = 
	`g_rdup
(
iv
->
ext_cook
);

1484 if(
iv
->
ext_n
!=
NULL
)

1486 *
f
 = 
iv
->
ext_n
;

1488  
TRUE
;

1489 
	}
}

1499 
RCLibCeSourTy
 
	$rib_ce_g_sour_ty
()

1501 
RCLibCePrive
 *
iv
;

1502 if(
ce_
==
NULL
 
RCLIB_CORE_SOURCE_NONE
;

1503 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1504 if(
iv
==
NULL
 
RCLIB_CORE_SOURCE_NONE
;

1505  
iv
->
ty
;

1506 
	}
}

1516 cڡ 
RCLibCeMada
 *
	$rib_ce_g_mada
()

1518 
RCLibCePrive
 *
iv
;

1519 if(
ce_
==
NULL
)  NULL;

1520 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1521 if(
iv
==
NULL
)  NULL;

1522  &(
iv
->
mada
);

1523 
	}
}

1536 
gboޗn
 
	$rib_ce_t_posi
(
gt64
 
pos
)

1538 
RCLibCePrive
 *
iv
;

1539 if(
ce_
==
NULL
 
FALSE
;

1540 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1541 if(
iv
->
t_time
>0)

1543  
	`g_emt_ek_sime
(
iv
->
ayb
, 
GST_FORMAT_TIME
,

1544 
GST_SEEK_FLAG_FLUSH
 | 
GST_SEEK_FLAG_KEY_UNIT
,

1545 
pos
 + 
iv
->
t_time
);

1549  
	`g_emt_ek_sime
(
iv
->
ayb
, 
GST_FORMAT_TIME
,

1550 
GST_SEEK_FLAG_FLUSH
 | 
GST_SEEK_FLAG_KEY_UNIT
, 
pos
);

1552 
	}
}

1562 
gt64
 
	$rib_ce_quy_posi
()

1564 
RCLibCePrive
 *
iv
;

1565 
gt64
 
posi
 = 0;

1566 
GFm
 
fm
 = 
GST_FORMAT_TIME
;

1567 if(
ce_
==
NULL
 
FALSE
;

1568 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1569 if(
	`g_emt_quy_posi
(
iv
->
ayb
, &
fm
, &
posi
))

1571 if(
posi
<0)osition = 0;

1574 if(
iv
->
t_time
>0)

1576 if(
posi
>
iv
->
t_time
)

1577 
posi
 =osi - 
iv
->
t_time
;

1580  
posi
;

1581 
	}
}

1591 
gt64
 
	$rib_ce_quy_duti
()

1593 
RCLibCePrive
 *
iv
;

1594 
gt64
 
duti
 = 0;

1595 
GFm
 
fm
 = 
GST_FORMAT_TIME
;

1596 if(
ce_
==
NULL
)  0;

1597 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1598 if(
iv
->
d_time
>0 &&riv->d_time>iv->
t_time
)

1600 
duti
 = 
iv
->
d_time
 -riv->
t_time
;

1601  
duti
;

1603 if(
	`g_emt_quy_duti
(
iv
->
ayb
, &
fm
, &
duti
))

1605 if(
duti
<0) duration = 0;

1607 if(
iv
->
t_time
>0 && 
duti
>priv->start_time)

1608 
duti
 = duti - 
iv
->
t_time
;

1609  
duti
;

1610 
	}
}

1623 
gboޗn
 
	$rib_ce_quy_bufrg_r
(
gt
 *
r
, 
gboޗn
 *
busy
)

1625 
RCLibCePrive
 *
iv
;

1626 
GQuy
 *
quy
;

1627 if(
ce_
==
NULL
 
FALSE
;

1628 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1629 if(
iv
==
NULL
 
FALSE
;

1630 
quy
 = 
	`g_quy_w_bufrg
(
GST_FORMAT_TIME
);

1631 
	`g_emt_quy
(
iv
->
ayb
, 
quy
);

1632 
	`g_quy_r_bufrg_r
(
quy
, 
r
, 
busy
);

1633 
	`g_quy_uef
(
quy
);

1634  
TRUE
;

1635 
	}
}

1650 
gboޗn
 
	$rib_ce_quy_bufrg_nge
(
gt64
 *
t
, gt64 *

,

1651 
gt64
 *
eimed_tٮ
)

1653 
RCLibCePrive
 *
iv
;

1654 
GQuy
 *
quy
;

1655 
GFm
 
fm
 = 
GST_FORMAT_PERCENT
;

1656 if(
ce_
==
NULL
 
FALSE
;

1657 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1658 if(
iv
==
NULL
 
FALSE
;

1659 
quy
 = 
	`g_quy_w_bufrg
(
GST_FORMAT_TIME
);

1660 
	`g_emt_quy
(
iv
->
ayb
, 
quy
);

1661 
	`g_quy_r_bufrg_nge
(
quy
, &
fm
, 
t
, 

,

1662 
eimed_tٮ
);

1663 
	`g_quy_uef
(
quy
);

1664  
TRUE
;

1665 
	}
}

1684 
GSChgeRu
 
	$rib_ce_g_e
(
GS
 *
e
,

1685 
GS
 *
ndg
, 
GClockTime
 
timeout
)

1687 
RCLibCePrive
 *
iv
;

1688 if(
ce_
==
NULL
 
GST_STATE_CHANGE_FAILURE
;

1689 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1690  
	`g_emt_g_e
(
iv
->
ayb
, 
e
, 
ndg
, 
timeout
);

1691 
	}
}

1701 
gboޗn
 
	$rib_ce_ay
()

1703 
RCLibCePrive
 *
iv
;

1704 
GS
 
e
;

1705 if(
ce_
==
NULL
 
FALSE
;

1706 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1707 
	`g_emt_g_e
(
iv
->
ayb
, &
e
, 
NULL
, 0);

1708 if(
e
!=
GST_STATE_PAUSED
 && s!=
GST_STATE_PLAYING
 &&

1709 
e
!=
GST_STATE_READY
 && s!=
GST_STATE_NULL
)

1711 
	`g_emt_t_e
(
iv
->
ayb
, 
GST_STATE_NULL
);

1713  
	`g_emt_t_e
(
iv
->
ayb
, 
GST_STATE_PLAYING
);

1714 
	}
}

1724 
gboޗn
 
	$rib_ce_u
()

1726 
RCLibCePrive
 *
iv
;

1727 
gboޗn
 
e_ag
;

1728 if(
ce_
==
NULL
 
FALSE
;

1729 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1736 
e_ag
 = 
	`g_emt_t_e
(
iv
->
ayb
, 
GST_STATE_PAUSED
);

1743  
e_ag
;

1744 
	}
}

1754 
gboޗn
 
	$rib_ce_
()

1756 
RCLibCePrive
 *
iv
;

1757 
GBus
 *
bus
;

1758 
GMesge
 *
msg
;

1759 
GTagLi
 *
gs
;

1760 if(
ce_
==
NULL
 
FALSE
;

1761 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1762 
bus
 = 
	`g_emt_g_bus
(
iv
->
ayb
);

1763 
	`g_emt_t_e
(
iv
->
ayb
, 
GST_STATE_READY
);

1764 
	`rib_ce_mada_
(&(
iv
->
mada
));

1765 
iv
->
duti
 = 0;

1766 
iv
->
me_
 = 0;

1767 
iv
->
chls
 = 0;

1768 
iv
->
dth
 = 0;

1769 
iv
->
g_sigl_emd
 = 
FALSE
;

1770 
	`g_async_queue_lock
(
iv
->
g_upde_queue
);

1771 (
gs
=
	`g_async_queue_y_p_uocked
(
iv
->
g_upde_queue
))!=

1772 
NULL
)

1774 
	`g_g_li_
(
gs
);

1776 
	`g_async_queue_uock
(
iv
->
g_upde_queue
);

1777 (
msg
=
	`g_bus_p_fd
(
bus
, 
GST_MESSAGE_STATE_CHANGED
))!=
NULL
)

1779 
	`g_bus_async_sigl_func
(
bus
, 
msg
, 
NULL
);

1780 
	`g_mesge_uef
(
msg
);

1782 
	`g_bus_t_ushg
(
bus
, 
TRUE
);

1783 
	`g_obje_uef
(
bus
);

1784 
	`g_emt_t_e
(
iv
->
ayb
, 
GST_STATE_NULL
);

1785 
	`rib_ce_t_posi
(0);

1786  
TRUE
;

1787 
	}
}

1798 
gboޗn
 
	$rib_ce_t_vume
(
gdoub
 
vume
)

1800 
RCLibCePrive
 *
iv
;

1801 if(
ce_
==
NULL
 
FALSE
;

1802 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1803 
	`g_obje_t
(
	`G_OBJECT
(
iv
->
ayb
), "vume", 
vume
, 
NULL
);

1804  
TRUE
;

1805 
	}
}

1816 
gboޗn
 
	$rib_ce_g_vume
(
gdoub
 *
vume
)

1818 
RCLibCePrive
 *
iv
;

1819 
gdoub
 
v
 = 0.0;

1820 if(
ce_
==
NULL
 
FALSE
;

1821 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1822 
	`g_obje_g
(
iv
->
ayb
, "vume", &
v
, 
NULL
);

1823 if(
vume
!=
NULL
*vum
v
;

1824  
TRUE
;

1825 
	}
}

1837 
gboޗn
 
	$rib_ce_t_eq
(
RCLibCeEQTy
 
ty
, 
gdoub
 *
bd
)

1839 
RCLibCePrive
 *
iv
;

1840 
gt
 
i
;

1841 
gch
 
bd_me
[16];

1842 if(
ce_
==
NULL
 
FALSE
;

1843 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1844 if(
iv
->
eq_ug
==
NULL
 
FALSE
;

1845 if(
ty
>=
RCLIB_CORE_EQ_TYPE_NONE
 &&y<
RCLIB_CORE_EQ_TYPE_CUSTOM
)

1847 
bd
 = 
ce_eq_da
[
ty
].
da
;

1848 
iv
->
eq_ty
 = 
ty
;

1852 if(
bd
==
NULL
 
FALSE
;

1853 
iv
->
eq_ty
 = 
RCLIB_CORE_EQ_TYPE_CUSTOM
;

1855 
i
=0;i<10;i++)

1857 
	`g_tf
(
bd_me
, 15, "bd%d", 
i
);

1858 
	`g_obje_t
(
	`G_OBJECT
(
iv
->
eq_ug
), 
bd_me
, 
bd
[
i
],

1859 
NULL
);

1861 
	`g_sigl_em
(
ce_
, 
ce_sigls
[
SIGNAL_EQ_CHANGED
], 0,

1862 
ty
, 
bd
);

1863  
TRUE
;

1864 
	}
}

1877 
gboޗn
 
	$rib_ce_g_eq
(
RCLibCeEQTy
 *
ty
, 
gdoub
 *
bd
)

1879 
RCLibCePrive
 *
iv
;

1880 
gt
 
i
;

1881 
gch
 
bd_me
[16];

1882 
gdoub
 
vue
;

1883 if(
ce_
==
NULL
 
FALSE
;

1884 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1885 if(
iv
->
eq_ug
==
NULL
 
FALSE
;

1886 if(
ty
!=
NULL
*ty = 
iv
->
eq_ty
;

1887 if(
bd
==
NULL
 
TRUE
;

1888 
i
=0;i<10;i++)

1890 
	`g_tf
(
bd_me
, 15, "bd%d", 
i
);

1891 
	`g_obje_g
(
	`G_OBJECT
(
iv
->
eq_ug
), 
bd_me
, &
vue
,

1892 
NULL
);

1893 
bd
[
i
] = 
vue
;

1895  
TRUE
;

1896 
	}
}

1907 cڡ 
gch
 *
	$rib_ce_g_eq_me
(
RCLibCeEQTy
 
ty
)

1909 if(
ty
>=
RCLIB_CORE_EQ_TYPE_NONE
 &&y<
RCLIB_CORE_EQ_TYPE_CUSTOM
)

1911  
	`gxt
(
ce_eq_da
[
ty
].
me
);

1914  
	`_
("Custom");

1915 
	}
}

1926 
gboޗn
 
	$rib_ce_t_b
(
gt
 
b
)

1928 
RCLibCePrive
 *
iv
;

1929 if(
ce_
==
NULL
 
FALSE
;

1930 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1931 if(
iv
->
eq_ug
==
NULL
 
FALSE
;

1932 
	`g_obje_t
(
	`G_OBJECT
(
iv
->
b_ug
), "nama", 
b
, 
NULL
);

1933 
	`g_sigl_em
(
ce_
, 
ce_sigls
[
SIGNAL_BALANCE_CHANGED
], 0,

1934 
b
);

1935  
TRUE
;

1936 
	}
}

1948 
gboޗn
 
	$rib_ce_g_b
(
gt
 *
b
)

1950 
RCLibCePrive
 *
iv
;

1951 
gt
 
b
;

1952 if(
ce_
==
NULL
 
FALSE
;

1953 
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1954 if(
iv
->
eq_ug
==
NULL
 
FALSE
;

1955 
	`g_obje_g
(
	`G_OBJECT
(
iv
->
b_ug
), "nama", &
b
, 
NULL
);

1956 if(
b
!=
NULL
*b = 
b
;

1957  
TRUE
;

1958 
	}
}

1971 
gboޗn
 
	$rib_ce_ef_ug_add
(
GEmt
 *
emt
)

1973 
gboޗn
 
ag
;

1974 if(
ce_
==
NULL
 
FALSE
;

1975 
RCLibCePrive
 *
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

1976 if(
iv
==
NULL
 ||riv->
efb
==NULL 
FALSE
;

1977 
	`rib_ce_
();

1978 
ag
 = 
	`rib_ce_ef_add_emt_
(
iv
->
efb
, 
emt
,

1979 
FALSE
);

1980 if(
ag
)

1982 
iv
->
exa_ug_li
 = 
	`g_li_nd
(priv->extra_plugin_list,

1983 
emt
);

1985  
TRUE
;

1986 
	}
}

1997 
	$rib_ce_ef_ug_move
(
GEmt
 *
emt
)

1999 if(
ce_
==
NULL
) ;

2000 
RCLibCePrive
 *
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

2001 if(
iv
==
NULL
 ||riv->
efb
==NULL) ;

2002 
	`rib_ce_
();

2003 
	`rib_ce_ef_move_emt_
(
iv
->
efb
, 
emt
,

2004 
FALSE
);

2005 
iv
->
exa_ug_li
 = 
	`g_li_move
(priv->extra_plugin_list,

2006 
emt
);

2007 
	}
}

2018 
GLi
 *
	$rib_ce_ef_ug_g_li
()

2020 if(
ce_
==
NULL
)  NULL;

2021 
RCLibCePrive
 *
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

2022 if(
iv
==
NULL
)  NULL;

2023  
iv
->
exa_ug_li
;

2024 
	}
}

2034 
gt
 
	$rib_ce_quy_me_
()

2036 if(
ce_
==
NULL
)  0;

2037 
RCLibCePrive
 *
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

2038 if(
iv
==
NULL
)  0;

2039  
iv
->
me_
;

2040 
	}
}

2050 
gt
 
	$rib_ce_quy_chls
()

2052 if(
ce_
==
NULL
)  0;

2053 
RCLibCePrive
 *
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

2054 if(
iv
==
NULL
)  0;

2055  
iv
->
chls
;

2056 
	}
}

2066 
gt
 
	$rib_ce_quy_dth
()

2068 if(
ce_
==
NULL
)  0;

2069 
RCLibCePrive
 *
iv
 = 
	`RCLIB_CORE
(
ce_
)->priv;

2070 if(
iv
==
NULL
)  0;

2071  
iv
->
dth
;

2072 
	}
}

	@lib/rclib-core.h

25 #ide
HAVE_RC_LIB_CORE_H


26 
	#HAVE_RC_LIB_CORE_H


	)

28 
	~<glib.h
>

29 
	~<glib/gi18n.h
>

30 
	~<glib-obje.h
>

31 
	~<g/g.h
>

32 
	~<g/audio/gaudiofr.h
>

33 
	~<g/f/gff32.h
>

35 
	gG_BEGIN_DECLS


37 
	#RCLIB_TYPE_CORE
 (
	`rib_ce_g_ty
())

	)

38 
	#RCLIB_CORE
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), 
RCLIB_TYPE_CORE
, \

39 
RCLibCe
))

	)

40 
	#RCLIB_CORE_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_CAST
((k), 
RCLIB_TYPE_CORE
, \

41 
RCLibCeCss
))

	)

42 
	#RCLIB_IS_CORE
(
o
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((o), 
RCLIB_TYPE_CORE
))

	)

43 
	#RCLIB_IS_CORE_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_TYPE
((k), 
RCLIB_TYPE_CORE
))

	)

44 
	#RCLIB_CORE_GET_CLASS
(
o
(
	`G_TYPE_INSTANCE_GET_CLASS
((o), \

45 
RCLIB_TYPE_CORE
, 
RCLibCeCss
))

	)

58 
	mRCLIB_CORE_SOURCE_NONE
 = 0,

59 
	mRCLIB_CORE_SOURCE_NORMAL
 = 1,

60 
	mRCLIB_CORE_SOURCE_CUE
 = 2,

61 
	mRCLIB_CORE_SOURCE_EMBEDDED_CUE
 = 3

62 }
	tRCLibCeSourTy
;

77 
	mRCLIB_CORE_ERROR_OK
 = 0,

78 
	mRCLIB_CORE_ERROR_ALREADY_INIT
 = 1,

79 
	mRCLIB_CORE_ERROR_NOT_INIT
 = 2,

80 
	mRCLIB_CORE_ERROR_MISSING_CORE_PLUGIN
 = 3,

81 
	mRCLIB_CORE_ERROR_CREATE_BIN_FAILED
 = 4,

82 
	mRCLIB_CORE_ERROR_LINK_FAILED
 = 5

83 }
	tRCLibCeECode
;

103 
	mRCLIB_CORE_EQ_TYPE_NONE
 = 0,

104 
	mRCLIB_CORE_EQ_TYPE_POP
 = 1,

105 
	mRCLIB_CORE_EQ_TYPE_ROCK
 = 2,

106 
	mRCLIB_CORE_EQ_TYPE_METAL
 = 3,

107 
	mRCLIB_CORE_EQ_TYPE_DANCE
 = 4,

108 
	mRCLIB_CORE_EQ_TYPE_ELECTRONIC
 = 5,

109 
	mRCLIB_CORE_EQ_TYPE_JAZZ
 = 6,

110 
	mRCLIB_CORE_EQ_TYPE_CLASSICAL
 = 7,

111 
	mRCLIB_CORE_EQ_TYPE_BLUES
 = 8,

112 
	mRCLIB_CORE_EQ_TYPE_VOCAL
 = 9,

113 
	mRCLIB_CORE_EQ_TYPE_CUSTOM
 = 10

114 }
	tRCLibCeEQTy
;

116 
_RCLibCeMada
 
	tRCLibCeMada
;

117 
_RCLibCe
 
	tRCLibCe
;

118 
_RCLibCeCss
 
	tRCLibCeCss
;

119 
_RCLibCePrive
 
	tRCLibCePrive
;

136 
	s_RCLibCeMada
 {

137 
gch
 *
	mt
;

138 
gch
 *
	mti
;

139 
gch
 *
	mbum
;

140 
gch
 *
	my
;

141 
gut
 
	mb
;

142 
gt64
 
	mduti
;

143 
gt
 
	mack
;

144 
gt
 
	myr
;

145 
GBufr
 *
	mimage
;

155 
	s_RCLibCe
 {

157 
GObje
 
	m
;

158 
RCLibCePrive
 *
	miv
;

167 
	s_RCLibCeCss
 {

169 
GObjeCss
 
	m_ass
;

170 (*
	me_chged
)(
RCLibCe
 *
	mce
, 
GS
 
	me
);

171 (*
	meos
)(
RCLibCe
 *
	mce
);

172 (*
	mg_found
)(
RCLibCe
 *
	mce
, cڡ 
RCLibCeMada
 *
	mmada
,

173 cڡ 
gch
 *
	muri
);

174 (*
	mw_duti
)(
RCLibCe
 *
	mce
, 
gt64
 
	mduti
);

175 (*
	muri_chged
)(
RCLibCe
 *
	mce
, cڡ 
gch
 *
	muri
);

176 (*
	mvume_chged
)(
RCLibCe
 *
	mce
, 
gdoub
 
	mvume
);

177 (*
	meq_chged
)(
RCLibCe
 *
	mce
, 
RCLibCeEQTy
 
	mty
,

178 
gdoub
 *
	mvues
);

179 (*
	mb_chged
)(
RCLibCe
 *
	mce
, 
gt
 
	mb
);

180 (*
	mbufrg
)(
RCLibCe
 *
	mce
, 
gt
 
	mr
);

181 (*
	mbufr_obe
)(
RCLibCe
 *
	mce
, 
GBufr
 *
	mbufr
);

182 (*
	mr
)(
RCLibCe
 *
	mce
, cڡ 
gch
 *
	mmesge
);

186 
GTy
 
rib_ce_g_ty
();

189 
gboޗn
 
rib_ce_
(
GE
 **
r
);

190 
rib_ce_ex
();

191 
GObje
 *
rib_ce_g_
();

192 
gulg
 
rib_ce_sigl_c
(cڡ 
gch
 *
me
,

193 
GClback
 
back
, 
gpor
 
da
);

194 
rib_ce_sigl_disc
(
gulg
 
hdr_id
);

195 
rib_ce_t_uri
(cڡ 
gch
 *
uri
);

196 
rib_ce_t_uri_wh_db_f
(cڡ 
gch
 *
uri
,

197 
GSequIr
 *
db_f
);

198 
rib_ce_t_uri_wh_ext_f
(cڡ 
gch
 *
uri
, cڡ gch *
cook
,

199 
GSequIr
 *
ex_f
);

200 
rib_ce_upde_db_n
(
GSequIr
 *
w_f
);

201 
rib_ce_upde_ex_n
(cڡ 
gch
 *
cook
,

202 
gpor
 
w_f
);

203 
gch
 *
rib_ce_g_uri
();

204 
GSequIr
 *
rib_ce_g_db_n
();

205 
gboޗn
 
rib_ce_g_ex_n
(
gch
 **
cook
, 
gpor
 *
f
);

206 
RCLibCeSourTy
 
rib_ce_g_sour_ty
();

207 cڡ 
RCLibCeMada
 *
rib_ce_g_mada
();

208 
gboޗn
 
rib_ce_t_posi
(
gt64
 
pos
);

209 
gt64
 
rib_ce_quy_posi
();

210 
gt64
 
rib_ce_quy_duti
();

211 
gboޗn
 
rib_ce_quy_bufrg_r
(
gt
 *
r
, gboޗ*
busy
);

212 
gboޗn
 
rib_ce_quy_bufrg_nge
(
gt64
 *
t
, gt64 *

,

213 
gt64
 *
eimed_tٮ
);

214 
GSChgeRu
 
rib_ce_g_e
(
GS
 *
e
,

215 
GS
 *
ndg
, 
GClockTime
 
timeout
);

216 
gboޗn
 
rib_ce_ay
();

217 
gboޗn
 
rib_ce_u
();

218 
gboޗn
 
rib_ce_
();

219 
gboޗn
 
rib_ce_t_vume
(
gdoub
 
vume
);

220 
gboޗn
 
rib_ce_g_vume
(
gdoub
 *
vume
);

221 
gboޗn
 
rib_ce_t_eq
(
RCLibCeEQTy
 
ty
, 
gdoub
 *
bd
);

222 
gboޗn
 
rib_ce_g_eq
(
RCLibCeEQTy
 *
ty
, 
gdoub
 *
bd
);

223 cڡ 
gch
 *
rib_ce_g_eq_me
(
RCLibCeEQTy
 
ty
);

224 
gboޗn
 
rib_ce_t_b
(
gt
 
b
);

225 
gboޗn
 
rib_ce_g_b
(
gt
 *
b
);

226 
gboޗn
 
rib_ce_ef_ug_add
(
GEmt
 *
emt
);

227 
rib_ce_ef_ug_move
(
GEmt
 *
emt
);

228 
GLi
 *
rib_ce_ef_ug_g_li
();

229 
gt
 
rib_ce_quy_me_
();

230 
gt
 
rib_ce_quy_chls
();

231 
gt
 
rib_ce_quy_dth
();

233 
	gG_END_DECLS


	@lib/rclib-cue.c

27 
	~"rib-cue.h
"

28 
	~"rib-comm.h
"

40 
gch
 *
	gcue_back_codg
 = 
NULL
;

53 
gut
 
	$rib_cue_ad_da
(cڡ 
gch
 *
put
, 
RCLibCueIutTy
 
ty
,

54 
RCLibCueDa
 *
da
)

56 
gch
 *
th
 = 
NULL
;

57 
gch
 *
buf
 = 
NULL
, *
le
 = NULL;

58 
gch
 *
d
 = 
NULL
;

59 
gch
 *
tmp
 = 
NULL
;

60 
gch
 *
cue_w_da
 = 
NULL
, *
cue_tmp_da
 = NULL, *
cue_w_da
 = NULL;

61 
gsize
 
cue_w_ngth
 = 0, 
cue_tmp_ngth
 = 0, 
cue_w_ngth
 = 0;

62 
gt
 
ack_dex
, 
ack_sm
, 
ack_ss
, 
ack_sd
;

63 
gut64
 
ack_time
;

64 
gch
 **
le_da_y
 = 
NULL
;

65 
gboޗn
 
ag
;

66 
gut
 
i
 = 0;

67 
gch
 
chr
;

68 
gut
 
ack_num
 = 0;

69 
GSLi
 *
ack_li
 = 
NULL
, *
li_fܗch
 = NULL;

70 
GRegex
 *
music_fame_gex
;

71 
GRegex
 *
da_gex
;

72 
GMchInfo
 *
mch_fo
;

73 
RCLibCueTck
 *
cue_ack_da
 = 
NULL
, *
cue_ack_y
 = NULL;

74 if(
put
==
NULL
)  0;

75 if(
da
==
NULL
)  0;

76 
ty
)

78 
RCLIB_CUE_INPUT_URI
:

79 
th
 = 
	`g_fame_om_uri
(
put
, 
NULL
, NULL);

80 if(
th
==
NULL
)  0;

81 
RCLIB_CUE_INPUT_PATH
:

82 if(
th
==
NULL
th = 
	`g_rdup
(
put
);

83 if(
th
==
NULL
)  0;

84 
ag
 = 
	`g_fe_g_cڋs
(
th
, &
cue_w_da
,

85 &
cue_w_ngth
, 
NULL
);

86 
d
 = 
	`g_th_g_dme
(
th
);

87 
	`g_
(
th
);

88 if(!
ag
)

90 
	`g_
(
d
);

93 
RCLIB_CUE_INPUT_EMBEDDED
:

98 if(
cue_w_da
==
NULL
)

100 if(!
	`g_utf8_vide
(
put
, -1, 
NULL
&& 
cue_back_codg
!=NULL)

101 
cue_tmp_da
 = 
	`g_cvt
(
put
, -1, "UTF-8",

102 
cue_back_codg
, 
NULL
, NULL, NULL);

104 
cue_tmp_da
 = 
	`g_rdup
(
put
);

108 if(!
	`g_utf8_vide
(
cue_w_da
, -1, 
NULL
))

109 
cue_tmp_da
 = 
	`g_cvt
(
cue_w_da
, -1, "UTF-8",

110 
cue_back_codg
, 
NULL
, NULL, NULL);

112 
cue_tmp_da
 = 
	`g_rdup
(
cue_w_da
);

113 
	`g_
(
cue_w_da
);

115 if(
cue_tmp_da
==
NULL
)

117 
	`g_
(
d
);

120 
cue_tmp_ngth
 = 
	`
(
cue_tmp_da
);

121 
cue_w_da
 = 
	`g_w0
(
gch
, 
cue_tmp_ngth
);

122 
i
=0;i<
cue_tmp_ngth
;i++)

124 
chr
 = 
cue_tmp_da
[
i
];

125 if(
chr
!='\r')

127 
cue_w_da
[
cue_w_ngth
] = 
chr
;

128 
cue_w_ngth
++;

130 if(
i
+1<
cue_tmp_ngth
 && 
cue_w_da
[i+1]!='\n')

132 
cue_w_da
[
cue_w_ngth
] = '\n';

133 
cue_w_ngth
++;

136 
	`g_
(
cue_tmp_da
);

137 
	`memt
(
da
, 0, (
RCLibCueDa
));

138 
da
->
ty
 =ype;

139 if(
ty
!=
RCLIB_CUE_INPUT_EMBEDDED
)

141 
music_fame_gex
 = 
	`g_gex_w
("(FILE \").*[\"]",

142 
G_REGEX_CASELESS
, 0, 
NULL
);

143 
	`g_gex_mch
(
music_fame_gex
, 
cue_w_da
, 0, &
mch_fo
);

144 if(
	`g_mch_fo_mches
(
mch_fo
))

146 
buf
 = 
	`g_mch_fo_tch
(
mch_fo
, 0);

147 if(
d
!=
NULL
)

149 
th
 = 
	`g_dup
(
buf
+6, 
	`
(buf)-7);

150 
tmp
 = 
	`g_bud_fame
(
d
, 
th
, 
NULL
);

151 
da
->
fe
 = 
	`g_fame_to_uri
(
tmp
, 
NULL
, NULL);

152 
	`g_
(
tmp
);

153 
	`g_
(
th
);

156 
da
->
fe
 = 
	`g_dup
(
buf
+6, 
	`
(buf)-7);

157 
	`g_
(
buf
);

159 
	`g_mch_fo_
(
mch_fo
);

160 
	`g_gex_uef
(
music_fame_gex
);

161 
	`g_
(
d
);

162 if(
da
->
fe
==
NULL
)

164 
	`g_
(
cue_w_da
);

169 
da
->
fe
 = 
NULL
;

170 
da_gex
 = 
	`g_gex_w
("\".*[^\"]", 
G_REGEX_CASELESS
, 0, 
NULL
);

171 
le_da_y
 = 
	`g_rl
(
cue_w_da
, "\n", 0);

172 
i
=0;
le_da_y
[i]!=
NULL
;i++)

174 
le
 = 
le_da_y
[
i
];

175 if(
	`g_gex_mch_sime
("(TRACK )[0-9]+AUDIO)", 
le
,

176 
G_REGEX_CASELESS
, 0))

178 
ack_num
++;

179 
cue_ack_da
 = 
	`g_w0
(
RCLibCueTck
, 1);

180 
	`ssnf
(
le
, "%*s%d", &(
cue_ack_da
->
dex
));

181 
ack_li
 = 
	`g_i_nd
ѿck_li, 
cue_ack_da
);

183 if(
cue_ack_da
!=
NULL
 && 
	`g_gex_mch_sime
("(INDEX )[0-9]+ "

184 "[0-9]+:[0-9]{2}:[0-9]{2}", 
le
, 
G_REGEX_CASELESS
, 0))

186 
	`ssnf
(
le
, "%*s%d %d:%d:%d", &
ack_dex
, &
ack_sm
,

187 &
ack_ss
, &
ack_sd
);

188 
ack_time
 = (
ack_sm
 * 60 + 
ack_ss
* 1000 + 10 * 
ack_sd
;

189 
ack_time
 *
GST_MSECOND
;

190 if(
ack_dex
==0)

191 
cue_ack_da
->
time0
 = 
ack_time
;

192 if(
ack_dex
==1)

193 
cue_ack_da
->
time1
 = 
ack_time
;

195 if(
	`g_gex_mch_sime
("(TITLE \").*[\"]", 
le
,

196 
G_REGEX_CASELESS
, 0))

198 
	`g_gex_mch
(
da_gex
, 
le
, 0, &
mch_fo
);

199 if(
	`g_mch_fo_mches
(
mch_fo
))

201 
buf
 = 
	`g_mch_fo_tch
(
mch_fo
, 0);

202 if(
buf
!=
NULL
 && 
	`
(buf)>1)

204 if(
cue_ack_da
!=
NULL
)

206 
	`g_
(
cue_ack_da
->
t
);

207 
cue_ack_da
->
t
 = 
	`g_rdup
(
buf
+1);

211 
	`g_
(
da
->
t
);

212 
da
->
t
 = 
	`g_rdup
(
buf
+1);

215 
	`g_
(
buf
);

217 
	`g_mch_fo_
(
mch_fo
);

219 if(
	`g_gex_mch_sime
("(PERFORMER \").*[\"]", 
le
,

220 
G_REGEX_CASELESS
, 0))

222 
	`g_gex_mch
(
da_gex
, 
le
, 0, &
mch_fo
);

223 if(
	`g_mch_fo_mches
(
mch_fo
))

225 
buf
 = 
	`g_mch_fo_tch
(
mch_fo
, 0);

226 if(
buf
!=
NULL
 && 
	`
(buf)>1)

228 if(
cue_ack_da
!=
NULL
)

230 
	`g_
(
cue_ack_da
->
rfm
);

231 
cue_ack_da
->
rfm
 = 
	`g_rdup
(
buf
+1);

235 
	`g_
(
da
->
rfm
);

236 
da
->
rfm
 = 
	`g_rdup
(
buf
+1);

239 
	`g_
(
buf
);

241 
	`g_mch_fo_
(
mch_fo
);

244 
	`g_rv
(
le_da_y
);

245 
	`g_
(
cue_w_da
);

246 
	`g_gex_uef
(
da_gex
);

247 
i
 = 0;

248 
cue_ack_y
 = 
	`g_w0
(
RCLibCueTck
, 
ack_num
);

249 
li_fܗch
=
ack_li
;li_fܗch!=
NULL
;

250 
li_fܗch
=
	`g_i_xt
(list_foreach))

252 
	`memy
(
cue_ack_y
+
i
, 
li_fܗch
->
da
, (
RCLibCueTck
));

253 
	`g_
(
li_fܗch
->
da
);

254 
i
++;

256 
	`g_i_
(
ack_li
);

257 
da
->
ack
 = 
cue_ack_y
;

258 
da
->
ngth
 = 
ack_num
;

259  
ack_num
;

260 
	}
}

270 
	$rib_cue_
(
RCLibCueDa
 *
da
)

272 
gut
 
i
;

273 
RCLibCueTck
 *
ack
;

274 
	`g_
(
da
->
fe
);

275 
	`g_
(
da
->
t
);

276 
	`g_
(
da
->
rfm
);

277 if(
da
->
ack
!=
NULL
)

279 
i
=0;i<
da
->
ngth
;i++)

281 
ack
 = 
da
->ack+
i
;

282 
	`g_
(
ack
->
t
);

283 
	`g_
(
ack
->
rfm
);

285 
	`g_
(
da
->
ack
);

287 
	`memt
(
da
, 0, (
RCLibCueDa
));

288 
	}
}

304 
gboޗn
 
	$rib_cue_g_ack_num
(cڡ 
gch
 *
th
, gch **
cue_th
,

305 
gt
 *
ack_num
)

307 
gch
 *
ed
;

308 
gt
 
n
;

309 
gt
 
ack
;

310 
ed
 = 
	`chr
(
th
, ':');

311 if(
	`ssnf
(
ed
, ":%d", &
ack
)!=1)

312  
FALSE
;

313 if(
ack
<0 
FALSE
;

314 if(
ack_num
!=
NULL
*ack_num = 
ack
;

315 if(
ed
==
NULL
 
FALSE
;

316 
n
 = 
ed
 - 
th
;

317 if(
n
<=0 
FALSE
;

318 if(
cue_th
!=
NULL
)

319 *
cue_th
 = 
	`g_dup
(
th
, 
n
);

320  
TRUE
;

321 
	}
}

330 
	$rib_cue_t_back_codg
(cڡ 
gch
 *
codg
)

332 if(
codg
==
NULL
) ;

333 
	`g_
(
cue_back_codg
);

334 
cue_back_codg
 = 
	`g_rdup
(
codg
);

335 
	}
}

343 cڡ 
gch
 *
	$rib_cue_g_back_codg
()

345  
cue_back_codg
;

346 
	}
}

	@lib/rclib-cue.h

25 #ide
HAVE_RCLIB_CUE_H


26 
	#HAVE_RCLIB_CUE_H


	)

28 
	~<rg.h
>

29 
	~<glib.h
>

30 
	~<gio/gio.h
>

31 
	~<g/g.h
>

33 
G_BEGIN_DECLS


45 
	mRCLIB_CUE_INPUT_URI
 = 0,

46 
	mRCLIB_CUE_INPUT_PATH
 = 1,

47 
	mRCLIB_CUE_INPUT_EMBEDDED
 = 2

48 }
	tRCLibCueIutTy
;

50 
_RCLibCueTck
 
	tRCLibCueTck
;

51 
_RCLibCueDa
 
	tRCLibCueDa
;

64 
	s_RCLibCueTck
 {

65 
gut
 
	mdex
;

66 
gch
 *
	mt
;

67 
gch
 *
	mrfm
;

68 
gut64
 
	mtime0
;

69 
gut64
 
	mtime1
;

84 
	s_RCLibCueDa
 {

85 
RCLibCueIutTy
 
	mty
;

86 
gch
 *
	mfe
;

87 
gch
 *
	mrfm
;

88 
gch
 *
	mt
;

89 
gut
 
	mngth
;

90 
RCLibCueTck
 *
	mack
;

93 
gut
 
rib_cue_ad_da
(cڡ 
gch
 *
put
, 
RCLibCueIutTy
 
ty
,

94 
RCLibCueDa
 *
da
);

95 
rib_cue_
(
RCLibCueDa
 *
da
);

96 
gboޗn
 
rib_cue_g_ack_num
(cڡ 
gch
 *
th
, gch **
cue_th
,

97 
gt
 *
ack_num
);

98 
rib_cue_t_back_codg
(cڡ 
gch
 *
codg
);

99 cڡ 
gch
 *
rib_cue_g_back_codg
();

101 
	gG_END_DECLS


	@lib/rclib-db-library.c

26 
	~"rib-db.h
"

27 
	~"rib-db-iv.h
"

28 
	~"rib-comm.h
"

29 
	~"rib-g.h
"

30 
	~"rib-cue.h
"

31 
	~"rib-ce.h
"

32 
	~"rib-ut.h
"

43 
RCLibDbLibryDa
 *
	$rib_db_libry_da_w
()

45 
RCLibDbLibryDa
 *
da
 = 
	`g_i_w0
(RCLibDbLibraryData);

46 
da
->
f_cou
 = 1;

47  
da
;

48 
	}
}

59 
RCLibDbLibryDa
 *
	$rib_db_libry_da_f
(
RCLibDbLibryDa
 *
da
)

61 if(
da
==
NULL
)  NULL;

62 
	`g_omic_t_add
(&(
da
->
f_cou
), 1);

63  
da
;

64 
	}
}

76 
	$rib_db_libry_da_uef
(
RCLibDbLibryDa
 *
da
)

78 if(
da
==
NULL
) ;

79 if(
	`g_omic_t_dec_d_
(&(
da
->
f_cou
)))

80 
	`rib_db_libry_da_
(
da
);

81 
	}
}

90 
	$rib_db_libry_da_
(
RCLibDbLibryDa
 *
da
)

92 if(
da
==
NULL
) ;

93 
	`g_
(
da
->
uri
);

94 
	`g_
(
da
->
t
);

95 
	`g_
(
da
->
ti
);

96 
	`g_
(
da
->
bum
);

97 
	`g_
(
da
->
y
);

98 
	`g_
(
da
->
lyricfe
);

99 
	`g_
(
da
->
lyriccfe
);

100 
	`g_
(
da
->
bumfe
);

101 
	`g_i_
(
RCLibDbLibryDa
, 
da
);

102 
	}
}

104 
gboޗn
 
	$_rib_db___libry
(
RCLibDb
 *
db
, 
RCLibDbPrive
 *
iv
)

106 if(
db
==
NULL
 || 
iv
==NULL 
FALSE
;

107 
iv
->
libry_quy
 = 
	`g_qu_w
((
GDeroyNify
)

108 
rib_db_libry_da_uef
);

109 
iv
->
libry_b
 = 
	`g_hash_b_w_fu
(
g_r_hash
,

110 
g_r_equ
, 
g_
, (
GDeroyNify
)
rib_db_libry_da_uef
);

111  
TRUE
;

112 
	}
}

114 
	$_rib_db__fize_libry
(
RCLibDbPrive
 *
iv
)

116 if(
iv
==
NULL
) ;

117 if(
iv
->
libry_quy
!=
NULL
)

118 
	`g_qu_
(
iv
->
libry_quy
);

119 if(
iv
->
libry_b
!=
NULL
)

120 
	`g_hash_b_deroy
(
iv
->
libry_b
);

121 
iv
->
libry_quy
 = 
NULL
;

122 
iv
->
libry_b
 = 
NULL
;

123 
	}
}

	@lib/rclib-db-playlist.c

26 
	~"rib-db.h
"

27 
	~"rib-db-iv.h
"

28 
	~"rib-comm.h
"

29 
	~"rib-g.h
"

30 
	~"rib-cue.h
"

31 
	~"rib-ce.h
"

32 
	~"rib-ut.h
"

34 
gt
 
	gdb_impt_dth
 = 5;

36 
gboޗn
 
	$rib_db_is__vid
(
GSequ
 *
q
, 
GSequIr
 *

)

38 
GSequIr
 *
_fܗch
;

39 if(
q
==
NULL
 || 

==NULL 
FALSE
;

40 
_fܗch
 = 
	`g_qu_g_beg_
(
q
);

41 !
	`g_qu__is_d
(
_fܗch
);

42 
_fܗch
 = 
	`g_qu__xt
(iter_foreach))

44 if(

==
_fܗch
 
TRUE
;

46  
FALSE
;

47 
	}
}

49 
le
 
	$rib_db_ayli_impt_id_da_
(

50 
RCLibDbPyliImptIdDa
 *
da
)

52 if(
da
==
NULL
) ;

53 if(
da
->
mmd
!=
NULL

	`rib_g_
(data->mmd);

54 
	`g_
(
da
);

55 
	}
}

57 
le
 
	$rib_db_ayli_esh_id_da_
(

58 
RCLibDbPyliReeshIdDa
 *
da
)

60 if(
da
==
NULL
) ;

61 if(
da
->
mmd
!=
NULL

	`rib_g_
(data->mmd);

62 
	`g_
(
da
);

63 
	}
}

65 
gboޗn
 
	$_rib_db_ayli_impt_id_cb
(
gpor
 
da
)

67 
RCLibDbPrive
 *
iv
;

68 
GObje
 *

;

69 
RCLibDbPyliDa
 *
ayli_da
;

70 
RCLibDbCogDa
 *
log_da
;

71 
GSequ
 *
ayli
;

72 
GSequIr
 *
ayli_
;

73 
RCLibDbPyliImptIdDa
 *
id_da
;

74 
RCLibTagMada
 *
mmd
;

75 if(
da
==
NULL
 
FALSE
;

76 

 = 
	`rib_db_g_
();

77 if(

==
NULL
 
FALSE
;

78 
id_da
 = (
RCLibDbPyliImptIdDa
 *)
da
;

79 if(
id_da
->
mmd
==
NULL
 
FALSE
;

80 
iv
 = 
	`RCLIB_DB
(

)->priv;

81 if(
iv
==
NULL
 
FALSE
;

82 if(

==
NULL
 
FALSE
;

83 if(!
	`rib_db_is__vid
(
iv
->
log
, 
id_da
->
log_
))

84  
FALSE
;

85 
log_da
 = 
	`g_qu_g
(
id_da
->
log_
);

86 if(
log_da
==
NULL
 
FALSE
;

87 
ayli
 = 
log_da
->playlist;

88 if(
ayli
==
NULL
 
FALSE
;

89 
mmd
 = 
id_da
->mmd;

90 
ayli_da
 = 
	`rib_db_ayli_da_w
();

91 
ayli_da
->
log
 = 
id_da
->
log_
;

92 
ayli_da
->
ty
 = 
id_da
->type;

93 
ayli_da
->
uri
 = 
	`g_rdup
(
mmd
->uri);

94 
ayli_da
->
t
 = 
	`g_rdup
(
mmd
->title);

95 
ayli_da
->
ti
 = 
	`g_rdup
(
mmd
->artist);

96 
ayli_da
->
bum
 = 
	`g_rdup
(
mmd
->album);

97 
ayli_da
->
y
 = 
	`g_rdup
(
mmd
->ftype);

98 
ayli_da
->
ngth
 = 
mmd
->length;

99 
ayli_da
->
acknum
 = 
mmd
->tracknum;

100 
ayli_da
->
yr
 = 
mmd
->year;

101 
ayli_da
->
tg
 = 3.0;

102 if(!
	`rib_db_is__vid
(
ayli
, 
id_da
->
ayli__
))

103 
id_da
->
ayli__
 = 
NULL
;

104 if(
id_da
->
ayli__
!=
NULL
)

106 
ayli_
 = 
	`g_qu__befe
(

107 
id_da
->
ayli__
, 
ayli_da
);

110 
ayli_
 = 
	`g_qu_nd
(
ayli
, 
ayli_da
);

111 
ayli_da
->
lf_
 = 
ayli_
;

112 
	`g_hash_b_a
(
iv
->
ayli__b
, 
ayli_
,

113 
ayli_
);

114 
iv
->
dty_ag
 = 
TRUE
;

115 
	`g_sigl_em_by_me
(

, "ayli-added", 
ayli_
);

116 
	`rib_db_ayli_impt_id_da_
(
id_da
);

117  
FALSE
;

118 
	}
}

120 
gboޗn
 
	$_rib_db_ayli_esh_id_cb
(
gpor
 
da
)

122 
RCLibDbPrive
 *
iv
;

123 
GObje
 *

;

124 
RCLibDbPyliDa
 *
ayli_da
;

125 
RCLibDbCogDa
 *
log_da
;

126 
GSequ
 *
ayli
;

127 
RCLibDbPyliReeshIdDa
 *
id_da
;

128 
RCLibTagMada
 *
mmd
;

129 if(
da
==
NULL
 
FALSE
;

130 

 = 
	`rib_db_g_
();

131 if(

==
NULL
 
FALSE
;

132 
id_da
 = (
RCLibDbPyliReeshIdDa
 *)
da
;

133 
iv
 = 
	`RCLIB_DB
(

)->priv;

134 if(
iv
==
NULL
 
FALSE
;

135 if(

==
NULL
 
FALSE
;

136 if(!
	`rib_db_is__vid
(
iv
->
log
, 
id_da
->
log_
))

137  
FALSE
;

138 
log_da
 = 
	`g_qu_g
(
id_da
->
log_
);

139 if(
log_da
==
NULL
 
FALSE
;

140 
ayli
 = 
log_da
->playlist;

141 if(
ayli
==
NULL
 
FALSE
;

142 if(!
	`rib_db_is__vid
(
ayli
, 
id_da
->
ayli_
))

143  
FALSE
;

144 
ayli_da
 = 
	`g_qu_g
(
id_da
->
ayli_
);

145 
mmd
 = 
id_da
->mmd;

146 
ayli_da
->
ty
 = 
id_da
->type;

147 if(
mmd
!=
NULL
)

149 
	`g_
(
ayli_da
->
t
);

150 
	`g_
(
ayli_da
->
ti
);

151 
	`g_
(
ayli_da
->
bum
);

152 
	`g_
(
ayli_da
->
y
);

153 
ayli_da
->
t
 = 
	`g_rdup
(
mmd
->title);

154 
ayli_da
->
ti
 = 
	`g_rdup
(
mmd
->artist);

155 
ayli_da
->
bum
 = 
	`g_rdup
(
mmd
->album);

156 
ayli_da
->
y
 = 
	`g_rdup
(
mmd
->ftype);

157 
ayli_da
->
ngth
 = 
mmd
->length;

158 
ayli_da
->
acknum
 = 
mmd
->tracknum;

159 
ayli_da
->
yr
 = 
mmd
->year;

161 
iv
->
dty_ag
 = 
TRUE
;

162 
	`g_sigl_em_by_me
(

, "playlist-changed",

163 
id_da
->
ayli_
);

164 
	`rib_db_ayli_esh_id_da_
(
id_da
);

165  
FALSE
;

166 
	}
}

168 
gboޗn
 
	$_rib_db___ayli
(
RCLibDb
 *
db
, 
RCLibDbPrive
 *
iv
)

170 if(
db
==
NULL
 || 
iv
==NULL 
FALSE
;

171 
iv
->
log__b
 = 
	`g_hash_b_w_fu
(
g_de_hash
,

172 
g_de_equ
, 
NULL
, NULL);

173 
iv
->
ayli__b
 = 
	`g_hash_b_w_fu
(
g_de_hash
,

174 
g_de_equ
, 
NULL
, NULL);

175 
iv
->
log
 = 
	`g_qu_w
((
GDeroyNify
)

176 
rib_db_log_da_uef
);

177  
TRUE
;

178 
	}
}

180 
	$_rib_db__fize_ayli
(
RCLibDbPrive
 *
iv
)

182 if(
iv
==
NULL
) ;

183 if(
iv
->
log
!=
NULL
)

184 
	`g_qu_
(
iv
->
log
);

185 if(
iv
->
log__b
!=
NULL
)

186 
	`g_hash_b_deroy
(
iv
->
log__b
);

187 if(
iv
->
ayli__b
!=
NULL
)

188 
	`g_hash_b_deroy
(
iv
->
ayli__b
);

189 
iv
->
log
 = 
NULL
;

190 
iv
->
log__b
 = 
NULL
;

191 
iv
->
ayli__b
 = 
NULL
;

192 
	}
}

203 
RCLibDbCogDa
 *
	$rib_db_log_da_w
()

205 
RCLibDbCogDa
 *
da
 = 
	`g_i_w0
(RCLibDbCatalogData);

206 
da
->
f_cou
 = 1;

207  
da
;

208 
	}
}

219 
RCLibDbCogDa
 *
	$rib_db_log_da_f
(
RCLibDbCogDa
 *
da
)

221 if(
da
==
NULL
)  NULL;

222 
	`g_omic_t_add
(&(
da
->
f_cou
), 1);

223  
da
;

224 
	}
}

236 
	$rib_db_log_da_uef
(
RCLibDbCogDa
 *
da
)

238 if(
da
==
NULL
) ;

239 if(
	`g_omic_t_dec_d_
(&(
da
->
f_cou
)))

240 
	`rib_db_log_da_
(
da
);

241 
	}
}

250 
	$rib_db_log_da_
(
RCLibDbCogDa
 *
da
)

252 if(
da
==
NULL
) ;

253 
	`g_
(
da
->
me
);

254 if(
da
->
ayli
!=
NULL

	`g_qu_
(data->playlist);

255 
	`g_i_
(
RCLibDbCogDa
, 
da
);

256 
	}
}

267 
RCLibDbPyliDa
 *
	$rib_db_ayli_da_w
()

269 
RCLibDbPyliDa
 *
da
 = 
	`g_i_w0
(RCLibDbPlaylistData);

270 
da
->
f_cou
 = 1;

271  
da
;

272 
	}
}

283 
RCLibDbPyliDa
 *
	$rib_db_ayli_da_f
(
RCLibDbPyliDa
 *
da
)

285 if(
da
==
NULL
)  NULL;

286 
	`g_omic_t_add
(&(
da
->
f_cou
), 1);

287  
da
;

288 
	}
}

300 
	$rib_db_ayli_da_uef
(
RCLibDbPyliDa
 *
da
)

302 if(
da
==
NULL
) ;

303 if(
	`g_omic_t_dec_d_
(&(
da
->
f_cou
)))

304 
	`rib_db_ayli_da_
(
da
);

305 
	}
}

314 
	$rib_db_ayli_da_
(
RCLibDbPyliDa
 *
da
)

316 if(
da
==
NULL
) ;

317 
	`g_
(
da
->
uri
);

318 
	`g_
(
da
->
t
);

319 
	`g_
(
da
->
ti
);

320 
	`g_
(
da
->
bum
);

321 
	`g_
(
da
->
y
);

322 
	`g_
(
da
->
lyricfe
);

323 
	`g_
(
da
->
lyriccfe
);

324 
	`g_
(
da
->
bumfe
);

325 
	`g_i_
(
RCLibDbPyliDa
, 
da
);

326 
	}
}

337 
GSequ
 *
	$rib_db_g_log
()

339 
RCLibDbPrive
 *
iv
;

340 
GObje
 *

;

341 

 = 
	`rib_db_g_
();

342 if(

==
NULL
)  NULL;

343 
iv
 = 
	`RCLIB_DB
(

)->priv;

344 if(
iv
==
NULL
)  NULL;

345  
iv
->
log
;

346 
	}
}

357 
gboޗn
 
	$rib_db_log_is_vid_
(
GSequIr
 *
log_
)

359 
RCLibDbPrive
 *
iv
;

360 
GObje
 *

;

361 

 = 
	`rib_db_g_
();

362 if(

==
NULL
 
FALSE
;

363 
iv
 = 
	`RCLIB_DB
(

)->priv;

364 if(
iv
==
NULL
 
FALSE
;

365  
	`g_hash_b_cڏs
(
iv
->
log__b
, 
log_
);

366 
	}
}

381 
GSequIr
 *
	$rib_db_log_add
(cڡ 
gch
 *
me
,

382 
GSequIr
 *

, 
gt
 
ty
)

384 
RCLibDbCogDa
 *
log_da
;

385 
GObje
 *

;

386 
RCLibDbPrive
 *
iv
;

387 
GSequ
 *
ayli
;

388 
GSequIr
 *
log_
;

389 

 = 
	`rib_db_g_
();

390 if(

==
NULL
 || 
me
==NULL)  NULL;

391 
iv
 = 
	`RCLIB_DB
(

)->priv;

392 if(
iv
==
NULL
)  NULL;

393 if(

!=
NULL
 && 
	`g_qu__g_qu
()!=
iv
->
log
)

394  
NULL
;

395 
log_da
 = 
	`rib_db_log_da_w
();

396 
ayli
 = 
	`g_qu_w
((
GDeroyNify
)
rib_db_ayli_da_uef
);

397 
log_da
->
me
 = 
	`g_rdup
(name);

398 
log_da
->
ty
 =ype;

399 
log_da
->
ayli
 =laylist;

400 if(

!=
NULL
)

401 
log_
 = 
	`g_qu__befe
(

, 
log_da
);

403 
log_
 = 
	`g_qu_nd
(
iv
->
log
, 
log_da
);

404 
log_da
->
lf_
 = 
log_
;

405 
	`g_hash_b_a
(
iv
->
log__b
, 
log_
,

406 
log_
);

407 
iv
->
dty_ag
 = 
TRUE
;

408 
	`g_sigl_em_by_me
(

, "log-added", 
log_
);

409  
log_
;

410 
	}
}

419 
	$rib_db_log_de
(
GSequIr
 *

)

421 
RCLibDbPrive
 *
iv
;

422 
RCLibDbCogDa
 *
log_da
;

423 
GObje
 *

;

424 
GSequIr
 *
_fܗch
;

425 if(

==
NULL
) ;

426 if(
	`g_qu__is_d
(

)) ;

427 

 = 
	`rib_db_g_
();

428 if(

==
NULL
) ;

429 
iv
 = 
	`RCLIB_DB
(

)->priv;

430 if(
iv
==
NULL
) ;

431 
log_da
 = 
	`g_qu_g
(

);

432 
log_da
->
lf_
 = 
NULL
;

433 
	`g_sigl_em_by_me
(

, "log-de", 

);

434 
_fܗch
=
	`g_qu_g_beg_
(
log_da
->
ayli
);

435 !
	`g_qu__is_d
(
_fܗch
);

436 
_fܗch
=
	`g_qu__xt
(iter_foreach))

438 
	`g_hash_b_move
(
iv
->
ayli__b
, 
_fܗch
);

440 
	`g_qu_move
(

);

441 
	`g_hash_b_move
(
iv
->
log__b
, 

);

442 
iv
->
dty_ag
 = 
TRUE
;

443 
	}
}

453 
	$rib_db_log_t_me
(
GSequIr
 *

, cڡ 
gch
 *
me
)

455 
RCLibDbPrive
 *
iv
;

456 
GObje
 *

;

457 
RCLibDbCogDa
 *
log_da
;

458 if(

==
NULL
 || 
me
==NULL) ;

459 if(
	`g_qu__is_d
(

)) ;

460 

 = 
	`rib_db_g_
();

461 if(

==
NULL
) ;

462 
iv
 = 
	`RCLIB_DB
(

)->priv;

463 if(
iv
==
NULL
) ;

464 
log_da
 = 
	`g_qu_g
(

);

465 if(
log_da
==
NULL
) ;

466 
	`g_
(
log_da
->
me
);

467 
log_da
->
me
 = 
	`g_rdup
(name);

468 
iv
->
dty_ag
 = 
TRUE
;

469 
	`g_sigl_em_by_me
(

, "log-chged", 

);

470 
	}
}

480 
	$rib_db_log_t_ty
(
GSequIr
 *

, 
RCLibDbCogTy
 
ty
)

482 
RCLibDbPrive
 *
iv
;

483 
GObje
 *

;

484 
RCLibDbCogDa
 *
log_da
;

485 if(

==
NULL
) ;

486 if(
	`g_qu__is_d
(

)) ;

487 

 = 
	`rib_db_g_
();

488 if(

==
NULL
) ;

489 
iv
 = 
	`RCLIB_DB
(

)->priv;

490 if(
iv
==
NULL
) ;

491 
log_da
 = 
	`g_qu_g
(

);

492 if(
log_da
==
NULL
) ;

493 
log_da
->
ty
 =ype;

494 
iv
->
dty_ag
 = 
TRUE
;

495 
	`g_sigl_em_by_me
(

, "log-chged", 

);

496 
	}
}

498 
gt
 
	$rib_db_d_func
(
GSequIr
 *
a
, GSequI*
b
,

499 
gpor
 
ur_da
)

501 
GHashTab
 *
w_posis
 = 
ur_da
;

502 
gt
 
os
 = 
	`GPOINTER_TO_INT
(
	`g_hash_b_lookup
(
w_posis
, 
a
));

503 
gt
 
bpos
 = 
	`GPOINTER_TO_INT
(
	`g_hash_b_lookup
(
w_posis
, 
b
));

504 if(
os
 < 
bpos
)  -1;

505 if(
os
 > 
bpos
)  1;

507 
	}
}

518 
	$rib_db_log_d
(
gt
 *
w_d
)

520 
RCLibDbPrive
 *
iv
;

521 
GObje
 *

;

522 
gt
 
i
;

523 
GHashTab
 *
w_posis
;

524 
GSequIr
 *
r
;

525 
gt
 *
d
;

526 
gt
 
ngth
;

527 

 = 
	`rib_db_g_
();

528 
	`g_tu_if_
(

!=
NULL
);

529 
	`g_tu_if_
(
w_d
!=
NULL
);

530 
iv
 = 
	`RCLIB_DB
(

)->priv;

531 
	`g_tu_if_
(
iv
!=
NULL
);

532 
ngth
 = 
	`g_qu_g_ngth
(
iv
->
log
);

533 
d
 = 
	`g_w
(
gt
, 
ngth
);

534 
i
=0;i<
ngth
;i++
d
[
w_d
[i]] = i;

535 
w_posis
 = 
	`g_hash_b_w
(
g_de_hash
, 
g_de_equ
);

536 
r
 = 
	`g_qu_g_beg_
(
iv
->
log
);

537 if(!
	`g_qu__is_d
(
r
))

539 
i
=0;!
	`g_qu__is_d
(
r
);r=
	`g_qu__xt
(ptr))

541 
	`g_hash_b_
(
w_posis
, 
r
,

542 
	`GINT_TO_POINTER
(
d
[
i
++]));

545 
	`g_
(
d
);

546 
	`g_qu_st_
(
iv
->
log
, 
rib_db_d_func
,

547 
w_posis
);

548 
	`g_hash_b_deroy
(
w_posis
);

549 
iv
->
dty_ag
 = 
TRUE
;

550 
	`g_sigl_em_by_me
(

, "log-ded", 
w_d
);

551 
	}
}

562 
gboޗn
 
	$rib_db_ayli_is_vid_
(
GSequIr
 *
ayli_
)

564 
RCLibDbPrive
 *
iv
;

565 
GObje
 *

;

566 

 = 
	`rib_db_g_
();

567 if(

==
NULL
 
FALSE
;

568 
iv
 = 
	`RCLIB_DB
(

)->priv;

569 if(
iv
==
NULL
 
FALSE
;

570  
	`g_hash_b_cڏs
(
iv
->
ayli__b
, 
ayli_
);

571 
	}
}

582 
	$rib_db_ayli_add_music
(
GSequIr
 *

,

583 
GSequIr
 *
_
, cڡ 
gch
 *
uri
)

585 
RCLibDbImptDa
 *
impt_da
;

586 
GObje
 *

;

587 
RCLibDbPrive
 *
iv
;

588 

 = 
	`rib_db_g_
();

589 if(
uri
==
NULL
 || 

==NULL || 

==NULL) ;

590 if(
	`g_qu__is_d
(

)) ;

591 
iv
 = 
	`RCLIB_DB
(

)->priv;

592 
iv
->
impt_wk_ag
 = 
TRUE
;

593 
impt_da
 = 
	`g_w0
(
RCLibDbImptDa
, 1);

594 
impt_da
->
ty
 = 
RCLIB_DB_IMPORT_TYPE_PLAYLIST
;

595 
impt_da
->
log_
 = 

;

596 
impt_da
->
ayli__
 = 
_
;

597 
impt_da
->
uri
 = 
	`g_rdup
(uri);

598 
	`g_async_queue_push
(
iv
->
impt_queue
, 
impt_da
);

599 
	}
}

611 
	$rib_db_ayli_add_music_d_ay
(
GSequIr
 *

,

612 
GSequIr
 *
_
, cڡ 
gch
 *
uri
)

614 
RCLibDbImptDa
 *
impt_da
;

615 
GObje
 *

;

616 
RCLibDbPrive
 *
iv
;

617 

 = 
	`rib_db_g_
();

618 if(
uri
==
NULL
 || 

==NULL || 

==NULL) ;

619 if(
	`g_qu__is_d
(

)) ;

620 
iv
 = 
	`RCLIB_DB
(

)->priv;

621 
iv
->
impt_wk_ag
 = 
TRUE
;

622 
impt_da
 = 
	`g_w0
(
RCLibDbImptDa
, 1);

623 
impt_da
->
ty
 = 
RCLIB_DB_IMPORT_TYPE_PLAYLIST
;

624 
impt_da
->
log_
 = 

;

625 
impt_da
->
ayli__
 = 
_
;

626 
impt_da
->
uri
 = 
	`g_rdup
(uri);

627 
impt_da
->
ay_ag
 = 
TRUE
;

628 
	`g_async_queue_push
(
iv
->
impt_queue
, 
impt_da
);

629 
	}
}

638 
	$rib_db_ayli_de
(
GSequIr
 *

)

640 
RCLibDbPrive
 *
iv
;

641 
RCLibDbPyliDa
 *
ayli_da
;

642 
GObje
 *

;

643 if(

==
NULL
) ;

644 if(
	`g_qu__is_d
(

)) ;

645 

 = 
	`rib_db_g_
();

646 if(

==
NULL
) ;

647 
iv
 = 
	`RCLIB_DB
(

)->priv;

648 if(
iv
==
NULL
) ;

649 
ayli_da
 = 
	`g_qu_g
(

);

650 
ayli_da
->
lf_
 = 
NULL
;

651 
	`g_sigl_em_by_me
(

, "ayli-de", 

);

652 
	`g_qu_move
(

);

653 
	`g_hash_b_move
(
iv
->
ayli__b
, 

);

654 
iv
->
dty_ag
 = 
TRUE
;

655 
	}
}

667 
	$rib_db_ayli_upde_mada
(
GSequIr
 *

,

668 cڡ 
RCLibDbPyliDa
 *
da
)

670 
RCLibDbPyliDa
 *
ayli_da
;

671 
RCLibDbPrive
 *
iv
;

672 
GObje
 *

;

673 if(

==
NULL
) ;

674 if(
	`g_qu__is_d
(

)) ;

675 

 = 
	`rib_db_g_
();

676 if(

==
NULL
) ;

677 
iv
 = 
	`RCLIB_DB
(

)->priv;

678 if(
iv
==
NULL
) ;

679 
ayli_da
 = 
	`g_qu_g
(

);

680 if(
ayli_da
==
NULL
) ;

681 if(
da
->
t
!=
NULL
 && 
	`g_rcmp0
(
ayli_da
->title,

682 
da
->
t
)!=0)

684 
iv
->
dty_ag
 = 
TRUE
;

685 
	`g_debug
("Playlist data updated,itle: %s -> %s",

686 
ayli_da
->
t
, 
da
->title);

688 if(
da
->
ti
!=
NULL
 && 
	`g_rcmp0
(
ayli_da
->artist,

689 
da
->
ti
)!=0)

691 
iv
->
dty_ag
 = 
TRUE
;

692 
	`g_debug
("Playlist data updated,rtist: %s -> %s",

693 
ayli_da
->
ti
, 
da
->artist);

695 if(
da
->
bum
!=
NULL
 && 
	`g_rcmp0
(
ayli_da
->album,

696 
da
->
bum
)!=0)

698 
iv
->
dty_ag
 = 
TRUE
;

699 
	`g_debug
("Playlist data updated,lbum: %s -> %s",

700 
ayli_da
->
bum
, 
da
->album);

702 if(
ayli_da
->
acknum
!=
da
->tracknum)

704 
iv
->
dty_ag
 = 
TRUE
;

705 
	`g_debug
("Playlist data updated,rackumber: %d -> %d",

706 
ayli_da
->
acknum
, 
da
->tracknum);

708 if(
ayli_da
->
yr
!=
da
->year)

710 
iv
->
dty_ag
 = 
TRUE
;

711 
	`g_debug
("Playlist data updated, year: %d -> %d",

712 
ayli_da
->
yr
, 
da
->year);

714 if(
ayli_da
->
ty
!=
da
->type)

716 
iv
->
dty_ag
 = 
TRUE
;

717 
	`g_debug
("Playlist data updated,ype: %d -> %d",

718 
ayli_da
->
ty
, 
da
->type);

720 
	`g_
(
ayli_da
->
t
);

721 
	`g_
(
ayli_da
->
ti
);

722 
	`g_
(
ayli_da
->
bum
);

723 
	`g_
(
ayli_da
->
y
);

724 
ayli_da
->
t
 = 
	`g_rdup
(
da
->title);

725 
ayli_da
->
ti
 = 
	`g_rdup
(
da
->artist);

726 
ayli_da
->
bum
 = 
	`g_rdup
(
da
->album);

727 
ayli_da
->
y
 = 
	`g_rdup
(
da
->ftype);

728 
ayli_da
->
acknum
 = 
da
->tracknum;

729 
ayli_da
->
yr
 = 
da
->year;

730 
ayli_da
->
ty
 = 
da
->type;

731 
	`g_sigl_em_by_me
(

, "ayli-chged", 

);

732 
	}
}

743 
	$rib_db_ayli_upde_ngth
(
GSequIr
 *

,

744 
gt64
 
ngth
)

746 
RCLibDbPrive
 *
iv
;

747 
GObje
 *

;

748 
RCLibDbPyliDa
 *
ayli_da
;

749 if(

==
NULL
) ;

750 if(
	`g_qu__is_d
(

)) ;

751 

 = 
	`rib_db_g_
();

752 if(

==
NULL
) ;

753 
iv
 = 
	`RCLIB_DB
(

)->priv;

754 if(
iv
==
NULL
) ;

755 
ayli_da
 = 
	`g_qu_g
(

);

756 if(
ayli_da
==
NULL
) ;

757 if(
ayli_da
->
ngth
!=length)

758 
iv
->
dty_ag
 = 
TRUE
;

759 
ayli_da
->
ngth
 =ength;

760 
	`g_sigl_em_by_me
(

, "ayli-chged", 

);

761 
	}
}

771 
	$rib_db_ayli_t_ty
(
GSequIr
 *

,

772 
RCLibDbPyliTy
 
ty
)

774 
RCLibDbPrive
 *
iv
;

775 
GObje
 *

;

776 
RCLibDbPyliDa
 *
ayli_da
;

777 if(

==
NULL
) ;

778 if(
	`g_qu__is_d
(

)) ;

779 

 = 
	`rib_db_g_
();

780 if(

==
NULL
) ;

781 
iv
 = 
	`RCLIB_DB
(

)->priv;

782 if(
iv
==
NULL
) ;

783 
ayli_da
 = 
	`g_qu_g
(

);

784 if(
ayli_da
==
NULL
) ;

785 if(
ayli_da
->
ty
!=type)

786 
iv
->
dty_ag
 = 
TRUE
;

787 
ayli_da
->
ty
 =ype;

788 
	`g_sigl_em_by_me
(

, "ayli-chged", 

);

789 
	}
}

799 
	$rib_db_ayli_t_tg
(
GSequIr
 *

, 
gt
 
tg
)

801 
RCLibDbPrive
 *
iv
;

802 
GObje
 *

;

803 
RCLibDbPyliDa
 *
ayli_da
;

804 if(

==
NULL
) ;

805 if(
	`g_qu__is_d
(

)) ;

806 if(
tg
<0.0)ating = 0.0;

807 if(
tg
>5.0)ating = 5.0;

808 

 = 
	`rib_db_g_
();

809 if(

==
NULL
) ;

810 
iv
 = 
	`RCLIB_DB
(

)->priv;

811 if(
iv
==
NULL
) ;

812 
ayli_da
 = 
	`g_qu_g
(

);

813 if(
ayli_da
==
NULL
) ;

814 if(
ayli_da
->
tg
!=rating)

815 
iv
->
dty_ag
 = 
TRUE
;

816 
ayli_da
->
tg
 =ating;

817 
	`g_sigl_em_by_me
(

, "ayli-chged", 

);

818 
	}
}

828 
	$rib_db_ayli_t_lyric_bd
(
GSequIr
 *

,

829 cڡ 
gch
 *
fame
)

831 
RCLibDbPrive
 *
iv
;

832 
GObje
 *

;

833 
RCLibDbPyliDa
 *
ayli_da
;

834 if(

==
NULL
) ;

835 

 = 
	`rib_db_g_
();

836 if(

==
NULL
) ;

837 
iv
 = 
	`RCLIB_DB
(

)->priv;

838 if(
iv
==
NULL
) ;

839 
ayli_da
 = 
	`g_qu_g
(

);

840 if(
ayli_da
==
NULL
) ;

841 
	`g_
(
ayli_da
->
lyricfe
);

842 
ayli_da
->
lyricfe
 = 
	`g_rdup
(
fame
);

843 
iv
->
dty_ag
 = 
TRUE
;

844 
	}
}

855 
	$rib_db_ayli_t_lyric_cdy_bd
(
GSequIr
 *

,

856 cڡ 
gch
 *
fame
)

858 
RCLibDbPrive
 *
iv
;

859 
GObje
 *

;

860 
RCLibDbPyliDa
 *
ayli_da
;

861 if(

==
NULL
) ;

862 if(
	`g_qu__is_d
(

)) ;

863 

 = 
	`rib_db_g_
();

864 if(

==
NULL
) ;

865 
iv
 = 
	`RCLIB_DB
(

)->priv;

866 if(
iv
==
NULL
) ;

867 
ayli_da
 = 
	`g_qu_g
(

);

868 if(
ayli_da
==
NULL
) ;

869 
	`g_
(
ayli_da
->
lyriccfe
);

870 
ayli_da
->
lyriccfe
 = 
	`g_rdup
(
fame
);

871 
iv
->
dty_ag
 = 
TRUE
;

872 
	}
}

883 
	$rib_db_ayli_t_bum_bd
(
GSequIr
 *

,

884 cڡ 
gch
 *
fame
)

886 
RCLibDbPrive
 *
iv
;

887 
GObje
 *

;

888 
RCLibDbPyliDa
 *
ayli_da
;

889 if(

==
NULL
) ;

890 if(
	`g_qu__is_d
(

)) ;

891 

 = 
	`rib_db_g_
();

892 if(

==
NULL
) ;

893 
iv
 = 
	`RCLIB_DB
(

)->priv;

894 if(
iv
==
NULL
) ;

895 
ayli_da
 = 
	`g_qu_g
(

);

896 if(
ayli_da
==
NULL
) ;

897 
	`g_
(
ayli_da
->
bumfe
);

898 
ayli_da
->
bumfe
 = 
	`g_rdup
(
fame
);

899 
iv
->
dty_ag
 = 
TRUE
;

900 
	}
}

913 
gboޗn
 
	$rib_db_ayli_g_tg
(
GSequIr
 *

, 
gt
 *
tg
)

915 
RCLibDbPyliDa
 *
ayli_da
;

916 if(
	`g_qu__is_d
(

) 
FALSE
;

917 
ayli_da
 = 
	`g_qu_g
(

);

918 if(
ayli_da
==
NULL
 
FALSE
;

919 if(
tg
!=
NULL
*tg = 
ayli_da
->rating;

920  
TRUE
;

921 
	}
}

933 cڡ 
gch
 *
	$rib_db_ayli_g_lyric_bd
(
GSequIr
 *

)

935 
RCLibDbPyliDa
 *
ayli_da
;

936 if(
	`g_qu__is_d
(

) 
NULL
;

937 
ayli_da
 = 
	`g_qu_g
(

);

938 if(
ayli_da
==
NULL
)  NULL;

939  
ayli_da
->
lyricfe
;

940 
	}
}

952 cڡ 
gch
 *
	$rib_db_ayli_g_lyric_cdy_bd
(
GSequIr
 *

)

954 
RCLibDbPyliDa
 *
ayli_da
;

955 if(
	`g_qu__is_d
(

) 
NULL
;

956 
ayli_da
 = 
	`g_qu_g
(

);

957 if(
ayli_da
==
NULL
)  NULL;

958  
ayli_da
->
lyriccfe
;

959 
	}
}

971 cڡ 
gch
 *
	$rib_db_ayli_g_bum_bd
(
GSequIr
 *

)

973 
RCLibDbPyliDa
 *
ayli_da
;

974 if(
	`g_qu__is_d
(

) 
NULL
;

975 
ayli_da
 = 
	`g_qu_g
(

);

976 if(
ayli_da
==
NULL
)  NULL;

977  
ayli_da
->
bumfe
;

978 
	}
}

990 
	$rib_db_ayli_d
(
GSequIr
 *

, 
gt
 *
w_d
)

992 
RCLibDbPrive
 *
iv
;

993 
GObje
 *

;

994 
RCLibDbCogDa
 *
log_da
;

995 
GHashTab
 *
w_posis
;

996 
GSequIr
 *
r
;

997 
gt
 
i
;

998 
gt
 *
d
;

999 
gt
 
ngth
;

1000 
	`g_tu_if_
(

!=
NULL
);

1001 
	`g_tu_if_
(
w_d
!=
NULL
);

1002 

 = 
	`rib_db_g_
();

1003 if(

==
NULL
) ;

1004 
iv
 = 
	`RCLIB_DB
(

)->priv;

1005 if(
iv
==
NULL
) ;

1006 
log_da
 = 
	`g_qu_g
(

);

1007 
	`g_tu_if_
(
log_da
!=
NULL
);

1008 
ngth
 = 
	`g_qu_g_ngth
(
log_da
->
ayli
);

1009 
d
 = 
	`g_w
(
gt
, 
ngth
);

1010 
i
=0;i<
ngth
;i++
d
[
w_d
[i]] = i;

1011 
w_posis
 = 
	`g_hash_b_w
(
g_de_hash
, 
g_de_equ
);

1012 
r
 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

1013 
i
=0;!
	`g_qu__is_d
(
r
);r=
	`g_qu__xt
(ptr))

1015 
	`g_hash_b_
(
w_posis
, 
r
, 
	`GINT_TO_POINTER
(
d
[
i
++]));

1017 
	`g_
(
d
);

1018 
	`g_qu_st_
(
log_da
->
ayli
, 
rib_db_d_func
,

1019 
w_posis
);

1020 
	`g_hash_b_deroy
 (
w_posis
);

1021 
	`g_sigl_em_by_me
(

, "ayli-ded", 

, 
w_d
);

1022 
iv
->
dty_ag
 = 
TRUE
;

1023 
	}
}

1035 
	$rib_db_ayli_move_to_h_log
(
GSequIr
 **
s
,

1036 
gut
 
num
, 
GSequIr
 *
log_
)

1038 
gt
 
i
;

1039 
RCLibDbPrive
 *
iv
;

1040 
GObje
 *

;

1041 
RCLibDbCogDa
 *
log_da
;

1042 
RCLibDbPyliDa
 *
d_da
, *
w_da
;

1043 
GSequIr
 *
w_
;

1044 
GSequIr
 *
n
;

1045 if(
s
==
NULL
 || 
log_
==NULL || 
num
<1) ;

1046 

 = 
	`rib_db_g_
();

1047 if(

==
NULL
) ;

1048 
iv
 = 
	`RCLIB_DB
(

)->priv;

1049 if(
iv
==
NULL
) ;

1050 
log_da
 = 
	`g_qu_g
(
log_
);

1051 if(
log_da
==
NULL
) ;

1052 
n
 = 
	`rib_ce_g_db_n
();

1053 
i
=0;i<
num
;i++)

1055 
d_da
 = 
	`g_qu_g
(
s
[
i
]);

1056 if(
d_da
==
NULL
) ;

1057 
w_da
 = 
	`rib_db_ayli_da_f
(
d_da
);

1058 
	`rib_db_ayli_de
(
s
[
i
]);

1059 
w_da
->
log
 = 
log_
;

1060 
w_
 = 
	`g_qu_nd
(
log_da
->
ayli
, 
w_da
);

1061 if(
s
[
i
]==
n
)

1062 
	`rib_ce_upde_db_n
(
w_
);

1063 
w_da
->
lf_
 = 
w_
;

1064 
	`g_hash_b_a
(
iv
->
ayli__b
, 
w_
,ew_iter);

1065 
	`g_sigl_em_by_me
(

, "ayli-added", 
w_
);

1067 
iv
->
dty_ag
 = 
TRUE
;

1068 
	}
}

1080 
	$rib_db_ayli_add_m3u_fe
(
GSequIr
 *

,

1081 
GSequIr
 *
_
, cڡ 
gch
 *
fame
)

1083 
GFe
 *
fe
;

1084 
GFeIutSm
 *
put_am
;

1085 
GDaIutSm
 *
da_am
;

1086 
gsize
 
le_n
;

1087 
gch
 *
le
 = 
NULL
;

1088 
gch
 *
uri
 = 
NULL
;

1089 
gch
 *
mp_me
 = 
NULL
;

1090 
gch
 *
th
 = 
NULL
;

1091 if(
fame
==
NULL
 || 

==NULL) ;

1092 
fe
 = 
	`g_fe_w_f_th
(
fame
);

1093 if(
fe
==
NULL
) ;

1094 if(!
	`g_fe_quy_exis
(
fe
, 
NULL
))

1096 
	`g_obje_uef
(
fe
);

1099 
put_am
 = 
	`g_fe_ad
(
fe
, 
NULL
, NULL);

1100 
	`g_obje_uef
(
fe
);

1101 if(
put_am
==
NULL
) ;

1102 
da_am
 = 
	`g_da_put_am_w
(
	`G_INPUT_STREAM
(
put_am
));

1103 
	`g_obje_uef
(
put_am
);

1104 if(
da_am
==
NULL
) ;

1105 
th
 = 
	`g_th_g_dme
(
fame
);

1106 
	`g_da_put_am_t_wle_ty
(
da_am
,

1107 
G_DATA_STREAM_NEWLINE_TYPE_ANY
);

1108 (
le
=
	`g_da_put_am_ad_le
(
da_am
, &
le_n
,

1109 
NULL
, NULL))!=NULL)

1111 if(!
	`g_r_has_efix
(
le
, "#") && *line!='\n' && *line!='\0')

1113 if(
	`cmp
(
le
, "file://", 7)!=0

1114 && 
	`cmp
(
le
, "http://", 7)!=0)

1116 if(
	`g_th_is_absu
(
le
))

1117 
uri
 = 
	`g_fame_to_uri
(
le
, 
NULL
, NULL);

1120 
mp_me
 = 
	`g_bud_fame
(
th
, 
le
, 
NULL
);

1121 
uri
 = 
	`g_fame_to_uri
(
mp_me
, 
NULL
, NULL);

1122 
	`g_
(
mp_me
);

1126 
uri
 = 
	`g_rdup
(
le
);

1127 if(
uri
!=
NULL
)

1129 
	`rib_db_ayli_add_music
(

, 
_
,

1130 
uri
);

1131 
	`g_
(
uri
);

1134 
	`g_
(
le
);

1136 
	`g_obje_uef
(
da_am
);

1137 
	`g_
(
th
);

1138 
	}
}

1140 
	$rib_db_ayli_add_dey_cursive
(
GSequIr
 *

,

1141 
GSequIr
 *
_
, cڡ 
gch
 *
fd
, 
gut
 
dth
)

1143 
gch
 *
fu_th
 = 
NULL
;

1144 
GD
 *
d
;

1145 cڡ 
gch
 *
fame
 = 
NULL
;

1146 
gch
 *
uri
 = 
NULL
;

1147 if(
dth
==0) ;

1148 
d
 = 
	`g_d_ݒ
(
fd
, 0, 
NULL
);

1149 if(
d
==
NULL
) ;

1150 (
fame
 = 
	`g_d_ad_me
(
d
))!=
NULL
)

1152 
fu_th
 = 
	`g_bud_fame
(
fd
, 
fame
, 
NULL
);

1153 if(
	`g_fe_
(
fu_th
, 
G_FILE_TEST_IS_DIR
))

1154 
	`rib_db_ayli_add_dey_cursive
(

, 
_
,

1155 
fu_th
, 
dth
-1);

1156 if(!
	`g_fe_
(
fu_th
, 
G_FILE_TEST_IS_REGULAR
))

1158 
	`g_
(
fu_th
);

1161 if(
	`rib_ut_is_su܋d_med
(
fu_th
))

1163 
uri
 = 
	`g_fame_to_uri
(
fu_th
, 
NULL
, NULL);

1164 
	`rib_db_ayli_add_music
(

, 
_
, 
uri
);

1165 
	`g_
(
uri
);

1167 
	`g_
(
fu_th
);

1169 
	`g_d_o
(
d
);

1170 
	}
}

1181 
	$rib_db_ayli_add_dey
(
GSequIr
 *

,

1182 
GSequIr
 *
_
, cڡ 
gch
 *
d
)

1184 if(

==
NULL
 || 
d
==NULL) ;

1185 
	`rib_db_ayli_add_dey_cursive
(

, 
_
, 
d
,

1186 
db_impt_dth
);

1187 
	}
}

1199 
gboޗn
 
	$rib_db_ayli_expt_m3u_fe
(
GSequIr
 *

,

1200 cڡ 
gch
 *
sfame
)

1202 
RCLibDbCogDa
 *
log_da
;

1203 
RCLibDbPyliDa
 *
ayli_da
;

1204 
GSequIr
 *
ayli_
;

1205 
gch
 *
t
 = 
NULL
;

1206 
gch
 *
fame
;

1207 
FILE
 *

;

1208 if(

==
NULL
 || 
sfame
==NULL 
FALSE
;

1209 
log_da
 = 
	`g_qu_g
(

);

1210 if(
log_da
==
NULL
 
FALSE
;

1211 if(
	`g_gex_mch_sime
("(.M3U)$", 
sfame
, 
G_REGEX_CASELESS
, 0))

1212 
fame
 = 
	`g_rdup
(
sfame
);

1214 
fame
 = 
	`g_rdup_tf
("%s.M3U", 
sfame
);

1215 

 = 
	`g_fݒ
(
fame
, "wb");

1216 
	`g_
(
fame
);

1217 if(

==
NULL
 
FALSE
;

1218 
	`g_rtf
(

, "#EXTM3U\n");

1219 
ayli_
 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

1220 !
	`g_qu__is_d
(
ayli_
);

1221 
ayli_
 = 
	`g_qu__xt
(playlist_iter))

1223 
ayli_da
 = 
	`g_qu_g
(
ayli_
);

1224 if(
ayli_da
==
NULL
 ||yli_da->
uri
==NULL) ;

1225 if(
ayli_da
->
t
!=
NULL
)

1226 
t
 = 
	`g_rdup
(
ayli_da
->title);

1228 
t
 = 
	`rib_g_g_me_om_uri
(
ayli_da
->
uri
);

1229 if(
t
==
NULL
t = 
	`g_rdup
(
	`_
("Unknown Title"));

1230 if(
ayli_da
->
ti
==
NULL
)

1232 
	`g_rtf
(

, "#EXTINF:%"
G_GINT64_FORMAT
",%s\n%s\n",

1233 
ayli_da
->
ngth
 / 
GST_SECOND
, 
t
,

1234 
ayli_da
->
uri
);

1238 
	`g_rtf
(

, "#EXTINF:%"
G_GINT64_FORMAT
",%s - %s\n%s\n",

1239 
ayli_da
->
ngth
 / 
GST_SECOND
,yli_da->
ti
,

1240 
t
, 
ayli_da
->
uri
);

1242 
	`g_
(
t
);

1244 
	`fo
(

);

1245  
TRUE
;

1246 
	}
}

1257 
gboޗn
 
	$rib_db_ayli_expt_l_m3u_fes
(cڡ 
gch
 *
d
)

1259 
gboޗn
 
ag
 = 
FALSE
;

1260 
RCLibDbCogDa
 *
log_da
;

1261 
RCLibDbPrive
 *
iv
;

1262 
GObje
 *

;

1263 
GSequIr
 *
log_
;

1264 
gch
 *
fame
;

1265 

 = 
	`rib_db_g_
();

1266 if(

==
NULL
 
FALSE
;

1267 
iv
 = 
	`RCLIB_DB
(

)->priv;

1268 
log_
 = 
	`g_qu_g_beg_
(
iv
->
log
);

1269 !
	`g_qu__is_d
(
log_
);

1270 
log_
 = 
	`g_qu__xt
(catalog_iter))

1272 
log_da
 = 
	`g_qu_g
(
log_
);

1273 if(
log_da
==
NULL
 || cog_da->
me
==NULL) ;

1274 
fame
 = 
	`g_rdup_tf
("%s%c%s.M3U", 
d
,

1275 
G_DIR_SEPARATOR
, 
log_da
->
me
);

1276 if(
	`rib_db_ayli_expt_m3u_fe
(
log_
, 
fame
))

1277 
ag
 = 
TRUE
;

1278 
	`g_
(
fame
);

1280  
ag
;

1281 
	}
}

1291 
	$rib_db_ayli_esh
(
GSequIr
 *

)

1293 
RCLibDbCogDa
 *
log_da
;

1294 
RCLibDbPyliDa
 *
ayli_da
;

1295 
RCLibDbReeshDa
 *
esh_da
;

1296 
GSequIr
 *
_fܗch
;

1297 
RCLibDbPrive
 *
iv
;

1298 
GObje
 *

;

1299 

 = 
	`rib_db_g_
();

1300 if(

==
NULL
) ;

1301 if(

==
NULL
) ;

1302 
iv
 = 
	`RCLIB_DB
(

)->priv;

1303 if(
iv
==
NULL
 ||riv->
esh_queue
==NULL) ;

1304 
log_da
 = 
	`g_qu_g
(

);

1305 if(
log_da
==
NULL
) ;

1306 if(
log_da
->
ayli
==
NULL
) ;

1307 
_fܗch
 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

1308 !
	`g_qu__is_d
(
_fܗch
);

1309 
_fܗch
 = 
	`g_qu__xt
(iter_foreach))

1311 
ayli_da
 = 
	`g_qu_g
(
_fܗch
);

1312 if(
ayli_da
==
NULL
 ||yli_da->
uri
==NULL) ;

1313 
esh_da
 = 
	`g_w0
(
RCLibDbReeshDa
, 1);

1314 
esh_da
->
log_
 = 

;

1315 
esh_da
->
ayli_
 = 
_fܗch
;

1316 
esh_da
->
uri
 = 
	`g_rdup
(
ayli_da
->uri);

1317 
	`g_async_queue_push
(
iv
->
esh_queue
, 
esh_da
);

1319 
	}
}

1329 
gboޗn
 
	$rib_db_ld_gacy
()

1331 
RCLibDbPrive
 *
iv
;

1332 
GObje
 *

;

1333 
GFe
 *
fe
;

1334 
GFeIutSm
 *
put_am
;

1335 
GDaIutSm
 *
da_am
;

1336 
gsize
 
le_n
;

1337 
RCLibDbCogDa
 *
log_da
 = 
NULL
;

1338 
RCLibDbPyliDa
 *
ayli_da
 = 
NULL
;

1339 
GSequIr
 *
log_
 = 
NULL
;

1340 
GSequIr
 *
ayli_
 = 
NULL
;

1341 
gch
 *
le
 = 
NULL
;

1342 
gt64
 
timefo
;

1343 
gt
 
ackno
;

1344 
gch
 *
i_t_fe_fu_th
 = 
NULL
;

1345 cڡ 
gch
 *
home_d
 = 
NULL
;

1346 

 = 
	`rib_db_g_
();

1347 if(

==
NULL
 
FALSE
;

1348 
iv
 = 
	`RCLIB_DB
(

)->priv;

1349 if(
iv
==
NULL
 
FALSE
;

1350 
home_d
 = 
	`g_gv
("HOME");

1351 if(
home_d
==
NULL
)

1352 
home_d
 = 
	`g_g_home_d
();

1353 
i_t_fe_fu_th
 = 
	`g_bud_fame
(
home_d
, ".RhythmCat",

1354 "ayli.d", 
NULL
);

1355 if(
i_t_fe_fu_th
==
NULL
 
FALSE
;

1356 
fe
 = 
	`g_fe_w_f_th
(
i_t_fe_fu_th
);

1357 if(
fe
==
NULL
 
FALSE
;

1358 if(!
	`g_fe_quy_exis
(
fe
, 
NULL
))

1360 
	`g_obje_uef
(
fe
);

1361  
FALSE
;

1363 
put_am
 = 
	`g_fe_ad
(
fe
, 
NULL
, NULL);

1364 
	`g_obje_uef
(
fe
);

1365 if(
put_am
==
NULL
 
FALSE
;

1366 
da_am
 = 
	`g_da_put_am_w
(
	`G_INPUT_STREAM
(
put_am
));

1367 
	`g_obje_uef
(
put_am
);

1368 if(
da_am
==
NULL
 
FALSE
;

1369 
	`g_da_put_am_t_wle_ty
(
da_am
,

1370 
G_DATA_STREAM_NEWLINE_TYPE_ANY
);

1371 (
le
=
	`g_da_put_am_ad_le
(
da_am
, &
le_n
,

1372 
NULL
, NULL))!=NULL)

1374 if(
log_da
!=
NULL
 && 
	`cmp
(
le
, "UR=", 3)==0)

1376 if(
ayli_
!=
NULL
)

1378 
	`g_sigl_em_by_me
(

, "playlist-changed",

1379 
ayli_
);

1381 
ayli_da
 = 
	`rib_db_ayli_da_w
();

1382 
ayli_da
->
uri
 = 
	`g_rdup
(
le
+3);

1383 
ayli_da
->
log
 = 
log_
;

1384 
ayli_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_MUSIC
;

1385 
ayli_
 = 
	`g_qu_nd
(
log_da
->
ayli
,

1386 
ayli_da
);

1387 
ayli_da
->
lf_
 = 
ayli_
;

1388 
	`g_hash_b_a
(
iv
->
ayli__b
, 
ayli_
,

1389 
ayli_
);

1390 
	`g_sigl_em_by_me
(

, "ayli-added", 
ayli_
);

1392 if(
ayli_da
!=
NULL
 && 
	`cmp
(
le
, "TI=", 3)==0)

1393 
ayli_da
->
t
 = 
	`g_rdup
(
le
+3);

1394 if(
ayli_da
!=
NULL
 && 
	`cmp
(
le
, "AR=", 3)==0)

1395 
ayli_da
->
ti
 = 
	`g_rdup
(
le
+3);

1396 if(
ayli_da
!=
NULL
 && 
	`cmp
(
le
, "AL=", 3)==0)

1397 
ayli_da
->
bum
 = 
	`g_rdup
(
le
+3);

1400 if(
ayli_da
!=
NULL
 && 
	`cmp
(
le
, "TL=", 3)==0)

1402 
timefo
 = 
	`g_ascii_l
(
le
+3, 
NULL
, 10) * 10;

1403 
timefo
 *
GST_MSECOND
;

1404 
ayli_da
->
ngth
 = 
timefo
;

1406 if(
	`cmp
(
le
, "TN=", 3)==0)

1408 
	`ssnf
(
le
+3, "%d", &
ackno
);

1409 
ayli_da
->
acknum
 = 
ackno
;

1411 if(
	`cmp
(
le
, "LF=", 3)==0)

1412 
ayli_da
->
lyricfe
 = 
	`g_rdup
(
le
+3);

1413 if(
	`cmp
(
le
, "AF=", 3)==0)

1414 
ayli_da
->
bumfe
 = 
	`g_rdup
(
le
+3);

1415 if(
	`cmp
(
le
, "LI=", 3)==0)

1417 
log_da
 = 
	`rib_db_log_da_w
();

1418 
log_da
->
me
 = 
	`g_rdup
(
le
+3);

1419 
log_da
->
ty
 = 
RCLIB_DB_CATALOG_TYPE_PLAYLIST
;

1420 
log_da
->
ayli
 = 
	`g_qu_w
((
GDeroyNify
)

1421 
rib_db_ayli_da_uef
);

1422 
log_
 = 
	`g_qu_nd
(
iv
->
log
, 
log_da
);

1423 
log_da
->
lf_
 = 
log_
;

1424 
	`g_hash_b_a
(
iv
->
log__b
, 
log_
,

1425 
log_
);

1426 
	`g_sigl_em_by_me
(

, "log-added", 
log_
);

1428 
	`g_
(
le
);

1430 
	`g_obje_uef
(
da_am
);

1431  
TRUE
;

1432 
	}
}

	@lib/rclib-db-priv.h

25 #ide
HAVE_RC_LIB_DB_PRIVATE_H


26 
	#HAVE_RC_LIB_DB_PRIVATE_H


	)

28 
	~"rib-g.h
"

30 
	#RCLIB_DB_ERROR
 
	`rib_db_r_quk
()

	)

34 
	mRCLIB_DB_IMPORT_TYPE_PLAYLIST
 = 0,

35 
	mRCLIB_DB_IMPORT_TYPE_LIBRARY
 = 1

36 }
	tRCLibDbImptTy
;

40 
	mRCLIB_DB_REFRESH_TYPE_PLAYLIST
 = 0,

41 
	mRCLIB_DB_REFRESH_TYPE_LIBRARY
 = 1

42 }
	tRCLibDbReeshTy
;

44 
	sRCLibDbImptDa


46 
RCLibDbImptTy
 
	mty
;

47 
gch
 *
	muri
;

48 
GSequIr
 *
	mlog_
;

49 
GSequIr
 *
	mayli__
;

50 
gboޗn
 
	may_ag
;

51 }
	tRCLibDbImptDa
;

53 
	sRCLibDbReeshDa


55 
RCLibDbReeshTy
 
	mty
;

56 
gch
 *
	muri
;

57 
GSequIr
 *
	mlog_
;

58 
GSequIr
 *
	mayli_
;

59 }
	tRCLibDbReeshDa
;

61 
	sRCLibDbPyliImptIdDa


63 
RCLibTagMada
 *
	mmmd
;

64 
GSequIr
 *
	mlog_
;

65 
GSequIr
 *
	mayli__
;

66 
RCLibDbPyliTy
 
	mty
;

67 
gboޗn
 
	may_ag
;

68 }
	tRCLibDbPyliImptIdDa
;

70 
	sRCLibDbPyliReeshIdDa


72 
RCLibTagMada
 *
	mmmd
;

73 
GSequIr
 *
	mlog_
;

74 
GSequIr
 *
	mayli_
;

75 
RCLibDbPyliTy
 
	mty
;

76 }
	tRCLibDbPyliReeshIdDa
;

78 
	s_RCLibDbPrive


80 
gch
 *
	mfame
;

81 
GSequ
 *
	mlog
;

82 
GHashTab
 *
	mlog__b
;

83 
GHashTab
 *
	mayli__b
;

84 
GSequ
 *
	mlibry_quy
;

85 
GHashTab
 *
	mlibry_b
;

86 
GThad
 *
	mimpt_thad
;

87 
GThad
 *
	mesh_thad
;

88 
GThad
 *
	mautove_thad
;

89 
GAsyncQueue
 *
	mimpt_queue
;

90 
GAsyncQueue
 *
	mesh_queue
;

91 
gboޗn
 
	mimpt_wk_ag
;

92 
gboޗn
 
	mesh_wk_ag
;

93 
gboޗn
 
	mdty_ag
;

94 
gboޗn
 
	mwk_ag
;

95 
gulg
 
	mautove_timeout
;

96 
GMux
 
	mautove_mux
;

97 
GCd
 
	mautove_cd
;

98 
GSg
 *
	mautove_xml_da
;

102 
gboޗn
 
_rib_db___ayli
(
RCLibDb
 *
db
, 
RCLibDbPrive
 *
iv
);

103 
gboޗn
 
_rib_db___libry
(
RCLibDb
 *
db
, 
RCLibDbPrive
 *
iv
);

104 
_rib_db__fize_ayli
(
RCLibDbPrive
 *
iv
);

105 
_rib_db__fize_libry
(
RCLibDbPrive
 *
iv
);

106 
gboޗn
 
_rib_db_ayli_impt_id_cb
(
gpor
 
da
);

107 
gboޗn
 
_rib_db_ayli_esh_id_cb
(
gpor
 
da
);

	@lib/rclib-db.c

26 
	~"rib-db.h
"

27 
	~"rib-db-iv.h
"

28 
	~"rib-comm.h
"

29 
	~"rib-msh.h
"

30 
	~"rib-g.h
"

31 
	~"rib-cue.h
"

32 
	~"rib-ce.h
"

33 
	~"rib-ut.h
"

49 
	sRCLibDbXMLPrDa


51 
gboޗn
 
	mdb_ag
;

52 
GSequ
 *
	mlog
;

53 
GSequ
 *
	mayli
;

54 
GSequIr
 *
	mlog_
;

55 
GHashTab
 *
	mlog__b
;

56 
GHashTab
 *
	mayli__b
;

57 }
	tRCLibDbXMLPrDa
;

61 
	mSIGNAL_CATALOG_ADDED
,

62 
	mSIGNAL_CATALOG_CHANGED
,

63 
	mSIGNAL_CATALOG_DELETE
,

64 
	mSIGNAL_CATALOG_REORDERED
,

65 
	mSIGNAL_PLAYLIST_ADDED
,

66 
	mSIGNAL_PLAYLIST_CHANGED
,

67 
	mSIGNAL_PLAYLIST_DELETE
,

68 
	mSIGNAL_PLAYLIST_REORDERED
,

69 
	mSIGNAL_IMPORT_UPDATED
,

70 
	mSIGNAL_REFRESH_UPDATED
,

71 
	mSIGNAL_LAST


74 
GObje
 *
	gdb_
 = 
NULL
;

75 
gpor
 
	grib_db__ass
 = 
NULL
;

76 
gt
 
	gdb_sigls
[
SIGNAL_LAST
] = {0};

77 cڡ 
gt
 
	gdb_autove_timeout
 = 120;

79 
gboޗn
 
	$rib_db_impt_upde_id_cb
(
gpor
 
da
)

81 
RCLibDbPrive
 *
iv
;

82 
gt
 
ngth
;

83 
ngth
 = 
	`GPOINTER_TO_INT
(
da
);

84 if(
db_
==
NULL
 
FALSE
;

85 
iv
 = 
	`RCLIB_DB
(
db_
)->priv;

86 if(
iv
==
NULL
 
FALSE
;

87 if(
ngth
<=0)

88 
iv
->
impt_wk_ag
 = 
FALSE
;

89 
	`g_sigl_em
(
db_
, 
db_sigls
[
SIGNAL_IMPORT_UPDATED
], 0,

90 
ngth
);

91  
FALSE
;

92 
	}
}

94 
gboޗn
 
	$rib_db_esh_upde_id_cb
(
gpor
 
da
)

96 
RCLibDbPrive
 *
iv
;

97 
gt
 
ngth
;

98 
ngth
 = 
	`GPOINTER_TO_INT
(
da
);

99 if(
db_
==
NULL
 
FALSE
;

100 
iv
 = 
	`RCLIB_DB
(
db_
)->priv;

101 if(
iv
==
NULL
 
FALSE
;

102 if(
ngth
<=0)

103 
iv
->
esh_wk_ag
 = 
FALSE
;

104 
	`g_sigl_em
(
db_
, 
db_sigls
[
SIGNAL_REFRESH_UPDATED
], 0,

105 
ngth
);

106  
FALSE
;

107 
	}
}

109 
	$rib_db_impt_da_
(
RCLibDbImptDa
 *
da
)

111 if(
da
==
NULL
) ;

112 
	`g_
(
da
->
uri
);

113 
	`g_
(
da
);

114 
	}
}

116 
	$rib_db_esh_da_
(
RCLibDbReeshDa
 *
da
)

118 if(
da
==
NULL
) ;

119 
	`g_
(
da
->
uri
);

120 
	`g_
(
da
);

121 
	}
}

124 
RCLibTagMada
 *
	$rib_db_g_mada_om_cue
(

125 
RCLibCueDa
 *
cue_da
, 
gut
 
ack_num
, 
RCLibTagMada
 *
cue_mmd
)

127 
RCLibTagMada
 *
mmd
 = 
NULL
;

128 
RCLibCueTck
 *
ack
 = 
NULL
;

129 
gboޗn
 
emy_ag
 = 
FALSE
;

130 if(
cue_da
==
NULL
)  NULL;

131 if(
cue_mmd
==
NULL
)

133 if(
cue_da
->
fe
==
NULL
)  NULL;

134 
cue_mmd
 = 
	`rib_g_ad_mada
(
cue_da
->
fe
);

135 if(
cue_mmd
==
NULL
)  NULL;

136 
emy_ag
 = 
TRUE
;

138 if(
ack_num
<0 ||ck_num>=
cue_da
->
ngth
 
NULL
;

139 
ack
 = 
cue_da
->ack + 
ack_num
;

140 
mmd
 = 
	`g_w0
(
RCLibTagMada
, 1);

141 if(
ack
->
t
!=
NULL
)

142 
mmd
->
t
 = 
	`g_rdup
(
ack
->title);

144 
mmd
->
t
 = 
	`g_rdup_tf
("Tck %d", 
ack_num
);

145 if(
ack
->
rfm
!=
NULL
)

146 
mmd
->
ti
 = 
	`g_rdup
(
ack
->
rfm
);

147 if(
cue_da
->
t
!=
NULL
)

148 
mmd
->
bum
 = 
	`g_rdup
(
cue_da
->
t
);

149 
mmd
->
acknum
 = 
ack_num
 + 1;

150 if(
ack_num
+1!=
cue_da
->
ngth
)

151 
mmd
->
ngth
 = 
ack
[1].
time1
 -rack->time1;

153 
mmd
->
ngth
 = 
cue_mmd
->ngth - 
ack
->
time1
;

154 if(
cue_da
->
fe
!=
NULL
)

155 
mmd
->
uri
 = 
	`g_rdup_tf
("%s:%d", 
cue_da
->
fe
, 
ack_num
+1);

157 
mmd
->
uri
 = 
	`g_rdup_tf
("%s:%d", 
cue_mmd
->uri, 
ack_num
+1);

158 if(
cue_mmd
->
y
!=
NULL
)

159 
mmd
->
y
 = 
	`g_rdup
(
cue_mmd
->ftype);

160 if(
cue_mmd
->
commt
!=
NULL
)

161 
mmd
->
commt
 = 
	`g_rdup
(
cue_mmd
->comment);

162 
mmd
->
b
 = 
cue_mmd
->bitrate;

163 
mmd
->
me
 = 
cue_mmd
->samplerate;

164 
mmd
->
chls
 = 
cue_mmd
->channels;

165 if(
cue_mmd
->
image
!=
NULL
)

167 
	`g_bufr_f
(
cue_mmd
->
image
);

168 
mmd
->
image
 = 
cue_mmd
->image;

170 if(
emy_ag

	`rib_g_
(
cue_mmd
);

171 
mmd
->
audio_ag
 = 
TRUE
;

172  
mmd
;

173 
	}
}

175 
gpor
 
	$rib_db_ayli_impt_thad_cb
(
gpor
 
da
)

177 
RCLibDbPyliImptIdDa
 *
id_da
;

178 
RCLibTagMada
 *
mmd
 = 
NULL
, *
cue_mmd
 = NULL;

179 
RCLibDbImptDa
 *
impt_da
;

180 
RCLibDbPrive
 *
iv
;

181 
RCLibCueDa
 
cue_da
;

182 
gch
 *
cue_uri
;

183 
gch
 *
scheme
;

184 
gut
 
i
;

185 
gt
 
ack
 = 0;

186 
gt
 
ngth
;

187 
gboޗn
 
lol_ag
;

188 
GObje
 *
obje
 = 
	`G_OBJECT
(
da
);

189 if(
obje
==
NULL
)

191 
	`g_thad_ex
(
NULL
);

192  
NULL
;

194 
iv
 = 
	`RCLIB_DB
(
obje
)->priv;

195 
iv
->
impt_queue
!=
NULL
)

197 
impt_da
 = 
	`g_async_queue_p
(
iv
->
impt_queue
);

198 if(
impt_da
->
uri
==
NULL
)

200 
	`g_
(
impt_da
);

203 
scheme
 = 
	`g_uri_r_scheme
(
impt_da
->
uri
);

204 if(
	`g_rcmp0
(
scheme
, "fe")==0
lol_ag
 = 
TRUE
;

205 
lol_ag
 = 
FALSE
;

206 
	`g_
(
scheme
);

207 
G_STMT_START


210 if(
lol_ag
 && 
	`g_gex_mch_sime
("(.CUE)$",

211 
impt_da
->
uri
, 
G_REGEX_CASELESS
, 0))

213 
	`memt
(&
cue_da
, 0, (
RCLibCueDa
));

214 if(
	`rib_cue_ad_da
(
impt_da
->
uri
,

215 
RCLIB_CUE_INPUT_URI
, &
cue_da
)>0)

217 
cue_mmd
 = 
	`rib_g_ad_mada
(
cue_da
.
fe
);

218 
i
=0;i<
cue_da
.
ngth
;i++)

220 
mmd
 = 
	`rib_db_g_mada_om_cue
(&
cue_da
,

221 
i
, 
cue_mmd
);

222 if(
mmd
==
NULL
) ;

223 
	`g_
(
mmd
->
uri
);

224 
mmd
->
uri
 = 
	`g_rdup_tf
("%s:%d",

225 
impt_da
->
uri
, 
i
+1);

226 if(
impt_da
->
ty
==
RCLIB_DB_IMPORT_TYPE_PLAYLIST
)

228 
id_da
 = 
	`g_w0
(

229 
RCLibDbPyliImptIdDa
, 1);

230 
id_da
->
mmd
 = mmd;

231 
id_da
->
log_
 =

232 
impt_da
->
log_
;

233 
id_da
->
ayli__
 =

234 
impt_da
->
ayli__
;

235 if(
i
==0)

236 
id_da
->
ay_ag
 = 
impt_da
->play_flag;

237 
id_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_CUE
;

238 
	`g_id_add
(
_rib_db_ayli_impt_id_cb
,

239 
id_da
);

243 
	`g_wng
("Unknown importype!");

244 
	`rib_g_
(
mmd
);

247 
	`rib_g_
(
cue_mmd
);

249 
	`rib_cue_
(&
cue_da
);

252 if(
lol_ag
 && 
	`rib_cue_g_ack_num
(
impt_da
->
uri
,

253 &
cue_uri
, &
ack
))

255 
	`memt
(&
cue_da
, 0, (
RCLibCueDa
));

256 if(
	`rib_cue_ad_da
(
cue_uri
, 
RCLIB_CUE_INPUT_URI
,

257 &
cue_da
)>0)

259 if(
	`g_gex_mch_sime
("(.CUE)$", 
cue_uri
,

260 
G_REGEX_CASELESS
, 0))

262 
mmd
 = 
	`rib_db_g_mada_om_cue
(&
cue_da
,

263 
ack
-1, 
NULL
);

264 if(
mmd
!=
NULL
)

266 
	`g_
(
mmd
->
uri
);

267 
mmd
->
uri
 = 
	`g_rdup
(
impt_da
->uri);

268 if(
impt_da
->
ty
==

269 
RCLIB_DB_IMPORT_TYPE_PLAYLIST
)

271 
id_da
 =

272 
	`g_w0
(
RCLibDbPyliImptIdDa
, 1);

273 
id_da
->
log_
 =

274 
impt_da
->
log_
;

275 
id_da
->
ayli__
 =

276 
impt_da
->
ayli__
;

277 
id_da
->
mmd
 = mmd;

278 
id_da
->
ay_ag
 = 
impt_da
->play_flag;

279 
id_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_CUE
;

280 
	`g_id_add
(
_rib_db_ayli_impt_id_cb
,

281 
id_da
);

285 
	`g_wng
("Unknown importype!");

286 
	`rib_g_
(
mmd
);

290 
	`rib_cue_
(&
cue_da
);

291 
	`g_
(
cue_uri
);

296 
	`g_
(
impt_da
->
uri
);

297 
impt_da
->
uri
 = 
	`g_rdup
(
cue_uri
);

298 
	`g_
(
cue_uri
);

301 
mmd
 = 
	`rib_g_ad_mada
(
impt_da
->
uri
);

302 if(
mmd
==
NULL
) ;

303 if(
mmd
->
emb_cue
!=
NULL
)

305 if(
	`rib_cue_ad_da
(
mmd
->
emb_cue
,

306 
RCLIB_CUE_INPUT_EMBEDDED
, &
cue_da
)>0)

308 if(
ack
>0)

310 
cue_mmd
 = 
	`rib_db_g_mada_om_cue
(&
cue_da
,

311 
ack
-1, 
mmd
);

312 if(
cue_mmd
!=
NULL
)

314 
	`rib_g_
(
mmd
);

315 if(
impt_da
->
ty
==

316 
RCLIB_DB_IMPORT_TYPE_PLAYLIST
)

318 
id_da
 = 
	`g_w0
(

319 
RCLibDbPyliImptIdDa
, 1);

320 
id_da
->
log_
 =

321 
impt_da
->
log_
;

322 
id_da
->
ayli__
 =

323 
impt_da
->
ayli__
;

324 
id_da
->
mmd
 = 
cue_mmd
;

325 
id_da
->
ay_ag
 = 
impt_da
->play_flag;

326 
id_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_CUE
;

327 
	`g_id_add
(
_rib_db_ayli_impt_id_cb
,

328 
id_da
);

332 
	`g_wng
("Unknown importype!");

333 
	`rib_g_
(
cue_mmd
);

339 
i
=0;i<
cue_da
.
ngth
;i++)

341 
cue_mmd
 = 
	`rib_db_g_mada_om_cue
(

342 &
cue_da
, 
i
, 
mmd
);

343 if(
cue_mmd
==
NULL
) ;

344 if(
impt_da
->
ty
==

345 
RCLIB_DB_IMPORT_TYPE_PLAYLIST
)

347 
id_da
 = 
	`g_w0
(

348 
RCLibDbPyliImptIdDa
, 1);

349 
id_da
->
log_
 =

350 
impt_da
->
log_
;

351 
id_da
->
ayli__
 =

352 
impt_da
->
ayli__
;

353 
id_da
->
mmd
 = 
cue_mmd
;

354 if(
i
==0)

356 
id_da
->
ay_ag
 =

357 
impt_da
->
ay_ag
;

359 
id_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_CUE
;

360 
	`g_id_add
(
_rib_db_ayli_impt_id_cb
,

361 
id_da
);

365 
	`g_wng
("Invalid importype!");

366 
	`rib_g_
(
cue_mmd
);

369 
	`rib_g_
(
mmd
);

374 if(
impt_da
->
ty
==
RCLIB_DB_IMPORT_TYPE_PLAYLIST
)

376 
id_da
 = 
	`g_w0
(
RCLibDbPyliImptIdDa
, 1);

377 
id_da
->
log_
 = 
impt_da
->catalog_iter;

378 
id_da
->
ayli__
 =

379 
impt_da
->
ayli__
;

380 
id_da
->
mmd
 = mmd;

381 
id_da
->
ay_ag
 = 
impt_da
->play_flag;

382 
id_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_MUSIC
;

383 
	`g_id_add
(
_rib_db_ayli_impt_id_cb
, 
id_da
);

387 
	`g_wng
("Invalid importype!");

388 
	`rib_g_
(
mmd
);

391 
G_STMT_END
;

392 
	`rib_db_impt_da_
(
impt_da
);

393 
ngth
 = 
	`g_async_queue_ngth
(
iv
->
impt_queue
);

394 
	`g_id_add
(
rib_db_impt_upde_id_cb
, 
	`GINT_TO_POINTER
(
ngth
));

396 
	`g_thad_ex
(
NULL
);

397  
NULL
;

398 
	}
}

401 
gpor
 
	$rib_db_ayli_esh_thad_cb
(
gpor
 
da
)

403 
RCLibDbPyliReeshIdDa
 *
id_da
;

404 
RCLibDbReeshDa
 *
esh_da
;

405 
RCLibTagMada
 *
mmd
 = 
NULL
, *
cue_mmd
 = NULL;

406 
RCLibDbPrive
 *
iv
;

407 
RCLibCueDa
 
cue_da
;

408 
gch
 *
cue_uri
;

409 
gch
 *
scheme
;

410 
gt
 
ack
 = 0;

411 
gt
 
ngth
;

412 
gboޗn
 
lol_ag
;

413 
GObje
 *
obje
 = 
	`G_OBJECT
(
da
);

414 if(
obje
==
NULL
)

416 
	`g_thad_ex
(
NULL
);

417  
NULL
;

419 
iv
 = 
	`RCLIB_DB
(
obje
)->priv;

420 
iv
->
esh_queue
!=
NULL
)

422 
esh_da
 = 
	`g_async_queue_p
(
iv
->
esh_queue
);

423 if(
esh_da
->
uri
==
NULL
)

425 
	`g_
(
esh_da
);

428 if(
esh_da
->
log_
==
NULL
 ||

429 
esh_da
->
ayli_
==
NULL
) ;

430 
scheme
 = 
	`g_uri_r_scheme
(
esh_da
->
uri
);

431 if(
	`g_rcmp0
(
scheme
, "fe")==0
lol_ag
 = 
TRUE
;

432 
lol_ag
 = 
FALSE
;

433 
	`g_
(
scheme
);

434 
G_STMT_START


436 if(
lol_ag
 && 
	`rib_cue_g_ack_num
(
esh_da
->
uri
,

437 &
cue_uri
, &
ack
))

439 if(
	`g_gex_mch_sime
("(.CUE)$", 
cue_uri
,

440 
G_REGEX_CASELESS
, 0))

442 
	`memt
(&
cue_da
, 0, (
RCLibCueDa
));

443 if(
	`rib_cue_ad_da
(
cue_uri
, 
RCLIB_CUE_INPUT_URI
,

444 &
cue_da
)>0)

446 
mmd
 = 
	`rib_db_g_mada_om_cue
(&
cue_da
,

447 
ack
-1, 
NULL
);

448 if(
mmd
!=
NULL

	`g_
(mmd->
uri
);

449 if(
esh_da
->
ty
==

450 
RCLIB_DB_REFRESH_TYPE_PLAYLIST
)

452 if(
mmd
!=
NULL
)

454 
mmd
->
uri
 = 
	`g_rdup
(
esh_da
->uri);

455 
id_da
 =

456 
	`g_w0
(
RCLibDbPyliReeshIdDa
, 1);

457 
id_da
->
log_
 =

458 
esh_da
->
log_
;

459 
id_da
->
ayli_
 =

460 
esh_da
->
ayli_
;

461 
id_da
->
mmd
 = mmd;

462 
id_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_CUE
;

463 
	`g_id_add
(
_rib_db_ayli_esh_id_cb
,

464 
id_da
);

468 
id_da
 =

469 
	`g_w0
(
RCLibDbPyliReeshIdDa
, 1);

470 
id_da
->
log_
 =

471 
esh_da
->
log_
;

472 
id_da
->
ayli_
 =

473 
esh_da
->
ayli_
;

474 
id_da
->
mmd
 = 
NULL
;

475 
id_da
->
ty
 =

476 
RCLIB_DB_PLAYLIST_TYPE_MISSING
;

477 
	`g_id_add
(
_rib_db_ayli_esh_id_cb
,

478 
id_da
);

483 
	`g_wng
("Unknownefreshype!");

484 if(
mmd
!=
NULL

	`rib_g_
(mmd);

487 
	`rib_cue_
(&
cue_da
);

488 
	`g_
(
cue_uri
);

493 
	`g_
(
esh_da
->
uri
);

494 
esh_da
->
uri
 = 
	`g_rdup
(
cue_uri
);

495 
	`g_
(
cue_uri
);

498 
mmd
 = 
	`rib_g_ad_mada
(
esh_da
->
uri
);

499 if(
mmd
!=
NULL
 && mmd->
emb_cue
!=NULL)

501 if(
	`rib_cue_ad_da
(
mmd
->
emb_cue
,

502 
RCLIB_CUE_INPUT_EMBEDDED
, &
cue_da
)>0)

504 if(
ack
>0)

506 
cue_mmd
 = 
	`rib_db_g_mada_om_cue
(&
cue_da
,

507 
ack
-1, 
mmd
);

508 
	`rib_g_
(
mmd
);

509 if(
esh_da
->
ty
==

510 
RCLIB_DB_REFRESH_TYPE_PLAYLIST
)

512 if(
cue_mmd
!=
NULL
)

514 
id_da
 =

515 
	`g_w0
(
RCLibDbPyliReeshIdDa
, 1);

516 
id_da
->
log_
 =

517 
esh_da
->
log_
;

518 
id_da
->
ayli_
 =

519 
esh_da
->
ayli_
;

520 
id_da
->
mmd
 = 
cue_mmd
;

521 
id_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_CUE
;

522 
	`g_id_add
(
_rib_db_ayli_esh_id_cb
,

523 
id_da
);

527 
id_da
 =

528 
	`g_w0
(
RCLibDbPyliReeshIdDa
, 1);

529 
id_da
->
log_
 =

530 
esh_da
->
log_
;

531 
id_da
->
ayli_
 =

532 
esh_da
->
ayli_
;

533 
id_da
->
mmd
 = 
NULL
;

534 
id_da
->
ty
 =

535 
RCLIB_DB_PLAYLIST_TYPE_MISSING
;

536 
	`g_id_add
(
_rib_db_ayli_esh_id_cb
,

537 
id_da
);

542 
	`g_wng
("Unknownefreshype!");

543 if(
cue_mmd
!=
NULL

	`rib_g_
(cue_mmd);

549 if(
esh_da
->
ty
==
RCLIB_DB_REFRESH_TYPE_PLAYLIST
)

551 
id_da
 = 
	`g_w0
(
RCLibDbPyliReeshIdDa
, 1);

552 
id_da
->
log_
 = 
esh_da
->catalog_iter;

553 
id_da
->
ayli_
 = 
esh_da
->playlist_iter;

554 
id_da
->
mmd
 = mmd;

555 if(
mmd
!=
NULL
)

556 
id_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_MUSIC
;

558 
id_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_MISSING
;

559 
	`g_id_add
(
_rib_db_ayli_esh_id_cb
, 
id_da
);

563 
	`g_wng
("Unknownefreshype!");

564 if(
mmd
!=
NULL

	`rib_g_
(mmd);

567 
G_STMT_END
;

568 
	`rib_db_esh_da_
(
esh_da
);

569 
ngth
 = 
	`g_async_queue_ngth
(
iv
->
esh_queue
);

570 
	`g_id_add
(
rib_db_esh_upde_id_cb
, 
	`GINT_TO_POINTER
(
ngth
));

572 
	`g_thad_ex
(
NULL
);

573  
NULL
;

574 
	}
}

576 
	$rib_db_xml_rr_t_emt_cb
(
GMkupPCڋxt
 *
cڋxt
,

577 cڡ 
gch
 *
emt_me
, cڡ gch **
ibu_mes
,

578 cڡ 
gch
 **
ibu_vues
, 
gpor
 
da
, 
GE
 **
r
)

580 
RCLibDbXMLPrDa
 *
rr_da
 = (RCLibDbXMLPrD*)
da
;

581 
RCLibDbCogDa
 *
log_da
;

582 
RCLibDbPyliDa
 *
ayli_da
;

583 
GSequIr
 *
log_
, *
ayli_
;

584 
gut
 
i
;

585 if(
da
==
NULL
) ;

586 if(
	`g_rcmp0
(
emt_me
, "rclibdb")==0)

588 
rr_da
->
db_ag
 = 
TRUE
;

591 if(!
rr_da
->
db_ag
) ;

592 if(
rr_da
->
ayli
!=
NULL
 && 
	`g_rcmp0
(
emt_me
, "item")==0)

594 
ayli_da
 = 
	`rib_db_ayli_da_w
();

595 
ayli_da
->
log
 = 
rr_da
->
log_
;

596 
i
=0;
ibu_mes
[i]!=
NULL
;i++)

598 if(
ayli_da
->
uri
==
NULL
 &&

599 
	`g_rcmp0
(
ibu_mes
[
i
], "uri")==0)

601 
ayli_da
->
uri
 = 
	`g_rdup
(
ibu_vues
[
i
]);

603 if(
	`g_rcmp0
(
ibu_mes
[
i
], "type")==0)

605 
	`ssnf
(
ibu_vues
[
i
], "%u", &(
ayli_da
->
ty
));

607 if(
ayli_da
->
t
==
NULL
 &&

608 
	`g_rcmp0
(
ibu_mes
[
i
], "title")==0)

610 
ayli_da
->
t
 = 
	`g_rdup
(
ibu_vues
[
i
]);

612 if(
ayli_da
->
ti
==
NULL
 &&

613 
	`g_rcmp0
(
ibu_mes
[
i
], "artist")==0)

615 
ayli_da
->
ti
 = 
	`g_rdup
(
ibu_vues
[
i
]);

617 if(
ayli_da
->
bum
==
NULL
 &&

618 
	`g_rcmp0
(
ibu_mes
[
i
], "album")==0)

620 
ayli_da
->
bum
 = 
	`g_rdup
(
ibu_vues
[
i
]);

622 if(
ayli_da
->
y
==
NULL
 &&

623 
	`g_rcmp0
(
ibu_mes
[
i
], "filetype")==0)

625 
ayli_da
->
y
 = 
	`g_rdup
(
ibu_vues
[
i
]);

627 if(
	`g_rcmp0
(
ibu_mes
[
i
], "length")==0)

629 
ayli_da
->
ngth
 = 
	`g_ascii_l
(
ibu_vues
[
i
],

630 
NULL
, 10);

632 if(
	`g_rcmp0
(
ibu_mes
[
i
], "tracknum")==0)

634 
	`ssnf
(
ibu_vues
[
i
], "%d",

635 &(
ayli_da
->
acknum
));

637 if(
	`g_rcmp0
(
ibu_mes
[
i
], "year")==0)

639 
	`ssnf
(
ibu_vues
[
i
], "%d",

640 &(
ayli_da
->
yr
));

642 if(
	`g_rcmp0
(
ibu_mes
[
i
], "rating")==0)

644 
	`ssnf
(
ibu_vues
[
i
], "%f",

645 &(
ayli_da
->
tg
));

647 if(
ayli_da
->
lyricfe
==
NULL
 &&

648 
	`g_rcmp0
(
ibu_mes
[
i
], "lyricfile")==0)

650 
ayli_da
->
lyricfe
 = 
	`g_rdup
(
ibu_vues
[
i
]);

652 if(
ayli_da
->
bumfe
==
NULL
 &&

653 
	`g_rcmp0
(
ibu_mes
[
i
], "albumfile")==0)

655 
ayli_da
->
bumfe
 = 
	`g_rdup
(
ibu_vues
[
i
]);

657 if(
ayli_da
->
lyriccfe
==
NULL
 &&

658 
	`g_rcmp0
(
ibu_mes
[
i
], "lyricsecondfile")==0)

660 
ayli_da
->
lyriccfe
 = 
	`g_rdup
(
ibu_vues
[
i
]);

663 
ayli_
 = 
	`g_qu_nd
(
rr_da
->
ayli
,

664 
ayli_da
);

665 
ayli_da
->
lf_
 = 
ayli_
;

666 
	`g_hash_b_a
(
rr_da
->
ayli__b
, 
ayli_
,

667 
ayli_
);

669 if(
rr_da
->
log
!=
NULL
 &&

670 
	`g_rcmp0
(
emt_me
, "playlist")==0)

672 
log_da
 = 
	`rib_db_log_da_w
();

673 
i
=0;
ibu_mes
[i]!=
NULL
;i++)

675 if(
log_da
->
me
==
NULL
 &&

676 
	`g_rcmp0
(
ibu_mes
[
i
], "name")==0)

678 
log_da
->
me
 = 
	`g_rdup
(
ibu_vues
[
i
]);

680 if(
	`g_rcmp0
(
ibu_mes
[
i
], "type")==0)

682 
	`ssnf
(
ibu_vues
[
i
], "%u", &(
log_da
->
ty
));

685 
log_da
->
ayli
 = 
	`g_qu_w
((
GDeroyNify
)

686 
rib_db_ayli_da_uef
);

687 
rr_da
->
ayli
 = 
log_da
->playlist;

688 
log_
 = 
	`g_qu_nd
(
rr_da
->
log
, 
log_da
);

689 
log_da
->
lf_
 = 
log_
;

690 
rr_da
->
log_
 = catalog_iter;

691 
	`g_hash_b_a
(
rr_da
->
log__b
, 
log_
,

692 
log_
);

694 
	}
}

696 
	$rib_db_xml_rr_d_emt_cb
(
GMkupPCڋxt
 *
cڋxt
,

697 cڡ 
gch
 *
emt_me
, 
gpor
 
da
, 
GE
 **
r
)

699 
RCLibDbXMLPrDa
 *
rr_da
 = (RCLibDbXMLPrD*)
da
;

700 if(
da
==
NULL
) ;

701 if(
	`g_rcmp0
(
emt_me
, "rclibdb")==0)

703 
rr_da
->
db_ag
 = 
FALSE
;

705 if(
	`g_rcmp0
(
emt_me
, "playlist")==0)

707 
rr_da
->
ayli
 = 
NULL
;

708 
rr_da
->
log_
 = 
NULL
;

710 
	}
}

712 
gboޗn
 
	$rib_db_ld_libry_db
(
GSequ
 *
log
,

713 
GHashTab
 *
log__b
, GHashTab *
ayli__b
,

714 cڡ 
gch
 *
fe
, 
gboޗn
 *
dty_ag
)

716 
RCLibDbXMLPrDa
 
rr_da
 = {0};

717 
GMkupPCڋxt
 *
r_cڋxt
;

718 
GMkupPr
 
mkup_rr
 =

720 .
t_emt
 = 
rib_db_xml_rr_t_emt_cb
,

721 .
d_emt
 = 
rib_db_xml_rr_d_emt_cb
,

722 .
xt
 = 
NULL
,

723 .
shrough
 = 
NULL
,

724 .
r
 = 
NULL


726 
GE
 *
r
 = 
NULL
;

727 
GFe
 *
put_fe
;

728 
GZlibDecomess
 *
decomess
;

729 
GFeIutSm
 *
fe_iam
;

730 
GIutSm
 *
decomess_iam
;

731 
gch
 
bufr
[4096];

732 
gssize
 
ad_size
;

733 
put_fe
 = 
	`g_fe_w_f_th
(
fe
);

734 if(
put_fe
==
NULL
 
FALSE
;

735 
fe_iam
 = 
	`g_fe_ad
(
put_fe
, 
NULL
, &
r
);

736 
	`g_obje_uef
(
put_fe
);

737 if(
fe_iam
==
NULL
)

739 
	`g_wng
("Cn opuam: %s", 
r
->
mesge
);

740 
	`g_r_
(
r
);

741 
r
 = 
NULL
;

742  
FALSE
;

744 
decomess
 = 
	`g_zlib_decomess_w
(
G_ZLIB_COMPRESSOR_FORMAT_ZLIB
);

745 
decomess_iam
 = 
	`g_cvr_put_am_w
(
	`G_INPUT_STREAM
(

746 
fe_iam
), 
	`G_CONVERTER
(
decomess
));

747 
	`g_obje_uef
(
fe_iam
);

748 
	`g_obje_uef
(
decomess
);

749 
rr_da
.
log
 = catalog;

750 
rr_da
.
log__b
 = catalog_iter_table;

751 
rr_da
.
ayli__b
 =laylist_iter_table;

752 
r_cڋxt
 = 
	`g_mkup_r_cڋxt_w
(&
mkup_rr
, 0,

753 &
rr_da
, 
NULL
);

754 (
ad_size
=
	`g_put_am_ad
(
decomess_iam
, 
bufr
, 4096,

755 
NULL
, NULL))>0)

757 
	`g_mkup_r_cڋxt_r
(
r_cڋxt
, 
bufr
, 
ad_size
,

758 
NULL
);

760 
	`g_mkup_r_cڋxt_d_r
(
r_cڋxt
, 
NULL
);

761 
	`g_obje_uef
(
decomess_iam
);

762 
	`g_mkup_r_cڋxt_
(
r_cڋxt
);

763 
	`g_mesge
("Playlistoaded.");

764 if(
dty_ag
!=
NULL
*dty_ag = 
FALSE
;

765  
TRUE
;

766 
	}
}

768 
le
 
GSg
 *
	$rib_db_bud_xml_da
(
GSequ
 *
log
)

770 
RCLibDbCogDa
 *
log_da
;

771 
RCLibDbPyliDa
 *
ayli_da
;

772 
GSequIr
 *
log_
, *
ayli_
;

773 
GSg
 *
da_r
;

774 
gch
 *
tmp
;

775 
gut
 
rib_maj_vsi
;

776 
gut
 
rib_m_vsi
;

777 
gut
 
rib_mio_vsi
;

778 
da_r
 = 
	`g_rg_w
("<?xml version=\"1.0\" standalone=\"yes\"?>\n");

779 
	`g_rg_nd_tf
(
da_r
, "<rclibdb version=\"%u.%u.%u\">\n",

780 
rib_maj_vsi
, 
rib_m_vsi
, 
rib_mio_vsi
);

781 
log_
 = 
	`g_qu_g_beg_
(
log
);

782 !
	`g_qu__is_d
(
log_
);

783 
log_
 = 
	`g_qu__xt
(catalog_iter))

785 
log_da
 = 
	`g_qu_g
(
log_
);

786 
tmp
 = 
	`g_mkup_tf_esd
(" <playlistame=\"%s\"ype=\"%u\">\n",

787 
log_da
->
me
, cog_da->
ty
);

788 
	`g_rg_nd
(
da_r
, 
tmp
);

789 
	`g_
(
tmp
);

790 
ayli_
 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

791 !
	`g_qu__is_d
(
ayli_
);

792 
ayli_
 = 
	`g_qu__xt
(playlist_iter))

794 
ayli_da
 = 
	`g_qu_g
(
ayli_
);

795 
	`g_rg_nd_tf
(
da_r
, " <itemype=\"%u\" ",

796 
ayli_da
->
ty
);

797 if(
ayli_da
->
uri
!=
NULL
)

799 
tmp
 = 
	`g_mkup_tf_esd
("uri=\"%s\" ",

800 
ayli_da
->
uri
);

801 
	`g_rg_nd
(
da_r
, 
tmp
);

802 
	`g_
(
tmp
);

804 if(
ayli_da
->
t
!=
NULL
)

806 
tmp
 = 
	`g_mkup_tf_esd
("title=\"%s\" ",

807 
ayli_da
->
t
);

808 
	`g_rg_nd
(
da_r
, 
tmp
);

809 
	`g_
(
tmp
);

811 if(
ayli_da
->
ti
!=
NULL
)

813 
tmp
 = 
	`g_mkup_tf_esd
("artist=\"%s\" ",

814 
ayli_da
->
ti
);

815 
	`g_rg_nd
(
da_r
, 
tmp
);

816 
	`g_
(
tmp
);

818 if(
ayli_da
->
bum
!=
NULL
)

820 
tmp
 = 
	`g_mkup_tf_esd
("album=\"%s\" ",

821 
ayli_da
->
bum
);

822 
	`g_rg_nd
(
da_r
, 
tmp
);

823 
	`g_
(
tmp
);

825 if(
ayli_da
->
y
!=
NULL
)

827 
tmp
 = 
	`g_mkup_tf_esd
("filetype=\"%s\" ",

828 
ayli_da
->
y
);

829 
	`g_rg_nd
(
da_r
, 
tmp
);

830 
	`g_
(
tmp
);

832 
tmp
 = 
	`g_mkup_tf_esd
("ngth=\"%"
G_GINT64_FORMAT
"\" ",

833 
ayli_da
->
ngth
);

834 
	`g_rg_nd
(
da_r
, 
tmp
);

835 
	`g_
(
tmp
);

836 
tmp
 = 
	`g_mkup_tf_esd
("tracknum=\"%d\" year=\"%d\" "

837 "tg=\"%f\" ", 
ayli_da
->
acknum
,

838 
ayli_da
->
yr
,yli_da->
tg
);

839 
	`g_rg_nd
(
da_r
, 
tmp
);

840 
	`g_
(
tmp
);

841 if(
ayli_da
->
lyricfe
!=
NULL
)

843 
tmp
 = 
	`g_mkup_tf_esd
("lyricfile=\"%s\" ",

844 
ayli_da
->
lyricfe
);

845 
	`g_rg_nd
(
da_r
, 
tmp
);

846 
	`g_
(
tmp
);

848 if(
ayli_da
->
bumfe
!=
NULL
)

850 
tmp
 = 
	`g_mkup_tf_esd
("albumfile=\"%s\" ",

851 
ayli_da
->
bumfe
);

852 
	`g_rg_nd
(
da_r
, 
tmp
);

853 
	`g_
(
tmp
);

855 if(
ayli_da
->
lyriccfe
!=
NULL
)

857 
tmp
 = 
	`g_mkup_tf_esd
("lyricsecondfile=\"%s\" ",

858 
ayli_da
->
lyriccfe
);

859 
	`g_rg_nd
(
da_r
, 
tmp
);

860 
	`g_
(
tmp
);

862 
	`g_rg_nd
(
da_r
, "/>\n");

864 
	`g_rg_nd
(
da_r
, " </playlist>\n");

866 
	`g_rg_nd
(
da_r
, "</rclibdb>\n");

867  
da_r
;

868 
	}
}

870 
gboޗn
 
	$rib_db_ve_libry_db
(
GSequ
 *
log
,

871 cڡ 
gch
 *
fe
, 
gboޗn
 *
dty_ag
)

873 
GSg
 *
xml_r
;

874 
GZlibComess
 *
comess
;

875 
GFeOuutSm
 *
fe_oam
;

876 
GOuutSm
 *
comess_oam
;

877 
GFe
 *
ouut_fe
;

878 
gssize
 
wre_size
;

879 
GE
 *
r
 = 
NULL
;

880 
gboޗn
 
ag
 = 
TRUE
;

881 
ouut_fe
 = 
	`g_fe_w_f_th
(
fe
);

882 if(
ouut_fe
==
NULL
 
FALSE
;

883 
xml_r
 = 
	`rib_db_bud_xml_da
(
log
);

884 if(
xml_r
==
NULL
 
FALSE
;

885 
fe_oam
 = 
	`g_fe_a
(
ouut_fe
, 
NULL
, 
FALSE
,

886 
G_FILE_CREATE_PRIVATE
, 
NULL
, &
r
);

887 
	`g_obje_uef
(
ouut_fe
);

888 if(
fe_oam
==
NULL
)

890 
	`g_wng
("Cn oouufam: %s", 
r
->
mesge
);

891 
	`g_r_
(
r
);

892 
r
 = 
NULL
;

893  
FALSE
;

895 
comess
 = 
	`g_zlib_comess_w
(
G_ZLIB_COMPRESSOR_FORMAT_ZLIB
, 5);

896 
comess_oam
 = 
	`g_cvr_ouut_am_w
(
	`G_OUTPUT_STREAM
(

897 
fe_oam
), 
	`G_CONVERTER
(
comess
));

898 
	`g_obje_uef
(
fe_oam
);

899 
	`g_obje_uef
(
comess
);

900 
wre_size
 = 
	`g_ouut_am_wre
(
comess_oam
, 
xml_r
->
r
,

901 
xml_r
->
n
, 
NULL
, &
r
);

902 if(
r
!=
NULL
)

904 
	`g_wng
("Cn savayli: %s", 
r
->
mesge
);

905 
	`g_r_
(
r
);

906 
r
 = 
NULL
;

907 
ag
 = 
FALSE
;

909 
	`g_ouut_am_o
(
comess_oam
, 
NULL
, &
r
);

910 if(
r
!=
NULL
)

912 
	`g_wng
("Cn clo fam: %s", 
r
->
mesge
);

913 
	`g_r_
(
r
);

914 
r
 = 
NULL
;

915 
ag
 = 
FALSE
;

917 
	`g_obje_uef
(
comess_oam
);

918 if(
ag
)

920 
	`g_mesge
("Pyli saved, wrِ%ld bys.", (
glg
)
wre_size
);

922 if(
dty_ag
!=
NULL
*dty_ag = 
FALSE
;

923  
ag
;

924 
	}
}

926 
gpor
 
	$rib_db_ayli_autove_thad_cb
(
gpor
 
da
)

928 
RCLibDbPrive
 *
iv
 = (RCLibDbPriv*)
da
;

929 
gch
 *
fame
;

930 
GZlibComess
 *
comess
;

931 
GFeOuutSm
 *
fe_oam
;

932 
GOuutSm
 *
comess_oam
;

933 
GFe
 *
ouut_fe
;

934 
gssize
 
wre_size
;

935 
GE
 *
r
 = 
NULL
;

936 
gboޗn
 
ag
 = 
TRUE
;

937 if(
da
==
NULL
)

939 
	`g_thad_ex
(
NULL
);

940  
NULL
;

942 
iv
->
wk_ag
)

944 
	`g_mux_lock
(&(
iv
->
autove_mux
));

945 
	`g_cd_wa
(&(
iv
->
autove_cd
), &riv->
autove_mux
));

946 
G_STMT_START


948 if(
iv
->
autove_xml_da
==
NULL
) ;

949 
fame
 = 
	`g_rdup_tf
("%s.autove", 
iv
->filename);

950 
ouut_fe
 = 
	`g_fe_w_f_th
(
fame
);

951 
	`g_
(
fame
);

952 if(
ouut_fe
==
NULL
) ;

953 
fe_oam
 = 
	`g_fe_a
(
ouut_fe
, 
NULL
, 
FALSE
,

954 
G_FILE_CREATE_PRIVATE
, 
NULL
, NULL);

955 
	`g_obje_uef
(
ouut_fe
);

956 if(
fe_oam
==
NULL
) ;

957 
comess
 = 
	`g_zlib_comess_w
(
G_ZLIB_COMPRESSOR_FORMAT_ZLIB
,

959 
comess_oam
 = 
	`g_cvr_ouut_am_w
(
	`G_OUTPUT_STREAM
(

960 
fe_oam
), 
	`G_CONVERTER
(
comess
));

961 
	`g_obje_uef
(
fe_oam
);

962 
	`g_obje_uef
(
comess
);

963 
wre_size
 = 
	`g_ouut_am_wre
(
comess_oam
,

964 
iv
->
autove_xml_da
->
r
,riv->autove_xml_da->
n
,

965 
NULL
, &
r
);

966 if(
r
!=
NULL
)

968 
	`g_r_
(
r
);

969 
r
 = 
NULL
;

970 
ag
 = 
FALSE
;

972 
	`g_ouut_am_o
(
comess_oam
, 
NULL
, &
r
);

973 if(
r
!=
NULL
)

975 
	`g_r_
(
r
);

976 
r
 = 
NULL
;

977 
ag
 = 
FALSE
;

979 
	`g_obje_uef
(
comess_oam
);

980 if(
ag
)

982 
	`g_mesge
("Auto save successfully, wrote %ld bytes.",

983 (
glg
)
wre_size
);

986 
G_STMT_END
;

987 if(
iv
->
autove_xml_da
!=
NULL
)

988 
	`g_rg_
(
iv
->
autove_xml_da
, 
TRUE
);

989 
iv
->
autove_xml_da
 = 
NULL
;

990 
iv
->
dty_ag
 = 
FALSE
;

991 
	`g_mux_uock
(&(
iv
->
autove_mux
));

993 
	`g_thad_ex
(
NULL
);

994  
NULL
;

995 
	}
}

997 
gboޗn
 
	$rib_db_autove_timeout_cb
(
gpor
 
da
)

999 
RCLibDbPrive
 *
iv
 = (RCLibDbPriv*)
da
;

1000 if(
da
==
NULL
 
FALSE
;

1001 if(!
iv
->
dty_ag
 
TRUE
;

1002 if(
iv
->
fame
==
NULL
 
TRUE
;

1003 if(
iv
->
autove_xml_da
!=
NULL
 
TRUE
;

1004 
iv
->
autove_xml_da
 = 
	`rib_db_bud_xml_da
riv->
log
);

1005 
	`g_mux_lock
(&(
iv
->
autove_mux
));

1006 
	`g_cd_sigl
(&(
iv
->
autove_cd
));

1007 
	`g_mux_uock
(&(
iv
->
autove_mux
));

1008  
TRUE
;

1009 
	}
}

1011 
	$rib_db_fize
(
GObje
 *
obje
)

1013 
RCLibDbImptDa
 *
impt_da
;

1014 
RCLibDbReeshDa
 *
esh_da
;

1015 
gch
 *
autove_fe
;

1016 
RCLibDbPrive
 *
iv
 = 
	`RCLIB_DB
(
obje
)->priv;

1017 
iv
->
wk_ag
 = 
FALSE
;

1018 
	`g_mux_lock
(&(
iv
->
autove_mux
));

1019 
	`g_cd_sigl
(&(
iv
->
autove_cd
));

1020 
	`g_mux_uock
(&(
iv
->
autove_mux
));

1021 
	`g_sour_move
(
iv
->
autove_timeout
);

1022 
	`g_thad_jo
(
iv
->
autove_thad
);

1023 
	`g_mux_r
(&(
iv
->
autove_mux
));

1024 
	`g_cd_r
(&(
iv
->
autove_cd
));

1025 
	`rib_db_impt_nl
();

1026 
	`rib_db_esh_nl
();

1027 
impt_da
 = 
	`g_w0
(
RCLibDbImptDa
, 1);

1028 
esh_da
 = 
	`g_w0
(
RCLibDbReeshDa
, 1);

1029 
	`g_async_queue_push
(
iv
->
impt_queue
, 
impt_da
);

1030 
	`g_async_queue_push
(
iv
->
esh_queue
, 
esh_da
);

1031 
	`g_thad_jo
(
iv
->
impt_thad
);

1032 
	`g_thad_jo
(
iv
->
esh_thad
);

1033 
	`rib_db_ve_libry_db
(
iv
->
log
,riv->
fame
,

1034 &(
iv
->
dty_ag
));

1035 
autove_fe
 = 
	`g_rdup_tf
("%s.autove", 
iv
->
fame
);

1036 
	`g_move
(
autove_fe
);

1037 
	`g_
(
autove_fe
);

1038 
	`g_
(
iv
->
fame
);

1039 
	`g_async_queue_uef
(
iv
->
impt_queue
);

1040 
	`_rib_db__fize_ayli
(
iv
);

1041 
	`_rib_db__fize_libry
(
iv
);

1042 
iv
->
impt_queue
 = 
NULL
;

1043 
iv
->
esh_queue
 = 
NULL
;

1044 
	`G_OBJECT_CLASS
(
rib_db__ass
)->
	`fize
(
obje
);

1045 
	}
}

1047 
GObje
 *
	$rib_db_cڡru
(
GTy
 
ty
, 
gut
 
n_cڡru_ms
,

1048 
GObjeCڡruPam
 *
cڡru_ms
)

1050 
GObje
 *
tv
;

1051 if(
db_
!=
NULL
)  db_instance;

1052 
tv
 = 
	`G_OBJECT_CLASS
(
rib_db__ass
)->
cڡru


1053 (
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

1054 
db_
 = 
tv
;

1055 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
db_
);

1056  
tv
;

1057 
	}
}

1059 
	$rib_db_ass_
(
RCLibDbCss
 *
kss
)

1061 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

1062 
rib_db__ass
 = 
	`g_ty_ass_ek_
(
kss
);

1063 
obje_ass
->
fize
 = 
rib_db_fize
;

1064 
obje_ass
->
cڡru
 = 
rib_db_cڡru
;

1065 
	`g_ty_ass_add_ive
(
kss
, (
RCLibDbPrive
));

1075 
db_sigls
[
SIGNAL_CATALOG_ADDED
] = 
	`g_sigl_w
("catalog-added",

1076 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1077 
log_added
), 
NULL
, NULL, 
g_cosu_msh_VOID__POINTER
,

1078 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
, 
NULL
);

1088 
db_sigls
[
SIGNAL_CATALOG_CHANGED
] = 
	`g_sigl_w
("catalog-changed",

1089 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1090 
log_chged
), 
NULL
, NULL, 
g_cosu_msh_VOID__POINTER
,

1091 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
, 
NULL
);

1101 
db_sigls
[
SIGNAL_CATALOG_DELETE
] = 
	`g_sigl_w
("catalog-delete",

1102 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1103 
log_de
), 
NULL
, NULL, 
g_cosu_msh_VOID__POINTER
,

1104 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
, 
NULL
);

1116 
db_sigls
[
SIGNAL_CATALOG_REORDERED
] = 
	`g_sigl_w
("catalog-reordered",

1117 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1118 
log_ded
), 
NULL
, NULL, 
g_cosu_msh_VOID__POINTER
,

1119 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
, 
NULL
);

1129 
db_sigls
[
SIGNAL_PLAYLIST_ADDED
] = 
	`g_sigl_w
("playlist-added",

1130 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1131 
ayli_added
), 
NULL
, NULL, 
g_cosu_msh_VOID__POINTER
,

1132 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
, 
NULL
);

1142 
db_sigls
[
SIGNAL_PLAYLIST_CHANGED
] = 
	`g_sigl_w
("playlist-changed",

1143 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1144 
ayli_chged
), 
NULL
, NULL, 
g_cosu_msh_VOID__POINTER
,

1145 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
, 
NULL
);

1155 
db_sigls
[
SIGNAL_PLAYLIST_DELETE
] = 
	`g_sigl_w
("playlist-delete",

1156 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1157 
ayli_de
), 
NULL
, NULL, 
g_cosu_msh_VOID__POINTER
,

1158 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
, 
NULL
);

1172 
db_sigls
[
SIGNAL_PLAYLIST_REORDERED
] = 
	`g_sigl_w
("playlist-reordered",

1173 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1174 
ayli_ded
), 
NULL
, NULL, 
rib_msh_VOID__POINTER_POINTER
,

1175 
G_TYPE_NONE
, 2, 
G_TYPE_POINTER
, G_TYPE_POINTER, 
NULL
);

1185 
db_sigls
[
SIGNAL_IMPORT_UPDATED
] = 
	`g_sigl_w
("import-updated",

1186 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1187 
impt_upded
), 
NULL
, NULL, 
g_cosu_msh_VOID__INT
,

1188 
G_TYPE_NONE
, 1, 
G_TYPE_INT
, 
NULL
);

1198 
db_sigls
[
SIGNAL_REFRESH_UPDATED
] = 
	`g_sigl_w
("refresh-updated",

1199 
RCLIB_TYPE_DB
, 
G_SIGNAL_RUN_FIRST
, 
	`G_STRUCT_OFFSET
(
RCLibDbCss
,

1200 
esh_upded
), 
NULL
, NULL, 
g_cosu_msh_VOID__INT
,

1201 
G_TYPE_NONE
, 1, 
G_TYPE_INT
, 
NULL
);

1202 
	}
}

1204 
	$rib_db__
(
RCLibDb
 *
db
)

1206 
RCLibDbPrive
 *
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
db
, 
RCLIB_TYPE_DB
,

1207 
RCLibDbPrive
);

1208 
db
->
iv
 =riv;

1209 
iv
->
wk_ag
 = 
TRUE
;

1210 
	`_rib_db___ayli
(
db
, 
iv
);

1211 
	`_rib_db___libry
(
db
, 
iv
);

1212 
iv
->
impt_queue
 = 
	`g_async_queue_w_fu
((
GDeroyNify
)

1213 
rib_db_impt_da_
);

1214 
iv
->
esh_queue
 = 
	`g_async_queue_w_fu
((
GDeroyNify
)

1215 
rib_db_esh_da_
);

1216 
	`g_mux_
(&(
iv
->
autove_mux
));

1217 
	`g_cd_
(&(
iv
->
autove_cd
));

1218 
iv
->
impt_thad
 = 
	`g_thad_w
("RC2-Import-Thread",

1219 
rib_db_ayli_impt_thad_cb
, 
db
);

1220 
iv
->
esh_thad
 = 
	`g_thad_w
("RC2-Refresh-Thread",

1221 
rib_db_ayli_esh_thad_cb
, 
db
);

1222 
iv
->
autove_thad
 = 
	`g_thad_w
("RC2-Autosave-Thread",

1223 
rib_db_ayli_autove_thad_cb
, 
iv
);

1224 
iv
->
impt_wk_ag
 = 
FALSE
;

1225 
iv
->
esh_wk_ag
 = 
FALSE
;

1226 
iv
->
dty_ag
 = 
FALSE
;

1227 
iv
->
autove_timeout
 = 
	`g_timeout_add_cds
(
db_autove_timeout
,

1228 
rib_db_autove_timeout_cb
, 
iv
);

1229 
	}
}

1231 
GTy
 
	$rib_db_g_ty
()

1233 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

1234 
GTy
 
g_defe_ty_id
;

1235 cڡ 
GTyInfo
 
db_fo
 = {

1236 .
ass_size
 = (
RCLibDbCss
),

1237 .
ba_
 = 
NULL
,

1238 .
ba_fize
 = 
NULL
,

1239 .
ass_
 = (
GCssInFunc
)
rib_db_ass_
,

1240 .
ass_fize
 = 
NULL
,

1241 .
ass_da
 = 
NULL
,

1242 .
_size
 = (
RCLibDb
),

1243 .
n_ocs
 = 0,

1244 .
_
 = (
GInInFunc
)
rib_db__


1246 if(
	`g___r
(&
g_defe_ty_id__vީe
))

1248 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
G_TYPE_OBJECT
,

1249 
	`g__ic_rg
("RCLibDb"), &
db_fo
, 0);

1250 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

1252  
g_defe_ty_id__vީe
;

1253 
	}
}

1255 
GTy
 
	$rib_db_log_da_g_ty
()

1257 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

1258 
GTy
 
g_defe_ty_id
;

1259 if(
	`g___r
(&
g_defe_ty_id__vީe
))

1261 
g_defe_ty_id
 = 
	`g_boxed_ty_gi_ic
(

1262 
	`g__ic_rg
("RCLibDbCatalogData"),

1263 (
GBoxedCyFunc
)
rib_db_log_da_f
,

1264 (
GBoxedFeFunc
)
rib_db_log_da_uef
);

1265 
	`g___ave
 (&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

1267  
g_defe_ty_id__vީe
;

1268 
	}
}

1270 
GTy
 
	$rib_db_ayli_da_g_ty
()

1272 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

1273 
GTy
 
g_defe_ty_id
;

1274 if(
	`g___r
(&
g_defe_ty_id__vީe
))

1276 
g_defe_ty_id
 = 
	`g_boxed_ty_gi_ic
(

1277 
	`g__ic_rg
("RCLibDbPlaylistData"),

1278 (
GBoxedCyFunc
)
rib_db_ayli_da_f
,

1279 (
GBoxedFeFunc
)
rib_db_ayli_da_uef
);

1280 
	`g___ave
 (&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

1282  
g_defe_ty_id__vީe
;

1283 
	}
}

1285 
GTy
 
	$rib_db_libry_da_g_ty
()

1287 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

1288 
GTy
 
g_defe_ty_id
;

1289 if(
	`g___r
(&
g_defe_ty_id__vީe
))

1291 
g_defe_ty_id
 = 
	`g_boxed_ty_gi_ic
(

1292 
	`g__ic_rg
("RCLibDbLibraryData"),

1293 (
GBoxedCyFunc
)
rib_db_libry_da_f
,

1294 (
GBoxedFeFunc
)
rib_db_libry_da_uef
);

1295 
	`g___ave
 (&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

1297  
g_defe_ty_id__vީe
;

1298 
	}
}

1309 
gboޗn
 
	$rib_db_
(cڡ 
gch
 *
fe
)

1311 
RCLibDbPrive
 *
iv
;

1312 
	`g_mesge
("Loading musicibrary database....");

1313 if(
db_
!=
NULL
)

1315 
	`g_wng
("The database islready initialized!");

1316  
FALSE
;

1318 
db_
 = 
	`g_obje_w
(
RCLIB_TYPE_DB
, 
NULL
);

1319 
iv
 = 
	`RCLIB_DB
(
db_
)->priv;

1320 if(
iv
->
log
==
NULL
 ||riv->
impt_queue
==NULL ||

1321 
iv
->
impt_thad
==
NULL
)

1323 
	`g_obje_uef
(
db_
);

1324 
db_
 = 
NULL
;

1325 
	`g_wng
("Failedooad database!");

1326  
FALSE
;

1328 
	`rib_db_ld_libry_db
(
iv
->
log
,riv->
log__b
,

1329 
iv
->
ayli__b
, 
fe
, &riv->
dty_ag
));

1330 
iv
->
fame
 = 
	`g_rdup
(
fe
);

1331 
	`g_mesge
("Databaseoaded.");

1332  
TRUE
;

1333 
	}
}

1341 
	$rib_db_ex
()

1343 if(
db_
!=
NULL

	`g_obje_uef
(db_instance);

1344 
db_
 = 
NULL
;

1345 
	`g_mesge
("Databasexited.");

1346 
	}
}

1356 
GObje
 *
	$rib_db_g_
()

1358  
db_
;

1359 
	}
}

1373 
gulg
 
	$rib_db_sigl_c
(cڡ 
gch
 *
me
,

1374 
GClback
 
back
, 
gpor
 
da
)

1376 if(
db_
==
NULL
)  0;

1377  
	`g_sigl_c
(
db_
, 
me
, 
back
, 
da
);

1378 
	}
}

1390 
	$rib_db_sigl_disc
(
gulg
 
hdr_id
)

1392 if(
db_
==
NULL
) ;

1393 
	`g_sigl_hdr_disc
(
db_
, 
hdr_id
);

1394 
	}
}

1403 
	$rib_db_impt_nl
()

1405 
RCLibDbPrive
 *
iv
;

1406 
GObje
 *

;

1407 
RCLibDbImptDa
 *
impt_da
;

1408 

 = 
	`rib_db_g_
();

1409 if(

==
NULL
) ;

1410 
iv
 = 
	`RCLIB_DB
(

)->priv;

1411 if(
iv
==
NULL
 ||riv->
impt_queue
==NULL) ;

1412 
	`g_async_queue_ngth
(
iv
->
impt_queue
)>=0)

1414 
impt_da
 = 
	`g_async_queue_y_p
(
iv
->
impt_queue
);

1415 if(
impt_da
!=
NULL
)

1416 
	`rib_db_impt_da_
(
impt_da
);

1418 
	}
}

1426 
	$rib_db_esh_nl
()

1428 
RCLibDbPrive
 *
iv
;

1429 
GObje
 *

;

1430 
RCLibDbReeshDa
 *
esh_da
;

1431 

 = 
	`rib_db_g_
();

1432 if(

==
NULL
) ;

1433 
iv
 = 
	`RCLIB_DB
(

)->priv;

1434 if(
iv
==
NULL
 ||riv->
esh_queue
==NULL) ;

1435 
	`g_async_queue_ngth
(
iv
->
esh_queue
)>=0)

1437 
esh_da
 = 
	`g_async_queue_y_p
(
iv
->
esh_queue
);

1438 if(
esh_da
!=
NULL
)

1439 
	`rib_db_esh_da_
(
esh_da
);

1441 
	}
}

1451 
gt
 
	$rib_db_impt_queue_g_ngth
()

1453 
RCLibDbPrive
 *
iv
;

1454 
GObje
 *

;

1455 

 = 
	`rib_db_g_
();

1456 if(

==
NULL
)  -1;

1457 
iv
 = 
	`RCLIB_DB
(

)->priv;

1458 if(
iv
==
NULL
 ||riv->
impt_queue
==NULL)  -1;

1459  
	`g_async_queue_ngth
(
iv
->
esh_queue
);

1460 
	}
}

1470 
gt
 
	$rib_db_esh_queue_g_ngth
()

1472 
RCLibDbPrive
 *
iv
;

1473 
GObje
 *

;

1474 

 = 
	`rib_db_g_
();

1475 if(

==
NULL
)  -1;

1476 
iv
 = 
	`RCLIB_DB
(

)->priv;

1477 if(
iv
==
NULL
 ||riv->
esh_queue
==NULL)  -1;

1478  
	`g_async_queue_ngth
(
iv
->
esh_queue
);

1479 
	}
}

1489 
gboޗn
 
	$rib_db_sync
()

1491 
RCLibDbPrive
 *
iv
;

1492 if(
db_
==
NULL
 
FALSE
;

1493 
iv
 = 
	`RCLIB_DB
(
db_
)->priv;

1494 if(
iv
==
NULL
 ||riv->
log
==NULL ||riv->
fame
==NULL)

1495  
FALSE
;

1496 if(!
iv
->
dty_ag
 
TRUE
;

1497  
	`rib_db_ve_libry_db
(
iv
->
log
,riv->
fame
,

1498 &(
iv
->
dty_ag
));

1499 
	}
}

1507 
gboޗn
 
	$rib_db_ld_autoved
()

1509 
RCLibDbPrive
 *
iv
;

1510 
GSequIr
 *

;

1511 
gch
 *
fame
;

1512 
gboޗn
 
ag
;

1513 if(
db_
==
NULL
 
FALSE
;

1514 
iv
 = 
	`RCLIB_DB
(
db_
)->priv;

1515 if(
iv
==
NULL
 ||riv->
log
==NULL ||riv->
fame
==NULL)

1516  
FALSE
;

1517 
	`g_qu_g_ngth
(
iv
->
log
)>0)

1519 

 = 
	`g_qu_g_beg_
(
iv
->
log
);

1520 
	`rib_db_log_de
(

);

1522 
fame
 = 
	`g_rdup_tf
("%s.autove", 
iv
->filename);

1523 
ag
 = 
	`rib_db_ld_libry_db
(
iv
->
log
,riv->
log__b
,

1524 
iv
->
ayli__b
, 
fame
, &riv->
dty_ag
));

1525 
	`g_
(
fame
);

1526 if(
ag
)

1528 

=
	`g_qu_g_beg_
(
iv
->
log
);

1529 !
	`g_qu__is_d
(

);

1530 

=
	`g_qu__xt
(iter))

1532 
	`g_sigl_em
(
db_
, 
db_sigls
[
SIGNAL_CATALOG_ADDED
],

1533 0, 

);

1536  
ag
;

1537 
	}
}

1547 
gboޗn
 
	$rib_db_autoved_exi
()

1549 
RCLibDbPrive
 *
iv
;

1550 
gch
 *
fame
;

1551 
gboޗn
 
ag
 = 
FALSE
;

1552 if(
db_
==
NULL
 
FALSE
;

1553 
iv
 = 
	`RCLIB_DB
(
db_
)->priv;

1554 if(
iv
==
NULL
 ||riv->
log
==NULL ||riv->
fame
==NULL)

1555  
FALSE
;

1556 
fame
 = 
	`g_rdup_tf
("%s.autove", 
iv
->filename);

1557 
ag
 = 
	`g_fe_
(
fame
, 
G_FILE_TEST_IS_REGULAR
 | 
G_FILE_TEST_EXISTS
);

1558 
	`g_
(
fame
);

1559  
ag
;

1560 
	}
}

1568 
	$rib_db_autoved_move
()

1570 
RCLibDbPrive
 *
iv
;

1571 
gch
 *
fame
;

1572 if(
db_
==
NULL
) ;

1573 
iv
 = 
	`RCLIB_DB
(
db_
)->priv;

1574 if(
iv
==
NULL
 ||riv->
log
==NULL ||riv->
fame
==NULL)

1576 
fame
 = 
	`g_rdup_tf
("%s.autove", 
iv
->filename);

1577 
	`g_move
(
fame
);

1578 
	`g_
(
fame
);

1579 
	}
}

	@lib/rclib-db.h

25 #ide
HAVE_RC_LIB_DB_H


26 
	#HAVE_RC_LIB_DB_H


	)

28 
	~<dlib.h
>

29 
	~<glib.h
>

30 
	~<glib/gdio.h
>

31 
	~<glib/gi18n.h
>

32 
	~<glib-obje.h
>

33 
	~<g/g.h
>

35 
	gG_BEGIN_DECLS


37 
	#RCLIB_TYPE_DB
 (
	`rib_db_g_ty
())

	)

38 
	#RCLIB_DB
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), 
RCLIB_TYPE_DB
, \

39 
RCLibDb
))

	)

40 
	#RCLIB_DB_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_CAST
((k), 
RCLIB_TYPE_DB
, \

41 
RCLibDbCss
))

	)

42 
	#RCLIB_IS_DB
(
o
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((o), 
RCLIB_TYPE_DB
))

	)

43 
	#RCLIB_IS_DB_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_TYPE
((k), 
RCLIB_TYPE_DB
))

	)

44 
	#RCLIB_DB_GET_CLASS
(
o
(
	`G_TYPE_INSTANCE_GET_CLASS
((o), \

45 
RCLIB_TYPE_DB
, 
RCLibDbCss
))

	)

47 
	#RCLIB_TYPE_DB_CATALOG_DATA
 (
	`rib_db_log_da_g_ty
())

	)

48 
	#RCLIB_TYPE_DB_PLAYLIST_DATA
 (
	`rib_db_ayli_da_g_ty
())

	)

49 
	#RCLIB_TYPE_DB_LIBRARY_DATA
 (
	`rib_db_libry_da_g_ty
())

	)

59 
	mRCLIB_DB_CATALOG_TYPE_PLAYLIST
 = 1

60 }
	tRCLibDbCogTy
;

72 
	mRCLIB_DB_PLAYLIST_TYPE_MISSING
 = 0,

73 
	mRCLIB_DB_PLAYLIST_TYPE_MUSIC
 = 1,

74 
	mRCLIB_DB_PLAYLIST_TYPE_CUE
 = 2

75 }
	tRCLibDbPyliTy
;

87 
	mRCLIB_DB_LIBRARY_TYPE_MISSING
 = 0,

88 
	mRCLIB_DB_LIBRARY_TYPE_MUSIC
 = 1,

89 
	mRCLIB_DB_LIBRARY_TYPE_CUE
 = 2

90 }
	tRCLibDbLibryTy
;

92 
_RCLibDbCogDa
 
	tRCLibDbCogDa
;

93 
_RCLibDbPyliDa
 
	tRCLibDbPyliDa
;

94 
_RCLibDbLibryDa
 
	tRCLibDbLibryDa
;

95 
_RCLibDb
 
	tRCLibDb
;

96 
_RCLibDbCss
 
	tRCLibDbCss
;

97 
_RCLibDbPrive
 
	tRCLibDbPrive
;

110 
	s_RCLibDbCogDa
 {

112 
gt
 
	mf_cou
;

115 
GSequ
 *
	mayli
;

116 
GSequIr
 *
	mlf_
;

117 
gch
 *
	mme
;

118 
RCLibDbCogTy
 
	mty
;

119 
gpor
 
	me
;

143 
	s_RCLibDbPyliDa
 {

145 
gt
 
	mf_cou
;

148 
GSequIr
 *
	mlog
;

149 
GSequIr
 *
	mlf_
;

150 
RCLibDbPyliTy
 
	mty
;

151 
gch
 *
	muri
;

152 
gch
 *
	mt
;

153 
gch
 *
	mti
;

154 
gch
 *
	mbum
;

155 
gch
 *
	my
;

156 
gt64
 
	mngth
;

157 
gt
 
	macknum
;

158 
gt
 
	myr
;

159 
gt
 
	mtg
;

160 
gch
 *
	mlyricfe
;

161 
gch
 *
	mlyriccfe
;

162 
gch
 *
	mbumfe
;

184 
	s_RCLibDbLibryDa
 {

186 
gt
 
	mf_cou
;

189 
RCLibDbLibryTy
 
	mty
;

190 
gch
 *
	muri
;

191 
gch
 *
	mt
;

192 
gch
 *
	mti
;

193 
gch
 *
	mbum
;

194 
gch
 *
	my
;

195 
gt64
 
	mngth
;

196 
gt
 
	macknum
;

197 
gt
 
	myr
;

198 
gt
 
	mtg
;

199 
gch
 *
	mlyricfe
;

200 
gch
 *
	mlyriccfe
;

201 
gch
 *
	mbumfe
;

211 
	s_RCLibDb
 {

213 
GObje
 
	m
;

214 
RCLibDbPrive
 *
	miv
;

223 
	s_RCLibDbCss
 {

225 
GObjeCss
 
	m_ass
;

226 (*
	mlog_added
)(
RCLibDb
 *
	mdb
, 
GSequIr
 *
	m
);

227 (*
	mlog_chged
)(
RCLibDb
 *
	mdb
, 
GSequIr
 *
	m
);

228 (*
	mlog_de
)(
RCLibDb
 *
	mdb
, 
GSequIr
 *
	m
);

229 (*
	mlog_ded
)(
RCLibDb
 *
	mdb
, 
gt
 *
	mw_d
);

230 (*
	mayli_added
)(
RCLibDb
 *
	mdb
, 
GSequIr
 *
	m
);

231 (*
	mayli_chged
)(
RCLibDb
 *
	mdb
, 
GSequIr
 *
	m
);

232 (*
	mayli_de
)(
RCLibDb
 *
	mdb
, 
GSequIr
 *
	m
);

233 (*
	mayli_ded
)(
RCLibDb
 *
	mdb
, 
GSequIr
 *
	m
,

234 
gt
 *
	mw_d
);

235 (*
	mimpt_upded
)(
RCLibDb
 *
	mdb
, 
gt
 
	mmag
);

236 (*
	mesh_upded
)(
RCLibDb
 *
	mdb
, 
gt
 
	mmag
);

240 
GTy
 
rib_db_g_ty
();

241 
GTy
 
rib_db_log_da_g_ty
();

242 
GTy
 
rib_db_ayli_da_g_ty
();

243 
GTy
 
rib_db_libry_da_g_ty
();

246 
gboޗn
 
rib_db_
(cڡ 
gch
 *
fe
);

247 
rib_db_ex
();

248 
GObje
 *
rib_db_g_
();

249 
gulg
 
rib_db_sigl_c
(cڡ 
gch
 *
me
,

250 
GClback
 
back
, 
gpor
 
da
);

251 
rib_db_sigl_disc
(
gulg
 
hdr_id
);

252 
rib_db_impt_nl
();

253 
rib_db_esh_nl
();

254 
gt
 
rib_db_impt_queue_g_ngth
();

255 
gt
 
rib_db_esh_queue_g_ngth
();

256 
gboޗn
 
rib_db_sync
();

257 
gboޗn
 
rib_db_ld_autoved
();

258 
gboޗn
 
rib_db_autoved_exi
();

259 
rib_db_autoved_move
();

262 
RCLibDbCogDa
 *
rib_db_log_da_w
();

263 
RCLibDbCogDa
 *
rib_db_log_da_f
(RCLibDbCogD*
da
);

264 
rib_db_log_da_uef
(
RCLibDbCogDa
 *
da
);

265 
rib_db_log_da_
(
RCLibDbCogDa
 *
da
);

266 
RCLibDbPyliDa
 *
rib_db_ayli_da_w
();

267 
RCLibDbPyliDa
 *
rib_db_ayli_da_f
(RCLibDbPyliD*
da
);

268 
rib_db_ayli_da_uef
(
RCLibDbPyliDa
 *
da
);

269 
rib_db_ayli_da_
(
RCLibDbPyliDa
 *
da
);

270 
GSequ
 *
rib_db_g_log
();

271 
gboޗn
 
rib_db_log_is_vid_
(
GSequIr
 *
log_
);

272 
GSequIr
 *
rib_db_log_add
(cڡ 
gch
 *
me
,

273 
GSequIr
 *

, 
gt
 
ty
);

274 
rib_db_log_de
(
GSequIr
 *

);

275 
rib_db_log_t_me
(
GSequIr
 *

, cڡ 
gch
 *
me
);

276 
rib_db_log_t_ty
(
GSequIr
 *

, 
RCLibDbCogTy
 
ty
);

277 
rib_db_log_d
(
gt
 *
w_d
);

278 
gboޗn
 
rib_db_ayli_is_vid_
(
GSequIr
 *
ayli_
);

279 
rib_db_ayli_add_music
(
GSequIr
 *

,

280 
GSequIr
 *
_
, cڡ 
gch
 *
uri
);

281 
rib_db_ayli_add_music_d_ay
(
GSequIr
 *

,

282 
GSequIr
 *
_
, cڡ 
gch
 *
uri
);

283 
rib_db_ayli_de
(
GSequIr
 *

);

284 
rib_db_ayli_upde_mada
(
GSequIr
 *

,

285 cڡ 
RCLibDbPyliDa
 *
da
);

286 
rib_db_ayli_upde_ngth
(
GSequIr
 *

,

287 
gt64
 
ngth
);

288 
rib_db_ayli_t_ty
(
GSequIr
 *

,

289 
RCLibDbPyliTy
 
ty
);

290 
rib_db_ayli_t_tg
(
GSequIr
 *

, 
gt
 
tg
);

291 
rib_db_ayli_t_lyric_bd
(
GSequIr
 *

,

292 cڡ 
gch
 *
fame
);

293 
rib_db_ayli_t_lyric_cdy_bd
(
GSequIr
 *

,

294 cڡ 
gch
 *
fame
);

295 
rib_db_ayli_t_bum_bd
(
GSequIr
 *

,

296 cڡ 
gch
 *
fame
);

297 
gboޗn
 
rib_db_ayli_g_tg
(
GSequIr
 *

, 
gt
 *
tg
);

298 cڡ 
gch
 *
rib_db_ayli_g_lyric_bd
(
GSequIr
 *

);

299 cڡ 
gch
 *
rib_db_ayli_g_lyric_cdy_bd
(
GSequIr
 *

);

300 cڡ 
gch
 *
rib_db_ayli_g_bum_bd
(
GSequIr
 *

);

301 
rib_db_ayli_d
(
GSequIr
 *

, 
gt
 *
w_d
);

302 
rib_db_ayli_move_to_h_log
(
GSequIr
 **
s
,

303 
gut
 
num
, 
GSequIr
 *
log_
);

304 
rib_db_ayli_add_m3u_fe
(
GSequIr
 *

,

305 
GSequIr
 *
_
, cڡ 
gch
 *
fame
);

306 
rib_db_ayli_add_dey
(
GSequIr
 *

,

307 
GSequIr
 *
_
, cڡ 
gch
 *
d
);

308 
gboޗn
 
rib_db_ayli_expt_m3u_fe
(
GSequIr
 *

,

309 cڡ 
gch
 *
sfame
);

310 
gboޗn
 
rib_db_ayli_expt_l_m3u_fes
(cڡ 
gch
 *
d
);

311 
rib_db_ayli_esh
(
GSequIr
 *

);

312 
gboޗn
 
rib_db_ld_gacy
();

315 
RCLibDbLibryDa
 *
rib_db_libry_da_w
();

316 
RCLibDbLibryDa
 *
rib_db_libry_da_f
(RCLibDbLibryD*
da
);

317 
rib_db_libry_da_uef
(
RCLibDbLibryDa
 *
da
);

318 
rib_db_libry_da_
(
RCLibDbLibryDa
 *
da
);

320 
	gG_END_DECLS


	@lib/rclib-lyric.c

26 
	~"rib-lyric.h
"

27 
	~"rib-comm.h
"

28 
	~"rib-msh.h
"

29 
	~"rib-ce.h
"

30 
	~"rib-g.h
"

31 
	~"rib-db.h
"

44 
	s_RCLibLyricPrive


46 
gch
 *
	mch_d
;

47 
gch
 *
	mcodg
;

48 
GRegex
 *
	mgex
;

49 
gulg
 
	mtim
;

50 
RCLibLyricPdDa
 
	mrd_da1
;

51 
RCLibLyricPdDa
 
	mrd_da2
;

52 
gulg
 
	mg_found_hdr
;

53 
gulg
 
	muri_chged_hdr
;

58 
	mSIGNAL_LYRIC_READY
,

59 
	mSIGNAL_LINE_CHANGED
,

60 
	mSIGNAL_LYRIC_TIMER
,

61 
	mSIGNAL_LYRIC_MAY_MISSING
,

62 
	mSIGNAL_LAST


65 
GObje
 *
	glyric_
 = 
NULL
;

66 
gpor
 
	grib_lyric__ass
 = 
NULL
;

67 
gt
 
	glyric_sigls
[
SIGNAL_LAST
] = {0};

69 
gt
 
	$rib_lyric_time_com_func
(
gcڡpor
 
a
, gcڡpo
b
,

70 
gpor
 
da
)

72 
gt
 
t
 = 0;

73 cڡ 
RCLibLyricDa
 *
da1
 = (cڡ RCLibLyricD*)
a
;

74 cڡ 
RCLibLyricDa
 *
da2
 = (cڡ RCLibLyricD*)
b
;

75 if(
da1
->
time
 > 
da2
->time
t
 = 1;

76 if(
da1
->
time
 < 
da2
->time
t
 = -1;

77  
t
;

78 
	}
}

80 
	$rib_lyric_lyric_da_
(
RCLibLyricDa
 *
da
)

82 if(
da
==
NULL
) ;

83 if(
da
->
xt
!=
NULL

	`g_
(data->text);

84 
	`g_
(
da
);

85 
	}
}

87 
gboޗn
 
	$rib_lyric_wch_tim
(
gpor
 
da
)

89 cڡ 
RCLibLyricDa
 *
n
[2] = {
NULL
, NULL};

90 
GS
 
e
 = 0;

91 
gt64
 
pos
;

92 
gt
 
i
;

93 
gt64
 
offt
;

94 cڡ 
RCLibLyricDa
 *
lyric_da
;

95 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

96 if(
e
!=
GST_STATE_PLAYING
 && s!=
GST_STATE_PAUSED
)

98  
TRUE
;

100 
pos
 = 
	`rib_ce_quy_posi
();

101 
i
=0;i<2;i++)

103 
offt
 = 
	`rib_lyric_g_ack_time_offt
(
i
);

104 
lyric_da
 = 
	`rib_lyric_g_le
(
i
, 
pos
);

105 
	`g_sigl_em
(
lyric_
, 
lyric_sigls
[
SIGNAL_LYRIC_TIMER
],

106 0, 
i
, 
pos
, 
lyric_da
, 
offt
);

107 if(
lyric_da
==
NULL
) ;

108 if(
n
[
i
]!=
lyric_da
)

110 
	`g_sigl_em
(
lyric_
, 
lyric_sigls
[
SIGNAL_LINE_CHANGED
],

111 0, 
i
, 
lyric_da
, 
offt
);

112 
n
[
i
] = 
lyric_da
;

115  
TRUE
;

116 
	}
}

118 
	$rib_lyric_g_found_cb
(
RCLibCe
 *
ce
,

119 cڡ 
RCLibCeMada
 *
mada
, cڡ 
gch
 *
uri
, 
gpor
 
da
)

121 
RCLibLyricPrive
 *
iv
;

122 
RCLibLyric
 *
lyric
;

123 
gch
 *
lyric_th
;

124 if(
da
==
NULL
 || 
uri
==NULL) ;

125 
lyric
 = 
	`RCLIB_LYRIC
(
da
);

126 
iv
 = 
lyric
->priv;

127 if(
iv
==
NULL
) ;

128 if(
iv
->
rd_da1
.
fame
==
NULL
)

130 
lyric_th
 = 
	`rib_lyric_ch_lyric
(
uri
, 
mada
->
t
,

131 
mada
->
ti
);

132 if(
lyric_th
!=
NULL
)

134 
	`rib_lyric_ld_fe
(
lyric_th
, 0);

135 
	`g_
(
lyric_th
);

138 
	}
}

140 
	$rib_lyric_uri_chged_cb
(
RCLibCe
 *
ce
, cڡ 
gch
 *
uri
,

141 
gpor
 
da
)

143 
GSequIr
 *

 = 
NULL
;

144 
gch
 *
lyric_th
 = 
NULL
;

145 
gch
 *
lyric_c_th
 = 
NULL
;

146 
RCLibDbPyliDa
 *
ayli_da
 = 
NULL
;

147 
gboޗn
 
ag1
 = 
FALSE
;

148 
gboޗn
 
ag2
 = 
FALSE
;

149 
	`rib_lyric_n
(0);

150 
	`rib_lyric_n
(1);

151 

 = 
	`rib_ce_g_db_n
();

152 if(

!=
NULL
)

154 
ayli_da
 = 
	`g_qu_g
(

);

155 
lyric_th
 = 
	`g_rdup
(
	`rib_db_ayli_g_lyric_bd
(

));

156 
lyric_c_th
 = 
	`g_rdup
(

157 
	`rib_db_ayli_g_lyric_cdy_bd
(

));

159 if(
lyric_th
==
NULL
)

160 
lyric_th
 = 
	`rib_lyric_ch_lyric
(
uri
, 
NULL
, NULL);

161 if(
lyric_th
!=
NULL
)

162 
ag1
 = 
	`rib_lyric_ld_fe
(
lyric_th
, 0);

163 if(
lyric_c_th
!=
NULL
)

164 
ag2
 = 
	`rib_lyric_ld_fe
(
lyric_c_th
, 1);

165 
	`g_
(
lyric_th
);

166 
	`g_
(
lyric_c_th
);

167 if(!
ag1
 && 
ayli_da
!=
NULL
)

169 
lyric_th
 = 
	`rib_lyric_ch_lyric
(
uri
, 
ayli_da
->
t
,

170 
ayli_da
->
ti
);

171 if(
lyric_th
!=
NULL
)

172 
ag1
 = 
	`rib_lyric_ld_fe
(
lyric_th
, 0);

173 
	`g_
(
lyric_th
);

175 if(!
ag1
 && !
ag2
)

177 
	`g_sigl_em
(
lyric_
,

178 
lyric_sigls
[
SIGNAL_LYRIC_MAY_MISSING
], 0);

180 
	}
}

182 
	$rib_lyric_fize
(
GObje
 *
obje
)

184 
RCLibLyricPrive
 *
iv
 = 
	`RCLIB_LYRIC
(
obje
)->priv;

185 if(
iv
->
g_found_hdr
>0)

186 
	`rib_ce_sigl_disc
(
iv
->
g_found_hdr
);

187 if(
iv
->
uri_chged_hdr
>0)

188 
	`rib_ce_sigl_disc
(
iv
->
uri_chged_hdr
);

189 if(
iv
->
gex
!=
NULL

	`g_gex_uef
(priv->regex);

190 
	`g_
(
iv
->
ch_d
);

191 
	`g_
(
iv
->
codg
);

192 if(
iv
->
rd_da1
.
q
!=
NULL

	`g_qu_
(priv->parsed_data1.seq);

193 
	`g_
(
iv
->
rd_da1
.
fame
);

194 
	`g_
(
iv
->
rd_da1
.
t
);

195 
	`g_
(
iv
->
rd_da1
.
ti
);

196 
	`g_
(
iv
->
rd_da1
.
bum
);

197 
	`g_
(
iv
->
rd_da1
.
auth
);

198 if(
iv
->
rd_da2
.
q
!=
NULL

	`g_qu_
(priv->parsed_data2.seq);

199 
	`g_
(
iv
->
rd_da2
.
fame
);

200 
	`g_
(
iv
->
rd_da2
.
t
);

201 
	`g_
(
iv
->
rd_da2
.
ti
);

202 
	`g_
(
iv
->
rd_da2
.
bum
);

203 
	`g_
(
iv
->
rd_da2
.
auth
);

204 
	`g_sour_move
(
iv
->
tim
);

205 
	`G_OBJECT_CLASS
(
rib_lyric__ass
)->
	`fize
(
obje
);

206 
	}
}

208 
GObje
 *
	$rib_lyric_cڡru
(
GTy
 
ty
, 
gut
 
n_cڡru_ms
,

209 
GObjeCڡruPam
 *
cڡru_ms
)

211 
GObje
 *
tv
;

212 if(
lyric_
!=
NULL
) yric_instance;

213 
tv
 = 
	`G_OBJECT_CLASS
(
rib_lyric__ass
)->
cڡru


214 (
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

215 
lyric_
 = 
tv
;

216 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
lyric_
);

217  
tv
;

218 
	}
}

220 
	$rib_lyric_ass_
(
RCLibLyricCss
 *
kss
)

222 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

223 
rib_lyric__ass
 = 
	`g_ty_ass_ek_
(
kss
);

224 
obje_ass
->
fize
 = 
rib_lyric_fize
;

225 
obje_ass
->
cڡru
 = 
rib_lyric_cڡru
;

226 
	`g_ty_ass_add_ive
(
kss
, (
RCLibLyricPrive
));

236 
lyric_sigls
[
SIGNAL_LYRIC_READY
] = 
	`g_sigl_w
("lyric-ready",

237 
RCLIB_TYPE_LYRIC
, 
G_SIGNAL_RUN_FIRST
,

238 
	`G_STRUCT_OFFSET
(
RCLibLyricCss
, 
lyric_ady
), 
NULL
, NULL,

239 
g_cosu_msh_VOID__UINT
, 
G_TYPE_NONE
, 1, 
G_TYPE_UINT
, 
NULL
);

251 
lyric_sigls
[
SIGNAL_LINE_CHANGED
] = 
	`g_sigl_w
("line-changed",

252 
RCLIB_TYPE_LYRIC
, 
G_SIGNAL_RUN_FIRST
,

253 
	`G_STRUCT_OFFSET
(
RCLibLyricCss
, 
le_chged
), 
NULL
, NULL,

254 
rib_msh_VOID__UINT_POINTER_INT64
, 
G_TYPE_NONE
, 3, 
G_TYPE_UINT
,

255 
G_TYPE_POINTER
, 
G_TYPE_INT64
, 
NULL
);

268 
lyric_sigls
[
SIGNAL_LYRIC_TIMER
] = 
	`g_sigl_w
("lyric-timer",

269 
RCLIB_TYPE_LYRIC
, 
G_SIGNAL_RUN_FIRST
,

270 
	`G_STRUCT_OFFSET
(
RCLibLyricCss
, 
lyric_tim
), 
NULL
, NULL,

271 
rib_msh_VOID__UINT_INT64_POINTER_INT64
, 
G_TYPE_NONE
, 4,

272 
G_TYPE_UINT
, 
G_TYPE_INT64
, 
G_TYPE_POINTER
, G_TYPE_INT64, 
NULL
);

281 
lyric_sigls
[
SIGNAL_LYRIC_MAY_MISSING
] = 
	`g_sigl_w
(

282 "lyric-may-missg", 
RCLIB_TYPE_LYRIC
, 
G_SIGNAL_RUN_FIRST
,

283 
	`G_STRUCT_OFFSET
(
RCLibLyricCss
, 
lyric_may_missg
), 
NULL
, NULL,

284 
g_cosu_msh_VOID__VOID
, 
G_TYPE_NONE
, 0,

285 
G_TYPE_NONE
, 
NULL
);

286 
	}
}

288 
	$rib_lyric__
(
RCLibLyric
 *
lyric
)

290 
RCLibLyricPrive
 *
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
lyric
,

291 
RCLIB_TYPE_LYRIC
, 
RCLibLyricPrive
);

292 
lyric
->
iv
 =riv;

293 
iv
->
rd_da1
.
q
 = 
	`g_qu_w
((
GDeroyNify
)

294 
rib_lyric_lyric_da_
);

295 
iv
->
rd_da2
.
q
 = 
	`g_qu_w
((
GDeroyNify
)

296 
rib_lyric_lyric_da_
);

297 
iv
->
gex
 = 
	`g_gex_w
("(?P<time>\\[[0-9]+:[0-9]+([\\.:][0-9]+)*\\])|"

300 "(?P<offt>\\[offt:.+\\])", 0, 0, 
NULL
);

301 
iv
->
tim
 = 
	`g_timeout_add
(100, (
GSourFunc
)
rib_lyric_wch_tim
,

302 
NULL
);

303 
iv
->
g_found_hdr
 = 
	`rib_ce_sigl_c
("tag-found",

304 
	`G_CALLBACK
(
rib_lyric_g_found_cb
), 
lyric
);

305 
iv
->
uri_chged_hdr
 = 
	`rib_ce_sigl_c
("uri-changed",

306 
	`G_CALLBACK
(
rib_lyric_uri_chged_cb
), 
lyric
);

307 
	}
}

309 
GTy
 
	$rib_lyric_g_ty
()

311 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

312 
GTy
 
g_defe_ty_id
;

313 cڡ 
GTyInfo
 
lyric_fo
 = {

314 .
ass_size
 = (
RCLibLyricCss
),

315 .
ba_
 = 
NULL
,

316 .
ba_fize
 = 
NULL
,

317 .
ass_
 = (
GCssInFunc
)
rib_lyric_ass_
,

318 .
ass_fize
 = 
NULL
,

319 .
ass_da
 = 
NULL
,

320 .
_size
 = (
RCLibLyric
),

321 .
n_ocs
 = 0,

322 .
_
 = (
GInInFunc
)
rib_lyric__


324 if(
	`g___r
(&
g_defe_ty_id__vީe
))

326 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
G_TYPE_OBJECT
,

327 
	`g__ic_rg
("RCLibLyric"), &
lyric_fo
, 0);

328 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

330  
g_defe_ty_id__vީe
;

331 
	}
}

339 
	$rib_lyric_
()

341 
RCLibLyricPrive
 *
iv
;

342 
	`g_mesge
("Loadingyricrocessor....");

343 if(
lyric_
!=
NULL
)

345 
	`g_wng
("Lyricrocessor islreadyoaded!");

348 
lyric_
 = 
	`g_obje_w
(
RCLIB_TYPE_LYRIC
, 
NULL
);

349 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

350 if(
iv
->
rd_da1
.
q
==
NULL
 ||riv->
rd_da2
.seq==NULL)

352 
	`g_wng
("Cannotoadyric sequence!");

353 
	`g_obje_uef
(
lyric_
);

356 if(
iv
->
gex
==
NULL
)

358 
	`g_wng
("Cannotoadyricegex!");

359 
	`g_obje_uef
(
lyric_
);

362 
	`g_mesge
("Lyricrocessoroaded.");

363 
	}
}

371 
	$rib_lyric_ex
()

373 if(
lyric_
!=
NULL

	`g_obje_uef
(lyric_instance);

374 
lyric_
 = 
NULL
;

375 
	`g_mesge
("Lyricrocessorxited.");

376 
	}
}

386 
GObje
 *
	$rib_lyric_g_
()

388  
lyric_
;

389 
	}
}

403 
gulg
 
	$rib_lyric_sigl_c
(cڡ 
gch
 *
me
,

404 
GClback
 
back
, 
gpor
 
da
)

406 if(
lyric_
==
NULL
)  0;

407  
	`g_sigl_c
(
lyric_
, 
me
, 
back
, 
da
);

408 
	}
}

420 
	$rib_lyric_sigl_disc
(
gulg
 
hdr_id
)

422 if(
lyric_
==
NULL
) ;

423 
	`g_sigl_hdr_disc
(
lyric_
, 
hdr_id
);

424 
	}
}

433 
	$rib_lyric_t_back_codg
(cڡ 
gch
 *
codg
)

435 
RCLibLyricPrive
 *
iv
;

436 if(
lyric_
==
NULL
) ;

437 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

438 if(
iv
==
NULL
) ;

439 
	`g_
(
iv
->
codg
);

440 
iv
->
codg
 = 
	`g_rdup
(encoding);

441 
	}
}

451 cڡ 
gch
 *
	$rib_lyric_g_back_codg
()

453 
RCLibLyricPrive
 *
iv
;

454 if(
lyric_
==
NULL
)  NULL;

455 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

456 if(
iv
==
NULL
)  NULL;

457  
iv
->
codg
;

458 
	}
}

460 
	$rib_lyric_add_le
(
RCLibLyricPdDa
 *
rd_da
,

461 
GRegex
 *
gex
, cڡ 
gch
 *
codg
, cڡ gch *
le
, 
gsize
 
ngth
)

463 
GMchInfo
 *
mch_fo
;

464 
gch
 *
tmp
;

465 
gch
 *
lyric_le
;

466 
gsize
 
bys_ad
, 
bys_wrn
;

467 
gt
 
mu
 = 0;

468 
gt
 
cd
 = 0.0;

469 
gt64
 
time
;

470 
gch
 *
r
;

471 
gt
 
vue
;

472 
gch
 *
xt
 = 
NULL
;

473 
GAay
 *
time_y
;

474 
gt
 
i
;

475 
RCLibLyricDa
 *
lyric_da
;

476 if(
rd_da
==
NULL
 || 
gex
==NULL || 
le
==NULL) ;

477 if(
	`g_utf8_vide
(
le
, 
ngth
, 
NULL
))

478 
lyric_le
 = 
	`g_rdup
(
le
);

479 if(
codg
!=
NULL
)

481 
tmp
 = 
	`g_cvt
(
le
, 
ngth
, "UTF-8", 
codg
, &
bys_ad
,

482 &
bys_wrn
, 
NULL
);

483 if(
tmp
==
NULL
) ;

484 
lyric_le
 = 
tmp
;

487 if(!
	`g_gex_mch
(
gex
, 
lyric_le
, 0, &
mch_fo
))

489 
	`g_
(
lyric_le
);

492 
time_y
 = 
	`g_y_w
(
FALSE
, FALSE, (
gt64
));

493 
	`g_mch_fo_mches
(
mch_fo
))

495 
r
 = 
	`g_mch_fo_tch_med
(
mch_fo
, "time");

496 if(
r
!=
NULL
 && 
	`
(str)>0)

498 if(
	`ssnf
(
r
, "[%d:%f]", &
mu
, &
cd
)==2)

500 
time
 = 
mu
 * 6000 + (
gt
)(
cd
 * 100);

501 
time
 *10 * 
GST_MSECOND
;

502 
	`g_y_nd_v
(
time_y
, 
time
);

505 
	`g_
(
r
);

506 
r
 = 
	`g_mch_fo_tch_med
(
mch_fo
, "title");

507 if(
r
!=
NULL
)

508 
tmp
 = 
	`g_rr_n
(
r
, -1, ":");

510 
tmp
 = 
NULL
;

511 if(
tmp
!=
NULL
 && 
	`
(tmp)>2)

513 
tmp
++;

514 if(
rd_da
->
t
==
NULL
)

515 
rd_da
->
t
 = 
	`g_dup
(
tmp
, 
	`
(tmp)-1);

517 
	`g_
(
r
);

518 
r
 = 
	`g_mch_fo_tch_med
(
mch_fo
, "artist");

519 if(
r
!=
NULL
)

520 
tmp
 = 
	`g_rr_n
(
r
, -1, ":");

522 
tmp
 = 
NULL
;

523 if(
tmp
!=
NULL
 && 
	`
(tmp)>2)

525 
tmp
++;

526 if(
rd_da
->
ti
==
NULL
)

527 
rd_da
->
ti
 = 
	`g_dup
(
tmp
, 
	`
(tmp)-1);

529 
	`g_
(
r
);

530 
r
 = 
	`g_mch_fo_tch_med
(
mch_fo
, "album");

531 if(
r
!=
NULL
)

532 
tmp
 = 
	`g_rr_n
(
r
, -1, ":");

534 
tmp
 = 
NULL
;

535 if(
tmp
!=
NULL
 && 
	`
(tmp)>2)

537 
tmp
++;

538 if(
rd_da
->
bum
==
NULL
)

539 
rd_da
->
bum
 = 
	`g_dup
(
tmp
, 
	`
(tmp)-1);

541 
	`g_
(
r
);

542 
r
 = 
	`g_mch_fo_tch_med
(
mch_fo
, "author");

543 if(
r
!=
NULL
)

544 
tmp
 = 
	`g_rr_n
(
r
, -1, ":");

546 
tmp
 = 
NULL
;

547 if(
tmp
!=
NULL
 && 
	`
(tmp)>2)

549 
tmp
++;

550 if(
rd_da
->
auth
==
NULL
)

551 
rd_da
->
auth
 = 
	`g_dup
(
tmp
, 
	`
(tmp)-1);

553 
	`g_
(
r
);

554 
r
 = 
	`g_mch_fo_tch_med
(
mch_fo
, "offset");

555 if(
r
!=
NULL
)

556 
tmp
 = 
	`g_rr_n
(
r
, -1, ":");

558 
tmp
 = 
NULL
;

559 if(
tmp
!=
NULL
 && 
	`
(tmp)>2)

561 
tmp
++;

562 if(
	`ssnf
(
tmp
, "%d", &
vue
)==1)

563 
rd_da
->
offt
 = 
vue
;

565 
	`g_
(
r
);

566 
r
 = 
	`g_mch_fo_tch_med
(
mch_fo
, "text");

567 if(
r
!=
NULL
 && 
	`
(str)>0)

569 
xt
 = 
	`g_rdup
(
r
);

571 
	`g_
(
r
);

572 
	`g_mch_fo_xt
(
mch_fo
, 
NULL
);

574 if(
xt
==
NULL
x
	`g_rdup
("");

575 
i
=0;i<
time_y
->
n
;i++)

577 
lyric_da
 = 
	`g_w0
(
RCLibLyricDa
, 1);

578 
lyric_da
->
time
 = 
	`g_y_dex
(
time_y
, 
gt64
, 
i
);

579 
lyric_da
->
ngth
 = -1;

580 
lyric_da
->
xt
 = 
	`g_rdup
(text);

581 
	`g_qu__s܋d
(
rd_da
->
q
, 
lyric_da
,

582 
rib_lyric_time_com_func
, 
NULL
);

584 
	`g_
(
xt
);

585 
	`g_y_
(
time_y
, 
TRUE
);

586 
	`g_
(
lyric_le
);

587 
	}
}

599 
gboޗn
 
	$rib_lyric_ld_fe
(cڡ 
gch
 *
fame
, 
gut
 
dex
)

601 
RCLibLyricPdDa
 *
rd_da
;

602 
gch
 *
le
;

603 
GFe
 *
fe
;

604 
GFeIutSm
 *
put_am
;

605 
GDaIutSm
 *
da_am
;

606 
gsize
 
le_n
;

607 
gt64
 
time
 = -1;

608 
RCLibLyricPrive
 *
iv
;

609 
GSequIr
 *

;

610 
RCLibLyricDa
 *
lyric_da
;

611 
	`rib_lyric_n
(
dex
);

612 if(
lyric_
==
NULL
 
FALSE
;

613 if(
fame
==
NULL
 
FALSE
;

614 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

615 if(
iv
==
NULL
 
FALSE
;

616 
fe
 = 
	`g_fe_w_f_th
(
fame
);

617 if(
fe
==
NULL
 
FALSE
;

618 if(!
	`g_fe_quy_exis
(
fe
, 
NULL
))

620 
	`g_obje_uef
(
fe
);

621  
FALSE
;

623 
put_am
 = 
	`g_fe_ad
(
fe
, 
NULL
, NULL);

624 
	`g_obje_uef
(
fe
);

625 if(
put_am
==
NULL
 
FALSE
;

626 
da_am
 = 
	`g_da_put_am_w
(
	`G_INPUT_STREAM
(
put_am
));

627 
	`g_obje_uef
(
put_am
);

628 if(
da_am
==
NULL
 
FALSE
;

629 
	`g_da_put_am_t_wle_ty
(
da_am
,

630 
G_DATA_STREAM_NEWLINE_TYPE_ANY
);

631 if(
dex
==1)

632 
rd_da
 = &(
iv
->
rd_da2
);

634 
rd_da
 = &(
iv
->
rd_da1
);

635 if(
dex
!=1) index = 0;

636 (
le
=
	`g_da_put_am_ad_le
(
da_am
, &
le_n
,

637 
NULL
, NULL))!=NULL)

639 
	`rib_lyric_add_le
(
rd_da
, 
iv
->
gex
,riv->
codg
,

640 
le
, 
le_n
);

641 
	`g_
(
le
);

643 
	`g_obje_uef
(
da_am
);

644 

 = 
	`g_qu_g_d_
(
rd_da
->
q
);

645 !
	`g_qu__is_beg
(

);)

647 

 = 
	`g_qu__ev
(iter);

648 
lyric_da
 = 
	`g_qu_g
(

);

649 if(
lyric_da
==
NULL
) ;

650 if(
time
>=0)

652 
lyric_da
->
ngth
 = 
time
 -yric_data->time;

654 
time
 = 
lyric_da
->time;

656 
rd_da
->
fame
 = 
	`g_rdup
(filename);

657 
	`g_sigl_em
(
lyric_
, 
lyric_sigls
[
SIGNAL_LYRIC_READY
], 0,

658 
dex
);

659  
TRUE
;

660 
	}
}

669 
	$rib_lyric_n
(
gut
 
dex
)

671 
RCLibLyricPdDa
 *
rd_da
;

672 
RCLibLyricPrive
 *
iv
;

673 
GSequIr
 *
beg_
, *
d_
;

674 if(
lyric_
==
NULL
) ;

675 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

676 if(
iv
==
NULL
) ;

677 if(
dex
==1)

678 
rd_da
 = &(
iv
->
rd_da2
);

680 
rd_da
 = &(
iv
->
rd_da1
);

681 
	`g_
(
rd_da
->
t
);

682 
rd_da
->
t
 = 
NULL
;

683 
	`g_
(
rd_da
->
ti
);

684 
rd_da
->
ti
 = 
NULL
;

685 
	`g_
(
rd_da
->
bum
);

686 
rd_da
->
bum
 = 
NULL
;

687 
	`g_
(
rd_da
->
auth
);

688 
rd_da
->
auth
 = 
NULL
;

689 
	`g_
(
rd_da
->
fame
);

690 
rd_da
->
fame
 = 
NULL
;

691 
rd_da
->
offt
 = 0;

692 if(
rd_da
->
q
==
NULL
) ;

693 
beg_
 = 
	`g_qu_g_beg_
(
rd_da
->
q
);

694 
d_
 = 
	`g_qu_g_d_
(
rd_da
->
q
);

695 if(
beg_
==
NULL
 || 
d_
==NULL) ;

696 
	`g_qu_move_nge
(
beg_
, 
d_
);

697 
	}
}

709 cڡ 
RCLibLyricDa
 *
	$rib_lyric_g_le
(
gut
 
dex
, 
gt64
 
time
)

711 
RCLibLyricDa
 *
lyric_da
 = 
NULL
;

712 
GSequIr
 *

;

713 

 = 
	`rib_lyric_g_le_
(
dex
, 
time
);

714 if(

==
NULL
)  NULL;

715 if(
	`g_qu__is_d
(

) 
NULL
;

716 
lyric_da
 = 
	`g_qu_g
(

);

717  
lyric_da
;

718 
	}
}

732 
GSequIr
 *
	$rib_lyric_g_le_
(
gut
 
dex
, 
gt64
 
time
)

734 
RCLibLyricPdDa
 *
rd_da
;

735 
RCLibLyricPrive
 *
iv
;

736 
RCLibLyricDa
 *
lyric_da
 = 
NULL
;

737 
GSequIr
 *
beg
, *
d
, *

;

738 
gt64
 
offt
;

739 if(
lyric_
==
NULL
)  NULL;

740 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

741 if(
iv
==
NULL
)  NULL;

742 if(
dex
==1)

743 
rd_da
 = &(
iv
->
rd_da2
);

745 
rd_da
 = &(
iv
->
rd_da1
);

746 
beg
 = 
	`g_qu_g_beg_
(
rd_da
->
q
);

747 
d
 = 
	`g_qu_g_d_
(
rd_da
->
q
);

748 if(
beg
==
d
 
NULL
;

749 
lyric_da
 = 
	`g_qu_g
(
beg
);

750 
offt
 = (
gt64
)
rd_da
->off* 
GST_MSECOND
;

751 if(
lyric_da
!=
NULL
)

753 if(
time
<
lyric_da
->time+
offt
 
NULL
;

757 

 = 
	`g_qu_nge_g_midpot
(
beg
, 
d
);

758 
lyric_da
 = 
	`g_qu_g
(

);

759 if(
lyric_da
==
NULL
) ;

760 if(
time
<
lyric_da
->time+
offt
)

762 
d
 = 

;

764 if(
time
>=
lyric_da
->time+
offt
 && (lyric_da->
ngth
<0 ||

765 
time
<
lyric_da
->time+
offt
+lyric_da->
ngth
))

769 
beg
 = 

;

771 
beg
!=
d
);

772  

;

773 
	}
}

782 
	$rib_lyric_t_ch_d
(cڡ 
gch
 *
d
)

784 
RCLibLyricPrive
 *
iv
;

785 if(
lyric_
==
NULL
) ;

786 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

787 if(
iv
==
NULL
) ;

788 
	`g_
(
iv
->
ch_d
);

789 
iv
->
ch_d
 = 
	`g_rdup
(
d
);

790 
	}
}

800 cڡ 
gch
 *
	$rib_lyric_g_ch_d
()

802 
RCLibLyricPrive
 *
iv
;

803 if(
lyric_
==
NULL
)  NULL;

804 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

805 if(
iv
==
NULL
)  NULL;

806  
iv
->
ch_d
;

807 
	}
}

820 
gch
 *
	$rib_lyric_ch_lyric
(cڡ 
gch
 *
uri
, cڡ gch *
t
,

821 cڡ 
gch
 *
ti
)

823 
RCLibLyricPrive
 *
iv
;

824 
GRegex
 *
gex
;

825 
GSg
 *
key
;

826 
GD
 *
d
 = 
NULL
;

827 
gch
 *
fd
 = 
NULL
, *
ame
 = NULL;

828 
gch
 *
th
, *
tmp1
, *
tmp2
;

829 cڡ 
gch
 *
ame_fܗch
;

830 
gch
 *
su
 = 
NULL
;

831 
gboޗn
 
ag
 = 
FALSE
;

832 if(
uri
!=
NULL
)

834 
th
 = 
	`g_fame_om_uri
(
uri
, 
NULL
, NULL);

835 if(
th
!=
NULL
)

837 
fd
 = 
	`g_th_g_dme
(
th
);

838 
ame
 = 
	`rib_g_g_me_om_h
(
th
);

839 
	`g_
(
th
);

842 
key
 = 
	`g_rg_w
("^(");

843 if(
ame
!=
NULL
)

845 
tmp1
 = 
	`g_gex_es_rg
(
ame
, -1);

846 
	`g_
(
ame
);

847 
	`g_rg_nd
(
key
, 
tmp1
);

848 
	`g_
(
tmp1
);

849 
ag
 = 
TRUE
;

851 if(
ti
!=
NULL
 && 
t
!=NULL && 
	`
(artist)>0 &&

852 
	`
(
t
)>0)

854 if(
ag
)

855 
	`g_rg_nd_c
(
key
, '|');

856 
tmp1
 = 
	`g_gex_es_rg
(
t
, -1);

857 
tmp2
 = 
	`g_gex_es_rg
(
ti
, -1);

858 
	`g_rg_nd_tf
(
key
, "%- %s|%- %s", 
tmp1
, 
tmp2
,

859 
tmp2
, 
tmp1
);

860 
	`g_
(
tmp1
);

861 
	`g_
(
tmp2
);

862 
ag
 = 
TRUE
;

864 if(
t
!=
NULL
 && 
	`
(title)>0)

866 if(
ag
)

867 
	`g_rg_nd_c
(
key
, '|');

868 
tmp1
 = 
	`g_gex_es_rg
(
t
, -1);

869 
	`g_rg_nd
(
key
, 
tmp1
);

870 
	`g_
(
tmp1
);

871 
ag
 = 
TRUE
;

873 if(!
ag
)

875 
	`g_rg_
(
key
, 
TRUE
);

876  
NULL
;

878 
	`g_rg_nd
(
key
, ")\\.([Ll][Rr][Cc])$");

879 
gex
 = 
	`g_gex_w
(
key
->
r
, 0, 0, 
NULL
);

880 
	`g_rg_
(
key
, 
TRUE
);

881 if(
gex
==
NULL
)

883 
	`g_
(
fd
);

884  
NULL
;

886 if(
fd
!=
NULL
)

887 
d
 = 
	`g_d_ݒ
(
fd
, 0, 
NULL
);

888 if(
d
!=
NULL
)

890 (
ame_fܗch
=
	`g_d_ad_me
(
d
))!=
NULL
)

892 if(
	`g_gex_mch
(
gex
, 
ame_fܗch
, 0, 
NULL
))

894 
su
 = 
	`g_bud_fame
(
fd
, 
ame_fܗch
, 
NULL
);

898 
	`g_d_o
(
d
);

899 
	`g_
(
fd
);

900 if(
su
!=
NULL
)

902 
	`g_gex_uef
(
gex
);

903  
su
;

906 if(
lyric_
==
NULL
)

908 
	`g_gex_uef
(
gex
);

909  
NULL
;

911 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

912 if(
iv
==
NULL
 ||riv->
ch_d
==NULL)

914 
	`g_gex_uef
(
gex
);

915  
NULL
;

917 
d
 = 
	`g_d_ݒ
(
iv
->
ch_d
, 0, 
NULL
);

918 if(
d
!=
NULL
)

920 (
ame_fܗch
=
	`g_d_ad_me
(
d
))!=
NULL
)

922 if(
	`g_gex_mch
(
gex
, 
ame_fܗch
, 0, 
NULL
))

924 
su
 = 
	`g_bud_fame
(
iv
->
ch_d
,

925 
ame_fܗch
, 
NULL
);

929 
	`g_d_o
(
d
);

931 
	`g_gex_uef
(
gex
);

932  
su
;

933 
	}
}

944 
gboޗn
 
	$rib_lyric_is_avaab
(
gut
 
dex
)

946 
RCLibLyricPrive
 *
iv
;

947 
RCLibLyricPdDa
 *
rd_da
;

948 if(
lyric_
==
NULL
 
FALSE
;

949 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

950 if(
iv
==
NULL
 
FALSE
;

951 if(
dex
==1)

952 
rd_da
 = &(
iv
->
rd_da2
);

954 
rd_da
 = &(
iv
->
rd_da1
);

955  (
rd_da
->
fame
!=
NULL
);

956 
	}
}

967 cڡ 
RCLibLyricPdDa
 *
	$rib_lyric_g_rd_da
(
gut
 
dex
)

969 
RCLibLyricPrive
 *
iv
;

970 cڡ 
RCLibLyricPdDa
 *
rd_da
;

971 if(
lyric_
==
NULL
)  NULL;

972 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

973 if(
iv
==
NULL
)  NULL;

974 if(
dex
==1)

975 
rd_da
 = &(
iv
->
rd_da2
);

977 
rd_da
 = &(
iv
->
rd_da1
);

978  
rd_da
;

979 
	}
}

990 
gt64
 
	$rib_lyric_g_ack_time_offt
(
gut
 
dex
)

992 
RCLibLyricPrive
 *
iv
;

993 
RCLibLyricPdDa
 *
rd_da
;

994 if(
lyric_
==
NULL
)  0;

995 
iv
 = 
	`RCLIB_LYRIC
(
lyric_
)->priv;

996 if(
iv
==
NULL
)  0;

997 if(
dex
==1)

998 
rd_da
 = &(
iv
->
rd_da2
);

1000 
rd_da
 = &(
iv
->
rd_da1
);

1001  (
gt64
)
rd_da
->
offt
 * 
GST_MSECOND
;

1002 
	}
}

	@lib/rclib-lyric.h

25 #ide
HAVE_RCLIB_LYRIC_H


26 
	#HAVE_RCLIB_LYRIC_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<gio/gio.h
>

32 
	gG_BEGIN_DECLS


34 
	#RCLIB_TYPE_LYRIC
 (
	`rib_lyric_g_ty
())

	)

35 
	#RCLIB_LYRIC
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

36 
RCLIB_TYPE_LYRIC
, 
RCLibLyric
))

	)

37 
	#RCLIB_LYRIC_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_CAST
((k), \

38 
RCLIB_TYPE_LYRIC
, 
RCLibLyricCss
))

	)

39 
	#RCLIB_IS_LYRIC
(
o
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((o), \

40 
RCLIB_TYPE_LYRIC
))

	)

41 
	#RCLIB_IS_LYRIC_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_TYPE
((k), \

42 
RCLIB_TYPE_LYRIC
))

	)

43 
	#RCLIB_LYRIC_GET_CLASS
(
o
(
	`G_TYPE_INSTANCE_GET_CLASS
((o), \

44 
RCLIB_TYPE_LYRIC
, 
RCLibLyricCss
))

	)

46 
_RCLibLyricDa
 
	tRCLibLyricDa
;

47 
_RCLibLyricPdDa
 
	tRCLibLyricPdDa
;

48 
_RCLibLyric
 
	tRCLibLyric
;

49 
_RCLibLyricCss
 
	tRCLibLyricCss
;

50 
_RCLibLyricPrive
 
	tRCLibLyricPrive
;

61 
	s_RCLibLyricDa
 {

62 
gt64
 
	mtime
;

63 
gt64
 
	mngth
;

64 
gch
 *
	mxt
;

80 
	s_RCLibLyricPdDa
 {

81 
GSequ
 *
	mq
;

82 
gch
 *
	mfame
;

83 
gch
 *
	mt
;

84 
gch
 *
	mti
;

85 
gch
 *
	mbum
;

86 
gch
 *
	mauth
;

87 
gt
 
	mofft
;

97 
	s_RCLibLyric
 {

99 
GObje
 
	m
;

100 
RCLibLyricPrive
 *
	miv
;

109 
	s_RCLibLyricCss
 {

111 
GObjeCss
 
	m_ass
;

112 (*
	mlyric_ady
)(
RCLibLyric
 *
	mlyric
, 
gut
 
	mdex
);

113 (*
	mle_chged
)(
RCLibLyric
 *
	mlyric
, 
gut
 
	mdex
,

114 cڡ 
RCLibLyricDa
 *
	mlyric_da
, 
gt64
 
	mofft
);

115 (*
	mlyric_tim
)(
RCLibLyric
 *
	mlyric
, 
gut
 
	mdex
, 
gt64
 
	mpos
,

116 cڡ 
RCLibLyricDa
 *
	mlyric_da
, 
gt64
 
	mofft
);

117 (*
	mlyric_may_missg
)(
RCLibLyric
 *
	mlyric
);

121 
GTy
 
rib_lyric_g_ty
();

124 
rib_lyric_
();

125 
rib_lyric_ex
();

126 
GObje
 *
rib_lyric_g_
();

127 
gulg
 
rib_lyric_sigl_c
(cڡ 
gch
 *
me
,

128 
GClback
 
back
, 
gpor
 
da
);

129 
rib_lyric_sigl_disc
(
gulg
 
hdr_id
);

130 
rib_lyric_t_back_codg
(cڡ 
gch
 *
codg
);

131 cڡ 
gch
 *
rib_lyric_g_back_codg
();

132 
gboޗn
 
rib_lyric_ld_fe
(cڡ 
gch
 *
fame
, 
gut
 
dex
);

133 
rib_lyric_n
(
gut
 
dex
);

134 cڡ 
RCLibLyricDa
 *
rib_lyric_g_le
(
gut
 
dex
, 
gt64
 
time
);

135 
GSequIr
 *
rib_lyric_g_le_
(
gut
 
dex
, 
gt64
 
time
);

136 
rib_lyric_t_ch_d
(cڡ 
gch
 *
d
);

137 cڡ 
gch
 *
rib_lyric_g_ch_d
();

138 
gch
 *
rib_lyric_ch_lyric
(cڡ gch *
uri
, cڡ gch *
t
,

139 cڡ 
gch
 *
ti
);

140 
gboޗn
 
rib_lyric_is_avaab
(
gut
 
dex
);

141 cڡ 
RCLibLyricPdDa
 *
rib_lyric_g_rd_da
(
gut
 
dex
);

142 
gt64
 
rib_lyric_g_ack_time_offt
(
gut
 
dex
);

144 
	gG_END_DECLS


	@lib/rclib-marshal.c

2 
	~<glib-obje.h
>

5 #ifde
G_ENABLE_DEBUG


6 
	#g_msh_vue_ek_boޗn
(
v

	`g_vue_g_boޗn
 (v)

	)

7 
	#g_msh_vue_ek_ch
(
v

	`g_vue_g_sch
 (v)

	)

8 
	#g_msh_vue_ek_uch
(
v

	`g_vue_g_uch
 (v)

	)

9 
	#g_msh_vue_ek_t
(
v

	`g_vue_g_t
 (v)

	)

10 
	#g_msh_vue_ek_ut
(
v

	`g_vue_g_ut
 (v)

	)

11 
	#g_msh_vue_ek_lg
(
v

	`g_vue_g_lg
 (v)

	)

12 
	#g_msh_vue_ek_ulg
(
v

	`g_vue_g_ulg
 (v)

	)

13 
	#g_msh_vue_ek_t64
(
v

	`g_vue_g_t64
 (v)

	)

14 
	#g_msh_vue_ek_ut64
(
v

	`g_vue_g_ut64
 (v)

	)

15 
	#g_msh_vue_ek_um
(
v

	`g_vue_g_um
 (v)

	)

16 
	#g_msh_vue_ek_ags
(
v

	`g_vue_g_ags
 (v)

	)

17 
	#g_msh_vue_ek_t
(
v

	`g_vue_g_t
 (v)

	)

18 
	#g_msh_vue_ek_doub
(
v

	`g_vue_g_doub
 (v)

	)

19 
	#g_msh_vue_ek_rg
(
v
(*
	`g_vue_g_rg
 (v)

	)

20 
	#g_msh_vue_ek_m
(
v

	`g_vue_g_m
 (v)

	)

21 
	#g_msh_vue_ek_boxed
(
v

	`g_vue_g_boxed
 (v)

	)

22 
	#g_msh_vue_ek_por
(
v

	`g_vue_g_por
 (v)

	)

23 
	#g_msh_vue_ek_obje
(
v

	`g_vue_g_obje
 (v)

	)

24 
	#g_msh_vue_ek_v
(
v

	`g_vue_g_v
 (v)

	)

30 
	#g_msh_vue_ek_boޗn
(
v
(v)->
da
[0].
v_t


	)

31 
	#g_msh_vue_ek_ch
(
v
(v)->
da
[0].
v_t


	)

32 
	#g_msh_vue_ek_uch
(
v
(v)->
da
[0].
v_ut


	)

33 
	#g_msh_vue_ek_t
(
v
(v)->
da
[0].
v_t


	)

34 
	#g_msh_vue_ek_ut
(
v
(v)->
da
[0].
v_ut


	)

35 
	#g_msh_vue_ek_lg
(
v
(v)->
da
[0].
v_lg


	)

36 
	#g_msh_vue_ek_ulg
(
v
(v)->
da
[0].
v_ulg


	)

37 
	#g_msh_vue_ek_t64
(
v
(v)->
da
[0].
v_t64


	)

38 
	#g_msh_vue_ek_ut64
(
v
(v)->
da
[0].
v_ut64


	)

39 
	#g_msh_vue_ek_um
(
v
(v)->
da
[0].
v_lg


	)

40 
	#g_msh_vue_ek_ags
(
v
(v)->
da
[0].
v_ulg


	)

41 
	#g_msh_vue_ek_t
(
v
(v)->
da
[0].
v_t


	)

42 
	#g_msh_vue_ek_doub
(
v
(v)->
da
[0].
v_doub


	)

43 
	#g_msh_vue_ek_rg
(
v
(v)->
da
[0].
v_por


	)

44 
	#g_msh_vue_ek_m
(
v
(v)->
da
[0].
v_por


	)

45 
	#g_msh_vue_ek_boxed
(
v
(v)->
da
[0].
v_por


	)

46 
	#g_msh_vue_ek_por
(
v
(v)->
da
[0].
v_por


	)

47 
	#g_msh_vue_ek_obje
(
v
(v)->
da
[0].
v_por


	)

48 
	#g_msh_vue_ek_v
(
v
(v)->
da
[0].
v_por


	)

54 
	$rib_msh_VOID__INT64
 (
GClosu
 *
osu
,

55 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

56 
gut
 
n_m_vues
,

57 cڡ 
GVue
 *
m_vues
,

58 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

59 
gpor
 
msh_da
)

61 (*
	tGMshFunc_VOID__INT64
(
	tgpor
 
	tda1
,

62 
	tgt64
 
	tg_1
,

63 
	tgpor
 
	tda2
);

64 
GMshFunc_VOID__INT64
 
back
;

65 
GCClosu
 *
cc
 = (GCClosu*
osu
;

66 
gpor
 
da1
, 
da2
;

68 
	`g_tu_if_
 (
n_m_vues
 == 2);

70 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

72 
da1
 = 
osu
->
da
;

73 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

77 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

78 
da2
 = 
osu
->
da
;

80 
back
 = (
GMshFunc_VOID__INT64
(
msh_da
 ? msh_d: 
cc
->callback);

82 
	`back
 (
da1
,

83 
	`g_msh_vue_ek_t64
 (
m_vues
 + 1),

84 
da2
);

85 
	}
}

89 
	$rib_msh_VOID__POINTER_INT64
 (
GClosu
 *
osu
,

90 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

91 
gut
 
n_m_vues
,

92 cڡ 
GVue
 *
m_vues
,

93 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

94 
gpor
 
msh_da
)

96 (*
	tGMshFunc_VOID__POINTER_INT64
(
	tgpor
 
	tda1
,

97 
	tgpor
 
	tg_1
,

98 
	tgt64
 
	tg_2
,

99 
	tgpor
 
	tda2
);

100 
GMshFunc_VOID__POINTER_INT64
 
back
;

101 
GCClosu
 *
cc
 = (GCClosu*
osu
;

102 
gpor
 
da1
, 
da2
;

104 
	`g_tu_if_
 (
n_m_vues
 == 3);

106 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

108 
da1
 = 
osu
->
da
;

109 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

113 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

114 
da2
 = 
osu
->
da
;

116 
back
 = (
GMshFunc_VOID__POINTER_INT64
(
msh_da
 ? msh_d: 
cc
->callback);

118 
	`back
 (
da1
,

119 
	`g_msh_vue_ek_por
 (
m_vues
 + 1),

120 
	`g_msh_vue_ek_t64
 (
m_vues
 + 2),

121 
da2
);

122 
	}
}

126 
	$rib_msh_VOID__POINTER_POINTER
 (
GClosu
 *
osu
,

127 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

128 
gut
 
n_m_vues
,

129 cڡ 
GVue
 *
m_vues
,

130 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

131 
gpor
 
msh_da
)

133 (*
	tGMshFunc_VOID__POINTER_POINTER
(
	tgpor
 
	tda1
,

134 
	tgpor
 
	tg_1
,

135 
	tgpor
 
	tg_2
,

136 
	tgpor
 
	tda2
);

137 
GMshFunc_VOID__POINTER_POINTER
 
back
;

138 
GCClosu
 *
cc
 = (GCClosu*
osu
;

139 
gpor
 
da1
, 
da2
;

141 
	`g_tu_if_
 (
n_m_vues
 == 3);

143 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

145 
da1
 = 
osu
->
da
;

146 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

150 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

151 
da2
 = 
osu
->
da
;

153 
back
 = (
GMshFunc_VOID__POINTER_POINTER
(
msh_da
 ? msh_d: 
cc
->callback);

155 
	`back
 (
da1
,

156 
	`g_msh_vue_ek_por
 (
m_vues
 + 1),

157 
	`g_msh_vue_ek_por
 (
m_vues
 + 2),

158 
da2
);

159 
	}
}

163 
	$rib_msh_VOID__POINTER_STRING
 (
GClosu
 *
osu
,

164 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

165 
gut
 
n_m_vues
,

166 cڡ 
GVue
 *
m_vues
,

167 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

168 
gpor
 
msh_da
)

170 (*
	tGMshFunc_VOID__POINTER_STRING
(
	tgpor
 
	tda1
,

171 
	tgpor
 
	tg_1
,

172 
	tgpor
 
	tg_2
,

173 
	tgpor
 
	tda2
);

174 
GMshFunc_VOID__POINTER_STRING
 
back
;

175 
GCClosu
 *
cc
 = (GCClosu*
osu
;

176 
gpor
 
da1
, 
da2
;

178 
	`g_tu_if_
 (
n_m_vues
 == 3);

180 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

182 
da1
 = 
osu
->
da
;

183 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

187 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

188 
da2
 = 
osu
->
da
;

190 
back
 = (
GMshFunc_VOID__POINTER_STRING
(
msh_da
 ? msh_d: 
cc
->callback);

192 
	`back
 (
da1
,

193 
	`g_msh_vue_ek_por
 (
m_vues
 + 1),

194 
	`g_msh_vue_ek_rg
 (
m_vues
 + 2),

195 
da2
);

196 
	}
}

200 
	$rib_msh_VOID__STRING_POINTER
 (
GClosu
 *
osu
,

201 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

202 
gut
 
n_m_vues
,

203 cڡ 
GVue
 *
m_vues
,

204 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

205 
gpor
 
msh_da
)

207 (*
	tGMshFunc_VOID__STRING_POINTER
(
	tgpor
 
	tda1
,

208 
	tgpor
 
	tg_1
,

209 
	tgpor
 
	tg_2
,

210 
	tgpor
 
	tda2
);

211 
GMshFunc_VOID__STRING_POINTER
 
back
;

212 
GCClosu
 *
cc
 = (GCClosu*
osu
;

213 
gpor
 
da1
, 
da2
;

215 
	`g_tu_if_
 (
n_m_vues
 == 3);

217 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

219 
da1
 = 
osu
->
da
;

220 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

224 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

225 
da2
 = 
osu
->
da
;

227 
back
 = (
GMshFunc_VOID__STRING_POINTER
(
msh_da
 ? msh_d: 
cc
->callback);

229 
	`back
 (
da1
,

230 
	`g_msh_vue_ek_rg
 (
m_vues
 + 1),

231 
	`g_msh_vue_ek_por
 (
m_vues
 + 2),

232 
da2
);

233 
	}
}

239 
	$rib_msh_VOID__UINT_POINTER_INT64
 (
GClosu
 *
osu
,

240 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

241 
gut
 
n_m_vues
,

242 cڡ 
GVue
 *
m_vues
,

243 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

244 
gpor
 
msh_da
)

246 (*
	tGMshFunc_VOID__UINT_POINTER_INT64
(
	tgpor
 
	tda1
,

247 
	tgut
 
	tg_1
,

248 
	tgpor
 
	tg_2
,

249 
	tgt64
 
	tg_3
,

250 
	tgpor
 
	tda2
);

251 
GMshFunc_VOID__UINT_POINTER_INT64
 
back
;

252 
GCClosu
 *
cc
 = (GCClosu*
osu
;

253 
gpor
 
da1
, 
da2
;

255 
	`g_tu_if_
 (
n_m_vues
 == 4);

257 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

259 
da1
 = 
osu
->
da
;

260 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

264 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

265 
da2
 = 
osu
->
da
;

267 
back
 = (
GMshFunc_VOID__UINT_POINTER_INT64
(
msh_da
 ? msh_d: 
cc
->callback);

269 
	`back
 (
da1
,

270 
	`g_msh_vue_ek_ut
 (
m_vues
 + 1),

271 
	`g_msh_vue_ek_por
 (
m_vues
 + 2),

272 
	`g_msh_vue_ek_t64
 (
m_vues
 + 3),

273 
da2
);

274 
	}
}

278 
	$rib_msh_VOID__UINT_INT64_POINTER_INT64
 (
GClosu
 *
osu
,

279 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

280 
gut
 
n_m_vues
,

281 cڡ 
GVue
 *
m_vues
,

282 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

283 
gpor
 
msh_da
)

285 (*
	tGMshFunc_VOID__UINT_INT64_POINTER_INT64
(
	tgpor
 
	tda1
,

286 
	tgut
 
	tg_1
,

287 
	tgt64
 
	tg_2
,

288 
	tgpor
 
	tg_3
,

289 
	tgt64
 
	tg_4
,

290 
	tgpor
 
	tda2
);

291 
GMshFunc_VOID__UINT_INT64_POINTER_INT64
 
back
;

292 
GCClosu
 *
cc
 = (GCClosu*
osu
;

293 
gpor
 
da1
, 
da2
;

295 
	`g_tu_if_
 (
n_m_vues
 == 5);

297 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

299 
da1
 = 
osu
->
da
;

300 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

304 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

305 
da2
 = 
osu
->
da
;

307 
back
 = (
GMshFunc_VOID__UINT_INT64_POINTER_INT64
(
msh_da
 ? msh_d: 
cc
->callback);

309 
	`back
 (
da1
,

310 
	`g_msh_vue_ek_ut
 (
m_vues
 + 1),

311 
	`g_msh_vue_ek_t64
 (
m_vues
 + 2),

312 
	`g_msh_vue_ek_por
 (
m_vues
 + 3),

313 
	`g_msh_vue_ek_t64
 (
m_vues
 + 4),

314 
da2
);

315 
	}
}

319 
	$rib_msh_VOID__UINT_UINT_FLOAT_POINTER
 (
GClosu
 *
osu
,

320 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

321 
gut
 
n_m_vues
,

322 cڡ 
GVue
 *
m_vues
,

323 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

324 
gpor
 
msh_da
)

326 (*
	tGMshFunc_VOID__UINT_UINT_FLOAT_POINTER
(
	tgpor
 
	tda1
,

327 
	tgut
 
	tg_1
,

328 
	tgut
 
	tg_2
,

329 
	tgt
 
	tg_3
,

330 
	tgpor
 
	tg_4
,

331 
	tgpor
 
	tda2
);

332 
GMshFunc_VOID__UINT_UINT_FLOAT_POINTER
 
back
;

333 
GCClosu
 *
cc
 = (GCClosu*
osu
;

334 
gpor
 
da1
, 
da2
;

336 
	`g_tu_if_
 (
n_m_vues
 == 5);

338 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

340 
da1
 = 
osu
->
da
;

341 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

345 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

346 
da2
 = 
osu
->
da
;

348 
back
 = (
GMshFunc_VOID__UINT_UINT_FLOAT_POINTER
(
msh_da
 ? msh_d: 
cc
->callback);

350 
	`back
 (
da1
,

351 
	`g_msh_vue_ek_ut
 (
m_vues
 + 1),

352 
	`g_msh_vue_ek_ut
 (
m_vues
 + 2),

353 
	`g_msh_vue_ek_t
 (
m_vues
 + 3),

354 
	`g_msh_vue_ek_por
 (
m_vues
 + 4),

355 
da2
);

356 
	}
}

360 
	$rib_msh_BOOLEAN__UINT_POINTER
 (
GClosu
 *
osu
,

361 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

362 
gut
 
n_m_vues
,

363 cڡ 
GVue
 *
m_vues
,

364 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

365 
gpor
 
msh_da
)

367 
	`gboޗn
 (*
	tGMshFunc_BOOLEAN__UINT_POINTER
(
	tgpor
 
	tda1
,

368 
	tgut
 
	tg_1
,

369 
	tgpor
 
	tg_2
,

370 
	tgpor
 
	tda2
);

371 
GMshFunc_BOOLEAN__UINT_POINTER
 
back
;

372 
GCClosu
 *
cc
 = (GCClosu*
osu
;

373 
gpor
 
da1
, 
da2
;

374 
gboޗn
 
v_tu
;

376 
	`g_tu_if_
 (
tu_vue
 !
NULL
);

377 
	`g_tu_if_
 (
n_m_vues
 == 3);

379 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

381 
da1
 = 
osu
->
da
;

382 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

386 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

387 
da2
 = 
osu
->
da
;

389 
back
 = (
GMshFunc_BOOLEAN__UINT_POINTER
(
msh_da
 ? msh_d: 
cc
->callback);

391 
v_tu
 = 
	`back
 (
da1
,

392 
	`g_msh_vue_ek_ut
 (
m_vues
 + 1),

393 
	`g_msh_vue_ek_por
 (
m_vues
 + 2),

394 
da2
);

396 
	`g_vue_t_boޗn
 (
tu_vue
, 
v_tu
);

397 
	}
}

	@lib/rclib-marshal.h

2 #ide
__rib_msh_MARSHAL_H__


3 
	#__rib_msh_MARSHAL_H__


	)

5 
	~<glib-obje.h
>

7 
G_BEGIN_DECLS


10 
rib_msh_VOID__INT64
 (
GClosu
 *
osu
,

11 
GVue
 *
tu_vue
,

12 
gut
 
n_m_vues
,

13 cڡ 
GVue
 *
m_vues
,

14 
gpor
 
voti_ht
,

15 
gpor
 
msh_da
);

18 
rib_msh_VOID__POINTER_INT64
 (
GClosu
 *
osu
,

19 
GVue
 *
tu_vue
,

20 
gut
 
n_m_vues
,

21 cڡ 
GVue
 *
m_vues
,

22 
gpor
 
voti_ht
,

23 
gpor
 
msh_da
);

26 
rib_msh_VOID__POINTER_POINTER
 (
GClosu
 *
osu
,

27 
GVue
 *
tu_vue
,

28 
gut
 
n_m_vues
,

29 cڡ 
GVue
 *
m_vues
,

30 
gpor
 
voti_ht
,

31 
gpor
 
msh_da
);

34 
rib_msh_VOID__POINTER_STRING
 (
GClosu
 *
osu
,

35 
GVue
 *
tu_vue
,

36 
gut
 
n_m_vues
,

37 cڡ 
GVue
 *
m_vues
,

38 
gpor
 
voti_ht
,

39 
gpor
 
msh_da
);

42 
rib_msh_VOID__STRING_POINTER
 (
GClosu
 *
osu
,

43 
GVue
 *
tu_vue
,

44 
gut
 
n_m_vues
,

45 cڡ 
GVue
 *
m_vues
,

46 
gpor
 
voti_ht
,

47 
gpor
 
msh_da
);

52 
rib_msh_VOID__UINT_POINTER_INT64
 (
GClosu
 *
osu
,

53 
GVue
 *
tu_vue
,

54 
gut
 
n_m_vues
,

55 cڡ 
GVue
 *
m_vues
,

56 
gpor
 
voti_ht
,

57 
gpor
 
msh_da
);

60 
rib_msh_VOID__UINT_INT64_POINTER_INT64
 (
GClosu
 *
osu
,

61 
GVue
 *
tu_vue
,

62 
gut
 
n_m_vues
,

63 cڡ 
GVue
 *
m_vues
,

64 
gpor
 
voti_ht
,

65 
gpor
 
msh_da
);

68 
rib_msh_VOID__UINT_UINT_FLOAT_POINTER
 (
GClosu
 *
osu
,

69 
GVue
 *
tu_vue
,

70 
gut
 
n_m_vues
,

71 cڡ 
GVue
 *
m_vues
,

72 
gpor
 
voti_ht
,

73 
gpor
 
msh_da
);

76 
rib_msh_BOOLEAN__UINT_POINTER
 (
GClosu
 *
osu
,

77 
GVue
 *
tu_vue
,

78 
gut
 
n_m_vues
,

79 cڡ 
GVue
 *
m_vues
,

80 
gpor
 
voti_ht
,

81 
gpor
 
msh_da
);

83 
	gG_END_DECLS


	@lib/rclib-player.c

26 
	~"rib-ay.h
"

27 
	~"rib-comm.h
"

28 
	~"rib-db.h
"

29 
	~"rib-ce.h
"

42 
	s_RCLibPyPrive


44 
RCLibPyRtMode
 
	m_mode
;

45 
RCLibPyRdomMode
 
	mndom_mode
;

46 
gulg
 
	meos_hdr
;

47 
gboޗn
 
	mlim_e
;

48 
gt
 
	mlim_tg
;

49 
gboޗn
 
	mlim_cdi
;

54 
	mSIGNAL_REPEAT_MODE_CHANGED
,

55 
	mSIGNAL_RANDOM_MODE_CHANGED
,

56 
	mSIGNAL_LAST


59 
GObje
 *
	gay_
 = 
NULL
;

60 
gpor
 
	grib_ay__ass
 = 
NULL
;

61 
gt
 
	gay_sigls
[
SIGNAL_LAST
] = {0};

63 
le
 
	$rib_ay_ndom_sg
(
RCLibPyPrive
 *
iv
)

65 
GSequIr
 *

;

66 
GSequ
 *
q
;

67 
gt
 
pos
, 
ngth
;

68 
GSequIr
 *
fܗch_
;

69 
GPAay
 *
_y
;

70 
gt
 
tg
;

71 

 = 
	`rib_ce_g_db_n
();

72 if(

==
NULL
) ;

73 
q
 = 
	`g_qu__g_qu
(

);

74 if(
q
==
NULL
) ;

75 if(
iv
->
lim_e
)

77 
_y
 = 
	`g_r_y_w
();

78 
fܗch_
=
	`g_qu_g_beg_
(
q
);

79 !
	`g_qu__is_d
(
fܗch_
);

80 
fܗch_
=
	`g_qu__xt
(foreach_iter))

82 if(
	`rib_db_ayli_g_tg
(
fܗch_
, &
tg
))

84 if(
iv
->
lim_cdi
)

86 if(
tg
<=
iv
->
lim_tg
)

87 
	`g_r_y_add
(
_y
, 
fܗch_
);

91 if(
tg
>=
iv
->
lim_tg
)

92 
	`g_r_y_add
(
_y
, 
fܗch_
);

96 if(
_y
->
n
==0)

98 
	`rib_ay_ay_db
(

);

99 
	`g_r_y_
(
_y
, 
TRUE
);

102 
pos
 = 
	`g_ndom_t_nge
(0, 
_y
->
n
);

103 

 = 
	`g_r_y_dex
(
_y
, 
pos
);

104 
	`g_r_y_
(
_y
, 
TRUE
);

105 if(

==
NULL
) ;

106 
	`rib_ay_ay_db
(

);

110 
ngth
 = 
	`g_qu_g_ngth
(
q
);

111 if(
ngth
<=0)

113 
	`rib_ay_ay_db
(

);

116 
pos
 = 
	`g_ndom_t_nge
(0, 
ngth
);

117 

 = 
	`g_qu_g___pos
(
q
, 
pos
);

118 if(

==
NULL
) ;

119 
	`rib_ay_ay_db
(

);

121 
	}
}

123 
le
 
	$rib_ay_ndom_l_ay
(
RCLibPyPrive
 *
iv
)

125 
GSequ
 *
log
 = 
NULL
;

126 
GSequIr
 *
log_
 = 
NULL
, *
ayli_
 = NULL;

127 
gt
 
tٮ_ngth
 = 0;

128 
gt
 
pos
, 
ngth
;

129 
gt
 
tg
;

130 
RCLibDbCogDa
 *
log_da
 = 
NULL
;

131 
log
 = 
	`rib_db_g_log
();

132 if(
log
==
NULL
) ;

133 
log_
 = 
	`g_qu_g_beg_
(
log
);

134 !
	`g_qu__is_d
(
log_
);

135 
log_
 = 
	`g_qu__xt
(catalog_iter))

137 
log_da
 = 
	`g_qu_g
(
log_
);

138 if(
log_da
==
NULL
) ;

139 if(
iv
->
lim_e
)

141 
ayli_
 = 
	`g_qu_g_beg_
(

142 
log_da
->
ayli
);

143 !
	`g_qu__is_d
(
ayli_
);

144 
ayli_
 = 
	`g_qu__xt
(playlist_iter))

146 if(!
	`rib_db_ayli_g_tg
(
ayli_
, &
tg
))

148 if(
iv
->
lim_cdi
)

150 if(
tg
<=
iv
->
lim_tg
)

151 
tٮ_ngth
++;

155 if(
tg
>=
iv
->
lim_tg
)

156 
tٮ_ngth
++;

161 
tٮ_ngth
 +
	`g_qu_g_ngth
(
log_da
->
ayli
);

163 if(
tٮ_ngth
<=0) ;

164 
pos
 = 
	`g_ndom_t_nge
(0, 
tٮ_ngth
);

165 if(
iv
->
lim_e

pos
++;

166 
log_
 = 
	`g_qu_g_beg_
(
log
);

167 !
	`g_qu__is_d
(
log_
);

168 
log_
 = 
	`g_qu__xt
(catalog_iter))

170 
log_da
 = 
	`g_qu_g
(
log_
);

171 if(
log_da
==
NULL
) ;

172 if(
iv
->
lim_e
)

174 
ayli_
 = 
	`g_qu_g_beg_
(

175 
log_da
->
ayli
);

176 ;!
	`g_qu__is_d
(
ayli_
);

177 
ayli_
 = 
	`g_qu__xt
(playlist_iter))

179 if(!
	`rib_db_ayli_g_tg
(
ayli_
, &
tg
))

181 if(
iv
->
lim_cdi
)

183 if(
tg
<=
iv
->
lim_tg
)

184 
pos
--;

188 if(
tg
>=
iv
->
lim_tg
)

189 
pos
--;

191 if(
pos
<=0) ;

193 if(
pos
<=0) ;

197 
ngth
 = 
	`g_qu_g_ngth
(
log_da
->
ayli
);

198 if(
ngth
==0) ;

199 if(
pos
>=
ngth
)

200 
pos
-=
ngth
;

203 if(
log_da
==
NULL
) ;

204 
ayli_
 = 
	`g_qu_g___pos
(

205 
log_da
->
ayli
, 
pos
);

210 if(
ayli_
==
NULL
) ;

211 
	`rib_ay_ay_db
(
ayli_
);

212 
	}
}

214 
le
 
	$rib_ay__li
(
RCLibPyPrive
 *
iv
)

216 
GSequIr
 *

;

217 
GSequ
 *
q
;

218 
GSequIr
 *
fܗch_
;

219 
GSequIr
 *
_w
 = 
NULL
;

220 
gt
 
tg
;

221 

 = 
	`rib_ce_g_db_n
();

222 if(

==
NULL
) ;

223 
q
 = 
	`g_qu__g_qu
(

);

224 if(
q
==
NULL
) ;

225 

 = 
	`g_qu__xt
(iter);

226 if(

==
NULL
) ;

227 if(
iv
->
lim_e
)

229 
fܗch_
=

;!
	`g_qu__is_d
(foreach_iter);

230 
fܗch_
=
	`g_qu__xt
(foreach_iter))

232 if(
	`rib_db_ayli_g_tg
(
fܗch_
, &
tg
))

234 if(
iv
->
lim_cdi
)

236 if(
tg
<=
iv
->
lim_tg
)

238 
	`rib_ay_ay_db
(
fܗch_
);

244 if(
tg
>=
iv
->
lim_tg
)

246 
	`rib_ay_ay_db
(
fܗch_
);

252 
fܗch_
=
	`g_qu_g_beg_
(
q
);fܗch_!=

;

253 
fܗch_
=
	`g_qu__xt
(foreach_iter))

255 if(
	`rib_db_ayli_g_tg
(
fܗch_
, &
tg
))

257 if(
iv
->
lim_cdi
)

259 if(
tg
<=
iv
->
lim_tg
)

261 
_w
 = 
fܗch_
;

267 if(
tg
>=
iv
->
lim_tg
)

269 
_w
 = 
fܗch_
;

275 if(
_w
!=
NULL
)

276 
	`rib_ay_ay_db
(
_w
);

280 if(
	`g_qu__is_d
(

))

281 

 = 
	`g_qu_g_beg_
(
q
);

282 
	`rib_ay_ay_db
(

);

284 
	}
}

286 
le
 
	$rib_ay_ay_xt_
(
RCLibPyPrive
 *
iv
,

287 
gboޗn
 
lo
)

289 
RCLibDbCogDa
 *
log_da
;

290 
RCLibDbPyliDa
 *
ayli_da
;

291 
GSequIr
 *

, *
log_
;

292 
GSequIr
 *
fܗch_
;

293 
gt
 
tg
;

294 

 = 
	`rib_ce_g_db_n
();

295 if(

==
NULL
) ;

296 if(
	`g_qu__is_d
(

)) ;

297 
ayli_da
 = 
	`g_qu_g
(

);

298 if(
ayli_da
==
NULL
) ;

299 if(
iv
->
lim_e
)

301 

 = 
	`g_qu__xt
(iter);

302 
fܗch_
=

;!
	`g_qu__is_d
(foreach_iter);

303 
fܗch_
=
	`g_qu__xt
(foreach_iter))

305 if(!
	`rib_db_ayli_g_tg
(
fܗch_
, &
tg
))

307 if(
iv
->
lim_cdi
)

309 if(
tg
<=
iv
->
lim_tg
)

311 
	`rib_ay_ay_db
(
fܗch_
);

317 if(
tg
>=
iv
->
lim_tg
)

319 
	`rib_ay_ay_db
(
fܗch_
);

324 
log_
 = 
ayli_da
->
log
;

325 
log_
 = 
	`g_qu__xt
(catalog_iter);

326 
fܗch_
=
log_
;!
	`g_qu__is_d
(foreach_iter);

327 
fܗch_
=
	`g_qu__xt
(foreach_iter))

329 
log_da
 = 
	`g_qu_g
(
fܗch_
);

330 

 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

331 ;!
	`g_qu__is_d
(

);

332 

=
	`g_qu__xt
(iter))

334 if(!
	`rib_db_ayli_g_tg
(

, &
tg
))

336 if(
iv
->
lim_cdi
)

338 if(
tg
<=
iv
->
lim_tg
)

340 
	`rib_ay_ay_db
(

);

346 if(
tg
>=
iv
->
lim_tg
)

348 
	`rib_ay_ay_db
(

);

354 
fܗch_
 = 
	`g_qu_g_beg_
(
	`rib_db_g_log
());

355 ;
fܗch_
!=
log_
;

356 
fܗch_
=
	`g_qu__xt
(foreach_iter))

358 
log_da
 = 
	`g_qu_g
(
fܗch_
);

359 

 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

360 ;!
	`g_qu__is_d
(

);

361 

=
	`g_qu__xt
(iter))

363 if(!
	`rib_db_ayli_g_tg
(

, &
tg
))

365 if(
iv
->
lim_cdi
)

367 if(
tg
<=
iv
->
lim_tg
)

369 
	`rib_ay_ay_db
(

);

375 if(
tg
>=
iv
->
lim_tg
)

377 
	`rib_ay_ay_db
(

);

386 

 = 
	`g_qu__xt
(iter);

387 if(
	`g_qu__is_d
(

))

389 
log_
 = 
ayli_da
->
log
;

390 
log_
 = 
	`g_qu__xt
(catalog_iter);

391 if(
	`g_qu__is_d
(
log_
))

393 if(!
lo
) ;

394 
log_
 = 
	`g_qu_g_beg_
(

395 
	`rib_db_g_log
());

396 
log_da
 = 
	`g_qu_g
(
log_
);

397 if(
log_da
==
NULL
) ;

398 !
	`g_qu__is_d
(
log_
) &&

399 
	`g_qu_g_ngth
(
log_da
->
ayli
)<=0)

401 
log_
 = 
	`g_qu__xt
(catalog_iter);

402 
log_da
 = 
	`g_qu_g
(
log_
);

403 if(
log_da
==
NULL
) ;

405 if(
	`g_qu__is_d
(
log_
))

407 
log_
 = 
	`g_qu_g_beg_
(

408 
	`rib_db_g_log
());

409 
log_da
 = 
	`g_qu_g
(
log_
);

411 if(
log_da
==
NULL
) ;

412 

 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

413 
	`rib_ay_ay_db
(

);

416 
log_da
 = 
	`g_qu_g
(
log_
);

417 if(
log_da
==
NULL
) ;

418 

 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

419 
ayli_da
 = 
	`g_qu_g
(

);

420 
	`rib_ay_ay_db
(

);

423 
	`rib_ay_ay_db
(

);

425 
	}
}

427 
	$rib_ay_eos_cb
(
RCLibCe
 *
ce
, 
gpor
 
da
)

429 
GSequIr
 *

;

430 
RCLibPy
 *
ay
;

431 
RCLibPyPrive
 *
iv
;

432 if(
da
==
NULL
) ;

433 
ay
 = 
	`RCLIB_PLAYER
(
da
);

434 
iv
 = 
ay
->priv;

435 if(
iv
->
ndom_mode
!=
RCLIB_PLAYER_RANDOM_NONE
)

437 
iv
->
ndom_mode
)

439 
RCLIB_PLAYER_RANDOM_SINGLE
:

440 
	`rib_ay_ndom_sg
(
iv
);

442 
RCLIB_PLAYER_RANDOM_ALL
:

443 
	`rib_ay_ndom_l_ay
(
iv
);

446 
	`rib_ay_ay_xt_
(
iv
, 
FALSE
);

451 
iv
->
_mode
)

453 
RCLIB_PLAYER_REPEAT_SINGLE
:

454 

 = 
	`rib_ce_g_db_n
();

455 if(

!=
NULL
)

456 
	`rib_ay_ay_db
(

);

458 
RCLIB_PLAYER_REPEAT_LIST
:

459 
	`rib_ay__li
(
iv
);

461 
RCLIB_PLAYER_REPEAT_ALL
:

462 
	`rib_ay_ay_xt_
(
iv
, 
TRUE
);

465 
	`rib_ay_ay_xt_
(
iv
, 
FALSE
);

468 
	}
}

470 
	$rib_ay_fize
(
GObje
 *
obje
)

472 
RCLibPyPrive
 *
iv
 = 
	`RCLIB_PLAYER
(
obje
)->priv;

473 
	`rib_ce_sigl_disc
(
iv
->
eos_hdr
);

474 
	`G_OBJECT_CLASS
(
rib_ay__ass
)->
	`fize
(
obje
);

475 
	}
}

477 
GObje
 *
	$rib_ay_cڡru
(
GTy
 
ty
, 
gut
 
n_cڡru_ms
,

478 
GObjeCڡruPam
 *
cڡru_ms
)

480 
GObje
 *
tv
;

481 if(
ay_
!=
NULL
) layer_instance;

482 
tv
 = 
	`G_OBJECT_CLASS
(
rib_ay__ass
)->
cڡru


483 (
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

484 
ay_
 = 
tv
;

485 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
ay_
);

486  
tv
;

487 
	}
}

489 
	$rib_ay_ass_
(
RCLibPyCss
 *
kss
)

491 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

492 
rib_ay__ass
 = 
	`g_ty_ass_ek_
(
kss
);

493 
obje_ass
->
fize
 = 
rib_ay_fize
;

494 
obje_ass
->
cڡru
 = 
rib_ay_cڡru
;

495 
	`g_ty_ass_add_ive
(
kss
, (
RCLibPyPrive
));

505 
ay_sigls
[
SIGNAL_REPEAT_MODE_CHANGED
] = 
	`g_sigl_w
(

506 "-mode-chged", 
RCLIB_TYPE_PLAYER
, 
G_SIGNAL_RUN_FIRST
,

507 
	`G_STRUCT_OFFSET
(
RCLibPyCss
, 
_mode_chged
), 
NULL
, NULL,

508 
g_cosu_msh_VOID__UINT
, 
G_TYPE_NONE
, 1, 
G_TYPE_UINT
, 
NULL
);

518 
ay_sigls
[
SIGNAL_RANDOM_MODE_CHANGED
] = 
	`g_sigl_w
(

519 "ndom-mode-chged", 
RCLIB_TYPE_PLAYER
, 
G_SIGNAL_RUN_FIRST
,

520 
	`G_STRUCT_OFFSET
(
RCLibPyCss
, 
ndom_mode_chged
), 
NULL
, NULL,

521 
g_cosu_msh_VOID__UINT
, 
G_TYPE_NONE
, 1, 
G_TYPE_UINT
, 
NULL
);

522 
	}
}

524 
	$rib_ay__
(
RCLibPy
 *
ay
)

526 
RCLibPyPrive
 *
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
ay
,

527 
RCLIB_TYPE_PLAYER
, 
RCLibPyPrive
);

528 
ay
->
iv
 =riv;

529 
iv
->
_mode
 = 
RCLIB_PLAYER_REPEAT_NONE
;

530 
iv
->
ndom_mode
 = 
RCLIB_PLAYER_RANDOM_NONE
;

531 
iv
->
eos_hdr
 = 
	`rib_ce_sigl_c
("eos",

532 
	`G_CALLBACK
(
rib_ay_eos_cb
), 
ay
);

533 
	}
}

535 
GTy
 
	$rib_ay_g_ty
()

537 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

538 
GTy
 
g_defe_ty_id
;

539 cڡ 
GTyInfo
 
ay_fo
 = {

540 .
ass_size
 = (
RCLibPyCss
),

541 .
ba_
 = 
NULL
,

542 .
ba_fize
 = 
NULL
,

543 .
ass_
 = (
GCssInFunc
)
rib_ay_ass_
,

544 .
ass_fize
 = 
NULL
,

545 .
ass_da
 = 
NULL
,

546 .
_size
 = (
RCLibPy
),

547 .
n_ocs
 = 0,

548 .
_
 = (
GInInFunc
)
rib_ay__


550 if(
	`g___r
(&
g_defe_ty_id__vީe
))

552 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
G_TYPE_OBJECT
,

553 
	`g__ic_rg
("RCLibPy"), &
ay_fo
, 0);

554 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

556  
g_defe_ty_id__vީe
;

557 
	}
}

565 
	$rib_ay_
()

567 
	`g_mesge
("Loadinglayer scheduler....");

568 if(
ay_
!=
NULL
)

570 
	`g_wng
("Player scheduler islreadyoaded!");

573 
ay_
 = 
	`g_obje_w
(
RCLIB_TYPE_PLAYER
, 
NULL
);

574 
	`g_mesge
("Player scheduleroaded.");

575 
	}
}

583 
	$rib_ay_ex
()

585 if(
ay_
!=
NULL

	`g_obje_uef
(player_instance);

586 
ay_
 = 
NULL
;

587 
	`g_mesge
("Player schedulerxited.");

588 
	}
}

598 
GObje
 *
	$rib_ay_g_
()

600  
ay_
;

601 
	}
}

615 
gulg
 
	$rib_ay_sigl_c
(cڡ 
gch
 *
me
,

616 
GClback
 
back
, 
gpor
 
da
)

618 if(
ay_
==
NULL
)  0;

619  
	`g_sigl_c
(
ay_
, 
me
, 
back
, 
da
);

620 
	}
}

632 
	$rib_ay_sigl_disc
(
gulg
 
hdr_id
)

634 if(
ay_
==
NULL
) ;

635 
	`g_sigl_hdr_disc
(
ay_
, 
hdr_id
);

636 
	}
}

646 
	$rib_ay_ay_db
(
GSequIr
 *

)

648 
RCLibDbPyliDa
 *
ayli_da
;

649 if(

==
NULL
) ;

650 
ayli_da
 = 
	`g_qu_g
(

);

651 if(
ayli_da
==
NULL
) ;

652 
	`rib_ce_t_uri_wh_db_f
(
ayli_da
->
uri
, 

);

653 
	`rib_ce_ay
();

654 
	}
}

670 
gboޗn
 
	$rib_ay_ay_ev
(
gboޗn
 
jump
, gboޗ

,

671 
gboޗn
 
lo
)

673 
RCLibDbCogDa
 *
log_da
;

674 
RCLibDbPyliDa
 *
ayli_da
;

675 
GSequIr
 *

, *
log_
;

676 

 = 
	`rib_ce_g_db_n
();

677 if(

==
NULL
 
FALSE
;

678 if(!
	`rib_db_ayli_is_vid_
(

) 
FALSE
;

679 if(
	`g_qu__is_beg
(

))

681 if(!
jump
)

683 if(

)

684 
	`rib_ay_ay_db
(

);

685  
TRUE
;

687 
ayli_da
 = 
	`g_qu_g
(

);

688 if(
ayli_da
==
NULL
 
FALSE
;

689 
log_
 = 
ayli_da
->
log
;

690 if(
	`g_qu__is_beg
(
log_
))

692 if(!
lo
)

694 if(

)

695 
	`rib_ay_ay_db
(

);

696  
TRUE
;

698 
log_
 = 
	`g_qu_g_d_
(
	`rib_db_g_log
());

701 
log_
 = 
	`g_qu__ev
(catalog_iter);

702 
log_da
 = 
	`g_qu_g
(
log_
);

703 if(
log_da
==
NULL
) ;

705 !
	`g_qu__is_beg
(
log_
) &&

706 
	`g_qu_g_ngth
(
log_da
->
ayli
)<=0);

707 if(
log_da
==
NULL
 
FALSE
;

708 

 = 
	`g_qu__ev
(
	`g_qu_g_d_
(

709 
log_da
->
ayli
));

710 
	`rib_ay_ay_db
(

);

711  
TRUE
;

715 if(
	`g_qu__is_beg
(
log_
))

716 
log_
 = 
	`g_qu_g_d_
(

717 
	`rib_db_g_log
());

718 
log_
 = 
	`g_qu__ev
(catalog_iter);

719 
log_da
 = 
	`g_qu_g
(
log_
);

720 if(
log_da
==
NULL
) ;

722 
	`g_qu_g_ngth
(
log_da
->
ayli
)<=0);

723 if(
log_da
==
NULL
 
FALSE
;

724 

 = 
	`g_qu__ev
(
	`g_qu_g_d_
(

725 
log_da
->
ayli
));

726 
ayli_da
 = 
	`g_qu_g
(

);

727 
	`rib_ay_ay_db
(

);

728  
TRUE
;

730 

 = 
	`g_qu__ev
(iter);

731 
	`rib_ay_ay_db
(

);

732  
TRUE
;

733 
	}
}

749 
gboޗn
 
	$rib_ay_ay_xt
(
gboޗn
 
jump
, gboޗ

,

750 
gboޗn
 
lo
)

752 
RCLibDbCogDa
 *
log_da
;

753 
RCLibDbPyliDa
 *
ayli_da
;

754 
GSequIr
 *

, *
log_
;

755 

 = 
	`rib_ce_g_db_n
();

756 if(

==
NULL
 
FALSE
;

757 if(!
	`rib_db_ayli_is_vid_
(

) 
FALSE
;

758 
ayli_da
 = 
	`g_qu_g
(

);

759 if(
ayli_da
==
NULL
 
FALSE
;

760 

 = 
	`g_qu__xt
(iter);

761 if(
	`g_qu__is_d
(

))

763 if(!
jump
)

765 if(

)

766 
	`rib_ay_ay_db
(
	`rib_ce_g_db_n
());

767  
TRUE
;

769 
log_
 = 
ayli_da
->
log
;

770 
log_
 = 
	`g_qu__xt
(catalog_iter);

771 if(
	`g_qu__is_d
(
log_
))

773 if(!
lo
)

775 if(

)

776 
	`rib_ay_ay_db
(
	`rib_ce_g_db_n
());

777  
TRUE
;

779 
log_
 = 
	`g_qu_g_beg_
(

780 
	`rib_db_g_log
());

781 
log_da
 = 
	`g_qu_g
(
log_
);

782 if(
log_da
==
NULL
 
FALSE
;

783 !
	`g_qu__is_d
(
log_
) &&

784 
	`g_qu_g_ngth
(
log_da
->
ayli
)<=0)

786 
log_
 = 
	`g_qu__xt
(catalog_iter);

787 
log_da
 = 
	`g_qu_g
(
log_
);

788 if(
log_da
==
NULL
) ;

790 if(
	`g_qu__is_d
(
log_
))

792 
log_
 = 
	`g_qu_g_beg_
(

793 
	`rib_db_g_log
());

794 
log_da
 = 
	`g_qu_g
(
log_
);

796 if(
log_da
==
NULL
 
FALSE
;

797 

 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

798 
	`rib_ay_ay_db
(

);

799  
TRUE
;

801 
log_da
 = 
	`g_qu_g
(
log_
);

802 if(
log_da
==
NULL
 
FALSE
;

803 

 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

804 
ayli_da
 = 
	`g_qu_g
(

);

805 
	`rib_ay_ay_db
(

);

806  
TRUE
;

808 
	`rib_ay_ay_db
(

);

809  
TRUE
;

810 
	}
}

819 
	$rib_ay_t__mode
(
RCLibPyRtMode
 
mode
)

821 
RCLibPyPrive
 *
iv
;

822 if(
ay_
==
NULL
) ;

823 
iv
 = 
	`RCLIB_PLAYER
(
ay_
)->priv;

824 if(
iv
==
NULL
) ;

825 
iv
->
_mode
 = 
mode
;

826 
	`g_sigl_em
(
ay_
,

827 
ay_sigls
[
SIGNAL_REPEAT_MODE_CHANGED
], 0, 
mode
);

828 
	}
}

837 
	$rib_ay_t_ndom_mode
(
RCLibPyRdomMode
 
mode
)

839 
RCLibPyPrive
 *
iv
;

840 if(
ay_
==
NULL
) ;

841 
iv
 = 
	`RCLIB_PLAYER
(
ay_
)->priv;

842 if(
iv
==
NULL
) ;

843 
iv
->
ndom_mode
 = 
mode
;

844 
	`g_sigl_em
(
ay_
,

845 
ay_sigls
[
SIGNAL_RANDOM_MODE_CHANGED
], 0, 
mode
);

846 
	}
}

856 
RCLibPyRtMode
 
	$rib_ay_g__mode
()

858 
RCLibPyPrive
 *
iv
;

859 if(
ay_
==
NULL
)  0;

860 
iv
 = 
	`RCLIB_PLAYER
(
ay_
)->priv;

861 if(
iv
==
NULL
)  0;

862  
iv
->
_mode
;

863 
	}
}

873 
RCLibPyRdomMode
 
	$rib_ay_g_ndom_mode
()

875 
RCLibPyPrive
 *
iv
;

876 if(
ay_
==
NULL
)  0;

877 
iv
 = 
	`RCLIB_PLAYER
(
ay_
)->priv;

878 if(
iv
==
NULL
)  0;

879  
iv
->
ndom_mode
;

880 
	}
}

894 
	$rib_ay_t_tg_lim
(
gboޗn
 
e
, 
gt
 
tg
,

895 
gboޗn
 
cdi
)

897 
RCLibPyPrive
 *
iv
;

898 if(
ay_
==
NULL
) ;

899 
iv
 = 
	`RCLIB_PLAYER
(
ay_
)->priv;

900 if(
iv
==
NULL
) ;

901 
iv
->
lim_e
 = 
e
;

902 if(
tg
>5.0)ating = 5.0;

903 if(
tg
<0.0)ating = 0.0;

904 
iv
->
lim_tg
 = 
tg
;

905 
iv
->
lim_cdi
 = 
cdi
;

906 
	}
}

918 
gboޗn
 
	$rib_ay_g_tg_lim
(
gt
 *
tg
, 
gboޗn
 *
cdi
)

920 
RCLibPyPrive
 *
iv
;

921 if(
ay_
==
NULL
 
FALSE
;

922 
iv
 = 
	`RCLIB_PLAYER
(
ay_
)->priv;

923 if(
iv
==
NULL
 
FALSE
;

924 if(
tg
!=
NULL
*tg = 
iv
->
lim_tg
;

925 if(
cdi
!=
NULL
*cdi = 
iv
->
lim_cdi
;

926  
iv
->
lim_e
;

927 
	}
}

	@lib/rclib-player.h

25 #ide
HAVE_RCLIB_PLAYER_H


26 
	#HAVE_RCLIB_PLAYER_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<g/g.h
>

32 
	gG_BEGIN_DECLS


34 
	#RCLIB_TYPE_PLAYER
 (
	`rib_ay_g_ty
())

	)

35 
	#RCLIB_PLAYER
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

36 
RCLIB_TYPE_PLAYER
, 
RCLibPy
))

	)

37 
	#RCLIB_PLAYER_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_CAST
((k), \

38 
RCLIB_TYPE_PLAYER
, 
RCLibPyCss
))

	)

39 
	#RCLIB_IS_PLAYER
(
o
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((o), \

40 
RCLIB_TYPE_PLAYER
))

	)

41 
	#RCLIB_IS_PLAYER_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_TYPE
((k), \

42 
RCLIB_TYPE_PLAYER
))

	)

43 
	#RCLIB_PLAYER_GET_CLASS
(
o
(
	`G_TYPE_INSTANCE_GET_CLASS
((o), \

44 
RCLIB_TYPE_PLAYER
, 
RCLibPyCss
))

	)

57 
	mRCLIB_PLAYER_REPEAT_NONE
,

58 
	mRCLIB_PLAYER_REPEAT_SINGLE
,

59 
	mRCLIB_PLAYER_REPEAT_LIST
,

60 
	mRCLIB_PLAYER_REPEAT_ALL


61 }
	tRCLibPyRtMode
;

73 
	mRCLIB_PLAYER_RANDOM_NONE
,

74 
	mRCLIB_PLAYER_RANDOM_SINGLE
,

75 
	mRCLIB_PLAYER_RANDOM_ALL


76 }
	tRCLibPyRdomMode
;

78 
_RCLibPy
 
	tRCLibPy
;

79 
_RCLibPyCss
 
	tRCLibPyCss
;

80 
_RCLibPyPrive
 
	tRCLibPyPrive
;

89 
	s_RCLibPy
 {

91 
GObje
 
	m
;

92 
RCLibPyPrive
 *
	miv
;

101 
	s_RCLibPyCss
 {

103 
GObjeCss
 
	m_ass
;

104 (*
	m_mode_chged
)(
RCLibPy
 *
	may
,

105 
RCLibPyRtMode
 
	mmode
);

106 (*
	mndom_mode_chged
)(
RCLibPy
 *
	may
,

107 
RCLibPyRdomMode
 
	mmode
);

111 
GTy
 
rib_ay_g_ty
();

114 
rib_ay_
();

115 
rib_ay_ex
();

116 
GObje
 *
rib_ay_g_
();

117 
gulg
 
rib_ay_sigl_c
(cڡ 
gch
 *
me
,

118 
GClback
 
back
, 
gpor
 
da
);

119 
rib_ay_sigl_disc
(
gulg
 
hdr_id
);

120 
rib_ay_ay_db
(
GSequIr
 *

);

121 
rib_ay_ay_uri
(cڡ 
gch
 *
uri
);

122 
gboޗn
 
rib_ay_ay_ev
(gboޗ
jump
, gboޗ

,

123 
gboޗn
 
lo
);

124 
gboޗn
 
rib_ay_ay_xt
(gboޗ
jump
, gboޗ

,

125 
gboޗn
 
lo
);

126 
rib_ay_t__mode
(
RCLibPyRtMode
 
mode
);

127 
rib_ay_t_ndom_mode
(
RCLibPyRdomMode
 
mode
);

128 
RCLibPyRtMode
 
rib_ay_g__mode
();

129 
RCLibPyRdomMode
 
rib_ay_g_ndom_mode
();

130 
rib_ay_t_tg_lim
(
gboޗn
 
e
, 
gt
 
tg
,

131 
gboޗn
 
cdi
);

132 
gboޗn
 
rib_ay_g_tg_lim
(
gt
 *
tg
, gboޗ*
cdi
);

134 
	gG_END_DECLS


	@lib/rclib-plugin.c

26 
	~"rib-ug.h
"

27 
	~"rib-comm.h
"

40 
	s_RCLibPlugPrive


42 
GHashTab
 *
	mug_b
;

43 
GHashTab
 *
	mld_b
;

44 
GKeyFe
 *
	mkeyfe
;

45 
gch
 *
	mcfigu_th
;

50 
	mSIGNAL_REGISTERED
,

51 
	mSIGNAL_LOADED
,

52 
	mSIGNAL_UNLOADED
,

53 
	mSIGNAL_UNREGISTERED
,

54 
	mSIGNAL_SHUTDOWN
,

55 
	mSIGNAL_LAST


58 
GObje
 *
	gug_
 = 
NULL
;

59 
gpor
 
	grib_ug__ass
 = 
NULL
;

60 
gt
 
	gug_sigls
[
SIGNAL_LAST
] = {0};

62 
gboޗn
 
	$rib_ug_is_tive
(cڡ *
fame
)

64 cڡ *
ϡ_riod
;

65 
gch
 *
le_
;

66 
gboޗn
 
ag
;

67 
ϡ_riod
 = 
	`chr
(
fame
, '.');

68 if(
ϡ_riod
 =
NULL
 
FALSE
;

69 
le_
 = 
	`g_ascii_rdown
(
ϡ_riod
, -1);

70 
ag
 = (
	`g_rcmp0
(
le_
, ".so")==0) ||

71 (
	`g_rcmp0
(
le_
, ".dll")==0) ||

72 (
	`g_rcmp0
(
le_
, ".sl")==0);

73 
	`g_
(
le_
);

74  
ag
;

75 
	}
}

77 
RCLibPlugLdInfo
 *
	$rib_ug_fd_ld_f_ug
(

78 cڡ 
RCLibPlugDa
 *
ug
)

80 cڡ 
gch
 *
ext
;

81 
gch
 *
le_
;

82 
RCLibPlugLdInfo
 *
ld
 = 
NULL
;

83 
RCLibPlugPrive
 *
iv
;

84 
	`g_tu_v_if_
(
ug
!=
NULL
, NULL);

85 
	`g_tu_v_if_
(
ug_
!=
NULL
, NULL);

86 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

87 
	`g_tu_v_if_
(
iv
!=
NULL
, NULL);

88 if(
iv
->
ld_b
==
NULL
)  NULL;

89 
ext
 = 
	`chr
(
ug
->
th
, '.');

90 if(
ext
==
NULL
)  NULL;

91 if(
	`
(
ext
)<1 
NULL
;

92 
ext
++;

93 
le_
 = 
	`g_ascii_rdown
(
ext
, -1);

94 if(
le_
==
NULL
)  NULL;

95 
ld
 = 
	`g_hash_b_lookup
(
iv
->
ld_b
, 
le_
);

96 
	`g_
(
le_
);

97  
ld
;

98 
	}
}

100 
	$rib_ug_da_
(
RCLibPlugDa
 *
ug
)

102 
RCLibPlugLdInfo
 *
ld
;

103 if(
ug
==
NULL
) ;

104 if(
ug
->
tive
)

106 if(
ug
->
fo
!=
NULL
 &&lug->fo->
deroy
!=NULL)

108 
ug
->
fo
->
	`deroy
(plugin);

110 if(
ug
->
hd
!=
NULL
)

111 
	`g_modu_o
(
ug
->
hd
);

115 
ld
 = 
	`rib_ug_fd_ld_f_ug
(
ug
);

116 if(
ld
!=
NULL
 &&d->
deroy
!=NULL)

117 
ld
->
	`deroy
(
ug
);

119 
	`g_
(
ug
->
r
);

120 
	`g_
(
ug
->
th
);

121 if(
ug
->
ddt_li
!=
NULL
)

122 
	`g_i_
(
ug
->
ddt_li
);

123 
	`g_i_
(
RCLibPlugDa
, 
ug
);

124 
	}
}

126 
le
 
RCLibPlugDa
 *
	$rib_iug_da_w
()

128 
RCLibPlugDa
 *
ug
 = 
	`g_i_w0
(RCLibPluginData);

129 
ug
->
f_cou
 = 1;

130  
ug
;

131 
	}
}

133 
	$rib_ug_fize
(
GObje
 *
obje
)

135 
gch
 *
cf_da
;

136 
gsize
 
cf_size
;

137 
GE
 *
r
 = 
NULL
;

138 
RCLibPlugPrive
 *
iv
 = 
	`RCLIB_PLUGIN
(
obje
)->priv;

139 if(
iv
->
keyfe
!=
NULL
 &&riv->
cfigu_th
!=NULL)

141 
cf_da
 = 
	`g_key_fe_to_da
(
iv
->
keyfe
, &
cf_size
, &
r
);

142 if(
cf_da
!=
NULL
)

144 if(!
	`g_fe_t_cڋs
(
iv
->
cfigu_th
, 
cf_da
,

145 
cf_size
, &
r
))

147 
	`g_wng
("Cannot savelug-in configure datao file: %s",

148 
r
->
mesge
);

149 
	`g_r_
(
r
);

151 
	`g_
(
cf_da
);

155 
	`g_wng
("Cannot savelug-in configure data: %s",

156 
r
->
mesge
);

157 
	`g_r_
(
r
);

160 
	`g_
(
iv
->
cfigu_th
);

161 
	`rib_ug_deroy_l
();

162 if(
iv
->
ug_b
!=
NULL
)

163 
	`g_hash_b_uef
(
iv
->
ug_b
);

164 if(
iv
->
ld_b
!=
NULL
)

165 
	`g_hash_b_uef
(
iv
->
ld_b
);

166 if(
iv
->
keyfe
!=
NULL
)

167 
	`g_key_fe_
(
iv
->
keyfe
);

168 
	`G_OBJECT_CLASS
(
rib_ug__ass
)->
	`fize
(
obje
);

169 
	}
}

171 
GObje
 *
	$rib_ug_cڡru
(
GTy
 
ty
, 
gut
 
n_cڡru_ms
,

172 
GObjeCڡruPam
 *
cڡru_ms
)

174 
GObje
 *
tv
;

175 if(
ug_
!=
NULL
) lugin_instance;

176 
tv
 = 
	`G_OBJECT_CLASS
(
rib_ug__ass
)->
cڡru


177 (
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

178 
ug_
 = 
tv
;

179  
tv
;

180 
	}
}

182 
	$rib_ug_ass_
(
RCLibPlugCss
 *
kss
)

184 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

185 
rib_ug__ass
 = 
	`g_ty_ass_ek_
(
kss
);

186 
obje_ass
->
fize
 = 
rib_ug_fize
;

187 
obje_ass
->
cڡru
 = 
rib_ug_cڡru
;

188 
	`g_ty_ass_add_ive
(
kss
, (
RCLibPlugPrive
));

197 
ug_sigls
[
SIGNAL_REGISTERED
] = 
	`g_sigl_w
("registered",

198 
RCLIB_TYPE_PLUGIN
, 
G_SIGNAL_RUN_FIRST
,

199 
	`G_STRUCT_OFFSET
(
RCLibPlugCss
, 
gied
), 
NULL
, NULL,

200 
g_cosu_msh_VOID__POINTER
, 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
,

201 
NULL
);

210 
ug_sigls
[
SIGNAL_LOADED
] = 
	`g_sigl_w
("loaded",

211 
RCLIB_TYPE_PLUGIN
, 
G_SIGNAL_RUN_FIRST
,

212 
	`G_STRUCT_OFFSET
(
RCLibPlugCss
, 
lded
), 
NULL
, NULL,

213 
g_cosu_msh_VOID__POINTER
, 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
,

214 
NULL
);

223 
ug_sigls
[
SIGNAL_UNLOADED
] = 
	`g_sigl_w
("unloaded",

224 
RCLIB_TYPE_PLUGIN
, 
G_SIGNAL_RUN_FIRST
,

225 
	`G_STRUCT_OFFSET
(
RCLibPlugCss
, 
uded
), 
NULL
, NULL,

226 
g_cosu_msh_VOID__POINTER
, 
G_TYPE_NONE
, 1, 
G_TYPE_POINTER
,

227 
NULL
);

236 
ug_sigls
[
SIGNAL_UNREGISTERED
] = 
	`g_sigl_w
("unregistered",

237 
RCLIB_TYPE_PLUGIN
, 
G_SIGNAL_RUN_FIRST
,

238 
	`G_STRUCT_OFFSET
(
RCLibPlugCss
, 
uegied
), 
NULL
, NULL,

239 
g_cosu_msh_VOID__STRING
, 
G_TYPE_NONE
, 1, 
G_TYPE_STRING
,

240 
NULL
);

250 
ug_sigls
[
SIGNAL_SHUTDOWN
] = 
	`g_sigl_w
("shutdown",

251 
RCLIB_TYPE_PLUGIN
, 
G_SIGNAL_RUN_FIRST
,

252 
	`G_STRUCT_OFFSET
(
RCLibPlugCss
, 
shutdown
), 
NULL
, NULL,

253 
g_cosu_msh_VOID__VOID
, 
G_TYPE_NONE
, 0, G_TYPE_NONE, 
NULL
);

254 
	}
}

256 
	$rib_ug__
(
RCLibPlug
 *
ug
)

258 
RCLibPlugPrive
 *
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
ug
,

259 
RCLIB_TYPE_PLUGIN
, 
RCLibPlugPrive
);

260 
ug
->
iv
 =riv;

261 
iv
->
ug_b
 = 
	`g_hash_b_w_fu
(
g_r_hash
, 
g_r_equ
,

262 
g_
, (
GDeroyNify
)
rib_ug_da_uef
);

263 
iv
->
ld_b
 = 
	`g_hash_b_w_fu
(
g_r_hash
, 
g_r_equ
,

264 
g_
, (
GDeroyNify
)
NULL
);

265 
iv
->
keyfe
 = 
	`g_key_fe_w
();

266 
	}
}

268 
GTy
 
	$rib_ug_g_ty
()

270 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

271 
GTy
 
g_defe_ty_id
;

272 cڡ 
GTyInfo
 
ug_fo
 = {

273 .
ass_size
 = (
RCLibPlugCss
),

274 .
ba_
 = 
NULL
,

275 .
ba_fize
 = 
NULL
,

276 .
ass_
 = (
GCssInFunc
)
rib_ug_ass_
,

277 .
ass_fize
 = 
NULL
,

278 .
ass_da
 = 
NULL
,

279 .
_size
 = (
RCLibPlug
),

280 .
n_ocs
 = 0,

281 .
_
 = (
GInInFunc
)
rib_ug__


283 if(
	`g___r
(&
g_defe_ty_id__vީe
))

285 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
G_TYPE_OBJECT
,

286 
	`g__ic_rg
("RCLibPlug"), &
ug_fo
, 0);

287 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

289  
g_defe_ty_id__vީe
;

290 
	}
}

292 
GTy
 
	$rib_ug_da_g_ty
()

294 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

295 
GTy
 
g_defe_ty_id
;

296 if(
	`g___r
(&
g_defe_ty_id__vީe
))

298 
g_defe_ty_id
 = 
	`g_boxed_ty_gi_ic
(

299 
	`g__ic_rg
("RCLibPluginData"),

300 (
GBoxedCyFunc
)
rib_ug_da_f
,

301 (
GBoxedFeFunc
)
rib_ug_da_uef
);

302 
	`g___ave
 (&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

304  
g_defe_ty_id__vީe
;

305 
	}
}

316 
gboޗn
 
	$rib_ug_
(cڡ 
gch
 *
fe
)

318 
RCLibPlugPrive
 *
iv
;

319 
GE
 *
r
 = 
NULL
;

320 
	`g_mesge
("Loadinglug-in support system....");

321 
ug_
 = 
	`g_obje_w
(
RCLIB_TYPE_PLUGIN
, 
NULL
);

322 if(
fe
!=
NULL
)

324 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

325 if(
	`g_fe_
(
fe
, 
G_FILE_TEST_EXISTS
))

327 if(!
	`g_key_fe_ld_om_fe
(
iv
->
keyfe
, 
fe
,

328 
G_KEY_FILE_NONE
, &
r
))

330 
	`g_wng
("Cannot openlug-in configure file: %s",

331 
r
->
mesge
);

332 
	`g_r_
(
r
);

335 
iv
->
cfigu_th
 = 
	`g_rdup
(
fe
);

337 
	`g_mesge
("Plug-in support systemoaded.");

338  
TRUE
;

339 
	}
}

347 
	$rib_ug_ex
()

349 if(
ug_
!=
NULL
)

351 
	`g_sigl_em
(
ug_
, 
ug_sigls
[
SIGNAL_SHUTDOWN
], 0);

352 
	`g_sigl_hdrs_disc_mched
(
ug_
,

353 
G_SIGNAL_MATCH_ID
, 
ug_sigls
[
SIGNAL_SHUTDOWN
], 0, 
NULL
,

354 
NULL
, NULL);

355 
	`g_obje_uef
(
ug_
);

357 
ug_
 = 
NULL
;

358 
	`g_mesge
("Plug-in support systemxited.");

359 
	}
}

369 
GObje
 *
	$rib_ug_g_
()

371  
ug_
;

372 
	}
}

386 
gulg
 
	$rib_ug_sigl_c
(cڡ 
gch
 *
me
,

387 
GClback
 
back
, 
gpor
 
da
)

389 if(
ug_
==
NULL
)  0;

390  
	`g_sigl_c
(
ug_
, 
me
, 
back
, 
da
);

391 
	}
}

403 
	$rib_ug_sigl_disc
(
gulg
 
hdr_id
)

405 if(
ug_
==
NULL
) ;

406 if(!
	`g_sigl_hdr_is_ced
(
ug_
, 
hdr_id
)) ;

407 
	`g_sigl_hdr_disc
(
ug_
, 
hdr_id
);

408 
	}
}

419 
RCLibPlugDa
 *
	$rib_ug_obe
(cڡ 
gch
 *
fame
)

421 
RCLibPlugDa
 *
ug
 = 
NULL
;

422 
RCLibPlugLdInfo
 *
ld
 = 
NULL
;

423 
	`gboޗn
 (*
ug_
)(
RCLibPlugDa
 *
ug

NULL
;

424 
gpor
 
uued
;

425 
gboޗn
 
tive
;

426 cڡ 
gch
 *
r_msg
;

427 
	`g_tu_v_if_
(
fame
!=
NULL
, NULL);

428 if(!
	`g_fe_
(
fame
, 
G_FILE_TEST_EXISTS
))

429  
NULL
;

430 
tive
 = 
	`rib_ug_is_tive
(
fame
);

431 
ug
 = 
	`rib_iug_da_w
();

432 
ug
->
th
 = 
	`g_rdup
(
fame
);

433 if(
tive
)

435 
ug
->
tive
 = 
TRUE
;

436 
ug
->
hd
 = 
	`g_modu_ݒ
(
fame
, 0);

437 if(
ug
->
hd
==
NULL
)

439 
r_msg
 = 
	`g_modu_r
();

440 if(
r_msg
!=
NULL
)

441 
ug
->
r
 = 
	`g_rdup
(
r_msg
);

443 
ug
->
r
 = 
	`g_rdup
(
	`_
("Unknownrror!"));

444 
	`g_wng
("E whdglug- %s: %s", 
fame
,

445 
ug
->
r
);

446 
ug
->
hd
 = 
	`g_modu_ݒ
(
fame
, 
G_MODULE_BIND_LAZY
);

447 
ug
->
udab
 = 
TRUE
;

448 if(
ug
->
hd
==
NULL
)

449  
ug
;

451 if(!
	`g_modu_symb
(
ug
->
hd
, "rlug_", &
uued
))

453 
	`g_wng
("Plug-in %s isot usable, because 'rcplugin_init' "

455 "RCPLUGIN_INIT_PLUGIN()?", 
fame
);

456 
	`g_modu_o
(
ug
->
hd
);

457 
r_msg
 = 
	`g_modu_r
();

458 
ug
->
hd
 = 
NULL
;

459 
ug
->
udab
 = 
TRUE
;

460 
ug
->
r
 = 
	`g_rdup_tf
(
	`_
("Cannot find symbol "

461 "'rlug_' ithug- %s"), 
fame
);

462  
ug
;

464 
ug_
 = 
uued
;

468 
ug
->
tive
 = 
FALSE
;

469 
ld
 = 
	`rib_ug_fd_ld_f_ug
(
ug
);

470 if(
ld
==
NULL
 ||d->
obe
==NULL)

472 
ug
->
udab
 = 
TRUE
;

473  
ug
;

475 
ug_
 = 
ld
->
obe
;

477 if(
ug_
==
NULL
)

479 
ug
->
udab
 = 
TRUE
;

480  
ug
;

482 if(!
	`ug_
(
ug
))

484 
ug
->
r
 = 
	`g_rdup
(
	`_
("Cannot initializehelug-in!"));

485 
	`g_wng
("Plug % blized!", 
fame
);

486 
ug
->
udab
 = 
TRUE
;

487  
ug
;

489 if(
ug
->
fo
==
NULL
)

491 
ug
->
r
 = 
	`g_rdup
(
	`_
("Thislug-in doesot have info data!"));

492 
	`g_wng
("Plug %d۠n havfda!", 
fame
);

493 
ug
->
udab
 = 
TRUE
;

494  
ug
;

496 if(
ug
->
fo
->
id
==
NULL
 || 
	`
(plugin->info->id)==0)

498 
ug
->
r
 = 
	`g_rdup
(
	`_
("Thislug-in hasot definedn ID!"));

499 
	`g_wng
("Plug %han defedID!", 
fame
);

500 
ug
->
udab
 = 
TRUE
;

501  
ug
;

503 if(
ug
->
fo
->
magic
!=
RCLIB_PLUGIN_MAGIC
)

505 
ug
->
r
 = 
	`g_rdup
(
	`_
("Thislugin has wrong magicumber!"));

506 
	`g_wng
("Plug %hawrg maginumb!", 
fame
);

507 
ug
->
udab
 = 
TRUE
;

508  
ug
;

510 if(
ug
->
fo
->
maj_vsi
!=
RCLIB_PLUGIN_MAJOR_VERSION
 ||

511 
ug
->
fo
->
m_vsi
>
RCLIB_PLUGIN_MINOR_VERSION
)

513 
ug
->
r
 = 
	`g_rdup_tf
(
	`_
("ABI version mismatch %d.%d.x "

514 "ғd %d.%d.x)"), 
ug
->
fo
->
maj_vsi
,

515 
ug
->
fo
->
m_vsi
, 
RCLIB_PLUGIN_MAJOR_VERSION
,

516 
RCLIB_PLUGIN_MINOR_VERSION
);

517 
	`g_wng
("Plug-in %s isotoadable: ABI version mismatch %d.%d.x "

518 "ғd %d.%d.x)", 
fame
, 
ug
->
fo
->
maj_vsi
,

519 
ug
->
fo
->
m_vsi
, 
RCLIB_PLUGIN_MAJOR_VERSION
,

520 
RCLIB_PLUGIN_MINOR_VERSION
);

521 
ug
->
udab
 = 
TRUE
;

522  
ug
;

524  
ug
;

525 
	}
}

536 
gboޗn
 
	$rib_ug_gi
(
RCLibPlugDa
 *
ug
)

538 
RCLibPlugPrive
 *
iv
;

539 
RCLibPlugLdInfo
 *
ld
;

540 cڡ 
gch
 * cڡ *
exts
;

541 
	`g_tu_v_if_
(
ug
!=
NULL
, 
FALSE
);

542 
	`g_tu_v_if_
(
ug_
!=
NULL
, 
FALSE
);

543 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

544 
	`g_tu_v_if_
(
iv
!=
NULL
, 
FALSE
);

545 if(
ug
->
fo
==
NULL
 
FALSE
;

546 if(
ug
->
fo
->
id
==
NULL
 || 
	`
(plugin->info->id)==0)

547  
FALSE
;

548 if(
ug
->
udab
)

549  
FALSE
;

550 if(
	`g_hash_b_lookup
(
iv
->
ug_b
, 
ug
->
fo
->
id
)!=
NULL
)

552 
ug
->
udab
 = 
TRUE
;

553  
FALSE
;

555 if(
ug
->
fo
->
ty
==
RCLIB_PLUGIN_TYPE_LOADER
)

557 if(
ug
->
fo
->
exa_fo
==
NULL
 
FALSE
;

558 
ld
 = 
ug
->
fo
->
exa_fo
;

559 if(
ld
->
exnsis
==
NULL
 
FALSE
;

560 
exts
=
ld
->
exnsis
;*exts!=
NULL
;exts++)

562 
	`g_hash_b_
(
iv
->
ld_b
, 
	`g_rdup
(*
exts
),

563 
ld
);

566 if(
iv
->
keyfe
!=
NULL
)

568 if(!
	`g_key_fe_has_key
(
iv
->
keyfe
, 
ug
->
fo
->
id
, "Enabled",

569 
NULL
))

571 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
ug
->
fo
->
id
,

572 "Ebd", 
FALSE
);

575 
	`g_hash_b_
(
iv
->
ug_b
, 
	`g_rdup
(
ug
->
fo
->
id
),

576 
	`rib_ug_da_f
(
ug
));

577 
	`g_sigl_em
(
ug_
, 
ug_sigls
[
SIGNAL_REGISTERED
], 0,

578 
ug
);

579  
TRUE
;

580 
	}
}

591 
RCLibPlugDa
 *
	$rib_ug_da_f
(
RCLibPlugDa
 *
ug
)

593 if(
ug
==
NULL
)  NULL;

594 
	`g_omic_t_add
(&(
ug
->
f_cou
), 1);

595  
ug
;

596 
	}
}

606 
	$rib_ug_da_uef
(
RCLibPlugDa
 *
ug
)

608 if(
ug
==
NULL
) ;

609 if(
	`g_omic_t_dec_d_
(&(
ug
->
f_cou
)))

610 
	`rib_ug_da_
(
ug
);

611 
	}
}

622 
gut
 
	$rib_ug_ld_om_d
(cڡ 
gch
 *
dme
)

624 
gut
 
numb
 = 0;

625 
GD
 *
gd
;

626 
GE
 *
r
 = 
NULL
;

627 cڡ 
gch
 *
fame
;

628 
gch
 *
th
;

629 
GSLi
 *
_li
 = 
NULL
, *
fܗch
;

630 
RCLibPlugDa
 *
ug_da
;

631 if(
dme
==
NULL
)  0;

632 
gd
 = 
	`g_d_ݒ
(
dme
, 0, &
r
);

633 if(
gd
==
NULL
)

635 
	`g_wng
("Cn oug- dey: %s", 
r
->
mesge
);

636 
	`g_r_
(
r
);

639 
	`g_mesge
("Srchglug- dey: %s", 
dme
);

640 (
fame
=
	`g_d_ad_me
(
gd
))!=
NULL
)

642 
th
 = 
	`g_bud_fame
(
dme
, 
fame
, 
NULL
);

643 if(
	`rib_ug_is_tive
(
fame
))

645 
ug_da
 = 
	`rib_ug_obe
(
th
);

646 if(
ug_da
!=
NULL
)

648 if(
ug_da
->
hd
!=
NULL
 && !ug_da->
udab
)

650 if(
	`rib_ug_gi
(
ug_da
))

652 
	`g_mesge
("Plug-in: %s initialized.",

653 
ug_da
->
fo
->
id
);

654 
numb
++;

657 
	`rib_ug_da_uef
(
ug_da
);

662 
_li
 = 
	`g_i_d
p_li, 
	`g_rdup
(
th
));

664 
	`g_
(
th
);

666 
	`g_d_o
(
gd
);

667 
fܗch
=
_li
;fܗch!=
NULL
;fܗch=
	`g_i_xt
(foreach))

669 
th
 = 
fܗch
->
da
;

670 
ug_da
 = 
	`rib_ug_obe
(
th
);

671 if(
ug_da
!=
NULL
)

673 if(
ug_da
->
hd
!=
NULL
 && !ug_da->
udab
)

675 if(
	`rib_ug_gi
(
ug_da
))

677 
	`g_mesge
("Plug-in: %s initialized.",

678 
ug_da
->
fo
->
id
);

679 
numb
++;

682 
	`rib_ug_da_uef
(
ug_da
);

685 
	`g_i__fu
(
_li
, 
g_
);

686 
	`g_mesge
("Found %ulug-hdey.", 
numb
);

687  
numb
;

688 
	}
}

699 
gboޗn
 
	$rib_ug_ld
(
RCLibPlugDa
 *
ug
)

701 
RCLibPlugPrive
 *
iv
;

702 
RCLibPlugLdInfo
 *
ld
;

703 
RCLibPlugDa
 *
d_ug
;

704 
gch
 **
ds
;

705 
GSLi
 *
d_li
 = 
NULL
, *
fܗch
 = NULL;

706 
	`g_tu_v_if_
(
ug
!=
NULL
, 
FALSE
);

707 if(
ug
->
lded
 
TRUE
;

708 if(
ug
->
udab
 
FALSE
;

709 if(
ug
->
r
!=
NULL
 
FALSE
;

710 if(
ug
->
fo
==
NULL
 
FALSE
;

713 
ds
=
ug
->
fo
->
dds
;ds!=
NULL
 && *deps!=NULL;deps++)

715 
d_ug
 = 
	`rib_ug_lookup
(*
ds
);

716 if(
d_ug
==
NULL
)

718 if(
d_li
!=
NULL

	`g_i_
(dep_list);

719 
	`g_wng
("Necessarylug-in forlug-in %s is missing!",

720 
ug
->
fo
->
id
);

721  
FALSE
;

723 
d_li
 = 
	`g_i_d
(d_li, 
d_ug
);

727 
fܗch
=
d_li
;fܗch!=
NULL
;fܗch=
	`g_i_xt
(foreach))

729 
d_ug
 = 
fܗch
->
da
;

730 if(
d_ug
==
NULL
) ;

731 if(
d_ug
->
lded
) ;

732 if(
d_ug
!=
ug
)

734 if(!
	`rib_ug_ld
(
d_ug
))

736 
	`g_i_
(
d_li
);

737 
	`g_wng
("Cannotoadecessarylug-in forlug-in %s!",

738 
ug
->
fo
->
id
);

739  
FALSE
;

745 
fܗch
=
d_li
;fܗch!=
NULL
;fܗch=
	`g_i_xt
(foreach))

747 
d_ug
 = 
fܗch
->
da
;

748 if(
d_ug
==
NULL
) ;

749 
d_ug
->
ddt_li
 = 
	`g_i_d
(

750 
d_ug
->
ddt_li
, 
ug
->
fo
->
id
);

752 if(
d_li
!=
NULL

	`g_i_
(dep_list);

754 if(
ug
->
tive
)

760 if(
ug
->
fo
->
ld
==
NULL
 
TRUE
;

761 if(!
ug
->
fo
->
	`ld
lug) 
FALSE
;

765 
ld
 = 
	`rib_ug_fd_ld_f_ug
(
ug
);

766 if(
ld
==
NULL
 ||d->
ld
==NULL 
FALSE
;

767 if(!
ld
->
	`ld
(
ug
) 
FALSE
;

769 
ug
->
lded
 = 
TRUE
;

770 if(
ug_
!=
NULL
)

772 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

773 if(
iv
!=
NULL
 &&riv->
keyfe
!=NULL)

775 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
ug
->
fo
->
id
,

776 "Ebd", 
TRUE
);

779 
	`g_sigl_em
(
ug_
, 
ug_sigls
[
SIGNAL_LOADED
], 0,

780 
ug
);

781  
TRUE
;

782 
	}
}

793 
gboޗn
 
	$rib_ug_ud
(
RCLibPlugDa
 *
ug
)

795 
RCLibPlugPrive
 *
iv
;

796 
RCLibPlugLdInfo
 *
ld
;

797 
RCLibPlugDa
 *
d_ug
;

798 
GSLi
 *
fܗch
 = 
NULL
;

799 
gch
 **
ds
;

800 
	`g_tu_v_if_
(
ug
!=
NULL
, 
FALSE
);

801 if(!
ug
->
lded
 
TRUE
;

802 if(
ug
->
udab
 
FALSE
;

803 if(
ug
->
r
!=
NULL
 
FALSE
;

804 if(
ug
->
fo
==
NULL
 
FALSE
;

807 
fܗch
=
ug
->
ddt_li
;fܗch!=
NULL
;

808 
fܗch
=
	`g_i_xt
(foreach))

810 
d_ug
 = 
fܗch
->
da
;

811 if(
d_ug
==
NULL
) ;

812 if(!
	`rib_ug_ud
(
d_ug
))

814 
	`g_wng
("Unableo unloadlug-ins which depend onlugin: %s!",

815 
ug
->
fo
->
id
);

816  
FALSE
;

821 
ds
=
ug
->
fo
->
dds
;ds!=
NULL
 && *deps!=NULL;deps++)

823 
d_ug
 = 
	`rib_ug_lookup
(*
ds
);

824 if(
d_ug
!=
NULL
)

826 
d_ug
->
ddt_li
 = 
	`g_i_move
(

827 
d_ug
->
ddt_li
, 
ug
->
fo
->
id
);

831 if(
ug
->
tive
)

837 if(
ug
->
fo
->
ud
==
NULL
 
TRUE
;

838 if(!
ug
->
fo
->
	`ud
lug) 
FALSE
;

842 
ld
 = 
	`rib_ug_fd_ld_f_ug
(
ug
);

843 if(
ld
==
NULL
 ||d->
ud
==NULL 
FALSE
;

844 if(!
ld
->
	`ud
(
ug
) 
FALSE
;

846 
ug
->
lded
 = 
FALSE
;

847 if(
ug_
!=
NULL
)

849 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

850 if(
iv
!=
NULL
 &&riv->
keyfe
!=NULL)

852 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
ug
->
fo
->
id
,

853 "Ebd", 
FALSE
);

856 
	`g_sigl_em
(
ug_
, 
ug_sigls
[
SIGNAL_UNLOADED
], 0,

857 
ug
);

858  
TRUE
;

859 
	}
}

870 
gboޗn
 
	$rib_ug_ld
(
RCLibPlugDa
 *
ug
)

872 if(
ug
==
NULL
 
FALSE
;

873 if(!
ug
->
lded
 
FALSE
;

874 if(!
	`rib_ug_ud
(
ug
) 
FALSE
;

875 if(!
	`rib_ug_ld
(
ug
) 
FALSE
;

876  
TRUE
;

877 
	}
}

888 
gboޗn
 
	$rib_ug_is_lded
(
RCLibPlugDa
 *
ug
)

890 if(
ug
==
NULL
 
FALSE
;

891  
ug
->
lded
;

892 
	}
}

901 
	$rib_ug_deroy
(
RCLibPlugDa
 *
ug
)

903 
RCLibPlugPrive
 *
iv
;

904 
RCLibPlugLdInfo
 *
ld
;

905 cڡ 
gch
 * cڡ *
exts
;

906 
gch
 *
id
;

907 if(
ug
==
NULL
) ;

908 if(
ug_
==
NULL
) ;

909 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

910 if(
iv
==
NULL
 ||riv->
ug_b
==NULL) ;

911 if(
ug
->
lded

	`rib_ug_ud
(plugin);

912 if(!
ug
->
udab
 &&lug->
fo
!=
NULL
 &&

913 
iv
->
ld_b
!=
NULL
 && 
ug
->
fo
->
exa_fo
!=NULL &&

914 
ug
->
fo
->
ty
==
RCLIB_PLUGIN_TYPE_LOADER
)

916 
ld
 = 
ug
->
fo
->
exa_fo
;

917 
exts
=
ld
->
exnsis
;exts!=
NULL
 && *exts!=NULL;exts++)

919 
	`g_hash_b_move
(
iv
->
ld_b
, *
exts
);

922 
id
 = 
	`g_rdup
(
ug
->
fo
->id);

923 
	`g_hash_b_move
(
iv
->
ug_b
, 
ug
->
fo
->
id
);

924 
	`g_sigl_em
(
ug_
, 
ug_sigls
[
SIGNAL_UNREGISTERED
], 0,

925 
id
);

926 
	`g_
(
id
);

927 
	`rib_ug_da_
(
ug
);

928 
	}
}

939 
	$rib_ug_fܗch
(
GHFunc
 
func
, 
gpor
 
da
)

941 
RCLibPlugPrive
 *
iv
;

942 if(
func
==
NULL
) ;

943 if(
ug_
==
NULL
) ;

944 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

945 if(
iv
==
NULL
 ||riv->
ug_b
==NULL) ;

946 
	`g_hash_b_fܗch
(
iv
->
ug_b
, 
func
, 
da
);

947 
	}
}

958 
RCLibPlugDa
 *
	$rib_ug_lookup
(cڡ 
gch
 *
id
)

960 
RCLibPlugPrive
 *
iv
;

961 if(
id
==
NULL
)  NULL;

962 if(
ug_
==
NULL
)  NULL;

963 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

964 if(
iv
==
NULL
 ||riv->
ug_b
==NULL)  NULL;

965  
	`g_hash_b_lookup
(
iv
->
ug_b
, 
id
);

966 
	}
}

974 
	$rib_ug_deroy_l
()

976 
RCLibPlugPrive
 *
iv
;

977 
RCLibPlugDa
 *
ug_da
;

978 
GHashTabIr
 

;

979 
GSLi
 *
tive_li
 = 
NULL
, *
n_tive_li
 = NULL;

980 
GSLi
 *
ld_li
 = 
NULL
;

981 if(
ug_
==
NULL
) ;

982 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

983 if(
iv
==
NULL
 ||riv->
ug_b
==NULL) ;

984 
	`g_hash_b__
(&

, 
iv
->
ug_b
);

985 
	`g_hash_b__xt
(&

, 
NULL
, (
gpor
 *)&
ug_da
))

987 if(
ug_da
==
NULL
) ;

988 if(
ug_da
->
tive
)

990 if(
ug_da
->
fo
->
ty
==
RCLIB_PLUGIN_TYPE_LOADER
)

991 
ld_li
 = 
	`g_i_d
(loader_list,

992 
	`rib_ug_da_f
(
ug_da
));

994 
tive_li
 = 
	`g_i_d
(native_list,

995 
	`rib_ug_da_f
(
ug_da
));

998 
n_tive_li
 = 
	`g_i_d
(non_native_list,

999 
	`rib_ug_da_f
(
ug_da
));

1001 
	`g_hash_b_move_l
(
iv
->
ug_b
);

1002 
	`g_i__fu
(
n_tive_li
, (
GDeroyNify
)
rib_ug_deroy
);

1003 
	`g_i__fu
(
tive_li
, (
GDeroyNify
)
rib_ug_deroy
);

1004 
	`g_i__fu
(
ld_li
, (
GDeroyNify
)
rib_ug_deroy
);

1005 
	}
}

1013 
	$rib_ug_ld_om_cfigu
()

1015 
RCLibPlugPrive
 *
iv
;

1016 
gch
 *
key
;

1017 
RCLibPlugDa
 *
ug_da
;

1018 
GHashTabIr
 

;

1019 
gboޗn
 
ag
;

1020 if(
ug_
==
NULL
) ;

1021 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

1022 if(
iv
==
NULL
 ||riv->
keyfe
==NULL) ;

1023 
	`g_hash_b__
(&

, 
iv
->
ug_b
);

1024 
	`g_hash_b__xt
(&

, (
gpor
 *)&
key
,

1025 (
gpor
 *)&
ug_da
))

1027 if(
key
==
NULL
 || 
ug_da
==NULL) ;

1028 
ag
 = 
	`g_key_fe_g_boޗn
(
iv
->
keyfe
, 
key
, "Ebd", 
NULL
);

1029 if(
ag

	`rib_ug_ld
(
ug_da
);

1031 
	}
}

1041 
GKeyFe
 *
	$rib_ug_g_keyfe
()

1043 
RCLibPlugPrive
 *
iv
;

1044 if(
ug_
==
NULL
)  NULL;

1045 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

1046 if(
iv
==
NULL
)  NULL;

1047  
iv
->
keyfe
;

1048 
	}
}

1059 
gboޗn
 
	$rib_ug_is_gied
(cڡ 
gch
 *
id
)

1061 
RCLibPlugPrive
 *
iv
;

1062 if(
id
==
NULL
 
FALSE
;

1063 if(
ug_
==
NULL
 
FALSE
;

1064 
iv
 = 
	`RCLIB_PLUGIN
(
ug_
)->priv;

1065 if(
iv
==
NULL
 ||riv->
ug_b
==NULL 
FALSE
;

1066  (
	`g_hash_b_lookup
(
iv
->
ug_b
, 
id
)!=
NULL
);

1067 
	}
}

	@lib/rclib-plugin.h

25 #ide
HAVE_RCLIB_PLUGIN_H


26 
	#HAVE_RCLIB_PLUGIN_H


	)

28 
	~<glib.h
>

29 
	~<gmodu.h
>

30 
	~<glib-obje.h
>

31 
	~<g/g.h
>

33 
	gG_BEGIN_DECLS


35 
	#RCLIB_PLUGIN_MAGIC
 0x20120617

	)

36 
	#RCLIB_PLUGIN_MAJOR_VERSION
 2

	)

37 
	#RCLIB_PLUGIN_MINOR_VERSION
 0

	)

39 
	#RCLIB_TYPE_PLUGIN
 (
	`rib_ug_g_ty
())

	)

40 
	#RCLIB_PLUGIN
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

41 
RCLIB_TYPE_PLUGIN
, 
RCLibPlug
))

	)

42 
	#RCLIB_PLUGIN_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_CAST
((k), \

43 
RCLIB_TYPE_PLUGIN
, 
RCLibPlugCss
))

	)

44 
	#RCLIB_IS_PLUGIN
(
o
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((o), \

45 
RCLIB_TYPE_PLUGIN
))

	)

46 
	#RCLIB_IS_PLUGIN_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_TYPE
((k), \

47 
RCLIB_TYPE_PLUGIN
))

	)

48 
	#RCLIB_PLUGIN_GET_CLASS
(
o
(
	`G_TYPE_INSTANCE_GET_CLASS
((o), \

49 
RCLIB_TYPE_PLUGIN
, 
RCLibPlugCss
))

	)

51 
	#RCLIB_TYPE_PLUGIN_DATA
 (
	`rib_ug_da_g_ty
())

	)

64 
	#RCPLUGIN_INIT_PLUGIN
(
ugme
, 
func
, 
ugfo
) \

65 
G_MODULE_EXPORT
 
gboޗn
 
	`rlug_
(
RCLibPlugDa
 *
ug
) \

67 
ug
->
fo
 = &(
ugfo
); \

68 if(
ug
->
fo
==
NULL
 ||lug->fo->
id
==NULL 
FALSE
; \

69 if(
	`rib_ug_is_gied
(
ug
->
fo
->
id
) 
FALSE
; \

70  
	`func
((
ug
)); \

71 }

	)

83 
	mRCLIB_PLUGIN_TYPE_UNKNOWN
 = 0,

84 
	mRCLIB_PLUGIN_TYPE_MODULE
 = 1,

85 
	mRCLIB_PLUGIN_TYPE_LOADER
 = 2

86 }
	tRCLibPlugTy
;

88 
_RCLibPlugInfo
 
	tRCLibPlugInfo
;

89 
_RCLibPlugLdInfo
 
	tRCLibPlugLdInfo
;

90 
_RCLibPlugDa
 
	tRCLibPlugDa
;

91 
_RCLibPlug
 
	tRCLibPlug
;

92 
_RCLibPlugCss
 
	tRCLibPlugCss
;

93 
_RCLibPlugPrive
 
	tRCLibPlugPrive
;

117 
	s_RCLibPlugInfo
 {

118 
gut32
 
	mmagic
;

119 
gut32
 
	mmaj_vsi
;

120 
gut32
 
	mm_vsi
;

121 
RCLibPlugTy
 
	mty
;

122 
gch
 *
	mid
;

123 
gch
 *
	mme
;

124 
gch
 *
	mvsi
;

125 
gch
 *
	mdesti
;

126 
gch
 *
	mauth
;

127 
gch
 *
	mhomage
;

128 
gboޗn
 (*
ld
)(
RCLibPlugDa
 *
	mug
);

129 
gboޗn
 (*
ud
)(
RCLibPlugDa
 *
	mug
);

130 (*
	mderoy
)(
RCLibPlugDa
 *
	mug
);

131 
gboޗn
 (*
cfigu
)(
RCLibPlugDa
 *
	mug
);

132 
gch
 **
	mdds
;

133 
gpor
 
	mexa_fo
;

146 
	s_RCLibPlugLdInfo
 {

147 cڡ 
gch
 * cڡ *
	mexnsis
;

148 
gboޗn
 (*
obe
)(
RCLibPlugDa
 *
	mug
);

149 
gboޗn
 (*
ld
)(
RCLibPlugDa
 *
	mug
);

150 
gboޗn
 (*
ud
)(
RCLibPlugDa
 *
	mug
);

151 (*
	mderoy
)(
RCLibPlugDa
 *
	mug
);

170 
	s_RCLibPlugDa
 {

172 
gt
 
	mf_cou
;

175 
gboޗn
 
	mtive
;

176 
gboޗn
 
	mlded
;

177 
gpor
 
	mhd
;

178 
gch
 *
	mth
;

179 
RCLibPlugInfo
 *
	mfo
;

180 
gch
 *
	mr
;

181 
gboޗn
 
	mudab
;

182 
GSLi
 *
	mddt_li
;

183 
gpor
 
	mexa
;

184 
gpor
 
	mc_da
;

187 (*
	m_rib_ug_rved1
)();

188 (*
	m_rib_ug_rved2
)();

189 (*
	m_rib_ug_rved3
)();

190 (*
	m_rib_ug_rved4
)();

200 
	s_RCLibPlug
 {

202 
GObje
 
	m
;

203 
RCLibPlugPrive
 *
	miv
;

212 
	s_RCLibPlugCss
 {

214 
GObjeCss
 
	m_ass
;

215 (*
	mgied
)(
RCLibPlug
 *
	mug
, cڡ 
RCLibPlugDa
 *
	mda
);

216 (*
	mlded
)(
RCLibPlug
 *
	mug
, cڡ 
RCLibPlugDa
 *
	mda
);

217 (*
	muded
)(
RCLibPlug
 *
	mug
, cڡ 
RCLibPlugDa
 *
	mda
);

218 (*
	muegied
)(
RCLibPlug
 *
	mug
, cڡ 
gch
 *
	mid
);

219 (*
	mshutdown
)(
RCLibPlug
 *
	mug
);

223 
GTy
 
rib_ug_g_ty
();

224 
GTy
 
rib_ug_da_g_ty
();

227 
gboޗn
 
rib_ug_
(cڡ 
gch
 *
fe
);

228 
rib_ug_ex
();

229 
GObje
 *
rib_ug_g_
();

230 
gulg
 
rib_ug_sigl_c
(cڡ 
gch
 *
me
,

231 
GClback
 
back
, 
gpor
 
da
);

232 
rib_ug_sigl_disc
(
gulg
 
hdr_id
);

233 
RCLibPlugDa
 *
rib_ug_obe
(cڡ 
gch
 *
fame
);

234 
gboޗn
 
rib_ug_gi
(
RCLibPlugDa
 *
ug
);

235 
RCLibPlugDa
 *
rib_ug_da_f
(RCLibPlugD*
ug
);

236 
rib_ug_da_uef
(
RCLibPlugDa
 *
ug
);

237 
gut
 
rib_ug_ld_om_d
(cڡ 
gch
 *
dme
);

238 
gboޗn
 
rib_ug_ld
(
RCLibPlugDa
 *
ug
);

239 
gboޗn
 
rib_ug_ud
(
RCLibPlugDa
 *
ug
);

240 
gboޗn
 
rib_ug_ld
(
RCLibPlugDa
 *
ug
);

241 
gboޗn
 
rib_ug_is_lded
(
RCLibPlugDa
 *
ug
);

242 
rib_ug_deroy
(
RCLibPlugDa
 *
ug
);

243 
rib_ug_fܗch
(
GHFunc
 
func
, 
gpor
 
da
);

244 
RCLibPlugDa
 *
rib_ug_lookup
(cڡ 
gch
 *
id
);

245 
rib_ug_deroy_l
();

246 
rib_ug_ld_om_cfigu
();

247 
GKeyFe
 *
rib_ug_g_keyfe
();

248 
gboޗn
 
rib_ug_is_gied
(cڡ 
gch
 *
id
);

250 
	gG_END_DECLS


	@lib/rclib-settings.c

26 
	~"rib-gs.h
"

27 
	~"rib-comm.h
"

28 
	~"rib-ce.h
"

29 
	~"rib-ay.h
"

30 
	~"rib-ut.h
"

31 
	~"rib-lyric.h
"

32 
	~"rib-g.h
"

33 
	~"rib-db.h
"

52 
GKeyFe
 *
	ggs_keyfe
 = 
NULL
;

53 
gch
 *
	ggs_th
 = 
NULL
;

54 
gboޗn
 
	ggs_dty
 = 
FALSE
;

56 
gboޗn
 
	$rib_gs_ld
(cڡ 
gch
 *
fame
)

58 
GE
 *
r
 = 
NULL
;

59 if(
gs_keyfe
==
NULL
 || 
fame
==NULL 
FALSE
;

60 if(
	`g_key_fe_ld_om_fe
(
gs_keyfe
, 
fame
,

61 
G_KEY_FILE_NONE
, &
r
))

63 
gs_dty
 = 
FALSE
;

64 
	`g_mesge
("Settings file has beenoaded.");

65  
TRUE
;

69 
	`g_wng
("Stgf blded: %s", 
r
->
mesge
);

70 
	`g_r_
(
r
);

71  
FALSE
;

73 
	}
}

75 
	$rib_gs_ve
(cڡ 
gch
 *
fame
)

77 
GE
 *
r
 = 
NULL
;

78 
gch
 *
gs_da
 = 
NULL
;

79 
gsize
 
gs_da_ngth
;

80 if(
gs_keyfe
==
NULL
 || 
fame
==NULL) ;

81 
gs_da
 = 
	`g_key_fe_to_da
(
gs_keyfe
,

82 &
gs_da_ngth
, 
NULL
);

83 if(
	`g_fe_t_cڋs
(
fame
, 
gs_da
, 
gs_da_ngth
,

84 &
r
))

86 
	`g_mesge
("Settings file has been saved.");

90 
	`g_wng
("Stgf bved: %s", 
r
->
mesge
);

91 
	`g_r_
(
r
);

93 
	`g_
(
gs_da
);

94 
gs_dty
 = 
FALSE
;

95 
	}
}

105 
gboޗn
 
	$rib_gs_
()

107 
gdoub
 
eq_y
[10] = {0.0};

108 if(
gs_keyfe
!=
NULL
)

110 
	`g_wng
("Settings module islreadyoaded!");

111  
FALSE
;

113 
	`g_mesge
("Loading settings module....");

114 
gs_keyfe
 = 
	`g_key_fe_w
();

115 if(
gs_keyfe
==
NULL
 
FALSE
;

116 
	`rib_gs_t_boޗn
("Py", "AutoPy", 
FALSE
);

117 
	`rib_gs_t_g
("Player", "RepeatMode",

118 
RCLIB_PLAYER_REPEAT_ALL
);

119 
	`rib_gs_t_g
("Player", "RandomMode",

120 
RCLIB_PLAYER_RANDOM_NONE
);

121 
	`rib_gs_t_doub
("Player", "Volume", 1.0);

122 
	`rib_gs_t_boޗn
("Py", "AutoPyWhSup", 
FALSE
);

123 
	`rib_gs_t_boޗn
("Py", "RgLimEbd", 
FALSE
);

124 
	`rib_gs_t_boޗn
("Py", "RgLimCdi", 
FALSE
);

125 
	`rib_gs_t_doub
("Player", "RatingLimitValue", 3.0);

126 
	`rib_gs_t_boޗn
("Py", "LdLaPosi", 
FALSE
);

127 
	`rib_gs_t_g
("Player", "LastPlayedCatalog", 0);

128 
	`rib_gs_t_g
("Player", "LastPlayedMusic", 0);

129 
	`rib_gs_t_g
("SoundEffect", "EQStyle",

130 
RCLIB_CORE_EQ_TYPE_NONE
);

131 
	`rib_gs_t_doub_li
("SoundEf", "EQ", 
eq_y
, 10);

132 
	`rib_gs_t_doub
("SoundEffect", "Balance", 0.0);

133 
	`rib_gs_t_boޗn
("Pyli", "AutoEncodgDe", 
TRUE
);

134 
	`rib_gs_t_boޗn
("Mada", "AutoDeEncodg", 
TRUE
);

135 
gs_dty
 = 
FALSE
;

136 
	`g_mesge
("Settings moduleoaded.");

137  
TRUE
;

138 
	}
}

146 
	$rib_gs_ex
()

148 if(
gs_th
!=
NULL
)

150 
	`rib_gs_upde
();

151 
	`rib_gs_ve
(
gs_th
);

152 
	`g_
(
gs_th
);

154 if(
gs_keyfe
!=
NULL
)

155 
	`g_key_fe_
(
gs_keyfe
);

156 
gs_keyfe
 = 
NULL
;

157 
	`g_mesge
("Settings modulexited.");

158 
	}
}

169 
gboޗn
 
	$rib_gs_ld_om_fe
(cڡ 
gch
 *
fame
)

171 
gboޗn
 
ag
;

172 if(
fame
==
NULL
 || 
gs_keyfe
==NULL 
FALSE
;

173 
	`g_
(
gs_th
);

174 
gs_th
 = 
	`g_rdup
(
fame
);

175 
ag
 = 
	`rib_gs_ld
(
fame
);

176  
ag
;

177 
	}
}

185 
	$rib_gs_y
()

187 
GE
 *
r
 = 
NULL
;

188 
gboޗn
 
bvue
;

189 
gt
 
ivue
;

190 
gdoub
 
dvue
;

191 
gdoub
 *
dy
;

192 
gsize
 
size
;

193 
gch
 *
codg
, *
id3_codg
;

194 
gboޗn
 
bvue2
;

195 
ivue
 = 
	`rib_gs_g_g
("Py", "RtMode", &
r
);

196 if(
r
==
NULL
)

198 
	`rib_ay_t__mode
(
ivue
);

202 
	`g_r_
(
r
);

203 
r
 = 
NULL
;

205 
ivue
 = 
	`rib_gs_g_g
("Py", "RdomMode", &
r
);

206 if(
r
==
NULL
)

208 
	`rib_ay_t_ndom_mode
(
ivue
);

212 
	`g_r_
(
r
);

213 
r
 = 
NULL
;

215 
dvue
 = 
	`rib_gs_g_doub
("Py", "Vume", &
r
);

216 if(
r
==
NULL
)

217 
	`rib_ce_t_vume
(
dvue
);

220 
	`g_r_
(
r
);

221 
r
 = 
NULL
;

223 
bvue
 = 
	`rib_gs_g_boޗn
("Player", "RatingLimitEnabled",

224 
NULL
);

225 
dvue
 = 
	`rib_gs_g_doub
("Player", "RatingLimitValue",

226 &
r
);

227 if(
r
!=
NULL
)

229 
	`g_r_
(
r
);

230 
r
 = 
NULL
;

231 
dvue
 = 3.0;

233 
bvue2
 = 
	`rib_gs_g_boޗn
("Player", "RatingLimitCondition",

234 
NULL
);

235 
	`rib_ay_t_tg_lim
(
bvue
, 
dvue
, 
bvue2
);

236 
ivue
 = 
	`rib_gs_g_g
("SoundEf", "EQSty", &
r
);

237 if(
r
==
NULL
)

239 if(
ivue
>=
RCLIB_CORE_EQ_TYPE_NONE
 && ivue<
RCLIB_CORE_EQ_TYPE_CUSTOM
)

240 
	`rib_ce_t_eq
(
ivue
, 
NULL
);

243 
dy
 = 
	`rib_gs_g_doub_li
("SoundEffect", "EQ",

244 &
size
, 
NULL
);

245 if(
dy
!=
NULL
)

247 
	`rib_ce_t_eq
(
RCLIB_CORE_EQ_TYPE_CUSTOM
, 
dy
);

249 
	`g_
(
dy
);

254 
	`g_r_
(
r
);

255 
r
 = 
NULL
;

257 
dvue
 = 
	`rib_gs_g_doub
("SoundEf", "B", 
NULL
);

258 
	`rib_ce_t_b
(
dvue
);

259 
bvue
 = 
	`rib_gs_g_boޗn
("Mada", "AutoDeEncodg", 
NULL
);

260 if(
bvue
)

262 
codg
 = 
	`rib_ut_de_codg_by_lo
();

263 if(
codg
!=
NULL
 && 
	`
(encoding)>0)

265 
id3_codg
 = 
	`g_rdup_tf
("%s:UTF-8", 
codg
);

266 
	`rib_lyric_t_back_codg
(
codg
);

267 
	`rib_gs_t_rg
("Mada", "LyricEncodg", 
codg
);

268 
	`rib_g_t_back_codg
(
id3_codg
);

269 
	`rib_gs_t_rg
("Metadata", "ID3Encoding",

270 
id3_codg
);

271 
	`g_
(
id3_codg
);

273 if(
codg
!=
NULL
)

274 
	`g_
(
codg
);

277 
id3_codg
 = 
	`rib_gs_g_rg
("Metadata", "ID3Encoding",

278 
NULL
);

279 if(
id3_codg
!=
NULL
 && 
	`
(id3_encoding)>0)

280 
	`rib_g_t_back_codg
(
id3_codg
);

281 
	`g_
(
id3_codg
);

282 
codg
 = 
	`rib_gs_g_rg
("Metadata", "LyricEncoding",

283 
NULL
);

284 if(
codg
!=
NULL
 && 
	`
(encoding)>0)

285 
	`rib_lyric_t_back_codg
(
codg
);

286 
	`g_
(
codg
);

291 
id3_codg
 = 
	`rib_gs_g_rg
("Metadata", "ID3Encoding",

292 
NULL
);

293 if(
id3_codg
!=
NULL
 && 
	`
(id3_encoding)>0)

294 
	`rib_g_t_back_codg
(
id3_codg
);

295 
	`g_
(
id3_codg
);

296 
codg
 = 
	`rib_gs_g_rg
("Metadata", "LyricEncoding",

297 
NULL
);

298 if(
codg
!=
NULL
 && 
	`
(encoding)>0)

299 
	`rib_lyric_t_back_codg
(
codg
);

300 
	`g_
(
codg
);

302 
	}
}

310 
	$rib_gs_upde
()

312 
gt
 
ivue
;

313 
gdoub
 
dvue
;

314 
gdoub
 
eq_y
[10] = {0.0};

315 
gt
 
fvue
;

316 
gboޗn
 
bvue
, 
bvue2
;

317 
GSequIr
 *
db_n
;

318 
RCLibDbPyliDa
 *
ayli_da
;

319 
ivue
 = 
	`rib_ay_g__mode
();

320 
	`rib_gs_t_g
("Py", "RtMode", 
ivue
);

321 
ivue
 = 
	`rib_ay_g_ndom_mode
();

322 
	`rib_gs_t_g
("Py", "RdomMode", 
ivue
);

323 
bvue
 = 
	`rib_ay_g_tg_lim
(&
fvue
, &
bvue2
);

324 
	`rib_gs_t_boޗn
("Py", "RgLimEbd", 
bvue
);

325 
	`rib_gs_t_boޗn
("Py", "RgLimCdi", 
bvue2
);

326 
	`rib_gs_t_doub
("Py", "RgLimVue", 
fvue
);

327 if(
	`rib_ce_g_vume
(&
dvue
))

328 
	`rib_gs_t_doub
("Py", "Vume", 
dvue
);

329 if(
	`rib_ce_g_eq
((
RCLibCeEQTy
 *)&
ivue
, 
eq_y
))

331 
	`rib_gs_t_g
("SoundEf", "EQSty", 
ivue
);

332 
	`rib_gs_t_doub_li
("SoundEf", "EQ", 
eq_y
, 10);

334 if(
	`rib_ce_g_b
(&
fvue
))

335 
	`rib_gs_t_doub
("SoundEf", "B", 
fvue
);

336 
db_n
 = 
	`rib_ce_g_db_n
();

337 if(
db_n
!=
NULL
)

339 
ayli_da
 = 
	`g_qu_g
(
db_n
);

340 if(
ayli_da
!=
NULL
)

342 
ivue
 = 
	`g_qu__g_posi
(
db_n
);

343 
	`rib_gs_t_g
("Py", "LaPyedMusic", 
ivue
);

344 
ivue
 = 
	`g_qu__g_posi
(
ayli_da
->
log
);

345 
	`rib_gs_t_g
("Player", "LastPlayedCatalog",

346 
ivue
);

349 
	}
}

358 
	$rib_gs_sync
()

360 if(
gs_th
==
NULL
) ;

361 if(!
gs_dty
) ;

362 
	`rib_gs_ve
(
gs_th
);

363 
	}
}

377 
gch
 *
	$rib_gs_g_rg
(cڡ 
gch
 *
group_me
,

378 cڡ 
gch
 *
key
, 
GE
 **
r
)

380 if(
gs_keyfe
==
NULL
)  NULL;

381  
	`g_key_fe_g_rg
(
gs_keyfe
, 
group_me
, 
key
, 
r
);

382 
	}
}

396 
gt
 
	$rib_gs_g_g
(cڡ 
gch
 *
group_me
,

397 cڡ 
gch
 *
key
, 
GE
 **
r
)

399 if(
gs_keyfe
==
NULL
)  0;

400  
	`g_key_fe_g_g
(
gs_keyfe
, 
group_me
, 
key
, 
r
);

401 
	}
}

416 
gdoub
 
	$rib_gs_g_doub
(cڡ 
gch
 *
group_me
,

417 cڡ 
gch
 *
key
, 
GE
 **
r
)

419 if(
gs_keyfe
==
NULL
)  0.0;

420  
	`g_key_fe_g_doub
(
gs_keyfe
, 
group_me
, 
key
, 
r
);

421 
	}
}

435 
gboޗn
 
	$rib_gs_g_boޗn
(cڡ 
gch
 *
group_me
,

436 cڡ 
gch
 *
key
, 
GE
 **
r
)

438 if(
gs_keyfe
==
NULL
 
FALSE
;

439  
	`g_key_fe_g_boޗn
(
gs_keyfe
, 
group_me
, 
key
, 
r
);

440 
	}
}

456 
gch
 **
	$rib_gs_g_rg_li
(cڡ 
gch
 *
group_me
,

457 cڡ 
gch
 *
key
, 
gsize
 *
ngth
, 
GE
 **
r
)

459 if(
gs_keyfe
==
NULL
)  NULL;

460  
	`g_key_fe_g_rg_li
(
gs_keyfe
, 
group_me
, 
key
,

461 
ngth
, 
r
);

462 
	}
}

477 
gboޗn
 *
	$rib_gs_g_boޗn_li
(cڡ 
gch
 *
group_me
,

478 cڡ 
gch
 *
key
, 
gsize
 *
ngth
, 
GE
 **
r
)

480 if(
gs_keyfe
==
NULL
)  NULL;

481  
	`g_key_fe_g_boޗn_li
(
gs_keyfe
, 
group_me
, 
key
,

482 
ngth
, 
r
);

483 
	}
}

498 
gt
 *
	$rib_gs_g_g_li
(cڡ 
gch
 *
group_me
,

499 cڡ 
gch
 *
key
, 
gsize
 *
ngth
, 
GE
 **
r
)

501 if(
gs_keyfe
==
NULL
)  NULL;

502  
	`g_key_fe_g_g_li
(
gs_keyfe
, 
group_me
, 
key
,

503 
ngth
, 
r
);

504 
	}
}

519 
gdoub
 *
	$rib_gs_g_doub_li
(cڡ 
gch
 *
group_me
,

520 cڡ 
gch
 *
key
, 
gsize
 *
ngth
, 
GE
 **
r
)

522 if(
gs_keyfe
==
NULL
)  NULL;

523  
	`g_key_fe_g_doub_li
(
gs_keyfe
, 
group_me
, 
key
,

524 
ngth
, 
r
);

525 
	}
}

538 
	$rib_gs_t_rg
(cڡ 
gch
 *
group_me
,

539 cڡ 
gch
 *
key
, cڡ gch *
rg
)

541 
gs_dty
 = 
TRUE
;

542 if(
gs_keyfe
==
NULL
) ;

543 
	`g_key_fe_t_rg
(
gs_keyfe
, 
group_me
, 
key
, 
rg
);

544 
	}
}

557 
	$rib_gs_t_boޗn
(cڡ 
gch
 *
group_me
,

558 cڡ 
gch
 *
key
, 
gboޗn
 
vue
)

560 
gs_dty
 = 
TRUE
;

561 if(
gs_keyfe
==
NULL
) ;

562 
	`g_key_fe_t_boޗn
(
gs_keyfe
, 
group_me
, 
key
, 
vue
);

563 
	}
}

576 
	$rib_gs_t_g
(cڡ 
gch
 *
group_me
,

577 cڡ 
gch
 *
key
, 
gt
 
vue
)

579 
gs_dty
 = 
TRUE
;

580 if(
gs_keyfe
==
NULL
) ;

581 
	`g_key_fe_t_g
(
gs_keyfe
, 
group_me
, 
key
, 
vue
);

582 
	}
}

595 
	$rib_gs_t_doub
(cڡ 
gch
 *
group_me
,

596 cڡ 
gch
 *
key
, 
gdoub
 
vue
)

598 
gs_dty
 = 
TRUE
;

599 if(
gs_keyfe
==
NULL
) ;

600 
	`g_key_fe_t_doub
(
gs_keyfe
, 
group_me
, 
key
, 
vue
);

601 
	}
}

615 
	$rib_gs_t_rg_li
(cڡ 
gch
 *
group_me
,

616 cڡ 
gch
 *
key
, cڡ gch * cڡ 
li
[], 
gsize
 
ngth
)

618 
gs_dty
 = 
TRUE
;

619 if(
gs_keyfe
==
NULL
) ;

620 
	`g_key_fe_t_rg_li
(
gs_keyfe
, 
group_me
, 
key
,

621 
li
, 
ngth
);

622 
	}
}

636 
	$rib_gs_t_boޗn_li
(cڡ 
gch
 *
group_me
,

637 cڡ 
gch
 *
key
, 
gboޗn
 
li
[], 
gsize
 
ngth
)

639 
gs_dty
 = 
TRUE
;

640 if(
gs_keyfe
==
NULL
) ;

641 
	`g_key_fe_t_boޗn_li
(
gs_keyfe
, 
group_me
, 
key
,

642 
li
, 
ngth
);

643 
	}
}

657 
	$rib_gs_t_g_li
(cڡ 
gch
 *
group_me
,

658 cڡ 
gch
 *
key
, 
gt
 
li
[], 
gsize
 
ngth
)

660 
gs_dty
 = 
TRUE
;

661 if(
gs_keyfe
==
NULL
) ;

662 
	`g_key_fe_t_g_li
(
gs_keyfe
, 
group_me
, 
key
,

663 
li
, 
ngth
);

664 
	}
}

678 
	$rib_gs_t_doub_li
(cڡ 
gch
 *
group_me
,

679 cڡ 
gch
 *
key
, 
gdoub
 
li
[], 
gsize
 
ngth
)

681 
gs_dty
 = 
TRUE
;

682 if(
gs_keyfe
==
NULL
) ;

683 
	`g_key_fe_t_doub_li
(
gs_keyfe
, 
group_me
, 
key
,

684 
li
, 
ngth
);

685 
	}
}

698 
gboޗn
 
	$rib_gs_has_key
(cڡ 
gch
 *
group_me
, gch *
key
,

699 
GE
 **
r
)

701 
gs_dty
 = 
TRUE
;

702 if(
gs_keyfe
==
NULL
 
FALSE
;

703  
	`g_key_fe_has_key
(
gs_keyfe
, 
group_me
, 
key
, 
r
);

704 
	}
}

	@lib/rclib-settings.h

25 #ide
HAVE_RCLIB_SETTINGS_H


26 
	#HAVE_RCLIB_SETTINGS_H


	)

28 
	~<glib.h
>

29 
	~<g/g.h
>

31 
G_BEGIN_DECLS


33 
gboޗn
 
rib_gs_
();

34 
rib_gs_ex
();

35 
gboޗn
 
rib_gs_ld_om_fe
(cڡ 
gch
 *
fame
);

36 
rib_gs_y
();

37 
rib_gs_upde
();

38 
rib_gs_sync
();

39 
gch
 *
rib_gs_g_rg
(cڡ gch *
group_me
,

40 cڡ 
gch
 *
key
, 
GE
 **
r
);

41 
gt
 
rib_gs_g_g
(cڡ 
gch
 *
group_me
,

42 cڡ 
gch
 *
key
, 
GE
 **
r
);

43 
gdoub
 
rib_gs_g_doub
(cڡ 
gch
 *
group_me
,

44 cڡ 
gch
 *
key
, 
GE
 **
r
);

45 
gboޗn
 
rib_gs_g_boޗn
(cڡ 
gch
 *
group_me
,

46 cڡ 
gch
 *
key
, 
GE
 **
r
);

47 
gch
 **
rib_gs_g_rg_li
(cڡ gch *
group_me
,

48 cڡ 
gch
 *
key
, 
gsize
 *
ngth
, 
GE
 **
r
);

49 
gboޗn
 *
rib_gs_g_boޗn_li
(cڡ 
gch
 *
group_me
,

50 cڡ 
gch
 *
key
, 
gsize
 *
ngth
, 
GE
 **
r
);

51 
gt
 *
rib_gs_g_g_li
(cڡ 
gch
 *
group_me
,

52 cڡ 
gch
 *
key
, 
gsize
 *
ngth
, 
GE
 **
r
);

53 
gdoub
 *
rib_gs_g_doub_li
(cڡ 
gch
 *
group_me
,

54 cڡ 
gch
 *
key
, 
gsize
 *
ngth
, 
GE
 **
r
);

55 
rib_gs_t_rg
(cڡ 
gch
 *
group_me
,

56 cڡ 
gch
 *
key
, cڡ gch *
rg
);

57 
rib_gs_t_boޗn
(cڡ 
gch
 *
group_me
,

58 cڡ 
gch
 *
key
, 
gboޗn
 
vue
);

59 
rib_gs_t_g
(cڡ 
gch
 *
group_me
,

60 cڡ 
gch
 *
key
, 
gt
 
vue
);

61 
rib_gs_t_doub
(cڡ 
gch
 *
group_me
,

62 cڡ 
gch
 *
key
, 
gdoub
 
vue
);

63 
rib_gs_t_rg_li
(cڡ 
gch
 *
group_me
,

64 cڡ 
gch
 *
key
, cڡ gch * cڡ 
li
[], 
gsize
 
ngth
);

65 
rib_gs_t_boޗn_li
(cڡ 
gch
 *
group_me
,

66 cڡ 
gch
 *
key
, 
gboޗn
 
li
[], 
gsize
 
ngth
);

67 
rib_gs_t_g_li
(cڡ 
gch
 *
group_me
,

68 cڡ 
gch
 *
key
, 
gt
 
li
[], 
gsize
 
ngth
);

69 
rib_gs_t_doub_li
(cڡ 
gch
 *
group_me
,

70 cڡ 
gch
 *
key
, 
gdoub
 
li
[], 
gsize
 
ngth
);

71 
gboޗn
 
rib_gs_has_key
(cڡ 
gch
 *
group_me
, gch *
key
,

72 
GE
 **
r
);

74 
	gG_END_DECLS


	@lib/rclib-tag.c

26 
	~"rib-g.h
"

27 
	~"rib-comm.h
"

28 
	~<g/pbuts/pbuts.h
>

40 
gch
 *
	gg_back_codg
 = 
NULL
;

42 
GTy
 
	$rib_g_mada_g_ty
()

44 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

45 
GTy
 
g_defe_ty_id
;

46 if(
	`g___r
(&
g_defe_ty_id__vީe
))

48 
g_defe_ty_id
 = 
	`g_boxed_ty_gi_ic
(

49 
	`g__ic_rg
("RCLibTagMetadata"),

50 (
GBoxedCyFunc
)
rib_g_cy_da
,

51 (
GBoxedFeFunc
)
rib_g_
);

52 
	`g___ave
 (&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

54  
g_defe_ty_id__vީe
;

55 
	}
}

61 
	$rib_g_g_g_cb
(cڡ 
GTagLi
 *
gs
, 
RCLibTagMada
 *
mmd
)

63 
gch
 *
rg
 = 
NULL
;

64 
GDe
 *
de
 = 
NULL
;

65 
gch
 *
cui
 = 
NULL
;

66 
GBufr
 *
image
 = 
NULL
;

67 
gut
 
bs
 = 0;

68 
gut
 
acknum
 = 0;

69 
gut
 
cue_num
 = 0;

70 
gut
 
i
 = 0;

71 if(
mmd
==
NULL
 || mmd->
uri
==NULL || 
gs
==NULL) ;

72 if(
	`g_g_li_g_rg
(
gs
, 
GST_TAG_AUDIO_CODEC
, &
rg
))

74 if(
mmd
->
y
==
NULL
)

75 
mmd
->
y
 = 
rg
;

76 
	`g_
(
rg
);

78 if(
	`g_g_li_g_rg
(
gs
, 
GST_TAG_TITLE
, &
rg
))

80 if(
mmd
->
t
==
NULL
)

81 
mmd
->
t
 = 
rg
;

82 
	`g_
(
rg
);

84 if(
	`g_g_li_g_rg
(
gs
, 
GST_TAG_ARTIST
, &
rg
))

86 if(
mmd
->
ti
==
NULL
)

87 
mmd
->
ti
 = 
rg
;

88 
	`g_
(
rg
);

90 if(
	`g_g_li_g_rg
(
gs
, 
GST_TAG_ALBUM
, &
rg
))

92 if(
mmd
->
bum
==
NULL
)

93 
mmd
->
bum
 = 
rg
;

94 
	`g_
(
rg
);

96 if(
	`g_g_li_g_rg
(
gs
, 
GST_TAG_COMMENT
, &
rg
))

98 if(
mmd
->
commt
==
NULL
)

99 
mmd
->
commt
 = 
rg
;

100 
	`g_
(
rg
);

102 if(
	`g_g_li_g_bufr
(
gs
, 
GST_TAG_IMAGE
, &
image
))

104 if(
mmd
->
image
==
NULL
)

105 
mmd
->
image
 = image;

106 
	`g_bufr_uef
(
image
);

108 if(
	`g_g_li_g_bufr
(
gs
, 
GST_TAG_PREVIEW_IMAGE
, &
image
))

110 if(
mmd
->
image
==
NULL
)

111 
mmd
->
image
 = image;

112 
	`g_bufr_uef
(
image
);

114 if(
	`g_g_li_g_ut
(
gs
, 
GST_TAG_NOMINAL_BITRATE
, &
bs
))

115 
mmd
->
b
 = 
bs
;

116 if(
	`g_g_li_g_ut
(
gs
, 
GST_TAG_TRACK_NUMBER
, &
acknum
))

117 
mmd
->
acknum
 =racknum;

118 if(
	`g_g_li_g_de
(
gs
, 
GST_TAG_DATE
, &
de
))

120 
mmd
->
yr
 = 
	`g_de_g_yr
(
de
);

121 
	`g_de_
(
de
);

123 
cue_num
 = 
	`g_g_li_g_g_size
(
gs
, 
GST_TAG_EXTENDED_COMMENT
);

124 
i
=0;i<
cue_num
 && 
mmd
->
emb_cue
==
NULL
;i++)

126 if(
	`g_g_li_g_rg_dex
(
gs
, 
GST_TAG_EXTENDED_COMMENT
, 
i
,

127 &
cui
))

129 if(
	`cmp
(
cui
, "cuesheet=", 9)==0)

131 
mmd
->
emb_cue
 = 
	`g_rdup
(
cui
+9);

132 
	`g_
(
cui
);

135 
	`g_
(
cui
);

138 
	}
}

150 
RCLibTagMada
 *
	$rib_g_ad_mada
(cڡ 
gch
 *
uri
)

152 
RCLibTagMada
 *
mmd
;

153 cڡ 
GTagLi
 *
gs
;

154 
GDiscov
 *
discov
;

155 
GDiscovInfo
 *
fo
;

156 
GDiscovResu
 
t
;

157 
GDiscovSmInfo
 *
am_fo
;

158 
GLi
 *
ams
;

159 
GLi
 *
l
;

160 
GE
 *
r
 = 
NULL
;

161 if(
uri
==
NULL
)

163  
NULL
;

165 
discov
 = 
	`g_discov_w
(5 * 
GST_SECOND
, &
r
);

166 if(
discov
==
NULL
)

168 
	`g_wng
("Cn makGDiscov f URI %s: %s", 
uri
,

169 
r
->
mesge
);

170 
	`g_r_
(
r
);

171 
r
 = 
NULL
;

172  
NULL
;

174 
fo
 = 
	`g_discov_discov_uri
(
discov
, 
uri
, &
r
);

175 
	`g_obje_uef
(
discov
);

176 if(
fo
==
NULL
)

178 
	`g_wng
("Cnلd madom URI %s: %s", 
uri
,

179 
r
->
mesge
);

180 
	`g_r_
(
r
);

181 
r
 = 
NULL
;

182  
NULL
;

184 
t
 = 
	`g_discov_fo_g_su
(
fo
);

185 if(
t
!=
GST_DISCOVERER_OK
)

187 
	`g_wng
("Cannotead metadata from URI %s,rror code: %u",

188 
uri
, 
t
);

189 
	`g_discov_fo_uef
(
fo
);

190  
NULL
;

192 
mmd
 = 
	`g_w0
(
RCLibTagMada
, 1);

193 
mmd
->
uri
 = 
	`g_rdup
(uri);

194 
gs
 = 
	`g_discov_fo_g_gs
(
fo
);

195 
	`rib_g_g_g_cb
(
gs
, 
mmd
);

196 
mmd
->
ngth
 = 
	`g_discov_fo_g_duti
(
fo
);

197 
ams
 = 
	`g_discov_fo_g_ams
(
fo
,

198 
GST_TYPE_DISCOVERER_STREAM_INFO
);

199 
l
=
ams
;l!=
NULL
;l=
	`g_li_xt
(l))

201 
am_fo
 = (
GDiscovSmInfo
 *)
l
->
da
;

202 if(
	`GST_IS_DISCOVERER_AUDIO_INFO
(
am_fo
))

204 
mmd
->
audio_ag
 = 
TRUE
;

205 
mmd
->
b
 = 
	`g_discov_audio_fo_g_b
(

206 
	`GST_DISCOVERER_AUDIO_INFO
(
am_fo
));

207 
mmd
->
chls
 = 
	`g_discov_audio_fo_g_chls
(

208 
	`GST_DISCOVERER_AUDIO_INFO
(
am_fo
));

209 
mmd
->
me
 = 
	`g_discov_audio_fo_g_me_
(

210 
	`GST_DISCOVERER_AUDIO_INFO
(
am_fo
));

212 if(
	`GST_IS_DISCOVERER_VIDEO_INFO
(
am_fo
))

213 
mmd
->
video_ag
 = 
TRUE
;

215 
	`g_discov_am_fo_li_
(
ams
);

216 
	`g_discov_fo_uef
(
fo
);

217  
mmd
;

218 
	}
}

229 
RCLibTagMada
 *
	$rib_g_cy_da
(cڡ 
RCLibTagMada
 *
mmd
)

231 
RCLibTagMada
 *
w_mmd
;

232 
w_mmd
 = (
RCLibTagMada
 *)
	`g_w0
(RCLibTagMetadata, 1);

233 
	`memy
(
w_mmd
, 
mmd
, (
RCLibTagMada
));

234 
w_mmd
->
uri
 = 
	`g_rdup
(
mmd
->uri);

235 
w_mmd
->
t
 = 
	`g_rdup
(
mmd
->title);

236 
w_mmd
->
ti
 = 
	`g_rdup
(
mmd
->artist);

237 
w_mmd
->
bum
 = 
	`g_rdup
(
mmd
->album);

238 
w_mmd
->
commt
 = 
	`g_rdup
(
mmd
->comment);

239 
w_mmd
->
y
 = 
	`g_rdup
(
mmd
->ftype);

240 
w_mmd
->
emb_cue
 = 
	`g_rdup
(
mmd
->emb_cue);

241 
w_mmd
->
image
 = 
	`g_bufr_cy
(
mmd
->image);

242  
w_mmd
;

243 
	}
}

252 
	$rib_g_
(
RCLibTagMada
 *
mmd
)

254 if(
mmd
==
NULL
) ;

255 if(
mmd
->
image
!=
NULL

	`g_bufr_uef
(mmd->image);

256 
	`g_
(
mmd
->
uri
);

257 
	`g_
(
mmd
->
t
);

258 
	`g_
(
mmd
->
ti
);

259 
	`g_
(
mmd
->
bum
);

260 
	`g_
(
mmd
->
commt
);

261 
	`g_
(
mmd
->
y
);

262 
	`g_
(
mmd
->
emb_cue
);

263 
	`g_
(
mmd
);

264 
	}
}

275 
gch
 *
	$rib_g_g_me_om_h
(cڡ 
gch
 *
fame
)

277 
gch
 *
ufame
;

278 
gch
 *
bame
;

279 
gch
 *
dr
;

280 
gch
 *
me
;

281 
gsize
 
n
;

282 
gt
 
ƒ
;

283 if(
fame
==
NULL
)  NULL;

284 
ufame
 = 
	`g_fame_to_utf8
(
fame
, -1, 
NULL
, NULL, NULL);

285 if(
ufame
==
NULL
ufam
	`g_rdup
(
fame
);

286 
bame
 = 
	`g_fame_diy_bame
(
ufame
);

287 
	`g_
(
ufame
);

288 if(
bame
==
NULL
)  NULL;

289 
n
 = 
	`
(
bame
);

290 
dr
 = 
	`chr
(
bame
, '.');

291 
ƒ
 = (
gt
)(
dr
 - 
bame
);

292 if(
dr
==
NULL
 || 
ƒ
<0 ||n>=
n
)

293 
me
 = 
	`g_rdup
(
bame
);

295 
me
 = 
	`g_dup
(
bame
, 
ƒ
);

296 
	`g_
(
bame
);

297  
me
;

298 
	}
}

309 
gch
 *
	$rib_g_g_me_om_uri
(cڡ 
gch
 *
uri
)

311 
gch
 *
fh
;

312 
gch
 *
me
;

313 if(
uri
==
NULL
)  NULL;

314 
fh
 = 
	`g_fame_om_uri
(
uri
, 
NULL
, NULL);

315 if(
fh
==
NULL
)  NULL;

316 
me
 = 
	`rib_g_g_me_om_h
(
fh
);

317 
	`g_
(
fh
);

318  
me
;

319 
	}
}

333 
gch
 *
	$rib_g_ch_lyric_fe
(cڡ 
gch
 *
dme
,

334 cڡ 
RCLibTagMada
 *
mmd
)

336 
gch
 *
su
 = 
NULL
;

337 
GRegex
 *
me_gex
 = 
NULL
;

338 
GRegex
 *
ti_t_gex
 = 
NULL
;

339 
GRegex
 *
t_ti_gex
 = 
NULL
;

340 
GRegex
 *
t_ly_gex
 = 
NULL
;

341 
gch
 *
me
 = 
NULL
;

342 
gch
 *
me_n
 = 
NULL
;

343 
gch
 *
tmp
, *
rg
;

344 
GD
 *
gd
;

345 cڡ 
gch
 *
ame_fܗch
 = 
NULL
;

346 cڡ 
gch
 *
mch_su
 = 
NULL
;

347 
gut
 
v
 = 0;

348 if(
dme
==
NULL
 || 
mmd
==NULL)  NULL;

349 
gd
 = 
	`g_d_ݒ
(
dme
, 0, 
NULL
);

350 if(
gd
==
NULL
)  NULL;

351 if(
mmd
->
uri
!=
NULL
)

352 
me
 = 
	`rib_g_g_me_om_uri
(
mmd
->
uri
);

353 if(
me
!=
NULL
)

355 
tmp
 = 
	`g_gex_es_rg
(
me
, -1);

356 
me_n
 = 
	`g_rdup_tf
("^(%s)(\\.LRC)$", 
tmp
);

357 
	`g_
(
tmp
);

358 
me_gex
 = 
	`g_gex_w
(
me_n
, 
G_REGEX_CASELESS
,

359 0, 
NULL
);

360 
	`g_
(
me
);

361 
	`g_
(
me_n
);

363 if(
mmd
->
t
!=
NULL
 && 
	`
(mmd->t)>0 && mmd->
ti
!=NULL &&

364 
	`
(
mmd
->
ti
)>0)

366 
tmp
 = 
	`g_rdup_tf
("%- %s", 
mmd
->
ti
, mmd->
t
);

367 
rg
 = 
	`g_gex_es_rg
(
tmp
, -1);

368 
	`g_
(
tmp
);

369 
tmp
 = 
	`g_rdup_tf
("^(%s)(\\.LRC)$", 
rg
);

370 
	`g_
(
rg
);

371 
ti_t_gex
 = 
	`g_gex_w
(
tmp
, 
G_REGEX_CASELESS
,

372 0, 
NULL
);

373 
	`g_
(
tmp
);

374 
tmp
 = 
	`g_rdup_tf
("%- %s", 
mmd
->
t
, mmd->
ti
);

375 
rg
 = 
	`g_gex_es_rg
(
tmp
, -1);

376 
	`g_
(
tmp
);

377 
tmp
 = 
	`g_rdup_tf
("^(%s)(\\.LRC)$", 
rg
);

378 
	`g_
(
rg
);

379 
t_ti_gex
 = 
	`g_gex_w
(
tmp
, 
G_REGEX_CASELESS
,

380 0, 
NULL
);

381 
	`g_
(
tmp
);

383 if(
mmd
->
t
!=
NULL
 && 
	`
(mmd->title)>0)

385 
tmp
 = 
	`g_gex_es_rg
(
mmd
->
t
, -1);

386 
rg
 = 
	`g_rdup_tf
("^(%s)(\\.LRC)$", 
tmp
);

387 
	`g_
(
tmp
);

388 
t_ly_gex
 = 
	`g_gex_w
(
rg
, 
G_REGEX_CASELESS
,

389 0, 
NULL
);

390 
	`g_
(
rg
);

392 (
ame_fܗch
=
	`g_d_ad_me
(
gd
))!=
NULL
)

394 if(
me_gex
!=
NULL
)

396 if(
	`g_gex_mch
(
me_gex
, 
ame_fܗch
, 0, 
NULL
))

398 
mch_su
 = 
ame_fܗch
;

399 
v
 = 4;

403 if(
ti_t_gex
!=
NULL
)

405 if(
	`g_gex_mch
(
ti_t_gex
, 
ame_fܗch
, 0, 
NULL
) &&

406 
v
<3)

408 
mch_su
 = 
ame_fܗch
;

409 
v
 = 3;

412 if(
t_ti_gex
!=
NULL
)

414 if(
	`g_gex_mch
(
t_ti_gex
, 
ame_fܗch
, 0, 
NULL
) &&

415 
v
<2)

417 
mch_su
 = 
ame_fܗch
;

418 
v
 = 2;

421 if(
t_ly_gex
!=
NULL
)

423 if(
	`g_gex_mch
(
t_ly_gex
, 
ame_fܗch
, 0, 
NULL
) &&

424 
v
<1)

426 
mch_su
 = 
ame_fܗch
;

427 
v
 = 1;

431 if(
me_gex
!=
NULL

	`g_gex_uef
(realname_regex);

432 if(
ti_t_gex
!=
NULL

	`g_gex_uef
(artist_title_regex);

433 if(
t_ti_gex
!=
NULL

	`g_gex_uef
(title_artist_regex);

434 if(
t_ly_gex
!=
NULL

	`g_gex_uef
(title_only_regex);

435 if(
mch_su
!=
NULL
)

436 
su
 = 
	`g_bud_fame
(
dme
, 
mch_su
, 
NULL
);

437 
	`g_d_o
(
gd
);

438  
su
;

439 
	}
}

452 
gch
 *
	$rib_g_ch_bum_fe
(cڡ 
gch
 *
dme
,

453 cڡ 
RCLibTagMada
 *
mmd
)

455 
gch
 *
su
 = 
NULL
;

456 
GRegex
 *
me_gex
 = 
NULL
;

457 
GRegex
 *
ti_gex
 = 
NULL
;

458 
GRegex
 *
t_gex
 = 
NULL
;

459 
GRegex
 *
bum_gex
 = 
NULL
;

460 
gch
 *
me
 = 
NULL
;

461 
gch
 *
me_n
 = 
NULL
;

462 
gch
 *
tmp
, *
rg
;

463 
GD
 *
gd
;

464 cڡ 
gch
 *
ame_fܗch
 = 
NULL
;

465 cڡ 
gch
 *
mch_su
 = 
NULL
;

466 
gut
 
v
 = 0;

467 if(
dme
==
NULL
 || 
mmd
==NULL)  NULL;

468 
gd
 = 
	`g_d_ݒ
(
dme
, 0, 
NULL
);

469 if(
gd
==
NULL
)  NULL;

470 if(
mmd
->
uri
!=
NULL
)

471 
me
 = 
	`rib_g_g_me_om_uri
(
mmd
->
uri
);

472 if(
me
!=
NULL
)

474 
tmp
 = 
	`g_gex_es_rg
(
me
, -1);

475 
me_n
 = 
	`g_rdup_tf
("^(%s)\\.(BMP|JPG|JPEG|PNG)$",

476 
tmp
);

477 
	`g_
(
tmp
);

478 
me_gex
 = 
	`g_gex_w
(
me_n
, 
G_REGEX_CASELESS
,

479 0, 
NULL
);

480 
	`g_
(
me
);

481 
	`g_
(
me_n
);

483 if(
mmd
->
t
!=
NULL
 && 
	`
(mmd->title)>0)

485 
rg
 = 
	`g_gex_es_rg
(
mmd
->
t
, -1);

486 
tmp
 = 
	`g_rdup_tf
("^(%s)\\.(BMP|JPG|JPEG|PNG)$", 
rg
);

487 
	`g_
(
rg
);

488 
t_gex
 = 
	`g_gex_w
(
tmp
, 
G_REGEX_CASELESS
, 0, 
NULL
);

489 
	`g_
(
tmp
);

491 if(
mmd
->
ti
!=
NULL
 && 
	`
(mmd->artist)>0)

493 
rg
 = 
	`g_gex_es_rg
(
mmd
->
ti
, -1);

494 
tmp
 = 
	`g_rdup_tf
("^(%s)\\.(BMP|JPG|JPEG|PNG)$", 
rg
);

495 
	`g_
(
rg
);

496 
ti_gex
 = 
	`g_gex_w
(
tmp
, 
G_REGEX_CASELESS
, 0, 
NULL
);

497 
	`g_
(
tmp
);

499 if(
mmd
->
bum
!=
NULL
 && 
	`
(mmd->album)>0)

501 
rg
 = 
	`g_gex_es_rg
(
mmd
->
bum
, -1);

502 
tmp
 = 
	`g_rdup_tf
("^(%s)\\.(BMP|JPG|JPEG|PNG)$", 
rg
);

503 
	`g_
(
rg
);

504 
bum_gex
 = 
	`g_gex_w
(
tmp
, 
G_REGEX_CASELESS
, 0, 
NULL
);

505 
	`g_
(
tmp
);

507 (
ame_fܗch
=
	`g_d_ad_me
(
gd
))!=
NULL
)

509 if(
me_gex
!=
NULL
)

511 if(
	`g_gex_mch
(
me_gex
, 
ame_fܗch
, 0, 
NULL
))

513 
mch_su
 = 
ame_fܗch
;

514 
v
 = 4;

518 if(
t_gex
!=
NULL
)

520 if(
	`g_gex_mch
(
t_gex
, 
ame_fܗch
, 0, 
NULL
) &&

521 
v
<3)

523 
mch_su
 = 
ame_fܗch
;

524 
v
 = 3;

527 if(
bum_gex
!=
NULL
)

529 if(
	`g_gex_mch
(
bum_gex
, 
ame_fܗch
, 0, 
NULL
) &&

530 
v
<2)

532 
mch_su
 = 
ame_fܗch
;

533 
v
 = 2;

536 if(
ti_gex
!=
NULL
)

538 if(
	`g_gex_mch
(
ti_gex
, 
ame_fܗch
, 0, 
NULL
) &&

539 
v
<1)

541 
mch_su
 = 
ame_fܗch
;

542 
v
 = 1;

546 if(
me_gex
!=
NULL

	`g_gex_uef
(realname_regex);

547 if(
ti_gex
!=
NULL

	`g_gex_uef
(artist_regex);

548 if(
t_gex
!=
NULL

	`g_gex_uef
(title_regex);

549 if(
bum_gex
!=
NULL

	`g_gex_uef
(album_regex);

550 if(
mch_su
!=
NULL
)

551 
su
 = 
	`g_bud_fame
(
dme
, 
mch_su
, 
NULL
);

552 
	`g_d_o
(
gd
);

553  
su
;

554 
	}
}

565 
	$rib_g_t_back_codg
(cڡ 
gch
 *
codg
)

567 
gch
 *
r
;

568 
r
 = 
	`g_rdup_tf
("%s:UTF-8", 
codg
);

569 
	`g_nv
("GST_ID3_TAG_ENCODING", 
r
, 
TRUE
);

570 
	`g_nv
("GST_ID3V2_TAG_ENCODING", 
r
, 
TRUE
);

571 
	`g_
(
r
);

572 
	`g_
(
g_back_codg
);

573 
g_back_codg
 = 
	`g_rdup
(
codg
);

574 
	}
}

584 cڡ 
gch
 *
	$rib_g_g_back_codg
()

586  
g_back_codg
;

587 
	}
}

	@lib/rclib-tag.h

25 #ide
HAVE_RC_LIB_TAG_H


26 
	#HAVE_RC_LIB_TAG_H


	)

28 
	~<glib.h
>

29 
	~<glib/gi18n.h
>

30 
	~<g/g.h
>

32 
	gG_BEGIN_DECLS


34 
	#RCLIB_TYPE_TAG_METADATA
 (
	`rib_g_mada_g_ty
())

	)

36 
_RCLibTagMada
 
	tRCLibTagMada
;

62 
	s_RCLibTagMada
 {

63 
gt64
 
	mngth
;

64 
gch
 *
	muri
;

65 
gut
 
	macknum
;

66 
gut
 
	mb
;

67 
gt
 
	mme
;

68 
gt
 
	mchls
;

69 
gt
 
	myr
;

70 
gch
 *
	mt
;

71 
gch
 *
	mti
;

72 
gch
 *
	mbum
;

73 
gch
 *
	mcommt
;

74 
gch
 *
	my
;

75 
gch
 *
	memb_cue
;

76 
GBufr
 *
	mimage
;

77 
gboޗn
 
	meos
;

78 
gboޗn
 
	maudio_ag
;

79 
gboޗn
 
	mvideo_ag
;

80 
gpor
 
	mur_da
;

84 
GTy
 
rib_g_mada_g_ty
();

87 
RCLibTagMada
 *
rib_g_ad_mada
(cڡ 
gch
 *
uri
);

88 
RCLibTagMada
 *
rib_g_cy_da
(cڡ RCLibTagMad*
mmd
);

89 
rib_g_
(
RCLibTagMada
 *
mmd
);

90 
gch
 *
rib_g_g_me_om_h
(cڡ gch *
fame
);

91 
gch
 *
rib_g_g_me_om_uri
(cڡ gch *
uri
);

92 
rib_g_t_back_codg
(cڡ 
gch
 *
codg
);

93 cڡ 
gch
 *
rib_g_g_back_codg
();

95 
	gG_END_DECLS


	@lib/rclib-util.c

26 #ifde
G_OS_WIN32


27 
	~<wdows.h
>

28 
	~<wba.h
>

31 
	~"rib-ut.h
"

32 
	~"rib-comm.h
"

33 
	~"rib-g.h
"

44 cڡ 
gch
 *
	gut_sut_fmx
 = "(.FLAC|.OGG|.MP3|.WMA|.WAV|"

46 cڡ 
gch
 *
	gut_sut_lix
 = "(.M3U)$";

47 
gch
 *
	gut_cov_ch_d
 = 
NULL
;

59 
gch
 *
	$rib_ut_g_da_d
(cڡ 
gch
 *
me
, cڡ gch *
g0
)

61 
gch
 *
da_d
 = 
NULL
;

62 
gch
 *
b_d
 = 
NULL
;

63 
gch
 *
exec_th
 = 
NULL
;

64 
fu_th
[
PATH_MAX
] = {0};

65 if(
me
==
NULL
)  NULL;

66 #ifde
G_OS_UNIX


67 
exec_th
 = 
	`g_fe_ad_lk
("/oc/lf/exe", 
NULL
);

68 if(
exec_th
!=
NULL
)

70 
b_d
 = 
	`g_th_g_dme
(
exec_th
);

71 
	`g_
(
exec_th
);

72 
exec_th
 = 
NULL
;

74 
exec_th
 = 
	`g_fe_ad_lk
("/oc/curoc/fe", 
NULL
);

75 if(
exec_th
!=
NULL
)

77 
b_d
 = 
	`g_th_g_dme
(
exec_th
);

78 
	`g_
(
exec_th
);

79 
exec_th
 = 
NULL
;

81 
exec_th
 = 
	`g_fe_ad_lk
("/oc/lf/th/a.out", 
NULL
);

82 if(
exec_th
!=
NULL
)

84 
b_d
 = 
	`g_th_g_dme
(
exec_th
);

85 
	`g_
(
exec_th
);

86 
exec_th
 = 
NULL
;

89 #ifde
G_OS_WIN32


90 
b_d
 = 
	`g_w32_g_ckage_ti_dey_of_modu
(
NULL
);

91 
da_d
 = 
	`g_bud_fame
(
b_d
, "she", 
me
, 
NULL
);

92 
	`g_
(
b_d
);

93 
b_d
 = 
NULL
;

95 if(
b_d
!=
NULL
)

97 
da_d
 = 
	`g_bud_fame
(
b_d
, "..", "she", 
me
,

98 
NULL
);

99 if(!
	`g_fe_
(
da_d
, 
G_FILE_TEST_IS_DIR
))

101 
	`g_
(
da_d
);

102 
da_d
 = 
	`g_rdup
(
b_d
);

104 
	`g_
(
b_d
);

106 #ifde
G_OS_UNIX


107 if(
da_d
==
NULL
)

109 if(
	`g_th_is_absu
(
g0
))

110 
exec_th
 = 
	`g_rdup
(
g0
);

113 
b_d
 = 
	`g_g_cut_d
();

114 
exec_th
 = 
	`g_bud_fame
(
b_d
, 
g0
, 
NULL
);

115 
	`g_
(
b_d
);

117 
	`y
(
fu_th
, 
exec_th
, 
PATH_MAX
-1);

118 
	`g_
(
exec_th
);

119 
exec_th
 = 
	`th
(
da_d
, 
fu_th
);

120 if(
exec_th
!=
NULL
)

121 
b_d
 = 
	`g_th_g_dme
(
exec_th
);

123 
b_d
 = 
NULL
;

124 if(
b_d
!=
NULL
)

126 
da_d
 = 
	`g_bud_fame
(
b_d
, "..", "share",

127 
me
, 
NULL
);

128 if(!
	`g_fe_
(
da_d
, 
G_FILE_TEST_IS_DIR
))

130 
	`g_
(
da_d
);

131 
da_d
 = 
	`g_rdup
(
b_d
);

133 
	`g_
(
b_d
);

136 if(
da_d
==
NULL
)

138 
da_d
 = 
	`g_g_cut_d
();

141  
da_d
;

142 
	}
}

153 
gboޗn
 
	$rib_ut_is_su܋d_med
(cڡ 
gch
 *
fe
)

155  
	`g_gex_mch_sime
(
ut_sut_fmx
, 
fe
,

156 
G_REGEX_CASELESS
, 0);

157 
	}
}

168 
gboޗn
 
	$rib_ut_is_su܋d_li
(cڡ 
gch
 *
fe
)

170  
	`g_gex_mch_sime
(
ut_sut_lix
, 
fe
,

171 
G_REGEX_CASELESS
, 0);

172 
	}
}

181 
	$rib_ut_t_cov_ch_d
(cڡ 
gch
 *
d
)

183 
	`g_
(
ut_cov_ch_d
);

184 
ut_cov_ch_d
 = 
	`g_rdup
(
d
);

185 
	}
}

195 cڡ 
gch
 *
	$rib_ut_g_cov_ch_d
()

197  
ut_cov_ch_d
;

198 
	}
}

212 
gch
 *
	$rib_ut_ch_cov
(cڡ 
gch
 *
uri
, cڡ gch *
t
,

213 cڡ 
gch
 *
ti
, cڡ gch *
bum
)

215 
GRegex
 *
gex
;

216 
GSg
 *
key
;

217 
GD
 *
d
 = 
NULL
;

218 
gch
 *
fd
 = 
NULL
, *
ame
 = NULL;

219 
gch
 *
th
, *
tmp1
, *
tmp2
;

220 cڡ 
gch
 *
ame_fܗch
;

221 
gch
 *
su
 = 
NULL
;

222 
gboޗn
 
ag
 = 
FALSE
;

223 if(
uri
!=
NULL
)

225 
th
 = 
	`g_fame_om_uri
(
uri
, 
NULL
, NULL);

226 if(
th
!=
NULL
)

228 
fd
 = 
	`g_th_g_dme
(
th
);

229 
ame
 = 
	`rib_g_g_me_om_h
(
th
);

230 
	`g_
(
th
);

233 
key
 = 
	`g_rg_w
("^(");

234 if(
ame
!=
NULL
)

236 
tmp1
 = 
	`g_gex_es_rg
(
ame
, -1);

237 
	`g_
(
ame
);

238 
	`g_rg_nd
(
key
, 
tmp1
);

239 
	`g_
(
tmp1
);

240 
ag
 = 
TRUE
;

242 if(
ti
!=
NULL
 && 
t
!=NULL && 
	`
(artist)>0 &&

243 
	`
(
t
)>0)

245 if(
ag
)

246 
	`g_rg_nd_c
(
key
, '|');

247 
tmp1
 = 
	`g_gex_es_rg
(
t
, -1);

248 
tmp2
 = 
	`g_gex_es_rg
(
ti
, -1);

249 
	`g_rg_nd_tf
(
key
, "%- %s|%- %s", 
tmp1
, 
tmp2
,

250 
tmp2
, 
tmp1
);

251 
	`g_
(
tmp1
);

252 
	`g_
(
tmp2
);

253 
ag
 = 
TRUE
;

255 if(
ti
!=
NULL
 && 
bum
!=NULL && 
	`
(artist)>0 &&

256 
	`
(
bum
)>0)

258 if(
ag
)

259 
	`g_rg_nd_c
(
key
, '|');

260 
tmp1
 = 
	`g_gex_es_rg
(
bum
, -1);

261 
tmp2
 = 
	`g_gex_es_rg
(
ti
, -1);

262 
	`g_rg_nd_tf
(
key
, "%- %s|%- %s", 
tmp1
, 
tmp2
,

263 
tmp2
, 
tmp1
);

264 
	`g_
(
tmp1
);

265 
	`g_
(
tmp2
);

266 
ag
 = 
TRUE
;

268 if(
t
!=
NULL
 && 
	`
(title)>0)

270 if(
ag
)

271 
	`g_rg_nd_c
(
key
, '|');

272 
tmp1
 = 
	`g_gex_es_rg
(
t
, -1);

273 
	`g_rg_nd
(
key
, 
tmp1
);

274 
	`g_
(
tmp1
);

275 
ag
 = 
TRUE
;

277 if(
bum
!=
NULL
 && 
	`
(album)>0)

279 if(
ag
)

280 
	`g_rg_nd_c
(
key
, '|');

281 
tmp1
 = 
	`g_gex_es_rg
(
bum
, -1);

282 
	`g_rg_nd
(
key
, 
tmp1
);

283 
	`g_
(
tmp1
);

284 
ag
 = 
TRUE
;

286 if(!
ag
)

288 
	`g_rg_
(
key
, 
TRUE
);

289  
NULL
;

291 
	`g_rg_nd
(
key
, ")\\.(([Jj][Pp][Gg])|([Pp][Nn][Gg])|"

293 
gex
 = 
	`g_gex_w
(
key
->
r
, 0, 0, 
NULL
);

294 
	`g_rg_
(
key
, 
TRUE
);

295 if(
gex
==
NULL
)

297 
	`g_
(
fd
);

298  
NULL
;

300 if(
fd
!=
NULL
)

301 
d
 = 
	`g_d_ݒ
(
fd
, 0, 
NULL
);

302 if(
d
!=
NULL
)

304 (
ame_fܗch
=
	`g_d_ad_me
(
d
))!=
NULL
)

306 if(
	`g_gex_mch
(
gex
, 
ame_fܗch
, 0, 
NULL
))

308 
su
 = 
	`g_bud_fame
(
fd
, 
ame_fܗch
, 
NULL
);

312 
	`g_d_o
(
d
);

313 
	`g_
(
fd
);

314 if(
su
!=
NULL
)

316 
	`g_gex_uef
(
gex
);

317  
su
;

320 if(
ut_cov_ch_d
==
NULL
)

322 
	`g_gex_uef
(
gex
);

323  
NULL
;

325 
d
 = 
	`g_d_ݒ
(
ut_cov_ch_d
, 0, 
NULL
);

326 if(
d
!=
NULL
)

328 (
ame_fܗch
=
	`g_d_ad_me
(
d
))!=
NULL
)

330 if(
	`g_gex_mch
(
gex
, 
ame_fܗch
, 0, 
NULL
))

332 
su
 = 
	`g_bud_fame
(
ut_cov_ch_d
,

333 
ame_fܗch
, 
NULL
);

337 
	`g_d_o
(
d
);

339 
	`g_gex_uef
(
gex
);

340  
su
;

341 
	}
}

352 
gch
 *
	$rib_ut_de_codg_by_lo
()

354 
gch
 *
codg
 = 
NULL
;

355 
gch
 *
lo
;

356 
lo
 = 
	`o
(
LC_ALL
, 
NULL
);

357 if(
	`g_r_has_efix
(
lo
, "zh_CN"))

358 
codg
 = 
	`g_rdup
("GB18030");

359 if(
	`cmp
(
lo
, "zh_TW", 5)==0)

360 
codg
 = 
	`g_rdup
("BIG5");

361 if(
	`cmp
(
lo
, "ja_JP", 5)==0)

362 
codg
 = 
	`g_rdup
("ShiftJIS");

363  
codg
;

364 
	}
}

	@lib/rclib-util.h

25 #ide
HAVE_RCLIB_UTILITIES_H


26 
	#HAVE_RCLIB_UTILITIES_H


	)

28 
	~<lims.h
>

29 
	~<dlib.h
>

30 
	~<rg.h
>

31 
	~<glib.h
>

32 
	~<g/g.h
>

34 
G_BEGIN_DECLS


36 
gch
 *
rib_ut_g_da_d
(cڡ gch *
me
, cڡ gch *
g0
);

37 
gboޗn
 
rib_ut_is_su܋d_med
(cڡ 
gch
 *
fe
);

38 
gboޗn
 
rib_ut_is_su܋d_li
(cڡ 
gch
 *
fe
);

39 
rib_ut_t_cov_ch_d
(cڡ 
gch
 *
d
);

40 cڡ 
gch
 *
rib_ut_g_cov_ch_d
();

41 
gch
 *
rib_ut_ch_cov
(cڡ gch *
uri
, cڡ gch *
t
,

42 cڡ 
gch
 *
ti
, cڡ gch *
bum
);

43 
gch
 *
rib_ut_de_codg_by_lo
();

45 
	gG_END_DECLS


	@lib/rclib.c

26 
	~"rib.h
"

27 
	~"rib-comm.h
"

42 cڡ 
gut
 
	grib_maj_vsi
 = 1;

43 cڡ 
gut
 
	grib_m_vsi
 = 9;

44 cڡ 
gut
 
	grib_mio_vsi
 = 4;

45 cڡ 
gch
 *
	grib_bud_de
 = 
__DATE__
;

46 cڡ 
gch
 *
	grib_bud_time
 = 
__TIME__
;

48 
gch
 *
	gdb_fe
 = 
NULL
;

49 
gulg
 
	gma_g_found_hdr
 = 0;

50 
gulg
 
	gma_w_duti_hdr
 = 0;

51 
gulg
 
	gma_log_de_hdr
 = 0;

52 
gulg
 
	gma_ayi_de_hdr
 = 0;

53 
gulg
 
	gma_r_hdr
 = 0;

55 
	$rib_ma_upde_db_mada_cb
(
RCLibCe
 *
ce
,

56 cڡ 
RCLibCeMada
 *
mada
, cڡ 
gch
 *
uri
, 
gpor
 
da
)

58 
RCLibDbPyliDa
 *
ayli_da
;

59 
gt
 
t
;

60 
RCLibCeSourTy
 
ty
;

61 
GSequIr
 *

;

62 if(
mada
==
NULL
 || 
uri
==NULL) ;

63 

 = 
	`rib_ce_g_db_n
();

64 if(

==
NULL
 || !
	`rib_db_ayli_is_vid_
(iter)) ;

65 
ayli_da
 = 
	`g_qu_g
(

);

66 
ty
 = 
	`rib_ce_g_sour_ty
();

67 
t
 = 
	`g_rcmp0
(
uri
, 
ayli_da
->uri);

68 if(
ty
==
RCLIB_CORE_SOURCE_NORMAL
 && 
t
!=0) ;

69 
ayli_da
 = 
	`g_w0
(
RCLibDbPyliDa
, 1);

70 
ayli_da
->
t
 = 
mada
->title;

71 
ayli_da
->
ti
 = 
mada
->artist;

72 
ayli_da
->
bum
 = 
mada
->album;

73 
ayli_da
->
y
 = 
mada
->ftype;

74 
ayli_da
->
acknum
 = 
mada
->
ack
;

75 
ayli_da
->
yr
 = 
mada
->year;

76 if(
ty
==
RCLIB_CORE_SOURCE_CUE
 ||y==
RCLIB_CORE_SOURCE_EMBEDDED_CUE
)

77 
ayli_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_CUE
;

79 
ayli_da
->
ty
 = 
RCLIB_DB_PLAYLIST_TYPE_MUSIC
;

80 
	`rib_db_ayli_upde_mada
(

, 
ayli_da
);

81 if(
mada
->
duti
>0)

82 
	`rib_db_ayli_upde_ngth
(

, 
mada
->
duti
);

83 
	`g_
(
ayli_da
);

84 
	}
}

86 
	$rib_ma_upde_db_duti_cb
(
RCLibCe
 *
ce
,

87 
gt64
 
duti
, 
gpor
 
da
)

89 
GSequIr
 *

 = 
	`rib_ce_g_db_n
();

90 if(

==
NULL
 || 
duti
<0) ;

91 
	`rib_db_ayli_upde_ngth
(

, 
duti
);

92 
	}
}

94 
	$rib_ma_log_de_cb
(
RCLibDb
 *
db
, 
GSequIr
 *

,

95 
gpor
 
da
)

97 
RCLibDbPyliDa
 *
ayli_da
;

98 
GSequIr
 *
n_
;

99 if(

==
NULL
) ;

100 
n_
 = 
	`rib_ce_g_db_n
();

101 if(
n_
!=
NULL
)

103 
ayli_da
 = 
	`g_qu_g
(
n_
);

104 if(
ayli_da
->
log
==

)

105 
	`rib_ce_upde_db_n
(
NULL
);

107 
	}
}

109 
	$rib_ma_ayli_de_cb
(
RCLibDb
 *
db
, 
GSequIr
 *

,

110 
gpor
 
da
)

112 if(

==
NULL
) ;

113 if(

==
	`rib_ce_g_db_n
())

114 
	`rib_ce_upde_db_n
(
NULL
);

115 
	}
}

117 
	$rib_ma_r_cb
(
RCLibCe
 *
ce
, cڡ 
gch
 *
mesge
,

118 
gpor
 
da
)

120 
GSequIr
 *

;

121 

 = 
	`rib_ce_g_db_n
();

122 if(

==
NULL
) ;

123 
	`rib_db_ayli_t_ty
(

, 
RCLIB_DB_PLAYLIST_TYPE_MISSING
);

124 
	}
}

143 
gboޗn
 
	$rib_
(
gt
 *
gc
, 
gch
 **
gv
[], cڡ gch *
d
,

144 
GE
 **
r
)

146 
gch
 *
lyric_d
, *
bum_d
;

147 
gch
 *
gs_fe
;

148 if(
d
==
NULL
 
FALSE
;

149 
	`g_ty_
();

150 if(!
	`g__check
(
gc
, 
gv
, 
r
))

151  
FALSE
;

152 if(!
	`rib_ce_
(
r
))

153  
FALSE
;

154 
	`g_mkd_wh_s
(
d
, 0700);

155 
db_fe
 = 
	`g_bud_fame
(
d
, "libry.zdb", 
NULL
);

156 if(!
	`rib_db_
(
db_fe
))

158 
	`rib_ce_ex
();

159  
FALSE
;

161 
	`rib_ay_
();

162 
	`rib_lyric_
();

163 
	`rib_bum_
();

164 
	`rib_gs_
();

165 
lyric_d
 = 
	`g_bud_fame
(
d
, "Lyrics", 
NULL
);

166 
	`g_mkd_wh_s
(
lyric_d
, 0700);

167 
	`rib_lyric_t_ch_d
(
lyric_d
);

168 
	`g_
(
lyric_d
);

169 
bum_d
 = 
	`g_bud_fame
(
d
, "AlbumImages", 
NULL
);

170 
	`g_mkd_wh_s
(
bum_d
, 0700);

171 
	`rib_ut_t_cov_ch_d
(
bum_d
);

172 
	`g_
(
bum_d
);

173 
gs_fe
 = 
	`g_bud_fame
(
d
, "gs.cf", 
NULL
);

174 
	`rib_gs_ld_om_fe
(
gs_fe
);

175 
	`g_
(
gs_fe
);

176 
ma_g_found_hdr
 = 
	`rib_ce_sigl_c
("tag-found",

177 
	`G_CALLBACK
(
rib_ma_upde_db_mada_cb
), 
NULL
);

178 
ma_w_duti_hdr
 = 
	`rib_ce_sigl_c
("new-duration",

179 
	`G_CALLBACK
(
rib_ma_upde_db_duti_cb
), 
NULL
);

180 
ma_log_de_hdr
 = 
	`rib_db_sigl_c
("catalog-delete",

181 
	`G_CALLBACK
(
rib_ma_log_de_cb
), 
NULL
);

182 
ma_ayi_de_hdr
 = 
	`rib_db_sigl_c
("playlist-delete",

183 
	`G_CALLBACK
(
rib_ma_ayli_de_cb
), 
NULL
);

184 
ma_r_hdr
 = 
	`rib_ce_sigl_c
("error",

185 
	`G_CALLBACK
(
rib_ma_r_cb
), 
NULL
);

186  
TRUE
;

187 
	}
}

195 
	$rib_ex
()

197 if(
ma_g_found_hdr
>0)

198 
	`rib_ce_sigl_disc
(
ma_g_found_hdr
);

199 if(
ma_w_duti_hdr
>0)

200 
	`rib_ce_sigl_disc
(
ma_w_duti_hdr
);

201 if(
ma_log_de_hdr
>0)

202 
	`rib_db_sigl_disc
(
ma_log_de_hdr
);

203 if(
ma_ayi_de_hdr
>0)

204 
	`rib_db_sigl_disc
(
ma_ayi_de_hdr
);

205 if(
ma_r_hdr
>0)

206 
	`rib_ce_sigl_disc
(
ma_r_hdr
);

207 
	`g_
(
db_fe
);

208 
	`rib_gs_ex
();

209 
	`rib_bum_ex
();

210 
	`rib_lyric_ex
();

211 
	`rib_ce_ex
();

212 
	`rib_db_ex
();

213 
	}
}

	@lib/rclib.h

25 #ide
HAVE_RC_LIB_H


26 
	#HAVE_RC_LIB_H


	)

28 
	~<glib.h
>

29 
	~<g/g.h
>

30 
	~"rib-ce.h
"

31 
	~"rib-db.h
"

32 
	~"rib-g.h
"

33 
	~"rib-cue.h
"

34 
	~"rib-ay.h
"

35 
	~"rib-ut.h
"

36 
	~"rib-lyric.h
"

37 
	~"rib-bum.h
"

38 
	~"rib-gs.h
"

39 
	~"rib-ug.h
"

41 
G_BEGIN_DECLS


48 cڡ 
gut
 
rib_maj_vsi
;

55 cڡ 
gut
 
rib_m_vsi
;

62 cڡ 
gut
 
rib_mio_vsi
;

69 cڡ 
gch
 *
rib_bud_de
;

76 cڡ 
gch
 *
rib_bud_time
;

78 
gboޗn
 
rib_
(
gt
 *
gc
, 
gch
 **
gv
[], cڡ gch *
d
,

79 
GE
 **
r
);

80 
rib_ex
();

82 
	gG_END_DECLS


	@plugins/base/desklrc.c

26 
	~<glib.h
>

27 
	~<glib/gtf.h
>

28 
	~<gtk/gtk.h
>

29 
	~<glib/gi18n.h
>

30 
	~<dlib.h
>

31 
	~<rib.h
>

33 
	#DESKLRC_ID
 "rc2-tive-deskt-lyric"

	)

35 
	#DESKLRC_MAX_LINE_NUMBER
 4

	)

37 
	#DESKLRC_OSD_WINDOW_MIN_WIDTH
 320

	)

38 
	#DESKLRC_DEFAULT_FONT_NAME
 "Moa 22"

	)

39 
	#DESKLRC_DEFAULT_OUTLINE_WIDTH
 3

	)

40 
	#DESKLRC_BORDER_WIDTH
 5

	)

41 
	#DESKLRC_DEFAULT_WIDTH
 1024

	)

43 
	#DESKLRC_MARGIN_TOP
 10

	)

44 
	#DESKLRC_MARGIN_BOTTOM
 10

	)

45 
	#DESKLRC_MARGIN_LEFT
 10

	)

46 
	#DESKLRC_MARGIN_RIGHT
 10

	)

47 
	#DESKLRC_LINE_PADDING
 5

	)

50 
	mDESKLRC_WINDOW_NORMAL
,

51 
	mDESKLRC_WINDOW_DOCK
,

52 }
	tDeskcWdowMode
;

55 
	mDESKLRC_LAYOUT_TEXT1_LINE1
 = 0,

56 
	mDESKLRC_LAYOUT_TEXT1_LINE2
 = 1,

57 
	mDESKLRC_LAYOUT_TEXT2_LINE1
 = 2,

58 
	mDESKLRC_LAYOUT_TEXT2_LINE2
 = 3,

59 
	mDESKLRC_LAYOUT_LAST
 = 4

60 }
	tDeskcTextLayout
;

62 
	sDeskcRdCڋxt


64 
gch
 *
	mft_me
;

65 
gt
 
	moue_width
;

66 
GdkRGBA
 
	mlr_nm_cs
[3];

67 
GdkRGBA
 
	mlr_aive_cs
[3];

68 
gdoub
 
	mlr_pos
[3];

69 
PgoCڋxt
 *
	mngo_cڋxt
;

70 
PgoLayout
 *
	mngo_yout
;

71 
gch
 *
	mxt
;

72 
gdoub
 
	mblur_dius
;

73 
gt
 
	mft_height
;

74 }
	tDeskcRdCڋxt
;

76 
	sDeskcPrive


78 
GtkWidg
 *
	mwdow
;

79 
DeskcRdCڋxt
 *
	mnd_cڋxt
;

80 
DeskcWdowMode
 
	mmode
;

81 
o_sur_t
 *
	mlyric_sur
[
DESKLRC_LAYOUT_LAST
];

82 
o_sur_t
 *
	mlyric_aive_sur
[2];

83 
gch
 *
	mlyric_xt
[
DESKLRC_LAYOUT_LAST
];

84 
gdoub
 
	mlyric_r
[2];

85 
gt
 
	mlyric_le_num
[2];

86 
gboޗn
 
	mcomposed
;

87 
gboޗn
 
	mmovab
;

88 
gboޗn
 
	mnify_ag
;

89 
gboޗn
 
	mupde_she
;

90 
PgoLayout
 *
	myout
;

91 
GdkRGBA
 
	mbg_c1
;

92 
GdkRGBA
 
	mbg_c2
;

93 
GdkRGBA
 
	mbg_c3
;

94 
GdkRGBA
 
	mfg_c1
;

95 
GdkRGBA
 
	mfg_c2
;

96 
GdkRGBA
 
	mfg_c3
;

97 
GdkPixbuf
 *
	mbg_pixbuf
;

98 
gch
 *
	mft_rg
;

99 
gboޗn
 
	mtwo_le
;

100 
gboޗn
 
	mtwo_ack
;

101 
gt
 
	mosd_wdow_width
;

102 
gt
 
	mosd_wdow_pos_x
;

103 
gt
 
	mosd_wdow_pos_y
;

104 
gulg
 
	mtimeout_id
;

105 
gulg
 
	mshutdown_id
;

106 
GKeyFe
 *
	mkeyfe
;

107 }
	tDeskcPrive
;

109 
	sDeskcPix


111 
gut64
 
	mpha
;

112 
gut64
 
	md
;

113 
gut64
 
	mg
;

114 
gut64
 
	mblue
;

115 }
	tDeskcPix
;

117 
DeskcPrive
 
	gdeskc_iv
 = {0};

119 
le
 
gt
 
	$deskc_pos_to_dex
(
gt
 
x
, g
y
,

120 
gt
 
width
, g
height
)

122 if(
x
 >
width
 || 
y
 >
height
 || x < 0 || y < 0)

124  
y
 * 
width
 + 
x
;

125 
	}
}

127 
le
 
	$deskc_num_to_pix_wh_
(

128 
DeskcPix
 *
pix
, 
gut32
 
vue
, 
gt
 

)

130 if(
pix
==
NULL
) ;

133 
pix
->
pha
 = ((
vue
 >> 24& 0xff* 

;

134 
pix
->
d
 = ((
vue
 >> 16& 0xff* 

;

135 
pix
->
g
 = ((
vue
 >> 8& 0xff* 

;

136 
pix
->
blue
 = (
vue
 & 0xff* 

;

137 
	}
}

139 
le
 
gut32
 
	$deskc_pix_to_num_wh_divis
(

140 
DeskcPix
 *
pix
, 
gt
 
divis
)

142 
gut32
 
pha
 = 
pix
->ph/ 
divis
;

143 if(
pha
 > 0xff)lpha = 0xff;

144 
gut32
 
d
 = 
pix
->d / 
divis
;

145 if(
d
 > 0xff)ed = 0xff;

146 
gut32
 
g
 = 
pix
->g / 
divis
;

147 if(
g
 > 0xff) green = 0xff;

148 
gut32
 
blue
 = 
pix
->blu/ 
divis
;

149 if(
blue
 > 0xff) blue = 0xff;

150  (
pha
 << 24| (
d
 << 16| (
g
 << 8| 
blue
;

151 
	}
}

153 
le
 
	$deskc_pix_us
(

154 
DeskcPix
 *
add_sum
, DeskcPix *
add2
)

156 
add_sum
->
pha
 +
add2
->alpha;

157 
add_sum
->
d
 +
add2
->red;

158 
add_sum
->
g
 +
add2
->green;

159 
add_sum
->
blue
 +
add2
->blue;

160 
	}
}

162 
gt
 *
	$deskc_lc_kl
(
gdoub
 
sigma
, 
gt
 *
size
)

164 
gt
 
kl_size
 = 
	`
 (
sigma
 * 6);

165 if(
kl_size
%2==0) kernel_size++;

166 
gt
 
ig
 = 
kl_size
 / 2;

167 if(
size
*siz
kl_size
;

168 
gdoub
 *
kl_doub
 = 
	`g_w
(, 
kl_size
);

169 
gdoub
 
sum
 = 0.0;

170 
gt
 *
kl
 = 
	`g_w
(, 
kl_size
);

171 
gt
 
i
;

172 
gdoub
 

 = 1.0 / 
	`sq
 (2.0 * 
M_PI
 * 
sigma
 * sigma);

173 
gdoub
 
dom
 = 1.0 / (2.0 * 
sigma
 * sigma);

174 
i
=0;i<
kl_size
;i++)

176 
kl_doub
[
i
] = 

*
	`exp
(-(- 
ig
)*(- orig)*
dom
);

177 
sum
+=
kl_doub
[
i
];

180 
i
=0;i<
kl_size
;i++)

182 
kl
[
i
] = 
kl_doub
[i]/
sum
*(1<<((
gt
)/2*8));

184 
	`g_
(
kl_doub
);

185  
kl
;

186 
	}
}

188 
	$deskc_y_kl
(
o_sur_t
 *
sur
,

189 cڡ 
gt
 *
kl
, g
kl_size
)

191 if(
kl
==
NULL
) ;

192 if(
kl_size
<=0 || kernel_size%2==0) ;

193 cڡ 
DIR
[2][2] = {{0, 1}, {1, 0}};

194 
gut32
 *
pixs
 = (gut32 *)
	`o_image_sur_g_da
(
sur
);

195 
gt
 
width
 = 
	`o_image_sur_g_width
(
sur
);

196 
gt
 
height
 = 
	`o_image_sur_g_height
(
sur
);

197 if(
pixs
==
NULL
 || 
width
 <0 || 
height
 <= 0)

199 
	`g_wng
("Invalid image surface");

202 
gt
 
kl_ig
 = 
kl_size
 / 2;

203 
gt
 
d
, 
i
, 
x
, 
y
;

204 
d
=0;d<2;d++)

206 
gut32
 *
d_pixs
 = 
	`g_w
(gut32, 
width
 * 
height
);

207 
	`memy
(
d_pixs
, 
pixs
, (
gut32
)*
width
*
height
);

208 
x
=0;x<
width
;x++)

210 
y
 = 0; y < 
height
; y++)

212 
DeskcPix
 
f_vue
 = {0};

213 
gt
 
sum
 = 0;

214 
i
=0;i<
kl_size
;i++)

216 
gt
 
x1
 = 
x
 + (
i
 - 
kl_ig
* 
DIR
[
d
][0];

217 
gt
 
y1
 = 
y
 + (
i
 - 
kl_ig
* 
DIR
[
d
][1];

218 
gt
 
dex1
 = 
	`deskc_pos_to_dex
(
x1
, 
y1
,

219 
width
, 
height
);

220 if(
dex1
>0)

222 
sum
 +
kl
[
i
];

223 
DeskcPix
 
vue
;

224 
	`deskc_num_to_pix_wh_
(&
vue
,

225 
d_pixs
[
dex1
], 
kl
[
i
]);

226 
	`deskc_pix_us
 (&
f_vue
, &
vue
);

229 
gt
 
dex
 = 
	`deskc_pos_to_dex
(
x
, 
y
, 
width
,

230 
height
);

231 
pixs
[
dex
] = 
	`deskc_pix_to_num_wh_divis
(

232 &
f_vue
, 
sum
);

235 
	`g_
(
d_pixs
);

237 
	}
}

240 
	$deskc_gussn_blur
(
o_sur_t
 *
sur
,

241 
gdoub
 
sigma
)

243 if(
sur
==
NULL
) ;

244 if(
sigma
<=0.0) ;

245 
o_fm_t
 
fm
 = 
	`o_image_sur_g_fm
(
sur
);

246 if(
fm
!=
CAIRO_FORMAT_ARGB32
)

248 
	`g_wng
("The surface format is %d, only ARGB32 is supported",

249 
fm
);

252 
gt
 
kl_size
;

253 
gt
 *
kl
 = 
	`deskc_lc_kl
(
sigma
, &
kl_size
);

254 
	`deskc_y_kl
(
sur
, 
kl
, 
kl_size
);

255 
	`g_
(
kl
);

256 
	}
}

258 
	$deskc_t_pixbuf_
(
o_t
 *

,

259 
GdkPixbuf
 *
sour
, 
gdoub
 
c_x
, gdoub 
c_y
, gdoub 
c_w
,

260 
gdoub
 
c_h
, gdoub 
des_x
, gdoub 
des_y
, gdoub 
des_w
,

261 
gdoub
 
des_h
)

263 
gdoub
 
sw
, 
sh
;

264 if(

==
NULL
 || 
sour
==NULL) ;

265 
	`o_ve
(

);

266 
sw
 = 
des_w
 / 
c_w
;

267 
sh
 = 
des_h
 / 
c_h
;

268 
	`o_e
(

, 
des_x
, 
des_y
);

269 
	`o_g
(

, 0, 0, 
des_w
, 
des_h
);

270 
	`o_s
(

, 
sw
, 
sh
);

271 
	`o_
(

);

272 
	`gdk_o_t_sour_pixbuf
(

, 
sour
, -
c_x
, -
c_y
);

273 
	`o_t
(

);

274 
	`o_e
(

);

275 
	}
}

277 
	$deskc_r_o
(
o_t
 *

)

279 if(

==
NULL
) ;

280 
	`o_ve
(

);

281 
	`o_t_sour_rgba
(

, 1.0, 1.0, 1.0, 0.0);

282 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_SOURCE
);

283 
	`o_t
(

);

284 
	`o_e
(

);

285 
	}
}

287 
	$deskc_nd_upde_ft_height
(

288 
DeskcRdCڋxt
 *
cڋxt
)

290 
PgoFtMrics
 *
mrics
;

291 
gt
 
as
, 
des
;

292 
mrics
 = 
	`ngo_cڋxt_g_mrics
(
cڋxt
->
ngo_cڋxt
,

293 
	`ngo_yout_g_ft_desti
(
cڋxt
->
ngo_yout
), 
NULL
);

294 if(
mrics
==
NULL
)

296 
	`g_wng
("Cannot get font metrics!");

298 
cڋxt
->
ft_height
 = 0;

299 
as
 = 
	`ngo_ft_mrics_g_as
(
mrics
);

300 
des
 = 
	`ngo_ft_mrics_g_des
(
mrics
);

301 
	`ngo_ft_mrics_uef
(
mrics
);

302 
cڋxt
->
ft_height
 +
	`PANGO_PIXELS
(
as
 + 
des
);

303 
	}
}

305 
	$deskc_nd_upde_ft
(
DeskcRdCڋxt
 *
cڋxt
)

307 
PgoFtDesti
 *
ft_desc
;

308 if(
cڋxt
==
NULL
) ;

309 
ft_desc
 = 
	`ngo_ft_desti_om_rg
(
cڋxt
->
ft_me
);

310 
	`ngo_yout_t_ft_desti
(
cڋxt
->
ngo_yout
, 
ft_desc
);

311 
	`ngo_ft_desti_
(
ft_desc
);

312 
	`deskc_nd_upde_ft_height
(
cڋxt
);

313 
	}
}

315 
	$deskc_nd_t_ft_me
(
DeskcRdCڋxt
 *
cڋxt
,

316 cڡ 
gch
 *
ft_me
)

318 if(
cڋxt
==
NULL
 || 
ft_me
==NULL) ;

319 
	`g_
(
cڋxt
->
ft_me
);

320 
cڋxt
->
ft_me
 = 
	`g_rdup
(font_name);

321 
	`deskc_nd_upde_ft
(
cڋxt
);

322 
	}
}

324 
DeskcRdCڋxt
 *
	$deskc_nd_cڋxt_w
()

326 
DeskcRdCڋxt
 *
cڋxt
 = 
	`g_w0
(DesklrcRenderContext, 1);

327 
cڋxt
->
ft_me
 = 
	`g_rdup
(
DESKLRC_DEFAULT_FONT_NAME
);

328 
cڋxt
->
lr_pos
[0] = 0.0;

329 
cڋxt
->
lr_pos
[1] = 0.5;

330 
cڋxt
->
lr_pos
[2] = 1.0;

331 
	`gdk_rgba_r
(&(
cڋxt
->
lr_nm_cs
[0]), "#4CFFFF");

332 
	`gdk_rgba_r
(&(
cڋxt
->
lr_nm_cs
[1]), "#0000FF");

333 
	`gdk_rgba_r
(&(
cڋxt
->
lr_nm_cs
[2]), "#4CFFFF");

334 
	`gdk_rgba_r
(&(
cڋxt
->
lr_aive_cs
[0]), "#FFFF00");

335 
	`gdk_rgba_r
(&(
cڋxt
->
lr_aive_cs
[1]), "#FF4C4C");

336 
	`gdk_rgba_r
(&(
cڋxt
->
lr_aive_cs
[2]), "#FFFF00");

337 
cڋxt
->
ngo_cڋxt
 = 
	`gdk_ngo_cڋxt_g
();

338 
cڋxt
->
ngo_yout
 = 
	`ngo_yout_w
(cڋxt->
ngo_cڋxt
);

339 
cڋxt
->
xt
 = 
NULL
;

340 
cڋxt
->
blur_dius
 = 0.0;

341 
	`deskc_nd_upde_ft
(
cڋxt
);

342 
cڋxt
->
oue_width
 = 
DESKLRC_DEFAULT_OUTLINE_WIDTH
;

343  
cڋxt
;

344 
	}
}

346 
	$deskc_nd_cڋxt_deroy
(
DeskcRdCڋxt
 *
cڋxt
)

348 if(
cڋxt
==
NULL
) ;

349 
	`g_
(
cڋxt
->
ft_me
);

350 if(
cڋxt
->
ngo_yout
!=
NULL
)

351 
	`g_obje_uef
(
cڋxt
->
ngo_yout
);

352 if(
cڋxt
->
ngo_cڋxt
!=
NULL
)

353 
	`g_obje_uef
(
cڋxt
->
ngo_cڋxt
);

354 
	`g_
(
cڋxt
->
xt
);

355 
	`g_
(
cڋxt
);

356 
	}
}

358 
	$deskc_nd_t_xt
(
DeskcRdCڋxt
 *
cڋxt
,

359 cڡ 
gch
 *
xt
)

361 if(
cڋxt
==
NULL
 || 
xt
==NULL) ;

362 if(
cڋxt
->
xt
!=
NULL
)

364 if(
	`g_rcmp0
(
cڋxt
->
xt
,ext)==0)

366 
	`g_
(
cڋxt
->
xt
);

368 
cڋxt
->
xt
 = 
	`g_rdup
(text);

369 
	`ngo_yout_t_xt
(
cڋxt
->
ngo_yout
, 
xt
, -1);

370 
	}
}

372 
	$deskc_nd_g_pix_size
(
DeskcRdCڋxt
 *
cڋxt
,

373 cڡ 
gch
 *
xt
, 
gt
 *
width
, g*
height
)

375 
gt
 
w
, 
h
;

376 if(
cڋxt
==
NULL
 || 
xt
==NULL || 
width
==NULL || 
height
==NULL) ;

377 
	`deskc_nd_t_xt
(
cڋxt
, 
xt
);

378 
	`ngo_yout_g_pix_size
 (
cڋxt
->
ngo_yout
, &
w
, &
h
);

379 if(
width
!=
NULL
)

381 *
width
 = 
	`round
(
w
 + 
cڋxt
->
oue_width
 +

382 
cڋxt
->
blur_dius
 * 2);

384 if(
height
!=
NULL
)

386 *
height
 = 
	`round
(
h
 + 
cڋxt
->
oue_width
 +

387 
cڋxt
->
blur_dius
 * 2);

389 
	}
}

391 
	$deskc_nd_t_xt
(
DeskcRdCڋxt
 *
cڋxt
,

392 
o_t
 *

, cڡ 
gch
 *
xt
, 
gdoub
 
xpos
, gdoub 
ypos
,

393 
gboޗn
 
aive
)

395 
gt
 
width
, 
height
;

396 
gt
 
i
;

397 
o_n_t
 *
n
;

398 if(
cڋxt
==
NULL
 || 

==NULL || 
xt
==NULL) ;

399 
	`deskc_nd_t_xt
(
cڋxt
, 
xt
);

400 
xpos
 +
cڋxt
->
oue_width
 / 2.0 + cڋxt->
blur_dius
;

401 
ypos
 +
cڋxt
->
oue_width
 / 2.0 + cڋxt->
blur_dius
;

402 
	`ngo_yout_g_pix_size
(
cڋxt
->
ngo_yout
, &
width
, &
height
);

403 
	`o_move_to
(

, 
xpos
, 
ypos
);

404 
	`o_ve
(

);

405 
	`ngo_o_yout_th
(

, 
cڋxt
->
ngo_yout
);

406 
	`o_t_sour_rgba
(

, 0.0, 0.0, 0.0, 0.8);

407 if(
cڋxt
->
oue_width
>0)

409 
	`o_t_le_width
(

, 
cڋxt
->
oue_width
);

410 if(
cڋxt
->
blur_dius
>1e-4)

412 
	`o_roke_erve
(

);

413 
	`o_fl
(

);

414 
	`deskc_gussn_blur
(
	`o_g_rg
(

),

415 
cڋxt
->
blur_dius
);

419 
	`o_roke
(

);

422 
	`o_e
(

);

423 
	`o_ve
(

);

424 
	`o_w_th
(

);

425 
n
 = 
	`o_n__lr
(
xpos
, 
ypos
, xpos, ypos+
height
);

426 
i
=0;i<3;i++)

428 if(
aive
)

430 
	`o_n_add_c__rgb
(
n
, 
cڋxt
->
lr_pos
[
i
],

431 
cڋxt
->
lr_aive_cs
[
i
].
d
,

432 
cڋxt
->
lr_aive_cs
[
i
].
g
,

433 
cڋxt
->
lr_aive_cs
[
i
].
blue
);

437 
	`o_n_add_c__rgb
(
n
, 
cڋxt
->
lr_pos
[
i
],

438 
cڋxt
->
lr_nm_cs
[
i
].
d
,

439 
cڋxt
->
lr_nm_cs
[
i
].
g
,

440 
cڋxt
->
lr_nm_cs
[
i
].
blue
);

443 
	`o_t_sour
(

, 
n
);

444 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

445 
	`o_move_to
(

, 
xpos
, 
ypos
);

446 
	`ngo_o_show_yout
(

, 
cڋxt
->
ngo_yout
);

447 
	`o_n_deroy
(
n
);

448 
	`o_e
(

);

449 
	}
}

451 
gboޗn
 
	$deskc_wdow_l_visib
(
DeskcPrive
 *
iv
)

453 if(
iv
==
NULL
 
FALSE
;

454  (
iv
->
mode
==
DESKLRC_WINDOW_NORMAL
) ||

455 (
iv
->
movab
 &&riv->
nify_ag
);

456 
	}
}

458 
gboޗn
 
	$deskc_t_bg
(
DeskcPrive
 *
iv
, 
o_t
 *

)

460 
GtkAoti
 
loti
;

461 
gt
 
w
, 
h
;

462 
gt
 
sw
, 
sh
;

463 
GtkStyCڋxt
 *
cڋxt
;

464 if(
iv
==
NULL
 || 

==NULL 
FALSE
;

465 if(
iv
->
wdow
==
NULL
 
FALSE
;

466 
	`gtk_widg_g_loti
(
iv
->
wdow
, &
loti
);

467 
w
 = 
loti
.
width
;

468 
h
 = 
loti
.
height
;

469 
	`deskc_r_o
(

);

470 if(
	`deskc_wdow_l_visib
(
iv
))

472 if(
iv
->
bg_pixbuf
!=
NULL
)

474 if(
iv
->
composed
)

476 
	`deskc_r_o
(

);

480 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_SOURCE
);

481 
	`o_t_sour_rgb
(

, 0.9, 0.9, 0.9);

482 
	`o_g
(

, 0, 0, 
w
, 
h
);

483 
	`o_fl
(

);

485 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

486 
sw
 = 
	`gdk_pixbuf_g_width
(
iv
->
bg_pixbuf
);

487 
sh
 = 
	`gdk_pixbuf_g_height
(
iv
->
bg_pixbuf
);

488 
	`deskc_t_pixbuf_
(

, 
iv
->
bg_pixbuf
,

489 0, 0, 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH,

490 0, 0, 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH);

491 
	`deskc_t_pixbuf_
(

, 
iv
->
bg_pixbuf
,

492 0, 
sh
 - 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH,

493 
DESKLRC_BORDER_WIDTH
, 0, 
h
 - DESKLRC_BORDER_WIDTH,

494 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH);

495 
	`deskc_t_pixbuf_
(

, 
iv
->
bg_pixbuf
,

496 
sw
 - 
DESKLRC_BORDER_WIDTH
, 0, DESKLRC_BORDER_WIDTH,

497 
DESKLRC_BORDER_WIDTH
, 
w
 - DESKLRC_BORDER_WIDTH, 0,

498 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH);

499 
	`deskc_t_pixbuf_
(

, 
iv
->
bg_pixbuf
,

500 
sw
 - 
DESKLRC_BORDER_WIDTH
, 
sh
 - DESKLRC_BORDER_WIDTH,

501 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH,

502 
w
 - 
DESKLRC_BORDER_WIDTH
, 
h
 - DESKLRC_BORDER_WIDTH,

503 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH);

504 
	`deskc_t_pixbuf_
(

, 
iv
->
bg_pixbuf
,

505 0, 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH,

506 
sh
 - 
DESKLRC_BORDER_WIDTH
 * 2, 0, DESKLRC_BORDER_WIDTH,

507 
DESKLRC_BORDER_WIDTH
, 
h
 - DESKLRC_BORDER_WIDTH * 2);

508 
	`deskc_t_pixbuf_
(

, 
iv
->
bg_pixbuf
,

509 
sw
 - 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH,

510 
DESKLRC_BORDER_WIDTH
, 
sh
 - DESKLRC_BORDER_WIDTH * 2,

511 
w
 - 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH,

512 
DESKLRC_BORDER_WIDTH
, 
h
 - DESKLRC_BORDER_WIDTH * 2);

513 
	`deskc_t_pixbuf_
(

, 
iv
->
bg_pixbuf
,

514 
DESKLRC_BORDER_WIDTH
, 0, 
sw
 - DESKLRC_BORDER_WIDTH * 2,

515 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH, 0,

516 
w
 - 
DESKLRC_BORDER_WIDTH
 * 2, DESKLRC_BORDER_WIDTH);

517 
	`deskc_t_pixbuf_
(

, 
iv
->
bg_pixbuf
,

518 
DESKLRC_BORDER_WIDTH
, 
sh
 - DESKLRC_BORDER_WIDTH,

519 
sw
 - 
DESKLRC_BORDER_WIDTH
 * 2, DESKLRC_BORDER_WIDTH,

520 
DESKLRC_BORDER_WIDTH
, 
h
 - DESKLRC_BORDER_WIDTH,

521 
w
 - 
DESKLRC_BORDER_WIDTH
 * 2, DESKLRC_BORDER_WIDTH);

522 
	`deskc_t_pixbuf_
(

, 
iv
->
bg_pixbuf
,

523 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH,

524 
sw
 - 
DESKLRC_BORDER_WIDTH
 * 2, 
sh
 - DESKLRC_BORDER_WIDTH * 2,

525 
DESKLRC_BORDER_WIDTH
, DESKLRC_BORDER_WIDTH,

526 
w
 - 
DESKLRC_BORDER_WIDTH
 * 2, 
h
 - DESKLRC_BORDER_WIDTH * 2);

530 
cڋxt
 = 
	`gtk_widg_g_y_cڋxt
(
iv
->
wdow
);

531 
	`gtk_nd_background
(
cڋxt
, 

, 0, 0, 
w
, 
h
);

534  
TRUE
;

535 
	}
}

537 
gboޗn
 
	$deskc_is_rg_emy
(cڡ 
gch
 *
r
)

539 
gt
 
i
;

540 
gut
 
n
;

541 if(
r
==
NULL
 
TRUE
;

542 
n
 = 
	`
(
r
);

543 
i
=0;i<
n
;i++)

545 if(
r
[
i
] != ' ')

546  
FALSE
;

548  
TRUE
;

549 
	}
}

551 
	$deskc_dw_lyric_sur
(
DeskcPrive
 *
iv
,

552 
o_sur_t
 **
sur
, cڡ 
gch
 *
lyric
, 
gboޗn
 
aive
)

554 
gt
 
w
 = 0, 
h
 = 0;

555 
o_t
 *

;

556 if(
iv
==
NULL
 || 
sur
==NULL) ;

557 if(*
sur
!=
NULL
)

559 
	`o_sur_deroy
(*
sur
);

560 *
sur
 = 
NULL
;

562 if(
lyric
==
NULL
) ;

563 if(!
	`gtk_widg_g_ized
(
iv
->
wdow
))

564 
	`gtk_widg_ize
(
iv
->
wdow
);

565 
	`deskc_nd_g_pix_size
(
iv
->
nd_cڋxt
, 
lyric
, &
w
, &
h
);

566 *
sur
 = 
	`o_image_sur_
(
CAIRO_FORMAT_ARGB32
, 
w
, 
h
);

567 

 = 
	`o_
(*
sur
);

568 
	`o_t_sour_rgba
(

, 1.0, 1.0, 1.0, 0.0);

569 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_SOURCE
);

570 
	`o_t
(

);

571 if(!
	`deskc_is_rg_emy
(
lyric
))

573 
	`deskc_nd_t_xt
(
iv
->
nd_cڋxt
, 

, 
lyric
,

574 0, 0, 
aive
);

576 
	`o_deroy
(

);

577 
	}
}

579 
le
 
	$deskc_upde_c
(
DeskcPrive
 *
iv
)

581 if(
iv
==
NULL
 ||riv->
nd_cڋxt
==NULL) ;

582 
iv
->
nd_cڋxt
->
lr_nm_cs
[0] =riv->
bg_c1
;

583 
iv
->
nd_cڋxt
->
lr_nm_cs
[1] =riv->
bg_c2
;

584 
iv
->
nd_cڋxt
->
lr_nm_cs
[2] =riv->
bg_c3
;

585 
iv
->
nd_cڋxt
->
lr_aive_cs
[0] =riv->
fg_c1
;

586 
iv
->
nd_cڋxt
->
lr_aive_cs
[1] =riv->
fg_c2
;

587 
iv
->
nd_cڋxt
->
lr_aive_cs
[2] =riv->
fg_c3
;

588 
	}
}

590 
le
 
	$deskc_dw_dg_shadow
(
o_t
 *

, 
gt
 
width
,

591 
gt
 
height
)

593 
	`o_ve
(

);

594 
	`o_t_sour_rgba
(

, 0.0, 0.0, 0.0, 0.4);

595 
	`o_move_to
(

, 0 + 5, 0);

596 
	`o_le_to
(

, 0 + 
width
 - 5, 0);

597 
	`o_move_to
(

, 0 + 
width
, 0 + 5);

598 
	`o_le_to
(

, 0 + 
width
, 0 + 
height
 - 5);

599 
	`o_move_to
(

, 0 + 
width
 - 5, 0 + 
height
);

600 
	`o_le_to
(

, 0 + 5, 0 + 
height
);

601 
	`o_move_to
(

, 0, 0 + 
height
 - 5);

602 
	`o_le_to
(

, 0, 0 + 5);

603 
	`o_c
(

, 0 + 5, 0 + 5, 5, 
G_PI
, 3 * G_PI / 2.0);

604 
	`o_c
(

, 0 + 
width
 - 5, 0 + 5, 5, 3 * 
G_PI
 / 2, 2 * G_PI);

605 
	`o_c
(

, 0 + 
width
 - 5, 0 + 
height
 - 5, 5, 0, 
G_PI
 / 2);

606 
	`o_c
(

, 0 + 5, 0 + 
height
 - 5, 5, 
G_PI
 / 2, G_PI);

607 
	`o_fl
(

);

608 
	`o_e
(

);

609 
	}
}

611 
	$deskc_show
(
GtkWidg
 *
widg
, 
DeskcPrive
 *
iv
, 
o_t
 *

)

613 
GtkAoti
 
loti
;

614 
o_sur_t
 *
sur
;

615 
gt
 
sur_width
, 
sur_height
;

616 
gt
 
dex1
 = 0, 
dex2
 = 0;

617 
gboޗn
 
two_ack
 = 
FALSE
;

618 
gboޗn
 
two_le
 = 
FALSE
;

619 
gt
 
r1
 = 0.0, 
r2
 = 0.0;

620 
gt
 
t_x
, 
t_y
;

621 
gt
 
r_low
, 
r_u
;

622 
gt
 
r_xt
;

623 
	`gtk_widg_g_loti
(
widg
, &
loti
);

624 if(
iv
->
nify_ag
)

626 
	`deskc_dw_dg_shadow
(

, 
loti
.
width
,

627 
loti
.
height
);

630 
dex1
 = 
iv
->
lyric_le_num
[0];

631 
r1
 = 
iv
->
lyric_r
[0];

634 
sur
 = 
iv
->
lyric_sur
[
DESKLRC_LAYOUT_TEXT1_LINE1
];

635 if(
sur
!=
NULL
)

637 
sur_width
 = 
	`o_image_sur_g_width
(
sur
);

638 
sur_height
 = 
	`o_image_sur_g_height
(
sur
);

639 if(
iv
->
lyric_sur
[
DESKLRC_LAYOUT_TEXT2_LINE1
]!=
NULL
)

640 
two_ack
 = 
TRUE
;

641 
two_le
 = 
iv
->two_line;

642 if(
two_le
)

643 
t_x
 = 
DESKLRC_MARGIN_LEFT
 + (
dex1
%2)*
loti
.
width
/3;

645 
t_x
 = 
DESKLRC_MARGIN_LEFT
;

646 if(
t_x
+
sur_width
>
loti
.
width
)

648 
r_low
 = (
gt
)(
loti
.
width
 - 
t_x
) / 2 /

649 
sur_width
;

650 
r_u
 = 1.0 - 
r_low
;

651 if(
r1
>=
r_u
)

652 
r_xt
 = 1.0;

653 if(
r1
>=
r_low
)

655 
r_xt
 = (
r1
 - 
r_low
) /

656 (
r_u
 - 
r_low
);

659 
r_xt
 = 0.0;

661 
t_x
 +(
gt
)(
loti
.
width
 - 
sur_width
 - start_x -

662 
DESKLRC_MARGIN_LEFT
 - 
DESKLRC_MARGIN_RIGHT
* 
r_xt
;

664 if(
two_le
 && 
two_ack
)

666 if(
dex1
%2==0)

667 
t_y
 = 
DESKLRC_MARGIN_TOP
;

670 
t_y
 = 
DESKLRC_MARGIN_TOP
 + 2 * (
DESKLRC_LINE_PADDING
 +

671 
iv
->
nd_cڋxt
->
ft_height
);

674 if(
two_le
 && !
two_ack
)

676 if(
dex1
%2==0)

677 
t_y
 = 
DESKLRC_MARGIN_TOP
;

679 
t_y
 = 
DESKLRC_MARGIN_TOP
 + 
DESKLRC_LINE_PADDING
 +

680 
iv
->
nd_cڋxt
->
ft_height
;

684 
t_y
 = 
DESKLRC_MARGIN_TOP
;

686 
	`o_ve
(

);

687 if(
iv
->
lyric_aive_sur
[0]!=
NULL
)

689 
	`o_g
(

, 
t_x
 + 
sur_width
 * 
r1
, 
t_y
,

690 
sur_width
 * (1.0 - 
r1
), 
sur_height
);

694 
	`o_g
(

, 
t_x
, 
t_y
, 
sur_width
,

695 
sur_height
);

697 
	`o_
(

);

698 
	`o_t_sour_sur
(

, 
sur
, 
t_x
, 
t_y
);

699 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

700 
	`o_t
(

);

701 
	`o_e
(

);

702 if(
iv
->
lyric_aive_sur
[0]!=
NULL
)

704 
	`o_ve
(

);

705 
	`o_g
(

, 
t_x
, 
t_y
, 
sur_width
 * 
r1
,

706 
sur_height
);

707 
	`o_
(

);

708 
	`o_t_sour_sur
(

, 
iv
->
lyric_aive_sur
[0],

709 
t_x
, 
t_y
);

710 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

711 
	`o_t
(

);

712 
	`o_e
(

);

717 
sur
 = 
iv
->
lyric_sur
[
DESKLRC_LAYOUT_TEXT1_LINE2
];

718 
dex1
++;

719 if(
sur
!=
NULL
)

721 
sur_width
 = 
	`o_image_sur_g_width
(
sur
);

722 
sur_height
 = 
	`o_image_sur_g_height
(
sur
);

723 
t_x
 = 
DESKLRC_MARGIN_LEFT
 + (
dex1
%2)*
loti
.
width
/3;

724 if(
r1
<0.5 && 
t_x
+
sur_width
>
loti
.
width
)

726 
t_x
 +
loti
.
width
 - 
sur_width
 - start_x -

727 
DESKLRC_MARGIN_LEFT
 - 
DESKLRC_MARGIN_RIGHT
;

729 if(
two_ack
)

731 if(
dex1
%2==0)

733 
t_y
 = 
DESKLRC_MARGIN_TOP
;

737 
t_y
 = 
DESKLRC_MARGIN_TOP
 + 2 * (
DESKLRC_LINE_PADDING
 +

738 
iv
->
nd_cڋxt
->
ft_height
);

743 if(
dex1
%2==0)

744 
t_y
 = 
DESKLRC_MARGIN_TOP
;

746 
t_y
 = 
DESKLRC_MARGIN_TOP
 + 
DESKLRC_LINE_PADDING
 +

747 
iv
->
nd_cڋxt
->
ft_height
;

749 
	`o_ve
(

);

750 
	`o_g
(

, 
t_x
, 
t_y
, 
sur_width
,

751 
sur_height
);

752 
	`o_
(

);

753 
	`o_t_sour_sur
(

, 
sur
, 
t_x
, 
t_y
);

754 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

755 
	`o_t
(

);

756 
	`o_e
(

);

759 
dex2
 = 
iv
->
lyric_le_num
[1];

760 
r2
 = 
iv
->
lyric_r
[1];

763 
sur
 = 
iv
->
lyric_sur
[
DESKLRC_LAYOUT_TEXT2_LINE1
];

764 if(
sur
!=
NULL
)

766 
sur_width
 = 
	`o_image_sur_g_width
(
sur
);

767 
sur_height
 = 
	`o_image_sur_g_height
(
sur
);

768 if(
iv
->
lyric_sur
[
DESKLRC_LAYOUT_TEXT2_LINE2
]!=
NULL
)

769 
two_le
 = 
TRUE
;

770 if(
two_le
)

771 
t_x
 = 
DESKLRC_MARGIN_LEFT
 + (
dex2
%2)*
loti
.
width
/3;

773 
t_x
 = 
DESKLRC_MARGIN_LEFT
;

774 if(
t_x
+
sur_width
>
loti
.
width
)

776 
r_low
 = (
gt
)(
loti
.
width
 - 
t_x
) / 2 /

777 
sur_width
;

778 
r_u
 = 1.0 - 
r_low
;

779 if(
r2
>=
r_u
)

780 
r_xt
 = 1.0;

781 if(
r2
>=
r_low
)

783 
r_xt
 = (
r2
 - 
r_low
) /

784 (
r_u
 - 
r_low
);

787 
r_xt
 = 0.0;

788 
t_x
 +(
gt
)(
loti
.
width
 - 
sur_width
 - start_x -

789 
DESKLRC_MARGIN_LEFT
 - 
DESKLRC_MARGIN_RIGHT
* 
r_xt
;

791 if(
two_le
)

793 if(
dex2
%2==0)

794 
t_y
 = 
DESKLRC_MARGIN_TOP
 + 
DESKLRC_LINE_PADDING
 +

795 
iv
->
nd_cڋxt
->
ft_height
;

798 
t_y
 = 
DESKLRC_MARGIN_TOP
 + 3 * (
DESKLRC_LINE_PADDING
 +

799 
iv
->
nd_cڋxt
->
ft_height
);

804 
t_y
 = 
DESKLRC_MARGIN_TOP
 + 
DESKLRC_LINE_PADDING
 +

805 
iv
->
nd_cڋxt
->
ft_height
;

807 
	`o_ve
(

);

808 if(
iv
->
lyric_aive_sur
[1]!=
NULL
)

810 
	`o_g
(

, 
t_x
 + 
sur_width
 * 
r2
, 
t_y
,

811 
sur_width
 * (1.0 - 
r2
), 
sur_height
);

815 
	`o_g
(

, 
t_x
, 
t_y
, 
sur_width
,

816 
sur_height
);

818 
	`o_
(

);

819 
	`o_t_sour_sur
(

, 
sur
, 
t_x
, 
t_y
);

820 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

821 
	`o_t
(

);

822 
	`o_e
(

);

823 if(
iv
->
lyric_aive_sur
[1]!=
NULL
)

825 
	`o_ve
(

);

826 
	`o_g
(

, 
t_x
, 
t_y
, 
sur_width
 * 
r2
,

827 
sur_height
);

828 
	`o_
(

);

829 
	`o_t_sour_sur
(

, 
iv
->
lyric_aive_sur
[1],

830 
t_x
, 
t_y
);

831 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

832 
	`o_t
(

);

833 
	`o_e
(

);

838 
sur
 = 
iv
->
lyric_sur
[
DESKLRC_LAYOUT_TEXT2_LINE2
];

839 
dex2
++;

840 if(
sur
!=
NULL
)

842 
sur_width
 = 
	`o_image_sur_g_width
(
sur
);

843 
sur_height
 = 
	`o_image_sur_g_height
(
sur
);

844 
t_x
 = 
DESKLRC_MARGIN_LEFT
 + (
dex2
%2)*
loti
.
width
/3;

845 if(
r2
<0.5 && 
t_x
+
sur_width
>
loti
.
width
)

847 
t_x
 +
loti
.
width
 - 
sur_width
 - start_x -

848 
DESKLRC_MARGIN_LEFT
 - 
DESKLRC_MARGIN_RIGHT
;

850 if(
dex2
%2==0)

852 
t_y
 = 
DESKLRC_MARGIN_TOP
 + 
DESKLRC_LINE_PADDING
 +

853 
iv
->
nd_cڋxt
->
ft_height
;

857 
t_y
 = 
DESKLRC_MARGIN_TOP
 + 3 * (
DESKLRC_LINE_PADDING
 +

858 
iv
->
nd_cڋxt
->
ft_height
);

860 
	`o_ve
(

);

861 
	`o_g
(

, 
t_x
, 
t_y
, 
sur_width
,

862 
sur_height
);

863 
	`o_
(

);

864 
	`o_t_sour_sur
(

, 
sur
, 
t_x
, 
t_y
);

865 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

866 
	`o_t
(

);

867 
	`o_e
(

);

870 
	}
}

872 
gboޗn
 
	$deskc_dg
(
GtkWidg
 *
widg
, 
GdkEvt
 *
evt
,

873 
gpor
 
da
)

875 
gt
 
move_x
 = 0;

876 
gt
 
move_y
 = 0;

877 
gboޗn
 
dg_ag
 = 
FALSE
;

878 
gboޗn
 
size_ag
 = 
FALSE
;

879 
GdkWdow
 *
wdow
;

880 
GtkAoti
 
loti
;

881 
GdkCurs
 *
curs
 = 
NULL
;

882 
gt
 
x
, 
y
;

883 
gt
 
width
 = 0;

884 
DeskcPrive
 *
iv
 = (DeskcPriv*)
da
;

885 if(
da
==
NULL
 
FALSE
;

886 if(!
iv
->
movab
 
FALSE
;

887 
wdow
 = 
	`gtk_widg_g_wdow
(
widg
);

888 
	`gtk_widg_g_loti
(
widg
, &
loti
);

889 if(
evt
->
bu
.button==1)

891 
evt
->
ty
)

893 
GDK_BUTTON_PRESS
:

895 
move_x
 = 
evt
->
bu
.
x
;

896 
move_y
 = 
evt
->
bu
.
y
;

897 if(
move_x
>
loti
.
width
-10)

899 
size_ag
 = 
TRUE
;

900 
curs
 = 
	`gdk_curs_w
(
GDK_RIGHT_SIDE
);

904 
dg_ag
 = 
TRUE
;

905 
curs
 = 
	`gdk_curs_w
(
GDK_HAND1
);

907 
	`gdk_wdow_t_curs
(
wdow
, 
curs
);

908 
	`g_obje_uef
(
curs
);

911 
GDK_BUTTON_RELEASE
:

913 
dg_ag
 = 
FALSE
;

914 
size_ag
 = 
FALSE
;

915 
curs
 = 
	`gdk_curs_w
(
GDK_ARROW
);

916 
	`gdk_wdow_t_curs
(
wdow
, 
curs
);

917 
	`g_obje_uef
(
curs
);

920 
GDK_MOTION_NOTIFY
:

922 if(
dg_ag
)

924 
	`gtk_wdow_g_posi
(
	`GTK_WINDOW
(
widg
), &
x
, &
y
);

925 
	`gtk_wdow_move
(
	`GTK_WINDOW
(
widg
), 
x
 +

926 
evt
->
bu
.
x
 - 
move_x
, 
y
 +

927 
evt
->
bu
.
y
 - 
move_y
);

928 
	`gtk_wdow_g_posi
(
	`GTK_WINDOW
(
widg
),

929 &(
iv
->
osd_wdow_pos_x
),

930 &(
iv
->
osd_wdow_pos_y
));

932 if(
size_ag
)

934 
width
 = 
evt
->
bu
.
x
 + 10;

935 
iv
->
osd_wdow_width
 = 
width
;

936 
	`gtk_wdow_size
(
	`GTK_WINDOW
(
widg
), 
width
,

937 
loti
.
height
);

941 if(
evt
->
bu
.
x
>
loti
.
width
-10)

942 
curs
 = 
	`gdk_curs_w
(
GDK_RIGHT_SIDE
);

944 
curs
 = 
	`gdk_curs_w
(
GDK_ARROW
);

945 
	`gdk_wdow_t_curs
(
wdow
, 
curs
);

946 
	`g_obje_uef
(
curs
);

953 
evt
->
ty
)

955 
GDK_ENTER_NOTIFY
:

957 
iv
->
nify_ag
 = 
TRUE
;

960 
GDK_LEAVE_NOTIFY
:

962 
iv
->
nify_ag
 = 
FALSE
;

968  
FALSE
;

969 
	}
}

971 
gboޗn
 
	$deskc_upde
(
gpor
 
da
)

973 
DeskcPrive
 *
iv
 = (DeskcPriv*)
da
;

974 if(
da
==
NULL
 
TRUE
;

975 
	`gtk_widg_queue_dw
(
iv
->
wdow
);

976  
TRUE
;

977 
	}
}

979 
le
 
	$deskc_nd_lyric_sur
(
DeskcPrive
 *
iv
,

980 
GSequIr
 *
1
, GSequI*
_beg1
, GSequI*
2
,

981 
GSequIr
 *
_beg2
)

983 cڡ 
RCLibLyricDa
 *
lyric_da
;

984 cڡ 
gch
 *
xt
;

985 
gut
 
le
;

986 
gboޗn
 
aive
;

989 
le
 = 
DESKLRC_LAYOUT_TEXT1_LINE1
;

990 
xt
 = 
NULL
;

991 
G_STMT_START


993 if(
1
==
NULL
虔1 = 
_beg1
;

994 if(
1
==
NULL
) ;

995 
lyric_da
 = 
	`g_qu_g
(
1
);

996 if(
lyric_da
==
NULL
) ;

997 
xt
 = 
lyric_da
->text;

999 
G_STMT_END
;

1000 if(
	`g_rcmp0
(
iv
->
lyric_xt
[
le
], 
xt
)!=0)

1002 
	`deskc_dw_lyric_sur
(
iv
, &riv->
lyric_sur
[
le
]),

1003 
xt
, 
FALSE
);

1004 
	`deskc_dw_lyric_sur
(
iv
, &riv->
lyric_aive_sur
[0]),

1005 
xt
, 
TRUE
);

1006 
	`g_
(
iv
->
lyric_xt
[
le
]);

1007 
iv
->
lyric_xt
[
le
] = 
	`g_rdup
(
xt
);

1011 
le
 = 
DESKLRC_LAYOUT_TEXT1_LINE2
;

1012 if(
iv
->
two_le
)

1014 
xt
 = 
NULL
;

1015 
G_STMT_START


1017 if(
1
==
NULL
虔1 = 
_beg1
;

1018 if(
1
==
NULL
) ;

1019 if(
iv
->
lyric_r
[0]>=0.5)

1021 
1
 = 
	`g_qu__xt
(iter1);

1025 if(
	`g_qu__is_beg
(
1
)) ;

1026 
1
 = 
	`g_qu__ev
(iter1);

1028 if(
1
==
NULL
 || 
	`g_qu__is_d
(iter1)) ;

1029 
lyric_da
 = 
	`g_qu_g
(
1
);

1030 if(
lyric_da
==
NULL
) ;

1031 
xt
 = 
lyric_da
->text;

1033 
G_STMT_END
;

1034 if(
	`g_rcmp0
(
iv
->
lyric_xt
[
le
], 
xt
)!=0)

1036 if(
iv
->
lyric_r
[0]>=0.5
aive
 = 
FALSE
;

1037 
aive
 = 
TRUE
;

1038 
	`deskc_dw_lyric_sur
(
iv
, &riv->
lyric_sur
[
le
]),

1039 
xt
, 
aive
);

1040 
	`g_
(
iv
->
lyric_xt
[
le
]);

1041 
iv
->
lyric_xt
[
le
] = 
	`g_rdup
(
xt
);

1046 if(
iv
->
lyric_sur
[
le
]!=
NULL
)

1048 
	`o_sur_deroy
(
iv
->
lyric_sur
[
le
]);

1049 
iv
->
lyric_sur
[
le
] = 
NULL
;

1051 
	`g_
(
iv
->
lyric_xt
[
le
]);

1052 
iv
->
lyric_xt
[
le
] = 
NULL
;

1055 if(
_beg2
!=
NULL
)

1058 
le
 = 
DESKLRC_LAYOUT_TEXT2_LINE1
;

1059 
xt
 = 
NULL
;

1060 
G_STMT_START


1062 if(
2
==
NULL
虔2 = 
_beg2
;

1063 if(
2
==
NULL
) ;

1064 
lyric_da
 = 
	`g_qu_g
(
2
);

1065 if(
lyric_da
==
NULL
) ;

1066 
xt
 = 
lyric_da
->text;

1068 
G_STMT_END
;

1069 if(
	`g_rcmp0
(
iv
->
lyric_xt
[
le
], 
xt
)!=0)

1071 
	`deskc_dw_lyric_sur
(
iv
, &riv->
lyric_sur
[
le
]),

1072 
xt
, 
FALSE
);

1073 
	`deskc_dw_lyric_sur
(
iv
,

1074 &(
iv
->
lyric_aive_sur
[1]), 
xt
, 
TRUE
);

1075 
	`g_
(
iv
->
lyric_xt
[
le
]);

1076 
iv
->
lyric_xt
[
le
] = 
	`g_rdup
(
xt
);

1080 
le
 = 
DESKLRC_LAYOUT_TEXT2_LINE2
;

1081 if(
iv
->
two_le
)

1083 
xt
 = 
NULL
;

1084 
G_STMT_START


1086 if(
2
==
NULL
虔2 = 
_beg2
;

1087 if(
2
==
NULL
) ;

1088 if(
iv
->
lyric_r
[1]>=0.5)

1090 
2
 = 
	`g_qu__xt
(iter2);

1094 if(
	`g_qu__is_beg
(
2
)) ;

1095 
2
 = 
	`g_qu__ev
(iter2);

1097 if(
2
==
NULL
 || 
	`g_qu__is_d
(iter2)) ;

1098 
lyric_da
 = 
	`g_qu_g
(
2
);

1099 if(
lyric_da
==
NULL
) ;

1100 
xt
 = 
lyric_da
->text;

1102 
G_STMT_END
;

1103 if(
	`g_rcmp0
(
iv
->
lyric_xt
[
le
], 
xt
)!=0)

1105 if(
iv
->
lyric_r
[1]>=0.5
aive
 = 
FALSE
;

1106 
aive
 = 
TRUE
;

1107 
	`deskc_dw_lyric_sur
(
iv
,

1108 &(
iv
->
lyric_sur
[
le
]), 
xt
, 
aive
);

1109 
	`g_
(
iv
->
lyric_xt
[
le
]);

1110 
iv
->
lyric_xt
[
le
] = 
	`g_rdup
(
xt
);

1115 if(
iv
->
lyric_sur
[
le
]!=
NULL
)

1117 
	`o_sur_deroy
(
iv
->
lyric_sur
[
le
]);

1118 
iv
->
lyric_sur
[
le
] = 
NULL
;

1120 
	`g_
(
iv
->
lyric_xt
[
le
]);

1121 
iv
->
lyric_xt
[
le
] = 
NULL
;

1126 
le
=
DESKLRC_LAYOUT_TEXT2_LINE1
;le<=
DESKLRC_LAYOUT_TEXT2_LINE2
;

1127 
le
++)

1129 if(
iv
->
lyric_sur
[
le
]!=
NULL
)

1131 
	`o_sur_deroy
(
iv
->
lyric_sur
[
le
]);

1132 
iv
->
lyric_sur
[
le
] = 
NULL
;

1134 
	`g_
(
iv
->
lyric_xt
[
le
]);

1135 
iv
->
lyric_xt
[
le
] = 
NULL
;

1137 if(
iv
->
lyric_aive_sur
[1]!=
NULL
)

1139 
	`o_sur_deroy
(
iv
->
lyric_aive_sur
[1]);

1140 
iv
->
lyric_aive_sur
[1] = 
NULL
;

1143 
	}
}

1145 
gboޗn
 
	$deskc_dw
(
GtkWidg
 *
widg
, 
o_t
 *

, 
gpor
 
da
)

1147 
DeskcPrive
 *
iv
 = (DeskcPriv*)
da
;

1148 
GtkAoti
 
loti
;

1149 
gt64
 
pos
 = 0, 
offt1
 = 0, 
offt2
 = 0;

1150 
GSequIr
 *
1
 = 
NULL
, *
_beg1
 = NULL;

1151 
GSequIr
 *
2
 = 
NULL
, *
_beg2
 = NULL;

1152 cڡ 
RCLibLyricPdDa
 *
rd_da1
 = 
NULL
;

1153 cڡ 
RCLibLyricPdDa
 *
rd_da2
 = 
NULL
;

1154 cڡ 
RCLibLyricDa
 *
lyric_da
;

1155 
gt64
 
duti
 = 0;

1156 
gt64
 
time_sd
 = 0, 
time_ngth
 = 0;

1157 
gut
 
le
 = 1;

1158 
gt
 
loc_height
 = 0;

1159 if(
da
==
NULL
 
FALSE
;

1160 
	`gtk_widg_g_loti
(
widg
, &
loti
);

1161 
	`deskc_t_bg
(
iv
, 

);

1162 
	`o_t_sour_rgba
(

, 1.0, 1.0, 1.0, 0.0);

1163 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_SOURCE
);

1164 
	`o_t
(

);

1165 
pos
 = 
	`rib_ce_quy_posi
();

1166 
duti
 = 
	`rib_ce_quy_duti
();

1167 
rd_da1
 = 
	`rib_lyric_g_rd_da
(0);

1168 
1
 = 
	`rib_lyric_g_le_
(0, 
pos
);

1169 if(
iv
->
two_ack
)

1171 
rd_da2
 = 
	`rib_lyric_g_rd_da
(1);

1172 
2
 = 
	`rib_lyric_g_le_
(1, 
pos
);

1174 if(
1
!=
NULL
 && 
	`g_qu__is_d
(iter1)) iter1 = NULL;

1175 if(
2
!=
NULL
 && 
	`g_qu__is_d
(iter2)) iter2 = NULL;

1176 if(
rd_da1
!=
NULL
)

1178 
offt1
 = (
gt64
)
rd_da1
->
offt
*
GST_MSECOND
;

1179 
_beg1
 = 
	`g_qu_g_beg_
(
rd_da1
->
q
);

1181 if(
rd_da2
!=
NULL
)

1183 
offt2
 = (
gt64
)
rd_da2
->
offt
*
GST_MSECOND
;

1184 
_beg2
 = 
	`g_qu_g_beg_
(
rd_da2
->
q
);

1186 if(
_beg1
!=
NULL
 && 
	`g_qu__is_d
(iter_begin1))

1187 
_beg1
 = 
NULL
;

1188 if(
_beg2
!=
NULL
 && 
	`g_qu__is_d
(iter_begin2))

1189 
_beg2
 = 
NULL
;

1190 if(
1
==
NULL
 && 
_beg1
==NULL && 
_beg2
!=NULL)

1192 
1
 = 
2
;

1193 
_beg1
 = 
_beg2
;

1194 
2
 = 
NULL
;

1195 
_beg2
 = 
NULL
;

1197 
iv
->
lyric_r
[0] = 0.0;

1198 
iv
->
lyric_r
[1] = 0.0;

1199 
iv
->
lyric_le_num
[0] = 0;

1200 
iv
->
lyric_le_num
[1] = 0;

1201 if(
1
!=
NULL
)

1203 
lyric_da
 = 
	`g_qu_g
(
1
);

1204 if(
lyric_da
!=
NULL
)

1206 
time_sd
 = 
pos
 - (
lyric_da
->
time
+
offt1
);

1207 if(
lyric_da
->
ngth
>0)

1208 
time_ngth
 = 
lyric_da
->
ngth
;

1210 
time_ngth
 = 
duti
 - (
lyric_da
->
time
+
offt1
);

1211 if(
time_sd
>0)

1212 
iv
->
lyric_r
[0] = (
gdoub
)
time_sd
 / 
time_ngth
;

1213 
iv
->
lyric_le_num
[0] = 
	`g_qu__g_posi
(
1
);

1216 if(
2
!=
NULL
)

1218 
lyric_da
 = 
	`g_qu_g
(
2
);

1219 if(
lyric_da
!=
NULL
)

1221 
le
 = 2;

1222 
time_sd
 = 
pos
 - (
lyric_da
->
time
+
offt2
);

1223 if(
lyric_da
->
ngth
>0)

1224 
time_ngth
 = 
lyric_da
->
ngth
;

1226 
time_ngth
 = 
duti
 - (
lyric_da
->
time
+
offt2
);

1227 if(
time_sd
>0)

1228 
iv
->
lyric_r
[1] = (
gdoub
)
time_sd
 / 
time_ngth
;

1229 
iv
->
lyric_le_num
[1] = 
	`g_qu__g_posi
(
2
);

1232 if(
iv
->
two_le
)

1233 
le
 *= 2;

1234 
loc_height
 = 
le
 * 
iv
->
nd_cڋxt
->
ft_height
 +

1235 (
le
 - 1* 
DESKLRC_LINE_PADDING
 +

1236 
iv
->
nd_cڋxt
->
oue_width
 + 
DESKLRC_MARGIN_TOP
 +

1237 
DESKLRC_MARGIN_BOTTOM
;

1238 if(
loti
.
width
!=
iv
->
osd_wdow_width
 ||

1239 
loti
.
height
!=
loc_height
)

1241 
	`gtk_wdow_size
(
	`GTK_WINDOW
(
widg
), 
iv
->
osd_wdow_width
,

1242 
loc_height
);

1244 
	`gtk_widg_g_loti
(
widg
, &
loti
);

1245 
	`deskc_nd_lyric_sur
(
iv
, 
1
, 
_beg1
, 
2
,

1246 
_beg2
);

1247 
	`deskc_show
(
widg
, 
iv
, 

);

1248  
FALSE
;

1249 
	}
}

1251 
	$deskc_ld_cf
(
DeskcPrive
 *
iv
)

1253 
gch
 *
rg
 = 
NULL
;

1254 
gt
 
ivue
 = 0;

1255 
gboޗn
 
bvue
 = 
FALSE
;

1256 
GE
 *
r
 = 
NULL
;

1257 if(
iv
==
NULL
 ||riv->
keyfe
==NULL) ;

1258 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1259 "NmC1", 
NULL
);

1260 if(
rg
!=
NULL
)

1262 if(!
	`gdk_rgba_r
(&(
iv
->
bg_c1
), 
rg
))

1263 
	`gdk_rgba_r
(&(
iv
->
bg_c1
), "#4CFFFF");

1266 
	`gdk_rgba_r
(&(
iv
->
bg_c1
), "#4CFFFF");

1267 
	`g_
(
rg
);

1268 
iv
->
bg_c3
 =riv->
bg_c1
;

1269 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1270 "NmC2", 
NULL
);

1271 if(
rg
!=
NULL
)

1273 if(!
	`gdk_rgba_r
(&(
iv
->
bg_c2
), 
rg
))

1274 
	`gdk_rgba_r
(&(
iv
->
bg_c2
), "#0000FF");

1277 
	`gdk_rgba_r
(&(
iv
->
bg_c2
), "#0000FF");

1278 
	`g_
(
rg
);

1279 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1280 "HighLightC1", 
NULL
);

1281 if(
rg
!=
NULL
)

1283 if(!
	`gdk_rgba_r
(&(
iv
->
fg_c1
), 
rg
))

1284 
	`gdk_rgba_r
(&(
iv
->
fg_c1
), "#FF4C4C");

1287 
	`gdk_rgba_r
(&(
iv
->
fg_c1
), "#FF4C4C");

1288 
	`g_
(
rg
);

1289 
iv
->
fg_c3
 =riv->
fg_c1
;

1290 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1291 "HighLightC2", 
NULL
);

1292 if(
rg
!=
NULL
)

1294 if(!
	`gdk_rgba_r
(&(
iv
->
fg_c2
), 
rg
))

1295 
	`gdk_rgba_r
(&(
iv
->
fg_c2
), "#FFFF00");

1298 
	`gdk_rgba_r
(&(
iv
->
fg_c2
), "#FFFF00");

1299 
	`g_
(
rg
);

1300 
ivue
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
DESKLRC_ID
,

1301 "OSDWdowWidth", 
NULL
);

1302 if(
ivue
>=
DESKLRC_OSD_WINDOW_MIN_WIDTH
)

1303 
iv
->
osd_wdow_width
 = 
ivue
;

1304 
ivue
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
DESKLRC_ID
,

1305 "OSDWdowPosiX", &
r
);

1306 if(
r
==
NULL
)

1307 
iv
->
osd_wdow_pos_x
 = 
ivue
;

1310 
	`g_r_
(
r
);

1311 
r
 = 
NULL
;

1313 
ivue
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
DESKLRC_ID
,

1314 "OSDWdowPosiY", &
r
);

1315 if(
r
==
NULL
)

1316 
iv
->
osd_wdow_pos_y
 = 
ivue
;

1319 
	`g_r_
(
r
);

1320 
r
 = 
NULL
;

1322 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1323 "Ft", 
NULL
);

1324 if(
rg
!=
NULL
)

1326 
	`g_
(
iv
->
ft_rg
);

1327 
iv
->
ft_rg
 = 
	`g_rdup
(
rg
);

1329 
	`g_
(
rg
);

1330 
bvue
 = 
	`g_key_fe_g_boޗn
(
iv
->
keyfe
, 
DESKLRC_ID
,

1331 "OSDWdowMovab", &
r
);

1332 if(
r
==
NULL
)

1333 
iv
->
movab
 = 
bvue
;

1336 
	`g_r_
(
r
);

1337 
r
 = 
NULL
;

1339 
bvue
 = 
	`g_key_fe_g_boޗn
(
iv
->
keyfe
, 
DESKLRC_ID
,

1340 "ShowTwoTck", &
r
);

1341 if(
r
==
NULL
)

1342 
iv
->
two_ack
 = 
bvue
;

1345 
	`g_r_
(
r
);

1346 
r
 = 
NULL
;

1348 
bvue
 = 
	`g_key_fe_g_boޗn
(
iv
->
keyfe
, 
DESKLRC_ID
,

1349 "ShowTwoLe", &
r
);

1350 if(
r
==
NULL
)

1351 
iv
->
two_le
 = 
bvue
;

1354 
	`g_r_
(
r
);

1355 
r
 = 
NULL
;

1357 
	}
}

1359 
	$deskc_ve_cf
(
DeskcPrive
 *
iv
)

1361 
gch
 *
rg
;

1362 if(
iv
==
NULL
 ||riv->
keyfe
==NULL) ;

1363 
rg
 = 
	`gdk_rgba_to_rg
(&(
iv
->
bg_c1
));

1364 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1365 "NmC1", 
rg
);

1366 
	`g_
(
rg
);

1367 
rg
 = 
	`gdk_rgba_to_rg
(&(
iv
->
bg_c2
));

1368 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1369 "NmC2", 
rg
);

1370 
	`g_
(
rg
);

1371 
rg
 = 
	`gdk_rgba_to_rg
(&(
iv
->
fg_c1
));

1372 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1373 "HighLightC1", 
rg
);

1374 
	`g_
(
rg
);

1375 
rg
 = 
	`gdk_rgba_to_rg
(&(
iv
->
fg_c2
));

1376 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1377 "HighLightC2", 
rg
);

1378 
	`g_
(
rg
);

1379 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
DESKLRC_ID
,

1380 "Ft", 
iv
->
ft_rg
);

1381 
	`g_key_fe_t_g
(
iv
->
keyfe
, 
DESKLRC_ID
,

1382 "OSDWdowWidth", 
iv
->
osd_wdow_width
);

1383 if(
iv
->
osd_wdow_pos_x
>=0)

1385 
	`g_key_fe_t_g
(
iv
->
keyfe
, 
DESKLRC_ID
,

1386 "OSDWdowPosiX", 
iv
->
osd_wdow_pos_x
);

1388 if(
iv
->
osd_wdow_pos_y
>=0)

1390 
	`g_key_fe_t_g
(
iv
->
keyfe
, 
DESKLRC_ID
,

1391 "OSDWdowPosiY", 
iv
->
osd_wdow_pos_y
);

1393 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
DESKLRC_ID
,

1394 "OSDWdowMovab", 
iv
->
movab
);

1395 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
DESKLRC_ID
,

1396 "ShowTwoTck", 
iv
->
two_ack
);

1397 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
DESKLRC_ID
,

1398 "ShowTwoLe", 
iv
->
two_le
);

1399 
	}
}

1401 
	$deskc_y_movab
(
DeskcPrive
 *
iv
)

1403 
o_gi_t
 *
gi
;

1404 
GdkWdow
 *
wdow
;

1405 if(
iv
==
NULL
 ||riv->
wdow
==NULL) ;

1406 
wdow
 = 
	`gtk_widg_g_wdow
(
iv
->window);

1407 if(
wdow
==
NULL
) ;

1408 if(
iv
->
movab
)

1409 
	`gdk_wdow_put_she_combe_gi
(
wdow
, 
NULL
, 0, 0);

1412 
gi
 = 
	`o_gi_
();

1413 
	`gdk_wdow_put_she_combe_gi
(
wdow
, 
gi
, 0, 0);

1414 
	`o_gi_deroy
(
gi
);

1416 
	}
}

1418 
	$deskc_shutdown_cb
(
RCLibPlug
 *
ug
,

1419 
gpor
 
da
)

1421 
DeskcPrive
 *
iv
 = (DeskcPriv*)
da
;

1422 if(
da
==
NULL
) ;

1423 
	`deskc_ve_cf
(
iv
);

1424 
	}
}

1426 
gboޗn
 
	$deskc_ld
(
RCLibPlugDa
 *
ug
)

1428 
DeskcPrive
 *
iv
 = &
deskc_iv
;

1429 
GdkSn
 *
sn
;

1430 
GdkVisu
 *
visu
;

1431 
GdkGeomry
 
wdow_hts
 =

1433 .
m_width
 = 500,

1434 .
m_height
 = 50,

1435 .
ba_width
 = 600,

1436 .
ba_height
 = 50

1438 
sn
 = 
	`gdk_sn_g_deu
();

1439 
iv
->
composed
 = 
	`gdk_sn_is_composed
(
sn
);

1440 if(!
iv
->
composed
)

1442 
	`g_wng
("DeskLRC: Compositeffect isotvailabe, "

1444  
FALSE
;

1446 
iv
->
nd_cڋxt
 = 
	`deskc_nd_cڋxt_w
();

1447 
	`deskc_nd_t_ft_me
(
iv
->
nd_cڋxt
,riv->
ft_rg
);

1448 
	`deskc_upde_c
(
iv
);

1449 
iv
->
wdow
 = 
	`gtk_wdow_w
(
GTK_WINDOW_POPUP
);

1450 
sn
 = 
	`gtk_widg_g_sn
(
iv
->
wdow
);

1451 
visu
 = 
	`gdk_sn_g_rgba_visu
(
sn
);

1452 if(
visu
!=
NULL
)

1453 
	`gtk_widg_t_visu
(
iv
->
wdow
, 
visu
);

1456 
	`g_wng
("DeskLRC: Transparent is NOT supported!");

1457 
	`gtk_widg_deroy
(
iv
->
wdow
);

1458 
iv
->
wdow
 = 
NULL
;

1459  
FALSE
;

1461 
	`g_obje_t
(
iv
->
wdow
, "t", 
	`_
("OSD Lyric Window"),

1462 "p-b", 
TRUE
, "ty-ht", 
GDK_WINDOW_TYPE_HINT_DOCK
,

1463 "wdow-posi", 
GTK_WIN_POS_CENTER
, "decܩed", 
FALSE
, 
NULL
);

1464 
	`gtk_wdow_t_geomry_hts
(
	`GTK_WINDOW
(
iv
->
wdow
),

1465 
	`GTK_WIDGET
(
iv
->
wdow
), &
wdow_hts
,

1466 
GDK_HINT_MIN_SIZE
);

1467 
	`gtk_wdow_size
(
	`GTK_WINDOW
(
iv
->
wdow
),riv->
osd_wdow_width
,

1469 if(
iv
->
osd_wdow_pos_x
>=0 &&riv->
osd_wdow_pos_y
>=0)

1471 
	`gtk_wdow_move
(
	`GTK_WINDOW
(
iv
->
wdow
),riv->
osd_wdow_pos_x
,

1472 
iv
->
osd_wdow_pos_y
);

1474 
	`gtk_widg_add_evts
(
iv
->
wdow
, 
GDK_ENTER_NOTIFY_MASK
 |

1475 
GDK_LEAVE_NOTIFY_MASK
 | 
GDK_BUTTON_PRESS_MASK
 |

1476 
GDK_BUTTON_RELEASE_MASK
 | 
GDK_POINTER_MOTION_MASK
 |

1477 
GDK_POINTER_MOTION_HINT_MASK
);

1478 
	`gtk_widg_ize
(
iv
->
wdow
);

1479 
	`deskc_y_movab
(
iv
);

1480 
	`g_sigl_c
(
iv
->
wdow
, "draw",

1481 
	`G_CALLBACK
(
deskc_dw
), 
iv
);

1482 
	`g_sigl_c
(
iv
->
wdow
, "button-press-event",

1483 
	`G_CALLBACK
(
deskc_dg
), 
iv
);

1484 
	`g_sigl_c
(
iv
->
wdow
, "motion-notify-event",

1485 
	`G_CALLBACK
(
deskc_dg
), 
iv
);

1486 
	`g_sigl_c
(
iv
->
wdow
, "button-release-event",

1487 
	`G_CALLBACK
(
deskc_dg
), 
iv
);

1488 
	`g_sigl_c
(
iv
->
wdow
, "enter-notify-event",

1489 
	`G_CALLBACK
(
deskc_dg
), 
iv
);

1490 
	`g_sigl_c
(
iv
->
wdow
, "leave-notify-event",

1491 
	`G_CALLBACK
(
deskc_dg
), 
iv
);

1492 
iv
->
timeout_id
 = 
	`g_timeout_add
(100,

1493 (
GSourFunc
)
deskc_upde
, 
iv
);

1494 
	`gtk_widg_show_l
(
iv
->
wdow
);

1495  
TRUE
;

1496 
	}
}

1498 
gboޗn
 
	$deskc_ud
(
RCLibPlugDa
 *
ug
)

1500 
DeskcPrive
 *
iv
 = &
deskc_iv
;

1501 if(
iv
->
timeout_id
>0)

1502 
	`g_sour_move
(
iv
->
timeout_id
);

1503 if(
iv
->
wdow
!=
NULL
)

1505 
	`gtk_widg_deroy
(
iv
->
wdow
);

1506 
iv
->
wdow
 = 
NULL
;

1508 if(
iv
->
nd_cڋxt
!=
NULL
)

1510 
	`deskc_nd_cڋxt_deroy
(
iv
->
nd_cڋxt
);

1511 
iv
->
nd_cڋxt
 = 
NULL
;

1513  
TRUE
;

1514 
	}
}

1516 
gboޗn
 
	$deskc_cfigu
(
RCLibPlugDa
 *
ug
)

1518 
DeskcPrive
 *
iv
 = &
deskc_iv
;

1519 
GtkWidg
 *
dlog
;

1520 
GtkWidg
 *
cڋ_
;

1521 
GtkWidg
 *
b
[4];

1522 
GtkWidg
 *
grid
;

1523 
GtkWidg
 *
c_grid
;

1524 
GtkWidg
 *
ft_bu
;

1525 
GtkWidg
 *
bg_c_bu1
;

1526 
GtkWidg
 *
bg_c_bu2
;

1527 
GtkWidg
 *
hi_c_bu1
;

1528 
GtkWidg
 *
hi_c_bu2
;

1529 
GtkWidg
 *
wdow_width_
;

1530 
GtkWidg
 *
wdow_movab_checkbox
;

1531 
GtkWidg
 *
two_ack_checkbox
;

1532 
GtkWidg
 *
two_le_mode_checkbox
;

1533 
gt
 
i
, 
su
;

1534 
dlog
 = 
	`gtk_dlog_w_wh_bus
(
	`_
("Deskt LyriPns"), 
NULL
,

1535 
GTK_DIALOG_MODAL
 | 
GTK_DIALOG_DESTROY_WITH_PARENT
, 
GTK_STOCK_OK
,

1536 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_REJECT
, 
NULL
);

1537 
grid
 = 
	`gtk_grid_w
();

1538 
c_grid
 = 
	`gtk_grid_w
();

1539 
b
[0] = 
	`gtk_b_w
(
	`_
("Font: "));

1540 
b
[1] = 
	`gtk_b_w
(
	`_
("Text Color: "));

1541 
b
[2] = 
	`gtk_b_w
(
	`_
("High-light Color: "));

1542 
b
[3] = 
	`gtk_b_w
(
	`_
("OSD Window Width: "));

1543 if(
iv
->
ft_rg
)

1544 
ft_bu
 = 
	`gtk_ft_bu_w_wh_ft
(
iv
->
ft_rg
);

1546 
ft_bu
 = 
	`gtk_ft_bu_w
();

1547 
bg_c_bu1
 = 
	`gtk_c_bu_w_wh_rgba
(&(
iv
->
bg_c1
));

1548 
bg_c_bu2
 = 
	`gtk_c_bu_w_wh_rgba
(&(
iv
->
bg_c2
));

1549 
hi_c_bu1
 = 
	`gtk_c_bu_w_wh_rgba
(&(
iv
->
fg_c1
));

1550 
hi_c_bu2
 = 
	`gtk_c_bu_w_wh_rgba
(&(
iv
->
fg_c2
));

1551 
wdow_width_
 = 
	`gtk__bu_w_wh_nge
(0, 4000, 1);

1552 
wdow_movab_checkbox
 = 
	`gtk_check_bu_w_wh_mmic
(

1553 
	`_
("Movable OSD Window"));

1554 
two_ack_checkbox
 = 
	`gtk_check_bu_w_wh_mmic
(

1555 
	`_
("Drawworacksheyricexts"));

1556 
two_le_mode_checkbox
 = 
	`gtk_check_bu_w_wh_mmic
(

1557 
	`_
("Drawwoines ofyricexts"));

1558 
i
=0;i<4;i++)

1560 
	`g_obje_t
(
b
[
i
], "xign", 0.0, "yign", 0.5, 
NULL
);

1562 
	`g_obje_t
(
wdow_width_
, "numic", 
FALSE
, "value",

1563 (
gdoub
)
iv
->
osd_wdow_width
, "hexnd-t", 
TRUE
, "hexpand",

1564 
TRUE
, "vexnd-t", TRUE, "vexnd", 
FALSE
, 
NULL
);

1565 
	`g_obje_t
(
ft_bu
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

1566 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

1567 
	`g_obje_t
(
bg_c_bu1
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

1568 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

1569 
	`g_obje_t
(
bg_c_bu2
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

1570 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

1571 
	`g_obje_t
(
hi_c_bu1
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

1572 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

1573 
	`g_obje_t
(
hi_c_bu2
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

1574 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

1575 
	`g_obje_t
(
wdow_movab_checkbox
, "hexnd-t", 
TRUE
, "hexpand",

1576 
TRUE
, "vexnd-t", TRUE, "vexnd", 
FALSE
, "active",

1577 
iv
->
movab
, 
NULL
);

1578 
	`g_obje_t
(
two_ack_checkbox
, "hexnd-t", 
TRUE
, "hexpand",

1579 
TRUE
, "vexnd-t", TRUE, "vexnd", 
FALSE
, "active",

1580 
iv
->
two_ack
, 
NULL
);

1581 
	`g_obje_t
(
two_le_mode_checkbox
, "hexnd-t", 
TRUE
, "hexpand",

1582 
TRUE
, "vexnd-t", TRUE, "vexnd", 
FALSE
, "active",

1583 
iv
->
two_le
, 
NULL
);

1584 
	`g_obje_t
(
c_grid
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

1585 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

1586 
	`gtk_grid_ch
(
	`GTK_GRID
(
c_grid
), 
b
[1], 0, 0, 1, 1);

1587 
	`gtk_grid_ch
(
	`GTK_GRID
(
c_grid
), 
bg_c_bu1
, 1, 0, 1, 1);

1588 
	`gtk_grid_ch
(
	`GTK_GRID
(
c_grid
), 
bg_c_bu2
, 2, 0, 1, 1);

1589 
	`gtk_grid_ch
(
	`GTK_GRID
(
c_grid
), 
b
[2], 0, 1, 1, 1);

1590 
	`gtk_grid_ch
(
	`GTK_GRID
(
c_grid
), 
hi_c_bu1
, 1, 1, 1, 1);

1591 
	`gtk_grid_ch
(
	`GTK_GRID
(
c_grid
), 
hi_c_bu2
, 2, 1, 1, 1);

1592 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
b
[0], 0, 0, 1, 1);

1593 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
ft_bu
, 1, 0, 1, 1);

1594 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
c_grid
, 0, 1, 2, 1);

1595 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
b
[3], 0, 2, 1, 1);

1596 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
wdow_width_
, 1, 2, 1, 1);

1597 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
wdow_movab_checkbox
, 0, 3, 2, 1);

1598 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
two_ack_checkbox
, 0, 4, 2, 1);

1599 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
two_le_mode_checkbox
, 0, 5, 2, 1);

1600 
cڋ_
 = 
	`gtk_dlog_g_cڋ_
(
	`GTK_DIALOG
(
dlog
));

1601 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
cڋ_
), 
grid
);

1602 
	`gtk_widg_show_l
(
dlog
);

1603 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
dlog
));

1604 if(
su
==
GTK_RESPONSE_ACCEPT
)

1606 
	`g_
(
iv
->
ft_rg
);

1607 
iv
->
ft_rg
 = 
	`g_rdup
(
	`gtk_ft_bu_g_ft_me
(

1608 
	`GTK_FONT_BUTTON
(
ft_bu
)));

1609 
	`gtk_c_bu_g_rgba
(
	`GTK_COLOR_BUTTON
(
bg_c_bu1
),

1610 &(
iv
->
bg_c1
));

1611 
	`gtk_c_bu_g_rgba
(
	`GTK_COLOR_BUTTON
(
bg_c_bu2
),

1612 &(
iv
->
bg_c2
));

1613 
iv
->
bg_c3
 =riv->
bg_c1
;

1614 
	`gtk_c_bu_g_rgba
(
	`GTK_COLOR_BUTTON
(
hi_c_bu1
),

1615 &(
iv
->
fg_c1
));

1616 
	`gtk_c_bu_g_rgba
(
	`GTK_COLOR_BUTTON
(
hi_c_bu2
),

1617 &(
iv
->
fg_c2
));

1618 
iv
->
fg_c3
 =riv->
fg_c1
;

1619 
iv
->
osd_wdow_width
 = 
	`gtk__bu_g_vue_as_t
(

1620 
	`GTK_SPIN_BUTTON
(
wdow_width_
));

1621 
iv
->
movab
 = 
	`gtk_togg_bu_g_aive
(

1622 
	`GTK_TOGGLE_BUTTON
(
wdow_movab_checkbox
));

1623 
iv
->
two_ack
 = 
	`gtk_togg_bu_g_aive
(

1624 
	`GTK_TOGGLE_BUTTON
(
two_ack_checkbox
));

1625 
iv
->
two_le
 = 
	`gtk_togg_bu_g_aive
(

1626 
	`GTK_TOGGLE_BUTTON
(
two_le_mode_checkbox
));

1627 if(
iv
->
nd_cڋxt
!=
NULL
)

1629 
	`deskc_nd_t_ft_me
(
iv
->
nd_cڋxt
,

1630 
iv
->
ft_rg
);

1632 
	`deskc_upde_c
(
iv
);

1633 
	`deskc_y_movab
(
iv
);

1634 if(
iv
->
wdow
!=
NULL
)

1635 
	`gtk_widg_queue_dw
(
iv
->
wdow
);

1636 
	`deskc_ve_cf
(
iv
);

1638 
	`gtk_widg_deroy
(
dlog
);

1639  
TRUE
;

1640 
	}
}

1642 
gboޗn
 
	$deskc_
(
RCLibPlugDa
 *
ug
)

1644 
DeskcPrive
 *
iv
 = &
deskc_iv
;

1645 
GdkSn
 *
sn
;

1646 
gt
 
sn_width
, 
sn_height
;

1647 
iv
->
movab
 = 
TRUE
;

1648 
iv
->
two_le
 = 
TRUE
;

1649 
iv
->
two_ack
 = 
TRUE
;

1650 
iv
->
ft_rg
 = 
	`g_rdup
("Monospace 22");

1651 
	`gdk_rgba_r
(&(
iv
->
bg_c1
), "#4CFFFF");

1652 
	`gdk_rgba_r
(&(
iv
->
bg_c2
), "#0000FF");

1653 
	`gdk_rgba_r
(&(
iv
->
bg_c3
), "#4CFFFF");

1654 
	`gdk_rgba_r
(&(
iv
->
fg_c1
), "#FF4C4C");

1655 
	`gdk_rgba_r
(&(
iv
->
fg_c2
), "#FFFF00");

1656 
	`gdk_rgba_r
(&(
iv
->
fg_c3
), "#4CFFFF");

1657 
sn
 = 
	`gdk_sn_g_deu
();

1658 
sn_width
 = 
	`gdk_sn_g_width
(
sn
);

1659 
sn_height
 = 
	`gdk_sn_g_height
(
sn
);

1660 if(
sn_width
>0)

1662 
iv
->
osd_wdow_width
 = 0.8 * 
sn_width
;

1663 
iv
->
osd_wdow_pos_x
 = 0.1 * 
sn_width
;

1667 
iv
->
osd_wdow_width
 = 500;

1668 
iv
->
osd_wdow_pos_x
 = 100;

1670 if(
sn_height
>0)

1671 
iv
->
osd_wdow_pos_y
 = 0.8 * 
sn_height
;

1673 
iv
->
osd_wdow_pos_y
 = 100;

1674 
iv
->
keyfe
 = 
	`rib_ug_g_keyfe
();

1675 
	`deskc_ld_cf
(
iv
);

1676 
iv
->
shutdown_id
 = 
	`rib_ug_sigl_c
("shutdown",

1677 
	`G_CALLBACK
(
deskc_shutdown_cb
), 
iv
);

1678  
TRUE
;

1679 
	}
}

1681 
	$deskc_deroy
(
RCLibPlugDa
 *
ug
)

1683 
DeskcPrive
 *
iv
 = &
deskc_iv
;

1684 if(
iv
->
shutdown_id
>0)

1685 
	`rib_ug_sigl_disc
(
iv
->
shutdown_id
);

1686 
	`g_
(
iv
->
ft_rg
);

1687 
	}
}

1689 
RCLibPlugInfo
 
	grlug_fo
 = {

1690 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

1691 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

1692 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

1693 .
	gty
 = 
RCLIB_PLUGIN_TYPE_MODULE
,

1694 .
	gid
 = 
DESKLRC_ID
,

1695 .
	gme
 = 
N_
("Desktop Lyric Plug-in"),

1696 .
	gvsi
 = "0.5",

1697 .
	gdesti
 = 
N_
("Showyrics on your desktop~!"),

1698 .
	gauth
 = "SuperCat",

1699 .
	ghomage
 = "http://supercat-lab.org/",

1700 .
	gld
 = 
deskc_ld
,

1701 .
	gud
 = 
deskc_ud
,

1702 .
	gcfigu
 = 
deskc_cfigu
,

1703 .
	gderoy
 = 
deskc_deroy
,

1704 .
	gexa_fo
 = 
NULL


1707 
RCPLUGIN_INIT_PLUGIN
(
rlug_fo
.
id
, 
deskc_
,cplugin_info);

	@plugins/base/lyricshow.c

26 
	~<dlib.h
>

27 
	~<glib.h
>

28 
	~<glib/gi18n.h
>

29 
	~<gdk/gdk.h
>

30 
	~<gtk/gtk.h
>

31 
	~<rib.h
>

32 
	~<rc-ui-mu.h
>

34 
	#LRCSHOW_ID
 "rc2-tive-lyric-show"

	)

36 
	sRCPlugLrcshowPriv


38 
GtkWidg
 *
	mc_wdow
;

39 
GtkWidg
 *
	mc_s
;

40 
GtkToggAi
 *
	mai
;

41 
gut
 
	mmu_id
;

42 
PgoLayout
 *
	myout
;

43 
o_sur_t
 **
	mc_nm_sur
;

44 
o_sur_t
 **
	mc_aive_sur
;

45 
gut
 
	mc_numb
;

46 
gt
 
	mmode
;

47 
gut
 
	mack
;

48 
gch
 *
	mft_rg
;

49 
gt
 
	mft_height
;

50 
gut
 
	mle_di
;

51 
gt
 
	mdg_to_lum
;

52 
gt
 
	mdg_om_lum
;

53 
gt
 
	mdg_height
;

54 
gt
 
	mwdow_x
;

55 
gt
 
	mwdow_y
;

56 
GdkRGBA
 
	mbackground
;

57 
GdkRGBA
 
	mxt_c
;

58 
GdkRGBA
 
	mxt_hight
;

59 
gboޗn
 
	mdg_ag
;

60 
gboޗn
 
	mdg_ai
;

61 
gulg
 
	mlyric_found_id
;

62 
gulg
 
	mtimeout_id
;

63 
gulg
 
	mshutdown_id
;

64 
gboޗn
 
	mshow_wdow
;

65 
GKeyFe
 *
	mkeyfe
;

66 }
	tRCPlugLrcshowPriv
;

68 
RCPlugLrcshowPriv
 
	gcshow_iv
 = {0};

70 
le
 
	$rc_ug_cshow_upde_ft_height
(

71 
RCPlugLrcshowPriv
 *
iv
)

73 
PgoCڋxt
 *
cڋxt
;

74 
PgoFtMrics
 *
mrics
;

75 
gt
 
as
, 
des
;

76 if(
iv
==
NULL
 ||riv->
yout
==NULL) ;

77 
cڋxt
 = 
	`ngo_yout_g_cڋxt
(
iv
->
yout
);

78 if(
cڋxt
==
NULL
) ;

79 
mrics
 = 
	`ngo_cڋxt_g_mrics
(
cڋxt
,

80 
	`ngo_yout_g_ft_desti
(
iv
->
yout
), 
NULL
);

81 if(
mrics
==
NULL
)

83 
	`g_wng
("Cannot get font metrics!");

85 
iv
->
ft_height
 = 0;

86 
as
 = 
	`ngo_ft_mrics_g_as
(
mrics
);

87 
des
 = 
	`ngo_ft_mrics_g_des
(
mrics
);

88 
	`ngo_ft_mrics_uef
(
mrics
);

89 
iv
->
ft_height
 +
	`PANGO_PIXELS
(
as
 + 
des
);

90 
	}
}

92 
le
 
	$rc_ug_cshow_upde_ft
(
RCPlugLrcshowPriv
 *
iv
)

94 
PgoFtDesti
 *
desc
;

95 if(
iv
==
NULL
 ||riv->
yout
==NULL) ;

96 if(
iv
->
ft_rg
!=
NULL
)

97 
desc
 = 
	`ngo_ft_desti_om_rg
(
iv
->
ft_rg
);

99 
desc
 = 
	`ngo_ft_desti_om_rg
("Monospace 10");

100 
	`ngo_yout_t_ft_desti
(
iv
->
yout
, 
desc
);

101 
	`ngo_ft_desti_
(
desc
);

102 
	`rc_ug_cshow_upde_ft_height
(
iv
);

103 
	}
}

105 
le
 
	$rc_ug_cshow_t_ft
(
RCPlugLrcshowPriv
 *
iv
,

106 cڡ 
gch
 *
ft_rg
)

108 if(
iv
==
NULL
 ||riv->
yout
==NULL) ;

109 
	`g_
(
iv
->
ft_rg
);

110 
iv
->
ft_rg
 = 
	`g_rdup
(font_string);

111 
	}
}

113 
	$rc_ug_cshow_ld_cf
(
RCPlugLrcshowPriv
 *
iv
)

115 
gch
 *
rg
 = 
NULL
;

116 
gboޗn
 
bvue
;

117 
gt
 
ivue
;

118 
GE
 *
r
 = 
NULL
;

119 if(
iv
==
NULL
 ||riv->
keyfe
==NULL) ;

120 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCSHOW_ID
, "Font",

121 
NULL
);

122 if(
rg
!=
NULL
)

124 
	`g_
(
iv
->
ft_rg
);

125 
iv
->
ft_rg
 = 
rg
;

127 
iv
->
le_di
 = 
	`g_key_fe_g_g
riv->
keyfe
, 
LRCSHOW_ID
,

128 "LeDi", 
NULL
);

129 if(
iv
->
le_di
<0)riv->line_distance = 0;

130 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCSHOW_ID
,

131 "BackgroundC", 
NULL
);

132 if(
rg
!=
NULL
)

134 if(!
	`gdk_rgba_r
(&(
iv
->
background
), 
rg
))

135 
	`gdk_rgba_r
(&(
iv
->
background
), "#3B5673");

138 
	`gdk_rgba_r
(&(
iv
->
background
), "#3B5673");

139 
	`g_
(
rg
);

140 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCSHOW_ID
,

141 "TextNmC", 
NULL
);

142 if(
rg
!=
NULL
)

144 if(!
	`gdk_rgba_r
(&(
iv
->
xt_c
), 
rg
))

145 
	`gdk_rgba_r
(&(
iv
->
xt_c
), "#FFFFFF");

148 
	`gdk_rgba_r
(&(
iv
->
xt_c
), "#FFFFFF");

149 
	`g_
(
rg
);

150 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCSHOW_ID
,

151 "TextHighLightC", 
NULL
);

152 if(
rg
!=
NULL
)

154 if(!
	`gdk_rgba_r
(&(
iv
->
xt_hight
), 
rg
))

155 
	`gdk_rgba_r
(&(
iv
->
xt_hight
), "#5CA6D6");

158 
	`gdk_rgba_r
(&(
iv
->
xt_hight
), "#5CA6D6");

159 
	`g_
(
rg
);

160 
iv
->
mode
 = 
	`g_key_fe_g_g
riv->
keyfe
, 
LRCSHOW_ID
,

161 "Mode", 
NULL
);

162 if(
iv
->
mode
<0 ||riv->mode>2)riv->mode = 0;

163 
bvue
 = 
	`g_key_fe_g_boޗn
(
iv
->
keyfe
, 
LRCSHOW_ID
,

164 "ShowWdow", &
r
);

165 if(
r
==
NULL
)

166 
iv
->
show_wdow
 = 
bvue
;

169 
	`g_r_
(
r
);

170 
r
 = 
NULL
;

172 
ivue
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
LRCSHOW_ID
,

173 "WdowPosiX", &
r
);

174 if(
r
==
NULL
)

175 
iv
->
wdow_x
 = 
ivue
;

178 
iv
->
wdow_x
 = -1;

179 
	`g_r_
(
r
);

180 
r
 = 
NULL
;

182 
ivue
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
LRCSHOW_ID
,

183 "WdowPosiY", &
r
);

184 if(
r
==
NULL
)

185 
iv
->
wdow_y
 = 
ivue
;

188 
iv
->
wdow_y
 = -1;

189 
	`g_r_
(
r
);

190 
r
 = 
NULL
;

192 
	}
}

194 
	$rc_ug_cshow_ve_cf
(
RCPlugLrcshowPriv
 *
iv
)

196 
gch
 *
rg
;

197 if(
iv
==
NULL
 ||riv->
keyfe
==NULL) ;

198 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
LRCSHOW_ID
, "Font",

199 
iv
->
ft_rg
);

200 
	`g_key_fe_t_g
(
iv
->
keyfe
, 
LRCSHOW_ID
, "LineDistance",

201 
iv
->
le_di
);

202 
rg
 = 
	`gdk_rgba_to_rg
(&(
iv
->
background
));

203 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
LRCSHOW_ID
, "BackgroundColor",

204 
rg
);

205 
	`g_
(
rg
);

206 
rg
 = 
	`gdk_rgba_to_rg
(&(
iv
->
xt_c
));

207 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
LRCSHOW_ID
, "TextNormalColor",

208 
rg
);

209 
	`g_
(
rg
);

210 
rg
 = 
	`gdk_rgba_to_rg
(&(
iv
->
xt_hight
));

211 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
LRCSHOW_ID
, "TextHighLightColor",

212 
rg
);

213 
	`g_
(
rg
);

214 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
LRCSHOW_ID
, "ShowWindow",

215 
iv
->
show_wdow
);

216 if(
iv
->
wdow_x
>=0)

218 
	`g_key_fe_t_g
(
iv
->
keyfe
, 
LRCSHOW_ID
,

219 "WdowPosiX", 
iv
->
wdow_x
);

221 if(
iv
->
wdow_y
>=0)

223 
	`g_key_fe_t_g
(
iv
->
keyfe
, 
LRCSHOW_ID
,

224 "WdowPosiY", 
iv
->
wdow_y
);

226 
	}
}

228 
le
 
	$rc_ug_cshow_dw_bg
(
RCPlugLrcshowPriv
 *
iv
,

229 
o_t
 *

)

231 
	`gdk_o_t_sour_rgba
(

, &(
iv
->
background
));

232 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_SOURCE
);

233 
	`o_t
(

);

234 
	}
}

236 
	$rc_ug_cshow_show
(
GtkWidg
 *
widg
,

237 
RCPlugLrcshowPriv
 *
iv
, 
o_t
 *

, 
gt64
 
pos
, gt64 
offt
,

238 
GSequIr
 *

, GSequI*
_beg
)

240 
GtkAoti
 
loti
;

241 
o_sur_t
 *
sur
;

242 
gt
 
sur_width
, 
sur_height
;

243 
GSequIr
 *
_now
, *
_fܗch
;

244 
GSequ
 *
q
;

245 cڡ 
RCLibLyricDa
 *
c_da
 = 
NULL
;

246 
gt
 
t_height
;

247 
gt
 
c_x
, 
c_y
;

248 
gt
 
c_y_offt
 = 0.0;

249 
gt
 
le_height
;

250 
gt
 
r
 = 0.0;

251 
gt
 
xt_r
 = 0.0;

252 
gt
 
low
, 
high
;

253 
gt64
 
time_sd
 = 0;

254 
gt64
 
time_ngth
 = 0;

255 
gt
 
dex_now
, 
dex_fܗch
;

256 if(
widg
==
NULL
 || 
iv
==NULL ||riv->
yout
==NULL || 

==NULL)

258 if(

!=
NULL
)

259 
_now
 = 

;

261 
_now
 = 
_beg
;

262 if(
_now
==
NULL
) ;

263 if(
	`g_qu__is_d
(
_now
)) ;

264 
	`gtk_widg_g_loti
(
widg
, &
loti
);

265 
t_height
 = 
iv
->
ft_height
;

266 
le_height
 = 
t_height
 + 
iv
->
le_di
;

267 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

268 if(
iv
->
dg_ai
)

270 
_now
 = 
	`g_qu__move
(_now, (
gt
)(
iv
->
dg_height
 /

271 
le_height
));

272 if(
	`g_qu__is_d
(
_now
))

273 
_now
 = 
	`g_qu__ev
(iter_now);

274 
c_y_offt
 = 
iv
->
dg_height
 % (
gt
)
le_height
;

275 if(

!=
NULL
)

276 
iv
->
dg_to_lum
 = 
	`g_qu__g_posi
(
_now
);

278 
iv
->
dg_to_lum
 = -1;

280 if(

!=
NULL
)

282 
c_da
 = 
	`g_qu_g
(

);

283 if(
c_da
!=
NULL
)

284 
time_sd
 = 
pos
 - (
c_da
->
time
+
offt
);

286 if(
c_da
!=
NULL
 && !
iv
->
dg_ai
)

288 if(
c_da
->
ngth
>0)

289 
r
 = (
gdoub
)
time_sd
 / 
c_da
->
ngth
;

292 
time_ngth
 = 
	`rib_ce_quy_duti
() -

293 (
c_da
->
time
+
offt
);

294 if(
time_ngth
>0)

295 
r
 = (
gdoub
)
time_sd
 / 
time_ngth
;

297 
c_y_offt
 = 
le_height
 * 
r
;

300 
q
 = 
	`g_qu__g_qu
(
_now
);

301 if(

!=
NULL
)

302 
dex_now
 = 
	`g_qu__g_posi
(
_now
);

304 
dex_now
 = -1;

306 
_fܗch
 = 
	`g_qu_g_beg_
(
q
);

307 !
	`g_qu__is_d
(
_fܗch
);

308 
_fܗch
 = 
	`g_qu__xt
(iter_foreach))

310 
dex_fܗch
 = 
	`g_qu__g_posi
(
_fܗch
);

311 
c_y
 = (
gt
)
loti
.
height
/2 - 
c_y_offt
 +

312 (
t_height
 + 
iv
->
le_di
* (
gt
)

313 (
dex_fܗch
 - 
dex_now
);

314 
c_y
 = 
	`roundf
(lrc_y);

315 if(
c_y
<0 ||rc_y>
loti
.
height
) ;

316 if(
dex_fܗch
!=
dex_now
)

318 
sur
 = 
iv
->
c_nm_sur
[
dex_fܗch
];

319 
sur_width
 = 
	`o_image_sur_g_width
(
sur
);

320 
sur_height
 = 
	`o_image_sur_g_height
(
sur
);

321 
c_x
 = 
	`roundf
((
loti
.
width
 - 
sur_width
) / 2);

322 
	`o_ve
(

);

323 
	`o_g
(

, 
c_x
, 
c_y
, 
sur_width
, 
sur_height
);

324 
	`o_
(

);

325 
	`o_t_sour_sur
(

, 
sur
, 
c_x
, 
c_y
);

326 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

327 
	`o_t
(

);

328 
	`o_e
(

);

332 
sur
 = 
iv
->
c_aive_sur
[
dex_fܗch
];

333 
sur_width
 = 
	`o_image_sur_g_width
(
sur
);

334 
sur_height
 = 
	`o_image_sur_g_height
(
sur
);

335 if(
sur_width
>
loti
.
width
 && !
iv
->
dg_ai
)

337 
low
 = (
gt
)
loti
.
width
 / 
sur_width
 /2;

338 
high
 = 1.0 - 
low
;

339 if(
r
<=
low
)

340 
xt_r
 = 0.0;

341 if(
r
<
high
)

342 
xt_r
 = (
r
-
low
/ (
high
-low);

344 
xt_r
 = 1.0;

345 
c_x
 = 10 + (
loti
.
width
-
sur_width
-20)*
xt_r
;

348 
c_x
 = (
loti
.
width
 - 
sur_width
) / 2;

349 
c_x
 = 
	`roundf
(lrc_x);

350 
	`o_ve
(

);

351 
	`o_g
(

, 
c_x
, 
c_y
, 
sur_width
, 
sur_height
);

352 
	`o_
(

);

353 
	`o_t_sour_sur
(

, 
sur
, 
c_x
, 
c_y
);

354 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_OVER
);

355 
	`o_t
(

);

356 
	`o_e
(

);

359 
	}
}

361 
gboޗn
 
	$rc_ug_cshow_dg
(
GtkWidg
 *
widg
, 
GdkEvt
 *
evt
,

362 
gpor
 
da
)

364 
RCPlugLrcshowPriv
 *
iv
 = (RCPlugLrcshowPriv *)
da
;

365 
GdkCurs
 *
curs
 = 
NULL
;

366 
GdkWdow
 *
wdow
;

367 
gt
 
dy
 = 0;

368 
gt64
 
pos
 = 0;

369 cڡ 
RCLibLyricPdDa
 *
rd_da
;

370 
GSequIr
 *

;

371 
RCLibLyricDa
 *
c_da
 = 
NULL
;

372 
gt
 
sy
 = 0;

373 if(!
iv
->
dg_ag
 
FALSE
;

374 
wdow
 = 
	`gtk_widg_g_wdow
(
widg
);

375 if(
evt
->
bu
.button==1)

377 
evt
->
ty
)

379 
GDK_BUTTON_PRESS
:

380 
curs
 = 
	`gdk_curs_w
(
GDK_HAND1
);

381 
	`gdk_wdow_t_curs
(
wdow
, 
curs
);

382 
	`g_obje_uef
(
curs
);

383 
iv
->
dg_ai
 = 
TRUE
;

384 
sy
 = 
evt
->
bu
.
y
;

385 
pos
 = 
	`rib_ce_quy_posi
();

386 

 = 
	`rib_lyric_g_le_
(
iv
->
ack
, 
pos
);

387 if(

!=
NULL
)

388 
iv
->
dg_om_lum
 =

389 
	`g_qu__g_posi
(

);

391 
iv
->
dg_om_lum
 = -1;

393 
GDK_BUTTON_RELEASE
:

394 
curs
 = 
	`gdk_curs_w
(
GDK_ARROW
);

395 
	`gdk_wdow_t_curs
(
wdow
, 
curs
);

396 
	`g_obje_uef
(
curs
);

397 if(!
iv
->
dg_ai
) ;

398 
iv
->
dg_ai
 = 
FALSE
;

399 
iv
->
dg_height
 = 0;

400 if(
iv
->
dg_om_lum
!riv->
dg_to_lum
)

402 
rd_da
 = 
	`rib_lyric_g_rd_da
(
iv
->
ack
);

403 if(
rd_da
==
NULL
 ||d_da->
fame
==NULL) ;

404 if(
iv
->
dg_to_lum
>=0)

406 

 = 
	`g_qu_g___pos
(
rd_da
->
q
,

407 
iv
->
dg_to_lum
);

408 
c_da
 = 
	`g_qu_g
(

);

410 if(
c_da
!=
NULL
)

412 
pos
 = 
c_da
->
time
 +

413 (
gt64
)
rd_da
->
offt
*
GST_MSECOND
;

415 
	`rib_ce_t_posi
(
pos
);

418 
GDK_MOTION_NOTIFY
:

419 if(!
iv
->
dg_ai
) ;

420 
dy
 = 
sy
 - 
evt
->
bu
.
y
;

421 
iv
->
dg_height
 = 
dy
;

427  
FALSE
;

428 
	}
}

430 
gboޗn
 
	$rc_ug_cshow_dw
(
GtkWidg
 *
widg
, 
o_t
 *

,

431 
gpor
 
da
)

433 
RCPlugLrcshowPriv
 *
iv
 = (RCPlugLrcshowPriv *)
da
;

434 
GSequIr
 *

, *
_beg
;

435 cڡ 
RCLibLyricPdDa
 *
rd_da
;

436 
gt64
 
pos
;

437 if(
da
==
NULL
 
FALSE
;

438 
	`rc_ug_cshow_dw_bg
(
iv
, 

);

439 
rd_da
 = 
	`rib_lyric_g_rd_da
(
iv
->
ack
);

440 if(
rd_da
==
NULL
 ||d_da->
q
==NULL)

441  
FALSE
;

442 
pos
 = 
	`rib_ce_quy_posi
();

443 

 = 
	`rib_lyric_g_le_
(
iv
->
ack
, 
pos
);

444 
_beg
 = 
	`g_qu_g_beg_
(
rd_da
->
q
);

445 
	`rc_ug_cshow_show
(
widg
, 
iv
, 

, 
pos
,

446 (
gt64
)
rd_da
->
offt
*
GST_MSECOND
, 

, 
_beg
);

447  
FALSE
;

448 
	}
}

450 
	$rc_ug_cshow_vw_mu_toggd
(
GtkToggAi
 *
togg
,

451 
gpor
 
da
)

453 
RCPlugLrcshowPriv
 *
iv
 = (RCPlugLrcshowPriv *)
da
;

454 
gboޗn
 
ag
;

455 if(
da
==
NULL
) ;

456 
ag
 = 
	`gtk_togg_ai_g_aive
(
togg
);

457 if(
ag
)

458 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
iv
->
c_wdow
));

460 
	`gtk_widg_hide
(
iv
->
c_wdow
);

461 
iv
->
show_wdow
 = 
ag
;

462 if(
iv
->
keyfe
!=
NULL
)

464 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
LRCSHOW_ID
, "ShowWindow",

465 
ag
);

467 
	}
}

469 
gboޗn
 
	$rc_ug_cshow_wdow_de_evt_cb
(
GtkWidg
 *
widg
,

470 
GdkEvt
 *
evt
, 
gpor
 
da
)

472 
RCPlugLrcshowPriv
 *
iv
 = (RCPlugLrcshowPriv *)
da
;

473 if(
da
==
NULL
 
TRUE
;

474 
	`gtk_togg_ai_t_aive
(
iv
->
ai
, 
FALSE
);

475  
TRUE
;

476 
	}
}

478 
	$rc_ug_cshow_wdow_deroy_cb
(
GtkWidg
 *
widg
,

479 
gpor
 
da
)

481 
RCPlugLrcshowPriv
 *
iv
 = (RCPlugLrcshowPriv *)
da
;

482 if(
da
==
NULL
) ;

483 
	`gtk_wdow_g_posi
(
	`GTK_WINDOW
(
widg
),

484 &(
iv
->
wdow_x
), &riv->
wdow_y
));

485 
	`gtk_widg_deroyed
(
iv
->
c_wdow
, &(priv->lrc_window));

486 
	}
}

489 
gboޗn
 
	$rc_ug_cshow_upde
(
gpor
 
da
)

491 
RCPlugLrcshowPriv
 *
iv
 = (RCPlugLrcshowPriv *)
da
;

492 if(
da
==
NULL
 
TRUE
;

493 
	`gtk_widg_queue_dw
(
iv
->
c_s
);

494  
TRUE
;

495 
	}
}

497 
	$rc_ug_cshow_lyric_ady_cb
(
RCLibLyric
 *
lyric
, 
gut
 
dex
,

498 
gpor
 
da
)

500 
RCPlugLrcshowPriv
 *
iv
 = (RCPlugLrcshowPriv *)
da
;

501 
RCLibLyricDa
 *
lyric_da
;

502 
o_t
 *

;

503 
gt
 
w
, 
h
;

504 
gt
 
c_numb
 = 0;

505 
gt
 
i
;

506 
GSequIr
 *

, *
_beg
;

507 cڡ 
RCLibLyricPdDa
 *
rd_da
;

508 if(
da
==
NULL
) ;

509 if(
iv
->
mode
>0)

511 if(
dex
>0
iv
->
ack
 = 1;

512 
iv
->
ack
 = 0;

514 
iv
->
ack
 = 0;

517 
rd_da
 = 
	`rib_lyric_g_rd_da
(
iv
->
ack
);

518 if(
rd_da
==
NULL
 ||d_da->
q
==NULL)

520 
c_numb
 = 
	`g_qu_g_ngth
(
rd_da
->
q
);

521 
iv
->
c_numb
 =rc_number;

522 if(
iv
->
c_nm_sur
!=
NULL
)

524 
i
=0;
iv
->
c_nm_sur
[i]!=
NULL
;i++)

525 
	`o_sur_deroy
(
iv
->
c_nm_sur
[
i
]);

526 
	`g_
(
iv
->
c_nm_sur
);

527 
iv
->
c_nm_sur
 = 
NULL
;

529 if(
iv
->
c_aive_sur
!=
NULL
)

531 
i
=0;
iv
->
c_aive_sur
[i]!=
NULL
;i++)

532 
	`o_sur_deroy
(
iv
->
c_aive_sur
[
i
]);

533 
	`g_
(
iv
->
c_aive_sur
);

534 
iv
->
c_aive_sur
 = 
NULL
;

536 
iv
->
c_nm_sur
 = 
	`g_w0
(
o_sur_t
 *, 
c_numb
+1);

537 
iv
->
c_aive_sur
 = 
	`g_w0
(
o_sur_t
 *, 
c_numb
+1);

538 
_beg
 = 
	`g_qu_g_beg_
(
rd_da
->
q
);

539 

 = 
_beg
;

540 
i
=0;i<
c_numb
;i++)

542 
lyric_da
 = 
	`g_qu_g
(

);

543 if(
lyric_da
==
NULL
) ;

544 
	`ngo_yout_t_xt
(
iv
->
yout
, 
lyric_da
->
xt
, -1);

545 
	`ngo_yout_g_pix_size
(
iv
->
yout
, &
w
, &
h
);

547 
iv
->
c_nm_sur
[
i
] = 
	`o_image_sur_
(

548 
CAIRO_FORMAT_ARGB32
, 
w
, 
h
);

549 

 = 
	`o_
(
iv
->
c_nm_sur
[
i
]);

550 
	`o_t_sour_rgba
(

, 1.0, 1.0, 1.0, 0.0);

551 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_SOURCE
);

552 
	`o_t
(

);

553 
	`o_move_to
(

, 0, 0);

554 
	`gdk_o_t_sour_rgba
(

, &(
iv
->
xt_c
));

555 
	`ngo_o_show_yout
(

, 
iv
->
yout
);

556 
	`o_deroy
(

);

558 
iv
->
c_aive_sur
[
i
] = 
	`o_image_sur_
(

559 
CAIRO_FORMAT_ARGB32
, 
w
, 
h
);

560 

 = 
	`o_
(
iv
->
c_aive_sur
[
i
]);

561 
	`o_t_sour_rgba
(

, 1.0, 1.0, 1.0, 0.0);

562 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_SOURCE
);

563 
	`o_t
(

);

564 
	`o_move_to
(

, 0, 0);

565 
	`gdk_o_t_sour_rgba
(

, &(
iv
->
xt_hight
));

566 
	`ngo_o_show_yout
(

, 
iv
->
yout
);

567 
	`o_deroy
(

);

568 

 = 
	`g_qu__xt
(iter);

570 
	}
}

572 
	$rc_ug_cshow_shutdown_cb
(
RCLibPlug
 *
ug
, 
gpor
 
da
)

574 
RCPlugLrcshowPriv
 *
iv
 = (RCPlugLrcshowPriv *)
da
;

575 if(
da
==
NULL
) ;

576 if(
iv
->
c_wdow
!=
NULL
)

578 
	`gtk_wdow_g_posi
(
	`GTK_WINDOW
(
iv
->
c_wdow
),

579 &(
iv
->
wdow_x
), &riv->
wdow_y
));

581 
	`rc_ug_cshow_ve_cf
(
iv
);

582 
	}
}

584 
gboޗn
 
	$rc_ug_cshow_ld
(
RCLibPlugDa
 *
ug
)

586 
RCPlugLrcshowPriv
 *
iv
 = &
cshow_iv
;

587 
iv
->
c_wdow
 = 
	`gtk_wdow_w
(
GTK_WINDOW_TOPLEVEL
);

588 
iv
->
c_s
 = 
	`gtk_dwg__w
();

589 
	`gtk_widg_t_size_que
(
iv
->
c_wdow
, 300, 400);

590 
	`gtk_widg_add_evts
(
iv
->
c_s
, 
GDK_BUTTON_PRESS_MASK
 |

591 
GDK_BUTTON_RELEASE_MASK
 | 
GDK_BUTTON_MOTION_MASK
 |

592 
GDK_POINTER_MOTION_HINT_MASK
);

593 
iv
->
yout
 = 
	`gtk_widg__ngo_yout
riv->
c_s
, 
NULL
);

594 
	`rc_ug_cshow_upde_ft
(
iv
);

595 
iv
->
ai
 = 
	`gtk_togg_ai_w
("RC2ViewPluginLyricShow",

596 
	`_
("LyriShow"), _("Show/hidlyrishow wdow"), 
NULL
);

597 
	`gtk_togg_ai_t_aive
(
iv
->
ai
, 
TRUE
);

598 
iv
->
mu_id
 = 
	`rc_ui_mu_add_mu_ai
(
	`GTK_ACTION
riv->
ai
),

600 "RC2VwPlugLyricShow", 
TRUE
);

601 
	`g_obje_t
(
iv
->
c_wdow
, "t", 
	`_
("Lyric Show"),

602 "wdow-posi", 
GTK_WIN_POS_CENTER
, 
NULL
);

603 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
c_wdow
),riv->
c_s
);

604 if(
iv
->
wdow_x
>=0 &&riv->
wdow_y
>=0)

606 
	`gtk_wdow_move
(
	`GTK_WINDOW
(
iv
->
c_wdow
),riv->
wdow_x
,

607 
iv
->
wdow_y
);

609 
	`gtk_widg_show_l
(
iv
->
c_wdow
);

610 
	`g_sigl_c
(
iv
->
c_s
, "draw",

611 
	`G_CALLBACK
(
rc_ug_cshow_dw
), 
iv
);

612 
	`g_sigl_c
(
iv
->
c_s
, "button-press-event",

613 
	`G_CALLBACK
(
rc_ug_cshow_dg
), 
iv
);

614 
	`g_sigl_c
(
iv
->
c_s
, "motion-notify-event",

615 
	`G_CALLBACK
(
rc_ug_cshow_dg
), 
iv
);

616 
	`g_sigl_c
(
iv
->
c_s
, "button-release-event",

617 
	`G_CALLBACK
(
rc_ug_cshow_dg
), 
iv
);

618 
	`g_sigl_c
(
iv
->
ai
, "toggled",

619 
	`G_CALLBACK
(
rc_ug_cshow_vw_mu_toggd
), 
iv
);

620 
	`g_sigl_c
(
iv
->
c_wdow
, "destroy",

621 
	`G_CALLBACK
(
rc_ug_cshow_wdow_deroy_cb
), 
iv
);

622 
	`g_sigl_c
(
iv
->
c_wdow
, "delete-event",

623 
	`G_CALLBACK
(
rc_ug_cshow_wdow_de_evt_cb
), 
iv
);

624 
iv
->
lyric_found_id
 = 
	`rib_lyric_sigl_c
("lyric-ready",

625 
	`G_CALLBACK
(
rc_ug_cshow_lyric_ady_cb
), 
iv
);

626 
iv
->
timeout_id
 = 
	`g_timeout_add
(100,

627 (
GSourFunc
)
rc_ug_cshow_upde
, 
iv
);

628 if(!
iv
->
show_wdow
)

629 
	`gtk_togg_ai_t_aive
(
iv
->
ai
, 
FALSE
);

630  
TRUE
;

631 
	}
}

633 
gboޗn
 
	$rc_ug_cshow_ud
(
RCLibPlugDa
 *
ug
)

635 
RCPlugLrcshowPriv
 *
iv
 = &
cshow_iv
;

636 if(
iv
->
mu_id
>0)

638 
	`rc_ui_mu_move_mu_ai
(
	`GTK_ACTION
(
iv
->
ai
),

639 
iv
->
mu_id
);

640 
	`g_obje_uef
(
iv
->
ai
);

642 if(
iv
->
timeout_id
>0)

643 
	`g_sour_move
(
iv
->
timeout_id
);

644 if(
iv
->
lyric_found_id
>0)

646 
	`rib_lyric_sigl_disc
(
iv
->
lyric_found_id
);

647 
iv
->
lyric_found_id
 = 0;

649 if(
iv
->
yout
!=
NULL
)

650 
	`g_obje_uef
(
iv
->
yout
);

651 if(
iv
->
c_wdow
!=
NULL
)

653 
	`gtk_widg_deroy
(
iv
->
c_wdow
);

654 
iv
->
c_wdow
 = 
NULL
;

656  
TRUE
;

657 
	}
}

659 
gboޗn
 
	$rc_ug_cshow_cfigu
(
RCLibPlugDa
 *
ug
)

661 
RCPlugLrcshowPriv
 *
iv
 = &
cshow_iv
;

662 
GtkWidg
 *
dlog
;

663 
GtkWidg
 *
cڋ_
;

664 
GtkWidg
 *
b
[5];

665 
GtkWidg
 *
grid
;

666 
GtkWidg
 *
ft_bu
;

667 
GtkWidg
 *
a_
;

668 
GtkWidg
 *
bg_c_bu
;

669 
GtkWidg
 *
fg_c_bu
;

670 
GtkWidg
 *
hi_c_bu
;

671 
gt
 
i
, 
su
;

672 
dlog
 = 
	`gtk_dlog_w_wh_bus
(
	`_
("LyriShow Pns"), 
NULL
,

673 
GTK_DIALOG_MODAL
 | 
GTK_DIALOG_DESTROY_WITH_PARENT
, 
GTK_STOCK_OK
,

674 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_REJECT
, 
NULL
);

675 
grid
 = 
	`gtk_grid_w
();

676 
b
[0] = 
	`gtk_b_w
(
	`_
("Font: "));

677 
b
[1] = 
	`gtk_b_w
(
	`_
("Line spacing: "));

678 
b
[2] = 
	`gtk_b_w
(
	`_
("Background Color: "));

679 
b
[3] = 
	`gtk_b_w
(
	`_
("Frontground Color: "));

680 
b
[4] = 
	`gtk_b_w
(
	`_
("Highlight Color: "));

681 if(
iv
->
ft_rg
!=
NULL
)

682 
ft_bu
 = 
	`gtk_ft_bu_w_wh_ft
(
iv
->
ft_rg
);

684 
ft_bu
 = 
	`gtk_ft_bu_w
();

685 
a_
 = 
	`gtk__bu_w_wh_nge
(0, 100, 1);

686 
bg_c_bu
 = 
	`gtk_c_bu_w_wh_rgba
(&(
iv
->
background
));

687 
fg_c_bu
 = 
	`gtk_c_bu_w_wh_rgba
(&(
iv
->
xt_c
));

688 
hi_c_bu
 = 
	`gtk_c_bu_w_wh_rgba
(&(
iv
->
xt_hight
));

689 
i
=0;i<5;i++)

691 
	`g_obje_t
(
b
[
i
], "xign", 0.0, "yign", 0.5, 
NULL
);

693 
	`g_obje_t
(
a_
, "numic", 
FALSE
, "value",

694 (
gdoub
)
iv
->
le_di
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

695 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

696 
	`g_obje_t
(
ft_bu
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

697 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

698 
	`g_obje_t
(
bg_c_bu
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

699 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

700 
	`g_obje_t
(
fg_c_bu
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

701 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

702 
	`g_obje_t
(
hi_c_bu
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

703 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, 
NULL
);

704 
	`g_obje_t
(
grid
, "row-spacing", 4, "column-spacing", 4, "expand",

705 
TRUE
, 
NULL
);

706 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
b
[0], 0, 0, 1, 1);

707 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
ft_bu
, 1, 0, 1, 1);

708 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
b
[1], 0, 1, 1, 1);

709 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
a_
, 1, 1, 1, 1);

710 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
b
[2], 0, 2, 1, 1);

711 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
bg_c_bu
, 1, 2, 1, 1);

712 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
b
[3], 0, 3, 1, 1);

713 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
fg_c_bu
, 1, 3, 1, 1);

714 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
b
[4], 0, 4, 1, 1);

715 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
hi_c_bu
, 1, 4, 1, 1);

716 
cڋ_
 = 
	`gtk_dlog_g_cڋ_
(
	`GTK_DIALOG
(
dlog
));

717 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
cڋ_
), 
grid
);

718 
	`gtk_widg_show_l
(
dlog
);

719 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
dlog
));

720 if(
su
==
GTK_RESPONSE_ACCEPT
)

722 
	`g_
(
iv
->
ft_rg
);

723 
iv
->
ft_rg
 = 
	`g_rdup
(
	`gtk_ft_bu_g_ft_me
(

724 
	`GTK_FONT_BUTTON
(
ft_bu
)));

725 
	`rc_ug_cshow_upde_ft
(
iv
);

726 
iv
->
le_di
 = 
	`gtk__bu_g_vue_as_t
(

727 
	`GTK_SPIN_BUTTON
(
a_
));

728 
	`gtk_c_bu_g_rgba
(
	`GTK_COLOR_BUTTON
(
bg_c_bu
),

729 &(
iv
->
background
));

730 
	`gtk_c_bu_g_rgba
(
	`GTK_COLOR_BUTTON
(
fg_c_bu
),

731 &(
iv
->
xt_c
));

732 
	`gtk_c_bu_g_rgba
(
	`GTK_COLOR_BUTTON
(
hi_c_bu
),

733 &(
iv
->
xt_hight
));

734 
	`rc_ug_cshow_ve_cf
(
iv
);

736 
	`gtk_widg_deroy
(
dlog
);

737  
TRUE
;

738 
	}
}

740 
gboޗn
 
	$rc_ug_cshow_
(
RCLibPlugDa
 *
ug
)

742 
RCPlugLrcshowPriv
 *
iv
 = &
cshow_iv
;

743 
iv
->
show_wdow
 = 
TRUE
;

744 
iv
->
wdow_x
 = -1;

745 
iv
->
wdow_y
 = -1;

746 
	`gdk_rgba_r
(&(
iv
->
background
), "#3B5673");

747 
	`gdk_rgba_r
(&(
iv
->
xt_c
), "#FFFFFF");

748 
	`gdk_rgba_r
(&(
iv
->
xt_hight
), "#5CA6D6");

749 
iv
->
ft_rg
 = 
	`g_rdup
("Monospace 10");

750 
iv
->
dg_ag
 = 
TRUE
;

751 
iv
->
keyfe
 = 
	`rib_ug_g_keyfe
();

752 
	`rc_ug_cshow_ld_cf
(
iv
);

753 
iv
->
shutdown_id
 = 
	`rib_ug_sigl_c
("shutdown",

754 
	`G_CALLBACK
(
rc_ug_cshow_shutdown_cb
), 
iv
);

755  
TRUE
;

756 
	}
}

758 
	$rc_ug_cshow_deroy
(
RCLibPlugDa
 *
ug
)

760 
RCPlugLrcshowPriv
 *
iv
 = &
cshow_iv
;

761 if(
iv
->
shutdown_id
>0)

762 
	`rib_ug_sigl_disc
(
iv
->
shutdown_id
);

763 
	`g_
(
iv
->
ft_rg
);

764 
	}
}

766 
RCLibPlugInfo
 
	grlug_fo
 = {

767 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

768 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

769 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

770 .
	gty
 = 
RCLIB_PLUGIN_TYPE_MODULE
,

771 .
	gid
 = 
LRCSHOW_ID
,

772 .
	gme
 = 
N_
("Lyric Show Plug-in"),

773 .
	gvsi
 = "0.5",

774 .
	gdesti
 = 
N_
("Showyric inhelayer or in single window."),

775 .
	gauth
 = "SuperCat",

776 .
	ghomage
 = "http://supercat-lab.org/",

777 .
	gld
 = 
rc_ug_cshow_ld
,

778 .
	gud
 = 
rc_ug_cshow_ud
,

779 .
	gcfigu
 = 
rc_ug_cshow_cfigu
,

780 .
	gderoy
 = 
rc_ug_cshow_deroy
,

781 .
	gexa_fo
 = 
NULL


784 
RCPLUGIN_INIT_PLUGIN
(
rlug_fo
.
id
, 
rc_ug_cshow_
,cplugin_info);

	@plugins/base/mediakey.c

26 
	~<glib.h
>

27 
	~<gio/gio.h
>

28 
	~<gdk/gdk.h
>

29 
	~<rib.h
>

31 #ifde
GDK_WINDOWING_X11


32 
	~<X11/Xlib.h
>

33 
	~<X11/XF86keysym.h
>

34 
	~<gdk/gdkx.h
>

37 
	#DBUS_MEDIAKEY_NAME
 "g.gnome.StgsDm"

	)

38 
	#DBUS_MEDIAKEY_OBJECT_PATH
 "/g/gnome/StgsDm/MedKeys"

	)

39 
	#DBUS_MEDIAKEY_INTERFACE
 "g.gnome.StgsDm.MedKeys"

	)

41 
	#DBUS_MEDIAKEY_FBACK_NAME
 "g.gnome.StgsDm"

	)

42 
	#DBUS_MEDIAKEY_FBACK_OBJECT_PATH
 "/g/gnome/StgsDm"

	)

43 
	#DBUS_MEDIAKEY_FBACK_INTERFACE
 "g.gnome.StgsDm"

	)

45 
	sRCPlugMedKeyPrive


47 
GDBusProxy
 *
	moxy
;

48 }
	tRCPlugMedKeyPrive
;

50 
RCPlugMedKeyPrive
 
	gmedkey_iv
 = {0};

52 
	$rc_ug_medkey_oxy_sigl_cb
(
GDBusProxy
 *
oxy
,

53 
gch
 *
nd_me
, gch *
sigl_me
, 
GV
 *
ms
,

54 
gpor
 
da
)

56 
gch
 *
iti
, *
key
;

57 
GS
 
e
;

58 
gt64
 
pos
, 
n
;

59 
RCLibPyRtMode
 
_mode
;

60 
RCLibPyRdomMode
 
ndom_mode
;

61 
	`g_v_g
(
ms
, "(ss)", &
iti
, &
key
);

62 if(
	`g_rcmp0
(
iti
, "RhythmCat2")==0)

64 if(
	`g_rcmp0
("Py", 
key
) == 0)

66 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

67 if(
e
==
GST_STATE_PLAYING
)

68 
	`rib_ce_u
();

70 
	`rib_ce_ay
();

72 if(
	`g_rcmp0
("Pvious", 
key
)==0)

73 
	`rib_ay_ay_ev
(
FALSE
, 
TRUE
, FALSE);

74 if(
	`g_rcmp0
("Next", 
key
)==0)

75 
	`rib_ay_ay_xt
(
FALSE
, 
TRUE
, FALSE);

76 if(
	`g_rcmp0
("St", 
key
)==0)

77 
	`rib_ce_
();

78 if(
	`g_rcmp0
("Rt", 
key
)==0)

80 
_mode
 = 
	`rib_ay_g__mode
();

81 
	`rib_ay_t__mode
(!
_mode
);

83 if(
	`g_rcmp0
("Shufe", 
key
)==0)

85 
ndom_mode
 = 
	`rib_ay_g_ndom_mode
();

86 
	`rib_ay_t_ndom_mode
(!
ndom_mode
);

88 if(
	`g_rcmp0
("Rewd", 
key
)==0)

90 
pos
 = 
	`rib_ce_quy_posi
();

91 if(
pos
>5 * 
GST_SECOND
)os -= 5 * GST_SECOND;

92 
pos
 = 0;

93 
	`rib_ce_t_posi
(
pos
);

95 if(
	`g_rcmp0
("FaFwd", 
key
)==0)

97 
pos
 = 
	`rib_ce_quy_posi
();

98 
n
 = 
	`rib_ce_quy_duti
();

99 
pos
 +5 * 
GST_SECOND
;

100 if(
pos
>
n
)os =en;

101 
	`rib_ce_t_posi
(
pos
);

104 
	`g_
(
iti
);

105 
	`g_
(
key
);

106 
	}
}

108 
gboޗn
 
	$rc_ug_medkey_gnome_lize
(

109 
RCPlugMedKeyPrive
 *
iv
)

111 
GDBusCi
 *
ci
;

112 
GE
 *
r
 = 
NULL
;

113 
GV
 *
v
;

114 
ci
 = 
	`g_bus_g_sync
(
G_BUS_TYPE_SESSION
, 
NULL
, &
r
);

115 if(
r
!=
NULL
)

117 
	`g_wng
("MediaKey: Cannot connecto D-Bus: %s",

118 
r
->
mesge
);

119 
	`g_r_
(
r
);

120 if(
ci
!=
NULL

	`g_obje_uef
(connection);

121  
FALSE
;

123 
iv
->
oxy
 = 
	`g_dbus_oxy_w_sync
(
ci
, 
G_DBUS_PROXY_FLAGS_NONE
,

124 
NULL
, 
DBUS_MEDIAKEY_NAME
, 
DBUS_MEDIAKEY_OBJECT_PATH
,

125 
DBUS_MEDIAKEY_INTERFACE
, 
NULL
, NULL);

126 if(
iv
->
oxy
==
NULL
)

128 
iv
->
oxy
 = 
	`g_dbus_oxy_w_sync
(
ci
,

129 
G_DBUS_PROXY_FLAGS_NONE
, 
NULL
, 
DBUS_MEDIAKEY_FBACK_NAME
,

130 
DBUS_MEDIAKEY_FBACK_OBJECT_PATH
, 
DBUS_MEDIAKEY_FBACK_INTERFACE
,

131 
NULL
, &
r
);

132 if(
r
!=
NULL
)

134 
	`g_wng
("MediaKey: Unableo connect MediaKeyroxy: %s",

135 
r
->
mesge
);

136 
	`g_r_
(
r
);

137 
r
 = 
NULL
;

138 
iv
->
oxy
 = 
NULL
;

141 
	`g_obje_uef
(
ci
);

142 if(
iv
->
oxy
==
NULL
 
FALSE
;

143 
v
 = 
	`g_dbus_oxy__sync
(
iv
->
oxy
,

144 "GbMedPyKeys", 
	`g_v_w
("(su)", "RhythmCat2", 0),

145 
G_DBUS_CALL_FLAGS_NONE
, -1, 
NULL
, &
r
);

146 if(
v
!=
NULL
)

147 
	`g_v_uef
(
v
);

150 
	`g_wng
("MediaKey: Unableo call method GrabMediaPlayerKeys: %s",

151 
r
->
mesge
);

152 
	`g_r_
(
r
);

153 
r
 = 
NULL
;

154 
	`g_obje_uef
(
iv
->
oxy
);

155 
iv
->
oxy
 = 
NULL
;

156  
FALSE
;

158 
	`g_sigl_c
(
iv
->
oxy
, "g-signal",

159 
	`G_CALLBACK
(
rc_ug_medkey_oxy_sigl_cb
), 
iv
);

160  
TRUE
;

161 
	}
}

163 #ifde
GDK_WINDOWING_X11


165 
	$rc_ug_medkey_gb_mmkey
(
gt
 
key_code
, 
GdkWdow
 *
ro
)

167 
Diy
 *
diy
;

168 
	`gdk_r__push
();

170 
diy
 = 
	`GDK_DISPLAY_XDISPLAY
(
	`gdk_diy_g_deu
());

171 
	`XGbKey
(
diy
, 
key_code
, 0, 
	`GDK_WINDOW_XID
(
ro
), 
True
, 
GbModeAsync
,

172 
GbModeAsync
);

173 
	`XGbKey
(
diy
, 
key_code
, 
Mod2Mask
, 
	`GDK_WINDOW_XID
 (
ro
), 
True
,

174 
GbModeAsync
, GrabModeAsync);

175 
	`XGbKey
(
diy
, 
key_code
, 
Mod5Mask
, 
	`GDK_WINDOW_XID
(
ro
), 
True
,

176 
GbModeAsync
, GrabModeAsync);

177 
	`XGbKey
(
diy
, 
key_code
, 
LockMask
, 
	`GDK_WINDOW_XID
 (
ro
), 
True
,

178 
GbModeAsync
, GrabModeAsync);

179 
	`XGbKey
(
diy
, 
key_code
, 
Mod2Mask
 | 
Mod5Mask
, 
	`GDK_WINDOW_XID
(
ro
),

180 
True
, 
GbModeAsync
, GrabModeAsync);

181 
	`XGbKey
(
diy
, 
key_code
, 
Mod2Mask
 | 
LockMask
, 
	`GDK_WINDOW_XID
(
ro
),

182 
True
, 
GbModeAsync
, GrabModeAsync);

183 
	`XGbKey
(
diy
, 
key_code
, 
Mod5Mask
 | 
LockMask
, 
	`GDK_WINDOW_XID
(
ro
),

184 
True
, 
GbModeAsync
, GrabModeAsync);

185 
	`XGbKey
(
diy
, 
key_code
, 
Mod2Mask
 | 
Mod5Mask
 | 
LockMask
,

186 
	`GDK_WINDOW_XID
(
ro
), 
True
, 
GbModeAsync
, GrabModeAsync);

188 
	`gdk_ush
 ();

190 if(
	`gdk_r__p
 ())

192 
	`g_wng
("Cannot grabbing key!");

194 
	}
}

196 
	$rc_ug_medkey_ungb_mmkey
(
gt
 
key_code
, 
GdkWdow
 *
ro
)

198 
Diy
 *
diy
;

199 
	`gdk_r__push
();

201 
diy
 = 
	`GDK_DISPLAY_XDISPLAY
(
	`gdk_diy_g_deu
());

202 
	`XUngbKey
 (
diy
, 
key_code
, 0, 
	`GDK_WINDOW_XID
(
ro
));

203 
	`XUngbKey
 (
diy
, 
key_code
, 
Mod2Mask
, 
	`GDK_WINDOW_XID
(
ro
));

204 
	`XUngbKey
 (
diy
, 
key_code
, 
Mod5Mask
, 
	`GDK_WINDOW_XID
(
ro
));

205 
	`XUngbKey
 (
diy
, 
key_code
, 
LockMask
, 
	`GDK_WINDOW_XID
(
ro
));

206 
	`XUngbKey
 (
diy
, 
key_code
, 
Mod2Mask
 | 
Mod5Mask
, 
	`GDK_WINDOW_XID
(
ro
));

207 
	`XUngbKey
 (
diy
, 
key_code
, 
Mod2Mask
 | 
LockMask
, 
	`GDK_WINDOW_XID
(
ro
));

208 
	`XUngbKey
 (
diy
, 
key_code
, 
Mod5Mask
 | 
LockMask
, 
	`GDK_WINDOW_XID
(
ro
));

209 
	`XUngbKey
 (
diy
, 
key_code
, 
Mod2Mask
 | 
Mod5Mask
 | 
LockMask
,

210 
	`GDK_WINDOW_XID
 (
ro
));

212 
	`gdk_ush
 ();

214 if(
	`gdk_r__p
 ())

216 
	`g_wng
("Cannot ungrab key!");

218 
	}
}

220 
GdkFrRu
 
	$rc_ug_medkey_fr_mmkeys
(
GdkXEvt
 *
xevt
,

221 
GdkEvt
 *
evt
, 
gpor
 
da
)

223 
GS
 
e
;

224 
XEvt
 *
xev
;

225 
XKeyEvt
 *
key
;

226 
Diy
 *
diy
;

227 
xev
 = (
XEvt
 *
xevt
;

228 if(
xev
->
ty
 !
KeyPss
)

230  
GDK_FILTER_CONTINUE
;

233 
key
 = (
XKeyEvt
 *
xevt
;

235 
diy
 = 
	`GDK_DISPLAY_XDISPLAY
(
	`gdk_diy_g_deu
());

237 if(
	`XKeysymToKeycode
(
diy
, 
XF86XK_AudioPy
)==
key
->
keycode
)

239 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

240 if(
e
==
GST_STATE_PLAYING
)

241 
	`rib_ce_u
();

243 
	`rib_ce_ay
();

244  
GDK_FILTER_REMOVE
;

246 if(
	`XKeysymToKeycode
 (
diy
, 
XF86XK_AudioPau
)==
key
->
keycode
)

248 
	`rib_ce_u
();

249  
GDK_FILTER_REMOVE
;

251 if(
	`XKeysymToKeycode
(
diy
, 
XF86XK_AudioSt
)==
key
->
keycode
)

253 
	`rib_ce_
();

254  
GDK_FILTER_REMOVE
;

256 if(
	`XKeysymToKeycode
(
diy
, 
XF86XK_AudioPv
)==
key
->
keycode
)

258 
	`rib_ay_ay_ev
(
FALSE
, 
TRUE
, FALSE);

259  
GDK_FILTER_REMOVE
;

261 if(
	`XKeysymToKeycode
(
diy
, 
XF86XK_AudioNext
)==
key
->
keycode
)

263 
	`rib_ay_ay_xt
(
FALSE
, 
TRUE
, FALSE);

264  
GDK_FILTER_REMOVE
;

268  
GDK_FILTER_CONTINUE
;

270 
	}
}

272 
	$rc_ug_medkey_mmkeys_gb
(
gboޗn
 
gb
)

274 
gt
 
keycodes
[] = {0, 0, 0, 0, 0};

275 
GdkDiy
 *
diy
;

276 
GdkSn
 *
sn
;

277 
GdkWdow
 *
ro
;

278 
gut
 
i
, 
j
;

280 
diy
 = 
	`gdk_diy_g_deu
();

281 
keycodes
[0] = 
	`XKeysymToKeycode
(
	`GDK_DISPLAY_XDISPLAY
(
diy
),

282 
XF86XK_AudioPy
);

283 
keycodes
[1] = 
	`XKeysymToKeycode
(
	`GDK_DISPLAY_XDISPLAY
(
diy
),

284 
XF86XK_AudioSt
);

285 
keycodes
[2] = 
	`XKeysymToKeycode
(
	`GDK_DISPLAY_XDISPLAY
(
diy
),

286 
XF86XK_AudioPv
);

287 
keycodes
[3] = 
	`XKeysymToKeycode
(
	`GDK_DISPLAY_XDISPLAY
(
diy
),

288 
XF86XK_AudioNext
);

289 
keycodes
[4] = 
	`XKeysymToKeycode
(
	`GDK_DISPLAY_XDISPLAY
(
diy
),

290 
XF86XK_AudioPau
);

292 
i
=0;i<
	`gdk_diy_g_n_sns
(
diy
); i++)

294 
sn
 = 
	`gdk_diy_g_sn
 (
diy
, 
i
);

296 if(
sn
!=
NULL
)

298 
ro
 = 
	`gdk_sn_g_ro_wdow
 (
sn
);

300 
j
=0;j<
	`G_N_ELEMENTS
(
keycodes
);j++)

302 if(
keycodes
[
j
]!=0)

304 if(
gb
)

305 
	`rc_ug_medkey_gb_mmkey
(
keycodes
[
j
], 
ro
);

307 
	`rc_ug_medkey_ungb_mmkey
(
keycodes
[
j
], 
ro
);

312 if(
gb
)

314 
	`gdk_wdow_add_fr
(
ro
, 
rc_ug_medkey_fr_mmkeys
,

315 
NULL
);

319 
	`gdk_wdow_move_fr
(
ro
,

320 
rc_ug_medkey_fr_mmkeys
, 
NULL
);

324 
	}
}

329 
gboޗn
 
	$rc_ug_medkey_ld
(
RCLibPlugDa
 *
ug
)

331 
RCPlugMedKeyPrive
 *
iv
 = &
medkey_iv
;

333 if(
	`rc_ug_medkey_gnome_lize
(
iv
) 
TRUE
;

335 #ifde
GDK_WINDOWING_X11


336 
	`rc_ug_medkey_mmkeys_gb
(
TRUE
);

337 
	`g_mesge
("Use X11 multimedia key grabs fallback support.");

338  
TRUE
;

341  
FALSE
;

342 
	}
}

345 
gboޗn
 
	$rc_ug_medkey_ud
(
RCLibPlugDa
 *
ug
)

347 
RCPlugMedKeyPrive
 *
iv
 = &
medkey_iv
;

348 if(
iv
->
oxy
!=
NULL

	`g_obje_uef
(priv->proxy);

349 
iv
->
oxy
 = 
NULL
;

351 #ifde
GDK_WINDOWING_X11


352 
	`rc_ug_medkey_mmkeys_gb
(
FALSE
);

353  
TRUE
;

356  
TRUE
;

357 
	}
}

359 
gboޗn
 
	$rc_ug_medkey_
(
RCLibPlugDa
 *
ug
)

362  
TRUE
;

363 
	}
}

365 
	$rc_ug_medkey_deroy
(
RCLibPlugDa
 *
ug
)

368 
	}
}

370 
RCLibPlugInfo
 
	grlug_fo
 = {

371 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

372 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

373 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

374 .
	gty
 = 
RCLIB_PLUGIN_TYPE_MODULE
,

375 .
	gid
 = "rc2-native-mediakey-controller",

376 .
	gme
 = 
N_
("Multimedia Key Support"),

377 .
	gvsi
 = "0.5",

378 .
	gdesti
 = 
N_
("Controlhelayer with multimedia key in GNOME."),

379 .
	gauth
 = "SuperCat",

380 .
	ghomage
 = "http://supercat-lab.org/",

381 .
	gld
 = 
rc_ug_medkey_ld
,

382 .
	gud
 = 
rc_ug_medkey_ud
,

383 .
	gcfigu
 = 
NULL
,

384 .
	gderoy
 = 
rc_ug_medkey_deroy
,

385 .
	gexa_fo
 = 
NULL


388 
RCPLUGIN_INIT_PLUGIN
(
rlug_fo
.
id
, 
rc_ug_medkey_
,cplugin_info);

	@plugins/base/mpris2.c

26 
	~<glib.h
>

27 
	~<gio/gio.h
>

28 
	~<gtk/gtk.h
>

29 
	~<g/g.h
>

30 
	~<rib.h
>

31 
	~<rc-ui-wdow.h
>

33 
	#DBUS_MPRIS_BUS_NAME_PREFIX
 "g.mis.MedPy2"

	)

34 
	#DBUS_MPRIS_OBJECT_NAME
 "/g/mis/MedPy2"

	)

36 
	#DBUS_MPRIS_ROOT_INTERFACE
 "g.mis.MedPy2"

	)

37 
	#DBUS_MPRIS_PLAYER_INTERFACE
 "g.mis.MedPy2.Py"

	)

38 
	#DBUS_MPRIS_TRACKLIST_INTERFACE
 "g.mis.MedPy2.TckLi"

	)

39 
	#DBUS_MPRIS_PLAYLISTS_INTERFACE
 "g.mis.MedPy2.Pylis"

	)

41 #ifde
G_LOG_DOMAIN


42 #unde
G_LOG_DOMAIN


45 
	#G_LOG_DOMAIN
 "MPRIS-Sut"

	)

46 
	#MPRISSUPPORT_ID
 "rc2-tive-mis2-cڌr"

	)

48 
	sRCPlugMPRISPrive


50 
GDBusCi
 *
	mci
;

51 
gut
 
	mmis_me_own_id
;

52 
gut
 
	mmis_ro_id
;

53 
gut
 
	mmis_ay_id
;

54 
GHashTab
 *
	may_ݔty_chges
;

55 
gut
 
	mݔty_em_id
;

57 
gulg
 
	me_chged_id
;

58 
gulg
 
	muri_chged_id
;

59 
gulg
 
	mmada_found_id
;

60 
gulg
 
	mvume_chged_id
;

61 
gulg
 
	m_mode_chged_id
;

62 
gulg
 
	mndom_mode_chged_id
;

63 }
	tRCPlugMPRISPrive
;

65 
RCPlugMPRISPrive
 
	gmis_iv
 = {0};

66 cڡ 
gch
 *
	gmis_idty
 = "RhythmCat2";

67 cڡ 
gch
 * cڡ 
	gmis_su܋d_uri_schemes
[] =

68 {"fe", "hp", 
NULL
};

69 cڡ 
gch
 * cڡ 
	gmis_su܋d_mime_tys
[] =

70 {"iti/ogg", "audio/x-vbis+ogg", "audio/x-ac", 
NULL
};

71 cڡ 
gch
 *
	gmis_oei_xml
 =

122 
	$rc_ug_mis_em_ݔty_chges
(
RCPlugMPRISPrive
 *
iv
,

123 
GHashTab
 *
chges
, cڡ 
gch
 *
r
)

125 
GE
 *
r
 = 
NULL
;

126 
GVBud
 *
ݔts
;

127 
GVBud
 *
vided
;

128 
GV
 *
ms
;

129 
gpor
 
me
, 
vue
;

130 
GHashTabIr
 

;

133 
ݔts
 = 
	`g_v_bud_w
(
	`G_VARIANT_TYPE
 ("a{sv}"));

134 
vided
 = 
	`g_v_bud_w
(
	`G_VARIANT_TYPE
 ("as"));

135 
	`g_hash_b__
(&

, 
chges
);

136 
	`g_hash_b__xt
(&

, &
me
, &
vue
))

138 if(
vue
!=
NULL
)

139 
	`g_v_bud_add
(
ݔts
, "{sv}", 
me
, 
vue
);

141 
	`g_v_bud_add
(
vided
, "s", 
me
);

143 
ms
 = 
	`g_v_w
("({sv}as)", 
r
, 
ݔts
,

144 
vided
);

145 
	`g_v_bud_uef
(
ݔts
);

146 
	`g_v_bud_uef
(
vided
);

147 
	`g_dbus_ci_em_sigl
(
iv
->
ci
, 
NULL
,

148 
DBUS_MPRIS_OBJECT_NAME
, "org.freedesktop.DBus.Properties",

149 "PrݔtsChged", 
ms
, &
r
);

150 if(
r
!=
NULL
)

152 
	`g_wng
("Unableo send MPRIS2roperty changes for %s: %s",

153 
r
, 
r
->
mesge
);

154 
	`g_r_r
(&
r
);

156 
	}
}

158 
gboޗn
 
	$rc_ug_mis_em_ݔts_id
(
gpor
 
da
)

160 
RCPlugMPRISPrive
 *
iv
 = (RCPlugMPRISPriv*)
da
;

161 if(
da
==
NULL
 
FALSE
;

162 if(
iv
->
ay_ݔty_chges
!=
NULL
)

164 
	`rc_ug_mis_em_ݔty_chges
(
iv
,

165 
iv
->
ay_ݔty_chges
, 
DBUS_MPRIS_PLAYER_INTERFACE
);

166 
	`g_hash_b_deroy
(
iv
->
ay_ݔty_chges
);

167 
iv
->
ay_ݔty_chges
 = 
NULL
;

169 
iv
->
ݔty_em_id
 = 0;

170  
FALSE
;

171 
	}
}

173 
	$rc_ug_mis_ay_add_ݔty_chge
(

174 
RCPlugMPRISPrive
 *
iv
, cڡ *
ݔty
, 
GV
 *
vue
)

176 if(
iv
->
ay_ݔty_chges
==
NULL
)

178 
iv
->
ay_ݔty_chges
 = 
	`g_hash_b_w_fu
(
g_r_hash
,

179 
g_r_equ
, 
g_
, (
GDeroyNify
)
g_v_uef
);

181 
	`g_hash_b_
(
iv
->
ay_ݔty_chges
, 
	`g_rdup
(
ݔty
),

182 
	`g_v_f_sk
(
vue
));

183 if(
iv
->
ݔty_em_id
 == 0)

185 
iv
->
ݔty_em_id
 = 
	`g_id_add
(

186 
rc_ug_mis_em_ݔts_id
, 
iv
);

188 
	}
}

190 
GV
 *
	$rc_ug_mis_g_mada
(cڡ 
gch
 *
uri
,

191 
GSequIr
 *
n
, cڡ 
RCLibCeMada
 *
mada
)

193 
GVBud
 *
bud
;

194 
GV
 *
v
;

195 
gt
 
acknum
 = 0;

196 
gch
 *
ack_id
 = 
NULL
;

197 cڡ 
gch
 *
t
, *
ti
, *
bum
;

198 
gt64
 
ngth
;

199 cڡ 
gch
 *
rv
[] = {
NULL
, NULL};

200 
RCLibDbPyliDa
 *
ayli_da
;

201 if(
n
!=
NULL
)

203 
ayli_da
 = 
	`g_qu_g
(
n
);

204 
t
 = 
ayli_da
->title;

205 
ti
 = 
ayli_da
->artist;

206 
bum
 = 
ayli_da
->album;

207 
ngth
 = 
ayli_da
->ngth / 
GST_USECOND
;

208 
acknum
 = 
ayli_da
->tracknum;

210 if(
mada
!=
NULL
)

212 
t
 = 
mada
->title;

213 
ti
 = 
mada
->artist;

214 
bum
 = 
mada
->album;

215 
ngth
 = 
mada
->
duti
 / 
GST_USECOND
;

216 
acknum
 = 
mada
->
ack
;

218  
NULL
;

219 
bud
 = 
	`g_v_bud_w
(
	`G_VARIANT_TYPE
("a{sv}"));

220 if(
n
!=
NULL
)

221 
ack_id
 = 
	`g_rdup_tf
("%p", 
n
);

222 if(
ack_id
!=
NULL
)

224 
	`g_v_bud_add
(
bud
, "{sv}", "mpris:trackid",

225 
	`g_v_w
("s", 
ack_id
));

226 
	`g_
(
ack_id
);

228 
	`g_v_bud_add
(
bud
, "{sv}", "mpris:length",

229 
	`g_v_w_t64
(
ngth
));

230 if(
t
!=
NULL
)

231 
	`g_v_bud_add
(
bud
, "{sv}", "xesam:title",

232 
	`g_v_w_rg
(
t
));

233 if(
ti
!=
NULL
)

235 
rv
[0] = 
ti
;

236 
	`g_v_bud_add
(
bud
, "{sv}", "xesam:artist",

237 
	`g_v_w_rv
(
rv
, -1));

239 if(
bum
!=
NULL
)

240 
	`g_v_bud_add
(
bud
, "{sv}", "xesam:album",

241 
	`g_v_w_rg
(
bum
));

242 if(
uri
!=
NULL
)

243 
	`g_v_bud_add
(
bud
, "{sv}", "xesam:url",

244 
	`g_v_w_rg
(
uri
));

245 
	`g_v_bud_add
(
bud
, "{sv}", "xesam:trackNumber",

246 
	`g_v_w_t32
(
acknum
));

247 
v
 = 
	`g_v_bud_d
(
bud
);

248 
	`g_v_bud_uef
(
bud
);

249  
v
;

250 
	}
}

252 
	$rc_ug_mis_ro_mhod__cb
(

253 
GDBusCi
 *
ci
, cڡ 
gch
 *
nd
,

254 cڡ 
gch
 *
obje_th
, cڡ gch *
r_me
,

255 cڡ 
gch
 *
mhod_me
, 
GV
 *
ms
,

256 
GDBusMhodInvoti
 *
voti
, 
gpor
 
da
)

258 if(
	`g_rcmp0
(
obje_th
, 
DBUS_MPRIS_OBJECT_NAME
)!= 0 ||

259 
	`g_rcmp0
(
r_me
, 
DBUS_MPRIS_ROOT_INTERFACE
)!=0)

261 
	`g_dbus_mhod_voti_tu_r
(
voti
, 
G_DBUS_ERROR
,

262 
G_DBUS_ERROR_NOT_SUPPORTED
, "Method %s.%s isot supported",

263 
r_me
, 
mhod_me
);

266 if(
	`g_rcmp0
(
mhod_me
, "Raise")==0)

268 
	`rc_ui_ma_wdow_e_ma_wdow
();

269 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

271 if(
	`g_rcmp0
(
mhod_me
, "Quit")==0)

274 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

276 
	}
}

278 
GV
 *
	$rc_ug_mis_g_ro_ݔty
(

279 
GDBusCi
 *
ci
, cڡ 
gch
 *
nd
,

280 cڡ 
gch
 *
obje_th
, cڡ gch *
r_me
,

281 cڡ 
gch
 *
ݔty_me
, 
GE
 **
r
, 
gpor
 
da
)

283 if(
	`g_rcmp0
(
obje_th
, 
DBUS_MPRIS_OBJECT_NAME
)!=0 ||

284 
	`g_rcmp0
(
r_me
, 
DBUS_MPRIS_ROOT_INTERFACE
)!=0)

286 
	`g_t_r
(
r
, 
G_DBUS_ERROR
, 
G_DBUS_ERROR_NOT_SUPPORTED
,

287 "Prݔty %s.%in su܋d", 
r_me
,

288 
ݔty_me
);

289  
NULL
;

291 if(
	`g_rcmp0
(
ݔty_me
, "CanQuit")==0)

293  
	`g_v_w_boޗn
(
FALSE
);

295 if(
	`g_rcmp0
(
ݔty_me
, "CanRaise")==0)

297  
	`g_v_w_boޗn
(
TRUE
);

299 if(
	`g_rcmp0
(
ݔty_me
, "HasTrackList")==0)

301  
	`g_v_w_boޗn
(
FALSE
);

303 if(
	`g_rcmp0
(
ݔty_me
, "Identity")==0)

305  
	`g_v_w_rg
(
mis_idty
);

307 if(
	`g_rcmp0
(
ݔty_me
, "SupportedUriSchemes")==0)

309  
	`g_v_w_rv
(
mis_su܋d_uri_schemes
, -1);

311 if(
	`g_rcmp0
(
ݔty_me
, "SupportedMimeTypes")==0)

313  
	`g_v_w_rv
(
mis_su܋d_mime_tys
, -1);

315 
	`g_t_r
(
r
, 
G_DBUS_ERROR
, 
G_DBUS_ERROR_NOT_SUPPORTED
,

316 "Prݔty %s.%in su܋d", 
r_me
, 
ݔty_me
);

317  
NULL
;

318  
NULL
;

319 
	}
}

321 
	$rc_ug_mis_ay_mhod__cb
(

322 
GDBusCi
 *
ci
, cڡ 
gch
 *
nd
,

323 cڡ 
gch
 *
obje_th
, cڡ gch *
r_me
,

324 cڡ 
gch
 *
mhod_me
, 
GV
 *
ms
,

325 
GDBusMhodInvoti
 *
voti
, 
gpor
 
da
)

327 
GS
 
e
;

328 
gboޗn
 
ag
;

329 
gt64
 
offt
;

330 
gpor
 
ack_id
;

331 
gch
 *
uri
;

332 if(
da
==
NULL
) ;

333 if(
	`g_rcmp0
(
obje_th
, 
DBUS_MPRIS_OBJECT_NAME
)!= 0 ||

334 
	`g_rcmp0
(
r_me
, 
DBUS_MPRIS_PLAYER_INTERFACE
)!=0)

336 
	`g_dbus_mhod_voti_tu_r
(
voti
, 
G_DBUS_ERROR
,

337 
G_DBUS_ERROR_NOT_SUPPORTED
, "Method %s.%s isot supported",

338 
r_me
, 
mhod_me
);

341 if(
	`g_rcmp0
(
mhod_me
, "Next")==0)

343 
	`rib_ay_ay_xt
(
FALSE
, FALSE, FALSE);

344 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

346 if(
	`g_rcmp0
(
mhod_me
, "Previous")==0)

348 
	`rib_ay_ay_ev
(
FALSE
, FALSE, FALSE);

349 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

351 if(
	`g_rcmp0
(
mhod_me
, "Pause") == 0)

353 if(
	`rib_ce_u
())

354 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

356 
	`g_dbus_mhod_voti_tu_r_l
(
voti
,

357 
G_DBUS_ERROR
, 
G_DBUS_ERROR_FAILED
, "Cannotause");

359 if(
	`g_rcmp0
(
mhod_me
, "PlayPause")==0)

361 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

362 if(
e
==
GST_STATE_PLAYING
)

363 
ag
 = 
	`rib_ce_u
();

365 
ag
 = 
	`rib_ce_ay
();

366 if(
ag
)

367 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

369 
	`g_dbus_mhod_voti_tu_r_l
(
voti
,

370 
G_DBUS_ERROR
, 
G_DBUS_ERROR_FAILED
, "Cannotlay/pause");

372 if(
	`g_rcmp0
(
mhod_me
, "Stop")==0)

374 
	`rib_ce_
();

375 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

377 if(
	`g_rcmp0
(
mhod_me
, "Play")==0)

379 if(
	`rib_ce_ay
())

380 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

382 
	`g_dbus_mhod_voti_tu_r_l
(
voti
,

383 
G_DBUS_ERROR
, 
G_DBUS_ERROR_FAILED
, "Cannotlay");

385 if(
	`g_rcmp0
(
mhod_me
, "Seek")==0)

387 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

388 if(
e
!=
GST_STATE_PLAYING
 && s!=
GST_STATE_PAUSED
)

390 
	`g_dbus_mhod_voti_tu_r_l
(
voti
,

391 
G_DBUS_ERROR
, 
G_DBUS_ERROR_FAILED
, "Cannot seek");

394 
	`g_v_g
(
ms
, "(x)", &
offt
);

395 
offt
 *
GST_USECOND
;

396 if(
	`rib_ce_t_posi
(
offt
))

397 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

399 
	`g_dbus_mhod_voti_tu_r_l
(
voti
,

400 
G_DBUS_ERROR
, 
G_DBUS_ERROR_FAILED
, "Cannot seek");

402 if(
	`g_rcmp0
(
mhod_me
, "SetPosition")==0)

404 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

405 if(
e
!=
GST_STATE_PLAYING
 && s!=
GST_STATE_PAUSED
)

407 
	`g_dbus_mhod_voti_tu_r_l
(
voti
,

408 
G_DBUS_ERROR
, 
G_DBUS_ERROR_FAILED
, "Cannot setosition");

411 
	`g_v_g
(
ms
, "(&ox)", &
ack_id
, &
offt
);

412 if(
ack_id
!=
	`rib_ce_g_db_n
())

414 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

417 
offt
 *
GST_USECOND
;

418 if(
	`rib_ce_t_posi
(
offt
))

419 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

421 
	`g_dbus_mhod_voti_tu_r_l
(
voti
,

422 
G_DBUS_ERROR
, 
G_DBUS_ERROR_FAILED
, "Cannot setosition");

424 if(
	`g_rcmp0
(
mhod_me
, "OpenUri")==0)

426 
	`g_v_g
(
ms
, "(&s)", &
uri
);

427 if(
uri
==
NULL
)

429 
	`g_dbus_mhod_voti_tu_r_l
(
voti
,

430 
G_DBUS_ERROR
, 
G_DBUS_ERROR_FAILED
, "Cannot open URI");

433 
	`rib_ce_t_uri
(
uri
);

434 
	`g_dbus_mhod_voti_tu_vue
(
voti
, 
NULL
);

436 
	}
}

438 
GV
 *
	$rc_ug_mis_g_ay_ݔty
(

439 
GDBusCi
 *
ci
, cڡ 
gch
 *
nd
,

440 cڡ 
gch
 *
obje_th
, cڡ gch *
r_me
,

441 cڡ 
gch
 *
ݔty_me
, 
GE
 **
r
, 
gpor
 
da
)

443 
GS
 
e
;

444 
gt64
 
pos
;

445 
gdoub
 
vume
 = 1.0;

446 
GSequIr
 *
n
;

447 
gch
 *
uri
;

448 cڡ 
RCLibCeMada
 *
mada
;

449 
GV
 *
v
;

450 if(
da
==
NULL
)  NULL;

451 if(
	`g_rcmp0
(
obje_th
, 
DBUS_MPRIS_OBJECT_NAME
)!=0 ||

452 
	`g_rcmp0
(
r_me
, 
DBUS_MPRIS_PLAYER_INTERFACE
)!=0)

454 
	`g_t_r
(
r
, 
G_DBUS_ERROR
, 
G_DBUS_ERROR_NOT_SUPPORTED
,

455 "Prݔty %s.%in su܋d", 
r_me
,

456 
ݔty_me
);

457  
NULL
;

459 if(
	`g_rcmp0
(
ݔty_me
, "PlaybackStatus")==0)

461 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

462 
e
)

464 
GST_STATE_PLAYING
:

465  
	`g_v_w_rg
("Playing");

467 
GST_STATE_PAUSED
:

468  
	`g_v_w_rg
("Paused");

471  
	`g_v_w_rg
("Stopped");

475 if(
	`g_rcmp0
(
ݔty_me
, "LoopStatus")==0)

477 
	`rib_ay_g__mode
())

479 
RCLIB_PLAYER_REPEAT_SINGLE
:

480  
	`g_v_w_rg
("Track");

482 
RCLIB_PLAYER_REPEAT_LIST
:

483  
	`g_v_w_rg
("Playlist");

486  
	`g_v_w_rg
("None");

490 if(
	`g_rcmp0
(
ݔty_me
, "Rate")==0)

492  
	`g_v_w_doub
(1.0);

494 if(
	`g_rcmp0
(
ݔty_me
, "Shuffle")==0)

496 if(
	`rib_ay_g_ndom_mode
()>0)

497  
	`g_v_w_boޗn
(
TRUE
);

499  
	`g_v_w_boޗn
(
FALSE
);

501 if(
	`g_rcmp0
(
ݔty_me
, "Metadata")==0)

503 
uri
 = 
	`rib_ce_g_uri
();

504 
n
 = 
	`rib_ce_g_db_n
();

505 
mada
 = 
	`rib_ce_g_mada
();

506 
v
 = 
	`rc_ug_mis_g_mada
(
uri
, 
n
, 
mada
);

507 
	`g_
(
uri
);

508  
v
;

510 if(
	`g_rcmp0
(
ݔty_me
, "Volume")==0)

512 
	`rib_ce_g_vume
(&
vume
);

513  
	`g_v_w_doub
(
vume
);

515 if(
	`g_rcmp0
(
ݔty_me
, "Position")==0)

517 
pos
 = 
	`rib_ce_quy_posi
(/ 
GST_USECOND
;

518  
	`g_v_w_t64
(
pos
);

520 if(
	`g_rcmp0
(
ݔty_me
, "MinimumRate")==0)

522  
	`g_v_w_doub
(1.0);

524 if(
	`g_rcmp0
(
ݔty_me
, "MaximumRate")==0)

526  
	`g_v_w_doub
(1.0);

528 if(
	`g_rcmp0
(
ݔty_me
, "CanGoNext")==0)

530  
	`g_v_w_boޗn
(
TRUE
);

532 if(
	`g_rcmp0
(
ݔty_me
, "CanGoPrevious")==0)

534  
	`g_v_w_boޗn
(
TRUE
);

536 if(
	`g_rcmp0
(
ݔty_me
, "CanPlay")==0)

538  
	`g_v_w_boޗn
(
TRUE
);

540 if(
	`g_rcmp0
(
ݔty_me
, "CanPause")==0)

542 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

543 if(
e
==
GST_STATE_PLAYING
)

544  
	`g_v_w_boޗn
(
TRUE
);

546  
	`g_v_w_boޗn
(
FALSE
);

548 if(
	`g_rcmp0
(
ݔty_me
, "CanSeek")==0)

550 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

551 if(
e
==
GST_STATE_PLAYING
 || s==
GST_STATE_PAUSED
)

552  
	`g_v_w_boޗn
(
TRUE
);

554  
	`g_v_w_boޗn
(
FALSE
);

556 if(
	`g_rcmp0
(
ݔty_me
, "CanControl")==0)

558  
	`g_v_w_boޗn
(
TRUE
);

560 
	`g_t_r
(
r
, 
G_DBUS_ERROR
, 
G_DBUS_ERROR_NOT_SUPPORTED
,

561 "Prݔty %s.%in su܋d", 
r_me
, 
ݔty_me
);

562  
NULL
;

563  
NULL
;

564 
	}
}

566 
gboޗn
 
	$rc_ug_mis_t_ay_ݔty
(

567 
GDBusCi
 *
ci
, cڡ 
gch
 *
nd
,

568 cڡ 
gch
 *
obje_th
, cڡ gch *
r_me
,

569 cڡ 
gch
 *
ݔty_me
, 
GV
 *
vue
, 
GE
 **
r
,

570 
gpor
 
da
)

572 cڡ 
gch
 *
rg
;

573 
gdoub
 
vume
;

574 if(
da
==
NULL
 
FALSE
;

575 if(
	`g_rcmp0
(
obje_th
, 
DBUS_MPRIS_OBJECT_NAME
)!=0 ||

576 
	`g_rcmp0
(
r_me
, 
DBUS_MPRIS_PLAYER_INTERFACE
)!=0)

578 
	`g_t_r
(
r
, 
G_DBUS_ERROR
, 
G_DBUS_ERROR_NOT_SUPPORTED
,

579 "Prݔty %s.%in su܋d", 
r_me
,

580 
ݔty_me
);

581  
FALSE
;

583 if(
	`g_rcmp0
(
ݔty_me
, "LoopStatus")==0)

585 
rg
 = 
	`g_v_g_rg
(
vue
, 
NULL
);

586 if(
	`g_rcmp0
(
rg
, "Playlist")==0)

587 
	`rib_ay_t__mode
(
RCLIB_PLAYER_REPEAT_LIST
);

588 if(
	`g_rcmp0
(
rg
, "Track")==0)

589 
	`rib_ay_t__mode
(
RCLIB_PLAYER_REPEAT_SINGLE
);

591 
	`rib_ay_t__mode
(
RCLIB_PLAYER_REPEAT_NONE
);

592  
TRUE
;

594 if(
	`g_rcmp0
(
ݔty_me
, "Rate")==0)

596 
	`g_t_r
(
r
, 
G_DBUS_ERROR
, 
G_DBUS_ERROR_NOT_SUPPORTED
,

598  
FALSE
;

600 if(
	`g_rcmp0
(
ݔty_me
, "Shuffle")==0)

602 if(
	`g_v_g_boޗn
(
vue
))

603 
	`rib_ay_t_ndom_mode
(
RCLIB_PLAYER_RANDOM_SINGLE
);

605 
	`rib_ay_t_ndom_mode
(
RCLIB_PLAYER_RANDOM_NONE
);

606  
TRUE
;

608 if(
	`g_rcmp0
(
ݔty_me
, "Volume")==0)

610 
vume
 = 
	`g_v_g_doub
(
vue
);

611 if(
vume
<0.0) volume = 0.0;

612 if(
vume
>1.0) volume = 1.0;

613 
	`rib_ce_t_vume
(
vume
);

614  
TRUE
;

616 
	`g_t_r
 (
r
, 
G_DBUS_ERROR
, 
G_DBUS_ERROR_NOT_SUPPORTED
,

617 "Prݔty %s.%in su܋d", 
r_me
, 
ݔty_me
);

618  
FALSE
;

619 
	}
}

621 cڡ 
GDBusIVTab
 
	grc_ug_mis_ro_vb
 =

623 .
mhod_
 = 
rc_ug_mis_ro_mhod__cb
,

624 .
	gg_ݔty
 = 
rc_ug_mis_g_ro_ݔty
,

625 .
	gt_ݔty
 = 
NULL


628 cڡ 
GDBusIVTab
 
	grc_ug_mis_ay_vb
 =

630 .
mhod_
 = 
rc_ug_mis_ay_mhod__cb
,

631 .
	gg_ݔty
 = 
rc_ug_mis_g_ay_ݔty
,

632 .
	gt_ݔty
 = 
rc_ug_mis_t_ay_ݔty
,

635 
	$rc_ug_mis_me_acqued_cb
(
GDBusCi
 *
ci
,

636 cڡ 
gch
 *
me
, 
gpor
 
da
)

638 
	`g_debug
("Successfullycquired D-Busame %s for MPRIS2 support.",

639 
me
);

640 
	}
}

642 
	$rc_ug_mis_me_lo_cb
(
GDBusCi
 *
ci
,

643 cڡ 
gch
 *
me
, 
gpor
 
da
)

645 
	`g_debug
("Lo D-Bum%f MPRIS2 sut.", 
me
);

646 
	}
}

648 
	$rc_ug_mis_e_chged_cb
(
RCLibCe
 *
ce
, 
GS
 
e
,

649 
gpor
 
da
)

651 
RCPlugMPRISPrive
 *
iv
 = (RCPlugMPRISPriv*)
da
;

652 cڡ 
gch
 *
ayback_us
 = "Stopped";

653 
gboޗn
 
n_u
 = 
FALSE
;

654 if(
da
==
NULL
) ;

655 
e
)

657 
GST_STATE_PLAYING
:

658 
ayback_us
 = "Playing";

659 
n_u
 = 
TRUE
;

661 
GST_STATE_PAUSED
:

662 
ayback_us
 = "Paused";

667 
	`rc_ug_mis_ay_add_ݔty_chge
(
iv
, "PlaybackStatus",

668 
	`g_v_w_rg
(
ayback_us
));

669 
	`rc_ug_mis_ay_add_ݔty_chge
(
iv
, "CanPause",

670 
	`g_v_w_boޗn
(
n_u
));

671 
	}
}

673 
	$rc_ug_mis_uri_chged_cb
(
RCLibCe
 *
ce
,

674 cڡ 
gch
 *
uri
, 
gpor
 
da
)

676 
GSequIr
 *
n
;

677 
GV
 *
mada_v
;

678 
RCPlugMPRISPrive
 *
iv
 = (RCPlugMPRISPriv*)
da
;

679 if(
da
==
NULL
) ;

680 
n
 = 
	`rib_ce_g_db_n
();

681 if(
n
!=
NULL
)

683 
mada_v
 = 
	`rc_ug_mis_g_mada
(
uri
, 
n
,

684 
NULL
);

685 if(
mada_v
!=
NULL
)

687 
	`rc_ug_mis_ay_add_ݔty_chge
(
iv
, "Metadata",

688 
mada_v
);

691 
	}
}

693 
	$rc_ug_mis_mada_found_cb
(
RCLibCe
 *
ce
,

694 cڡ 
RCLibCeMada
 *
mada
, cڡ 
gch
 *
uri
, 
gpor
 
da
)

696 
RCPlugMPRISPrive
 *
iv
 = (RCPlugMPRISPriv*)
da
;

697 
GV
 *
mada_v
;

698 if(
da
==
NULL
) ;

699 
mada_v
 = 
	`rc_ug_mis_g_mada
(
uri
, 
NULL
, 
mada
);

700 if(
mada_v
!=
NULL
)

702 
	`rc_ug_mis_ay_add_ݔty_chge
(
iv
, "Metadata",

703 
mada_v
);

705 
	}
}

707 
	$rc_ug_mis_vume_chged_cb
(
RCLibCe
 *
ce
,

708 
gdoub
 
vume
, 
gpor
 
da
)

710 
RCPlugMPRISPrive
 *
iv
 = (RCPlugMPRISPriv*)
da
;

711 if(
da
==
NULL
) ;

712 
	`rc_ug_mis_ay_add_ݔty_chge
(
iv
, "Volume",

713 
	`g_v_w_doub
(
vume
));

714 
	}
}

716 
	$rc_ug_mis__mode_chged_cb
(
RCLibPy
 *
ay
,

717 
RCLibPyRtMode
 
mode
, 
gpor
 
da
)

719 
RCPlugMPRISPrive
 *
iv
 = (RCPlugMPRISPriv*)
da
;

720 cڡ 
gch
 *
mode_r
 = "None";

721 if(
da
==
NULL
) ;

722 
mode
)

724 
RCLIB_PLAYER_REPEAT_SINGLE
:

725 
mode_r
 = "Track";

727 
RCLIB_PLAYER_REPEAT_LIST
:

728 
mode_r
 = "Playlist";

733 
	`rc_ug_mis_ay_add_ݔty_chge
(
iv
, "LoopStatus",

734 
	`g_v_w_rg
(
mode_r
));

735 
	}
}

737 
	$rc_ug_mis_ndom_mode_chged_cb
(
RCLibPy
 *
ay
,

738 
RCLibPyRdomMode
 
mode
, 
gpor
 
da
)

740 
RCPlugMPRISPrive
 *
iv
 = (RCPlugMPRISPriv*)
da
;

741 
gboޗn
 
ag
 = 
FALSE
;

742 if(
da
==
NULL
) ;

743 if(
mode
>
RCLIB_PLAYER_RANDOM_NONE
)

744 
ag
 = 
TRUE
;

745 
	`rc_ug_mis_ay_add_ݔty_chge
(
iv
, "Shuffle",

746 
	`g_v_w_boޗn
(
ag
));

747 
	}
}

749 
gboޗn
 
	$rc_ug_mis_ld
(
RCLibPlugDa
 *
ug
)

751 
RCPlugMPRISPrive
 *
iv
 = &
mis_iv
;

752 
GDBusNodeInfo
 *
mis_node_fo
;

753 
GDBusIInfo
 *
ifo
;

754 
gch
 *
mis_fu_me
;

755 
GE
 *
r
 = 
NULL
;

756 
iv
->
ci
 = 
	`g_bus_g_sync
(
G_BUS_TYPE_SESSION
, 
NULL
, &
r
);

757 if(
r
!=
NULL
)

759 
	`g_wng
("Unableo connecto D-Bus session bus: %s",

760 
r
->
mesge
);

761 
	`g_r_
(
r
);

762 
iv
->
ci
 = 
NULL
;

763  
FALSE
;

765 
mis_node_fo
 = 
	`g_dbus_node_fo_w_f_xml
(

766 
mis_oei_xml
, &
r
);

767 if(
r
!=
NULL
)

769 
	`g_wng
("Unableoead MPRIS2 interface specificiation: %s",

770 
r
->
mesge
);

771 
	`g_r_
(
r
);

772 
r
 = 
NULL
;

773 
mis_node_fo
 = 
NULL
;

774 
	`g_obje_uef
(
iv
->
ci
);

775 
iv
->
ci
 = 
NULL
;

776  
FALSE
;

780 
ifo
 = 
	`g_dbus_node_fo_lookup_r
(
mis_node_fo
,

781 
DBUS_MPRIS_ROOT_INTERFACE
);

782 
iv
->
mis_ro_id
 = 
	`g_dbus_ci_gi_obje
(

783 
iv
->
ci
, 
DBUS_MPRIS_OBJECT_NAME
, 
ifo
,

784 &
rc_ug_mis_ro_vb
, 
iv
, 
NULL
, &
r
);

785 if(
r
!=
NULL
)

787 
	`g_wng
("Unableoegister MPRIS2oot interface: %s",

788 
r
->
mesge
);

789 
	`g_r_
(
r
);

790 
r
 = 
NULL
;

791 
iv
->
mis_ro_id
 = 0;

792 
	`g_dbus_node_fo_uef
(
mis_node_fo
);

793 
	`g_obje_uef
(
iv
->
ci
);

794 
iv
->
ci
 = 
NULL
;

795  
FALSE
;

799 
ifo
 = 
	`g_dbus_node_fo_lookup_r
(
mis_node_fo
,

800 
DBUS_MPRIS_PLAYER_INTERFACE
);

801 
iv
->
mis_ay_id
 = 
	`g_dbus_ci_gi_obje
(

802 
iv
->
ci
, 
DBUS_MPRIS_OBJECT_NAME
, 
ifo
,

803 &
rc_ug_mis_ay_vb
, 
iv
, 
NULL
, &
r
);

804 if(
r
!=
NULL
)

806 
	`g_wng
("Unableoegister MPRISlayer interface: %s",

807 
r
->
mesge
);

808 
	`g_r_
(
r
);

809 
r
 = 
NULL
;

810 
	`g_dbus_ci_uegi_obje
(
iv
->
ci
,

811 
iv
->
mis_ro_id
);

812 
iv
->
mis_ro_id
 = 0;

813 
iv
->
mis_ay_id
 = 0;

814 
	`g_dbus_node_fo_uef
(
mis_node_fo
);

815 
	`g_obje_uef
(
iv
->
ci
);

816 
iv
->
ci
 = 
NULL
;

819 
	`g_dbus_node_fo_uef
(
mis_node_fo
);

821 
mis_fu_me
 = 
	`g_rdup_tf
("%s.%s", 
DBUS_MPRIS_BUS_NAME_PREFIX
,

822 
mis_idty
);

823 
iv
->
mis_me_own_id
 = 
	`g_bus_own_me
(
G_BUS_TYPE_SESSION
,

824 
mis_fu_me
, 
G_BUS_NAME_OWNER_FLAGS_NONE
, 
NULL
,

825 
rc_ug_mis_me_acqued_cb
, 
rc_ug_mis_me_lo_cb
,

826 
NULL
, NULL);

827 
	`g_
(
mis_fu_me
);

829 
iv
->
e_chged_id
 = 
	`rib_ce_sigl_c
("state-changed",

830 
	`G_CALLBACK
(
rc_ug_mis_e_chged_cb
), 
iv
);

831 
iv
->
uri_chged_id
 = 
	`rib_ce_sigl_c
("uri-changed",

832 
	`G_CALLBACK
(
rc_ug_mis_uri_chged_cb
), 
iv
);

833 
iv
->
mada_found_id
 = 
	`rib_ce_sigl_c
("tag-found",

834 
	`G_CALLBACK
(
rc_ug_mis_mada_found_cb
), 
iv
);

835 
iv
->
vume_chged_id
 = 
	`rib_ce_sigl_c
("volume-changed",

836 
	`G_CALLBACK
(
rc_ug_mis_vume_chged_cb
), 
iv
);

837 
iv
->
_mode_chged_id
 = 
	`rib_ay_sigl_c
(

838 "-mode-chged", 
	`G_CALLBACK
(
rc_ug_mis__mode_chged_cb
),

839 
NULL
);

840 
iv
->
ndom_mode_chged_id
 = 
	`rib_ay_sigl_c
(

841 "ndom-mode-chged", 
	`G_CALLBACK
(
rc_ug_mis_ndom_mode_chged_cb
),

842 
NULL
);

843  
TRUE
;

844 
	}
}

847 
gboޗn
 
	$rc_ug_mis_ud
(
RCLibPlugDa
 *
ug
)

849 
RCPlugMPRISPrive
 *
iv
 = &
mis_iv
;

850 if(
iv
->
e_chged_id
>0)

851 
	`rib_ce_sigl_disc
(
iv
->
e_chged_id
);

852 if(
iv
->
uri_chged_id
>0)

853 
	`rib_ce_sigl_disc
(
iv
->
uri_chged_id
);

854 if(
iv
->
mada_found_id
>0)

855 
	`rib_ce_sigl_disc
(
iv
->
mada_found_id
);

856 if(
iv
->
vume_chged_id
>0)

857 
	`rib_ce_sigl_disc
(
iv
->
vume_chged_id
);

858 if(
iv
->
_mode_chged_id
>0)

859 
	`rib_ay_sigl_disc
(
iv
->
_mode_chged_id
);

860 if(
iv
->
ndom_mode_chged_id
>0)

861 
	`rib_ay_sigl_disc
(
iv
->
ndom_mode_chged_id
);

862 if(
iv
->
mis_ro_id
!=0)

864 
	`g_dbus_ci_uegi_obje
(
iv
->
ci
,

865 
iv
->
mis_ro_id
);

867 if(
iv
->
mis_ay_id
!=0)

869 
	`g_dbus_ci_uegi_obje
(
iv
->
ci
,

870 
iv
->
mis_ay_id
);

872 if(
iv
->
mis_me_own_id
>0)

873 
	`g_bus_unown_me
(
iv
->
mis_me_own_id
);

874 if(
iv
->
ci
!=
NULL
)

875 
	`g_obje_uef
(
iv
->
ci
);

876 
iv
->
ci
 = 
NULL
;

877  
TRUE
;

878 
	}
}

880 
gboޗn
 
	$rc_ug_mis_
(
RCLibPlugDa
 *
ug
)

883  
TRUE
;

884 
	}
}

886 
	$rc_ug_mis_deroy
(
RCLibPlugDa
 *
ug
)

889 
	}
}

891 
RCLibPlugInfo
 
	grlug_fo
 = {

892 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

893 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

894 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

895 .
	gty
 = 
RCLIB_PLUGIN_TYPE_MODULE
,

896 .
	gid
 = 
MPRISSUPPORT_ID
,

897 .
	gme
 = 
N_
("MPRIS2 Support"),

898 .
	gvsi
 = "0.5",

899 .
	gdesti
 = 
N_
("Provide MPRIS2 support forhelayer."),

900 .
	gauth
 = "SuperCat",

901 .
	ghomage
 = "http://supercat-lab.org/",

902 .
	gld
 = 
rc_ug_mis_ld
,

903 .
	gud
 = 
rc_ug_mis_ud
,

904 .
	gcfigu
 = 
NULL
,

905 .
	gderoy
 = 
rc_ug_mis_deroy
,

906 .
	gexa_fo
 = 
NULL


909 
RCPLUGIN_INIT_PLUGIN
(
rlug_fo
.
id
, 
rc_ug_mis_
,cplugin_info);

	@plugins/base/notify.c

26 
	~<glib.h
>

27 
	~<gio/gio.h
>

28 
	~<gtk/gtk.h
>

29 
	~<rib.h
>

30 
	~<rc-ui-ay.h
>

32 
	#NOTIFY_DBUS_NAME
 "g.deskt.Nifitis"

	)

33 
	#NOTIFY_DBUS_CORE_INTERFACE
 "g.deskt.Nifitis"

	)

34 
	#NOTIFY_DBUS_CORE_OBJECT
 "/g/deskt/Nifitis"

	)

36 
	sRCPlugNifyPrive


38 
GDBusProxy
 *
	moxy
;

39 
gut32
 
	mid
;

40 
gut
 
	mxid
;

41 
gboޗn
 
	mupde_ag
;

42 
gulg
 
	muri_chged_id
;

43 
gulg
 
	mg_found_id
;

44 }
	tRCPlugNifyPrive
;

46 
RCPlugNifyPrive
 
	gnify_iv
 = {0};

47 cڡ 
gch
 *
	gnify_p_me
 = "RhythmCat";

49 
	$rc_ug_nify_show_dbus__cb
(
GObje
 *
obje
,

50 
GAsyncResu
 *
s
, 
gpor
 
da
)

52 
RCPlugNifyPrive
 *
iv
 = (RCPlugNifyPriv*)
da
;

53 
GV
 *
su
;

54 
GE
 *
r
 = 
NULL
;

55 if(
da
==
NULL
) ;

56 
su
 = 
	`g_dbus_oxy__fish
(
iv
->
oxy
, 
s
, &
r
);

57 if(
r
!=
NULL
)

59 
	`g_wng
("NotifyPopups: Cannot send D-Bus message: %s",

60 
r
->
mesge
);

61 
	`g_r_
(
r
);

62 if(
su
!=
NULL

	`g_v_uef
(result);

65 if(
su
==
NULL
) ;

66 if(!
	`g_v_is_of_ty
(
su
, 
	`G_VARIANT_TYPE
("(u)")))

68 
	`g_v_uef
(
su
);

69 
	`g_wng
("NotifyPopups: Unexpectedeplyype!");

72 
	`g_v_g
(
su
, "(u)", &(
iv
->
id
));

73 
	`g_v_uef
(
su
);

74 
	}
}

76 
gboޗn
 
	$rc_ug_nify_show
(
RCPlugNifyPrive
 *
iv
,

77 cڡ 
gch
 *
t
, cڡ gch *
body
, 
GdkPixbuf
 *
pixbuf
,

78 
gt
 
timeout
)

80 
gt
 
width
, 
height
, 
rowride
, 
bs_r_me
, 
chls
;

81 
guch
 *
image
;

82 
gboޗn
 
has_pha
;

83 
gsize
 
image_n
;

84 
GV
 *
image_v
 = 
NULL
;

85 
GVBud
 
ais_bud
, 
hts_bud
;

87 if(
iv
==
NULL
 
FALSE
;

88 if(
pixbuf
!=
NULL
)

90 
	`g_obje_g
(
	`G_OBJECT
(
pixbuf
), "width", &
width
, "height", &
height
,

91 "rowride", &
rowride
, "n-chls", &
chls
,

92 "bs-r-me", &
bs_r_me
, "pixs", &
image
,

93 "has-pha", &
has_pha
, 
NULL
);

94 
image_n
 = (
height
-1* 
rowride
 + 
width
 *

95 ((
chls
 * 
bs_r_me
 + 7)/8);

96 
image_v
 = 
	`g_v_w
("(iiibii@ay)", 
width
, 
height
,

97 
rowride
, 
has_pha
, 
bs_r_me
, 
chls
,

98 
	`g_v_w_om_da
(
	`G_VARIANT_TYPE
("ay"), 
image
, 
image_n
,

99 
TRUE
, (
GDeroyNify
)
g_obje_uef
, 
	`g_obje_f
(
pixbuf
)));

101 
	`g_v_bud_
(&
ais_bud
, 
	`G_VARIANT_TYPE
("as"));

102 
	`g_v_bud_
(&
hts_bud
, 
	`G_VARIANT_TYPE
 ("a{sv}"));

103 if(
image_v
!=
NULL
)

105 
	`g_v_bud_add
(&
hts_bud
, "{sv}", "image-data",

106 
image_v
);

108 if(
iv
->
xid
>0)

110 
	`g_v_bud_add
(&
hts_bud
, "{sv}", "window-xid",

111 
	`g_v_w
("(u)", 
iv
->
xid
));

113 
	`g_dbus_oxy_
(
iv
->
oxy
, "Notify",

114 
	`g_v_w
("(suss{sv}i)", 
nify_p_me
, 
iv
->
id
, "",

115 
t
 ? : "", 
body
 ? body : "", &
ais_bud
,

116 &
hts_bud
, 
timeout
), 
G_DBUS_CALL_FLAGS_NONE
, -1, 
NULL
,

117 
rc_ug_nify_show_dbus__cb
, 
iv
);

118  
TRUE
;

119 
	}
}

121 
	$rc_ug_nify_mada_chged_cb
(
RCLibCe
 *
ce
,

122 cڡ 
RCLibCeMada
 *
mada
, cڡ 
gch
 *
uri
, 
gpor
 
da
)

124 
RCPlugNifyPrive
 *
iv
 = (RCPlugNifyPriv*)
da
;

125 
GdkPixbufLd
 *
ld
;

126 
gch
 *
fame
 = 
NULL
;

127 
gch
 *

 = 
NULL
;

128 
gch
 *
body
;

129 
GdkPixbuf
 *
pixbuf
 = 
NULL
;

130 
GdkPixbuf
 *
sd_pixbuf
 = 
NULL
;

131 cڡ 
gch
 *
i
, *
lbum
;

132 
GE
 *
r
 = 
NULL
;

133 if(
da
==
NULL
) ;

134 if(
uri
==
NULL
 || 
mada
==NULL) ;

135 if(
iv
->
upde_ag
) ;

136 if(
mada
->
t
!=
NULL
 && 
	`
(metadata->title)>0)

137 

 = 
	`g_rdup
(
mada
->
t
);

140 
fame
 = 
	`g_fame_om_uri
(
uri
, 
NULL
, NULL);

141 if(
fame
!=
NULL
)

142 

 = 
	`rib_g_g_me_om_h
(
fame
);

143 
	`g_
(
fame
);

145 if(

==
NULL
蹙 = 
	`g_rdup
(
	`_
("Unknown Title"));

146 if(
mada
->
ti
 && 
	`
(metadata->artist)>0)

147 
i
 = 
mada
->
ti
;

149 
i
 = 
	`_
("Unknown Artist");

150 if(
mada
->
bum
 && 
	`
(metadata->album)>0)

151 
lbum
 = 
mada
->
bum
;

153 
lbum
 = 
	`_
("Unknown Album");

154 
body
 = 
	`g_rdup_tf
("%- %s", 
i
, 
lbum
);

155 if(
mada
->
image
!=
NULL
)

157 
ld
 = 
	`gdk_pixbuf_ld_w
();

158 if(
	`gdk_pixbuf_ld_wre
(
ld
, 
mada
->
image
->
da
,

159 
mada
->
image
->
size
, &
r
))

161 
pixbuf
 = 
	`gdk_pixbuf_ld_g_pixbuf
(
ld
);

162 if(
pixbuf
!=
NULL

	`g_obje_f
(pixbuf);

163 
	`gdk_pixbuf_ld_o
(
ld
, 
NULL
);

167 
	`g_wng
("NotifyPopups: Cannotoad cover image "

168 "om GBufr: %s", 
r
->
mesge
);

169 
	`g_r_
(
r
);

171 
	`g_obje_uef
(
ld
);

173 if(
pixbuf
!=
NULL
)

175 
sd_pixbuf
 = 
	`gdk_pixbuf_s_sime
(
pixbuf
,

176 128, 128, 
GDK_INTERP_HYPER
);

177 
	`g_obje_uef
(
pixbuf
);

179 
	`rc_ug_nify_show
(
iv
, 

, 
body
, 
sd_pixbuf
, 5000);

180 
	`g_
(

);

181 
	`g_
(
body
);

182 if(
sd_pixbuf
!=
NULL

	`g_obje_uef
(scaled_pixbuf);

183 
iv
->
upde_ag
 = 
TRUE
;

184 
	}
}

186 
	$rc_ug_nify_uri_chged_cb
(
RCLibCe
 *
ce
,

187 cڡ 
gch
 *
uri
, 
gpor
 
da
)

189 
RCPlugNifyPrive
 *
iv
 = (RCPlugNifyPriv*)
da
;

190 
gch
 *
fame
;

191 
gch
 *

;

192 if(
da
==
NULL
) ;

193 
fame
 = 
	`g_fame_om_uri
(
uri
, 
NULL
, NULL);

194 if(
fame
==
NULL
) ;

195 

 = 
	`rib_g_g_me_om_h
(
fame
);

196 
	`g_
(
fame
);

197 
	`rc_ug_nify_show
(
iv
, 

, "", 
NULL
, 5000);

198 
	`g_
(

);

199 
iv
->
upde_ag
 = 
FALSE
;

200 
	}
}

202 
gboޗn
 
	$rc_ug_nify_ld
(
RCLibPlugDa
 *
ug
)

204 
RCPlugNifyPrive
 *
iv
 = &
nify_iv
;

205 
GDBusCi
 *
ci
;

206 
GE
 *
r
 = 
NULL
;

207 
GtkStusIc
 *
us_ic
;

208 
ci
 = 
	`g_bus_g_sync
(
G_BUS_TYPE_SESSION
, 
NULL
, &
r
);

209 if(
r
!=
NULL
)

211 
	`g_wng
("NotifyPopups: Cannot connecto D-Bus: %s",

212 
r
->
mesge
);

213 
	`g_r_
(
r
);

214 if(
ci
!=
NULL

	`g_obje_uef
(connection);

215  
FALSE
;

217 
iv
->
oxy
 = 
	`g_dbus_oxy_w_sync
(
ci
, 
G_DBUS_PROXY_FLAGS_NONE
,

218 
NULL
, 
NOTIFY_DBUS_NAME
, 
NOTIFY_DBUS_CORE_OBJECT
,

219 
NOTIFY_DBUS_CORE_INTERFACE
, 
NULL
, &
r
);

220 
	`g_obje_uef
(
ci
);

221 if(
r
!=
NULL
)

223 
	`g_wng
("NotifyPopups: Cannot connecto D-Busroxy: %s",

224 
r
->
mesge
);

225 
	`g_r_
(
r
);

226 if(
iv
->
oxy
!=
NULL

	`g_obje_uef
(priv->proxy);

227 
iv
->
oxy
 = 
NULL
;

228  
FALSE
;

230 
us_ic
 = 
	`rc_ui_ay_g_ay_ic
();

231 if(
us_ic
!=
NULL
)

232 
iv
->
xid
 = 
	`gtk_us_ic_g_x11_wdow_id
(
us_ic
);

234 
iv
->
xid
 = 0;

235 
	`rc_ug_nify_show
(
iv
, 
	`_
("Welcomeo RhythmCat"),

236 
	`_
("Welcomeo RhythmCat 2.0,he musiclayer withlug-in support!"),

237 
NULL
, 5000);

238 
iv
->
g_found_id
 = 
	`rib_ce_sigl_c
("tag-found",

239 
	`G_CALLBACK
(
rc_ug_nify_mada_chged_cb
), 
iv
);

240 
iv
->
uri_chged_id
 = 
	`rib_ce_sigl_c
("uri-changed",

241 
	`G_CALLBACK
(
rc_ug_nify_uri_chged_cb
), 
iv
);

242  
TRUE
;

243 
	}
}

246 
gboޗn
 
	$rc_ug_nify_ud
(
RCLibPlugDa
 *
ug
)

248 
RCPlugNifyPrive
 *
iv
 = &
nify_iv
;

249 if(
iv
->
oxy
!=
NULL

	`g_obje_uef
(priv->proxy);

250 
iv
->
oxy
 = 
NULL
;

251 if(
iv
->
g_found_id
>0)

252 
	`rib_ce_sigl_disc
(
iv
->
g_found_id
);

253 
iv
->
g_found_id
 = 0;

254 if(
iv
->
uri_chged_id
>0)

255 
	`rib_ce_sigl_disc
(
iv
->
uri_chged_id
);

256 
iv
->
uri_chged_id
 = 0;

257  
TRUE
;

258 
	}
}

260 
gboޗn
 
	$rc_ug_nify_
(
RCLibPlugDa
 *
ug
)

263  
TRUE
;

264 
	}
}

266 
	$rc_ug_nify_deroy
(
RCLibPlugDa
 *
ug
)

269 
	}
}

271 
RCLibPlugInfo
 
	grlug_fo
 = {

272 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

273 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

274 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

275 .
	gty
 = 
RCLIB_PLUGIN_TYPE_MODULE
,

276 .
	gid
 = "rc2-native-notify-popup",

277 .
	gme
 = 
N_
("Notify Popups"),

278 .
	gvsi
 = "0.5",

279 .
	gdesti
 = 
N_
("Showhe music information inopups when "

281 .
	gauth
 = "SuperCat",

282 .
	ghomage
 = "http://supercat-lab.org/",

283 .
	gld
 = 
rc_ug_nify_ld
,

284 .
	gud
 = 
rc_ug_nify_ud
,

285 .
	gcfigu
 = 
NULL
,

286 .
	gderoy
 = 
rc_ug_nify_deroy
,

287 .
	gexa_fo
 = 
NULL


290 
RCPLUGIN_INIT_PLUGIN
(
rlug_fo
.
id
, 
rc_ug_nify_
,cplugin_info);

	@plugins/devel/karamixer.c

26 
	~<glib.h
>

27 
	~<gtk/gtk.h
>

28 
	~<rib.h
>

29 
	~<rc-ui-mu.h
>

31 #ifde
G_LOG_DOMAIN


32 #unde
G_LOG_DOMAIN


35 
	#G_LOG_DOMAIN
 "KaokeMix"

	)

36 
	#KARAMIXER_ID
 "rc2-tive-kaoke-mix"

	)

38 
	sRCPlugKaMixPrive


40 
GtkWidg
 *
	mwdow
;

41 
GtkWidg
 *
	mmusic_y
;

42 
GtkWidg
 *
	mvoi_y
;

43 
GtkWidg
 *
	mmix_y
;

44 
GtkWidg
 *
	mcd_bu
;

45 
GtkWidg
 *
	mcd_image
;

46 
GtkWidg
 *
	mayback_bu
;

47 
GtkWidg
 *
	mayback_image
;

48 
GtkWidg
 *
	mmix_bu
;

49 
GtkWidg
 *
	mmix_image
;

50 
GtkWidg
 *
	mvumebu
;

51 
GtkWidg
 *
	mouut_checkbu
;

52 
GtkWidg
 *
	msu_b
;

53 
GtkToggAi
 *
	mai
;

54 
GEmt
 *
	mcd_pe
;

55 
GEmt
 *
	mcd_fesk
;

56 
GEmt
 *
	mcd_vume
;

57 
GEmt
 *
	mmix_pe
;

58 
GEmt
 *
	mmix_fesk
;

59 
GEmt
 *
	mmix_fec1
;

60 
GEmt
 *
	mmix_fec2
;

61 
GEmt
 *
	mecho_pe
;

62 
GEmt
 *
	mecho_vume
;

63 
GEmt
 *
	mayback_pe
;

64 
GEmt
 *
	mayback_fec1
;

65 
GEmt
 *
	mayback_fec2
;

66 
gut
 
	mmu_id
;

67 }
	tRCPlugKaMixPrive
;

69 
RCPlugKaMixPrive
 
	gkamix_iv
 = {0};

71 
	$rc_ug_kamix_cd_t
(cڡ 
gch
 *
fe
)

73 
RCPlugKaMixPrive
 *
iv
 = &
kamix_iv
;

74 
gch
 *
uri
 = 
NULL
;

75 
gch
 *
music_fe
;

76 if(
fe
==
NULL
) ;

77 if(
iv
->
cd_pe
==
NULL
) ;

78 
uri
 = 
	`rib_ce_g_uri
();

79 if(
uri
==
NULL
) ;

80 
music_fe
 = 
	`g_fame_om_uri
(
uri
, 
NULL
, NULL);

81 
	`g_
(
uri
);

82 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
music_y
), 
music_fe
);

83 
	`g_
(
music_fe
);

84 
	`g_obje_t
(
iv
->
cd_fesk
, "loti", 
fe
, 
NULL
);

85 
	`rib_ce_
();

86 if(
	`g_emt_t_e
(
iv
->
cd_pe
, 
GST_STATE_PLAYING
))

88 
	`rib_ce_ay
();

90 
	}
}

92 
	$rc_ug_kamix_cd_
()

94 
RCPlugKaMixPrive
 *
iv
 = &
kamix_iv
;

95 if(
iv
->
cd_pe
==
NULL
) ;

96 
	`g_emt_t_e
(
iv
->
cd_pe
, 
GST_STATE_NULL
);

97 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(
iv
->
cd_image
),

98 
GTK_STOCK_MEDIA_RECORD
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

99 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
), 
	`_
("Ready"));

100 
	`gtk_widg_t_nsive
(
iv
->
cd_bu
, 
TRUE
);

101 
	`gtk_widg_t_nsive
(
iv
->
ayback_bu
, 
TRUE
);

102 
	`gtk_widg_t_nsive
(
iv
->
mix_bu
, 
TRUE
);

103 
	}
}

105 
gboޗn
 
	$rc_ug_kamix_cd_bus_hdr
(
GBus
 *
bus
,

106 
GMesge
 *
msg
, 
gpor
 
da
)

108 
GS
 
e
, 
ndg
;

109 
GE
 *
r
 = 
NULL
;

110 
gch
 *
r_msg
;

111 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

112 if(
da
==
NULL
 || 
iv
->
cd_pe
==NULL 
TRUE
;

113 
	`GST_MESSAGE_TYPE
(
msg
))

115 
GST_MESSAGE_EOS
:

116 
	`rc_ug_kamix_cd_
();

118 
GST_MESSAGE_ERROR
:

119 
	`g_mesge_r_r
(
msg
, &
r
, 
NULL
);

120 
	`rc_ug_kamix_cd_
();

121 
r_msg
 = 
	`g_rdup_tf
(
	`_
("Cannotecord: %s"),

122 
r
->
mesge
);

123 
	`g_r_
(
r
);

124 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
), 
r_msg
);

125 
	`g_
(
r_msg
);

127 
GST_MESSAGE_STATE_CHANGED
:

128 if(
iv
!=
NULL
 &&

129 
	`GST_MESSAGE_SRC
(
msg
)==
	`GST_OBJECT
(
iv
->
cd_pe
))

131 
	`g_mesge_r_e_chged
(
msg
, 
NULL
, &
e
, &
ndg
);

132 if(
ndg
==
GST_STATE_VOID_PENDING
)

134 if(
e
==
GST_STATE_PLAYING
)

136 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(

137 
iv
->
cd_image
), 
GTK_STOCK_MEDIA_STOP
,

138 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

139 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

140 
	`_
("Recording..."));

141 
	`gtk_widg_t_nsive
(
iv
->
ayback_bu
,

142 
FALSE
);

143 
	`gtk_widg_t_nsive
(
iv
->
mix_bu
, 
FALSE
);

147 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(

148 
iv
->
cd_image
), 
GTK_STOCK_MEDIA_RECORD
,

149 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

150 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

151 
	`_
("Ready"));

152 
	`gtk_widg_t_nsive
(
iv
->
cd_bu
, 
TRUE
);

153 
	`gtk_widg_t_nsive
(
iv
->
ayback_bu
, 
TRUE
);

154 
	`gtk_widg_t_nsive
(
iv
->
mix_bu
, 
TRUE
);

161  
TRUE
;

162 
	}
}

164 
gboޗn
 
	$rc_ug_kamix_cd_pe_
(

165 
RCPlugKaMixPrive
 *
iv
)

167 
GEmt
 *
voi_put
 = 
NULL
;

168 
GEmt
 *
audio_cvt
 = 
NULL
;

169 
GEmt
 *
audio_me
 = 
NULL
;

170 
GEmt
 *
fesk
 = 
NULL
;

171 
GEmt
 *
vume
 = 
NULL
;

172 
GEmt
 *
cod
 = 
NULL
;

173 
GEmt
 *
oggmux
 = 
NULL
;

174 
GEmt
 *
pe
 = 
NULL
;

175 
GBus
 *
bus
;

176 
gboޗn
 
ag
 = 
FALSE
;

177 if(
iv
==
NULL
 ||riv->
cd_pe
!=NULL 
FALSE
;

178 
G_STMT_START


180 
ag
 = 
FALSE
;

181 
voi_put
 = 
	`g_emt_y_make
("autudioc", 
NULL
);

182 if(
voi_put
==
NULL
) ;

183 
fesk
 = 
	`g_emt_y_make
("fesk", 
NULL
);

184 if(
fesk
==
NULL
) ;

185 
audio_cvt
 = 
	`g_emt_y_make
("audiocvt", 
NULL
);

186 if(
audio_cvt
==
NULL
) ;

187 
audio_me
 = 
	`g_emt_y_make
("audieme", 
NULL
);

188 if(
audio_me
==
NULL
) ;

189 
vume
 = 
	`g_emt_y_make
("vume", 
NULL
);

190 if(
vume
==
NULL
) ;

191 
cod
 = 
	`g_emt_y_make
("vbinc", 
NULL
);

192 if(
cod
==
NULL
) ;

193 
oggmux
 = 
	`g_emt_y_make
("oggmux", 
NULL
);

194 if(
oggmux
==
NULL
) ;

195 
pe
 = 
	`g_pe_w
("recorder-pipeline");

196 if(
pe
==
NULL
) ;

197 
ag
 = 
TRUE
;

199 
G_STMT_END
;

200 if(!
ag
)

202 if(
voi_put
!=
NULL

	`g_obje_uef
(voice_input);

203 if(
fesk
!=
NULL

	`g_obje_uef
(filesink);

204 if(
audio_cvt
!=
NULL

	`g_obje_uef
(audio_convert);

205 if(
audio_me
!=
NULL

	`g_obje_uef
(audio_resample);

206 if(
vume
!=
NULL

	`g_obje_uef
(volume);

207 if(
cod
!=
NULL

	`g_obje_uef
(encoder);

208 if(
oggmux
!=
NULL

	`g_obje_uef
(oggmux);

209 if(
pe
!=
NULL

	`g_obje_uef
(pipeline);

210  
FALSE
;

212 
	`g_b_add_my
(
	`GST_BIN
(
pe
), 
voi_put
, 
audio_cvt
,

213 
audio_me
, 
vume
, 
cod
, 
oggmux
, 
fesk
, 
NULL
);

214 if(!
	`g_emt_lk_my
(
voi_put
, 
audio_cvt
, 
audio_me
,

215 
vume
, 
cod
, 
oggmux
, 
fesk
, 
NULL
))

217 
	`g_obje_uef
(
pe
);

218  
FALSE
;

220 
	`g_obje_t
(
vume
, "vume", 1.0, 
NULL
);

221 
bus
 = 
	`g_pe_g_bus
(
	`GST_PIPELINE
(
pe
));

222 
	`g_bus_add_wch
(
bus
,

223 (
GBusFunc
)
rc_ug_kamix_cd_bus_hdr
, 
iv
);

224 
	`g_obje_uef
(
bus
);

225 
	`g_emt_t_e
(
pe
, 
GST_STATE_NULL
);

226 
iv
->
cd_pe
 = 
pe
;

227 
iv
->
cd_vume
 = 
vume
;

228 
iv
->
cd_fesk
 = 
fesk
;

229  
TRUE
;

230 
	}
}

232 
	$rc_ug_kamix_mix_t
(cڡ 
gch
 *
cfe1
,

233 cڡ 
gch
 *
cfe2
, cڡ gch *
mixfe
)

235 
RCPlugKaMixPrive
 *
iv
 = &
kamix_iv
;

236 if(
cfe1
==
NULL
 || 
cfe2
==NULL || 
mixfe
==NULL) ;

237 if(
iv
->
mix_pe
==
NULL
) ;

238 
	`g_obje_t
(
iv
->
mix_fesk
, "loti", 
mixfe
, 
NULL
);

239 
	`g_obje_t
(
iv
->
mix_fec1
, "loti", 
cfe1
, 
NULL
);

240 
	`g_obje_t
(
iv
->
mix_fec2
, "loti", 
cfe2
, 
NULL
);

241 
	`g_emt_t_e
(
iv
->
mix_pe
, 
GST_STATE_PLAYING
);

242 
	}
}

244 
	$rc_ug_kamix_mix_
()

246 
RCPlugKaMixPrive
 *
iv
 = &
kamix_iv
;

247 if(
iv
->
mix_pe
==
NULL
) ;

248 
	`g_emt_t_e
(
iv
->
mix_pe
, 
GST_STATE_NULL
);

249 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(
iv
->
mix_image
),

250 
GTK_STOCK_CONVERT
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

251 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
), 
	`_
("Ready"));

252 
	`gtk_widg_t_nsive
(
iv
->
cd_bu
, 
TRUE
);

253 
	`gtk_widg_t_nsive
(
iv
->
ayback_bu
, 
TRUE
);

254 
	`gtk_widg_t_nsive
(
iv
->
mix_bu
, 
TRUE
);

255 
	}
}

257 
gboޗn
 
	$rc_ug_kamix_mix_bus_hdr
(
GBus
 *
bus
,

258 
GMesge
 *
msg
, 
gpor
 
da
)

260 
GS
 
e
, 
ndg
;

261 
GE
 *
r
 = 
NULL
;

262 
gch
 *
r_msg
;

263 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

264 if(
da
==
NULL
 || 
iv
->
mix_pe
==NULL 
TRUE
;

265 
	`GST_MESSAGE_TYPE
(
msg
))

267 
GST_MESSAGE_EOS
:

268 
	`rc_ug_kamix_mix_
();

270 
GST_MESSAGE_ERROR
:

271 
	`g_mesge_r_r
(
msg
, &
r
, 
NULL
);

272 
	`rc_ug_kamix_mix_
();

273 
r_msg
 = 
	`g_rdup_tf
(
	`_
("Cannot mix: %s"),

274 
r
->
mesge
);

275 
	`g_r_
(
r
);

276 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
), 
r_msg
);

277 
	`g_
(
r_msg
);

279 
GST_MESSAGE_STATE_CHANGED
:

280 if(
iv
!=
NULL
 &&

281 
	`GST_MESSAGE_SRC
(
msg
)==
	`GST_OBJECT
(
iv
->
mix_pe
))

283 
	`g_mesge_r_e_chged
(
msg
, 
NULL
, &
e
, &
ndg
);

284 if(
ndg
==
GST_STATE_VOID_PENDING
)

286 if(
e
==
GST_STATE_PLAYING
)

288 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(

289 
iv
->
mix_image
), 
GTK_STOCK_CANCEL
,

290 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

291 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

292 
	`_
("Mixing..."));

293 
	`gtk_widg_t_nsive
(
iv
->
cd_bu
, 
FALSE
);

294 
	`gtk_widg_t_nsive
(
iv
->
ayback_bu
,

295 
FALSE
);

299 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(

300 
iv
->
mix_image
), 
GTK_STOCK_CONVERT
,

301 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

302 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

303 
	`_
("Ready"));

304 
	`gtk_widg_t_nsive
(
iv
->
cd_bu
, 
TRUE
);

305 
	`gtk_widg_t_nsive
(
iv
->
ayback_bu
, 
TRUE
);

306 
	`gtk_widg_t_nsive
(
iv
->
mix_bu
, 
TRUE
);

313  
TRUE
;

314 
	}
}

316 
	$rc_ug_kamix_mix_d_added_cb
(
GEmt
 *
demux
,

317 
GPad
 *
d
, 
gboޗn
 
ia
, 
GEmt
 *
cvt
)

319 
GPad
 *
cn_d
;

320 
cn_d
 = 
	`g_emt_g_comtib_d
(
cvt
, 
d
, 
NULL
);

321 
	`g_d_lk
(
d
, 
cn_d
);

322 
	`g_obje_uef
(
cn_d
);

323 
	}
}

325 
gboޗn
 
	$rc_ug_kamix_mix_pe_
(

326 
RCPlugKaMixPrive
 *
iv
)

328 
GEmt
 *
fec1
 = 
NULL
, *
fec2
 = NULL;

329 
GEmt
 *
decodeb1
 = 
NULL
, *
decodeb2
 = NULL;

330 
GEmt
 *
audiocvt1
 = 
NULL
, *
audiocvt2
 = NULL;

331 
GEmt
 *
audieme1
 = 
NULL
, *
audieme2
 = NULL;

332 
GEmt
 *
add
 = 
NULL
;

333 
GEmt
 *
cod
 = 
NULL
;

334 
GEmt
 *
oggmux
 = 
NULL
;

335 
GEmt
 *
fesk
 = 
NULL
;

336 
GEmt
 *
pe
 = 
NULL
;

337 
GPad
 *
c_d
, *
sk_d
;

338 
gboޗn
 
ag
 = 
FALSE
;

339 if(
iv
==
NULL
 ||riv->
mix_pe
!=NULL 
FALSE
;

340 
GBus
 *
bus
;

341 
G_STMT_START


343 
ag
 = 
FALSE
;

344 
fec1
 = 
	`g_emt_y_make
("fec", 
NULL
);

345 if(
fec1
==
NULL
) ;

346 
fec2
 = 
	`g_emt_y_make
("fec", 
NULL
);

347 if(
fec2
==
NULL
) ;

348 
decodeb1
 = 
	`g_emt_y_make
("decodeb2", 
NULL
);

349 if(
decodeb1
==
NULL
) ;

350 
decodeb2
 = 
	`g_emt_y_make
("decodeb2", 
NULL
);

351 if(
decodeb2
==
NULL
) ;

352 
audiocvt1
 = 
	`g_emt_y_make
("audiocvt", 
NULL
);

353 if(
audiocvt1
==
NULL
) ;

354 
audiocvt2
 = 
	`g_emt_y_make
("audiocvt", 
NULL
);

355 if(
audiocvt2
==
NULL
) ;

356 
audieme1
 = 
	`g_emt_y_make
("audieme", 
NULL
);

357 if(
audieme1
==
NULL
) ;

358 
audieme2
 = 
	`g_emt_y_make
("audieme", 
NULL
);

359 if(
audieme2
==
NULL
) ;

360 
add
 = 
	`g_emt_y_make
("add", 
NULL
);

361 if(
add
==
NULL
) ;

362 
fesk
 = 
	`g_emt_y_make
("fesk", 
NULL
);

363 if(
fesk
==
NULL
) ;

364 
cod
 = 
	`g_emt_y_make
("vbinc", 
NULL
);

365 if(
cod
==
NULL
) ;

366 
oggmux
 = 
	`g_emt_y_make
("oggmux", 
NULL
);

367 if(
oggmux
==
NULL
) ;

368 
pe
 = 
	`g_pe_w
("mixer-pipeline");

369 if(
pe
==
NULL
) ;

370 
ag
 = 
TRUE
;

372 
G_STMT_END
;

373 if(!
ag
)

375 if(
fec1
!=
NULL

	`g_obje_uef
(filesrc1);

376 if(
fec2
!=
NULL

	`g_obje_uef
(filesrc2);

377 if(
decodeb1
!=
NULL

	`g_obje_uef
(decodebin1);

378 if(
decodeb2
!=
NULL

	`g_obje_uef
(decodebin2);

379 if(
audiocvt1
!=
NULL

	`g_obje_uef
(audioconvert1);

380 if(
audiocvt2
!=
NULL

	`g_obje_uef
(audioconvert2);

381 if(
audieme1
!=
NULL

	`g_obje_uef
(audioresample1);

382 if(
audieme2
!=
NULL

	`g_obje_uef
(audioresample2);

383 if(
add
!=
NULL

	`g_obje_uef
(adder);

384 if(
fesk
!=
NULL

	`g_obje_uef
(filesink);

385 if(
cod
!=
NULL

	`g_obje_uef
(encoder);

386 if(
oggmux
!=
NULL

	`g_obje_uef
(oggmux);

387 if(
pe
!=
NULL

	`g_obje_uef
(pipeline);

388  
FALSE
;

390 
	`g_b_add_my
(
	`GST_BIN
(
pe
), 
fec1
, 
fec2
, 
decodeb1
,

391 
decodeb2
, 
audiocvt1
, 
audiocvt2
, 
audieme1
,

392 
audieme2
, 
add
, 
cod
, 
oggmux
, 
fesk
, 
NULL
);

393 if(!
	`g_emt_lk
(
fec1
, 
decodeb1
) ||

394 !
	`g_emt_lk
(
fec2
, 
decodeb2
) ||

395 !
	`g_emt_lk
(
audiocvt1
, 
audieme1
) ||

396 !
	`g_emt_lk
(
audiocvt2
, 
audieme2
) ||

397 !
	`g_emt_lk_my
(
add
, 
cod
, 
oggmux
, 
fesk
, 
NULL
))

399 
	`g_obje_uef
(
pe
);

400  
FALSE
;

402 
sk_d
 = 
	`g_emt_g_que_d
(
add
, "sink%d");

403 
c_d
 = 
	`g_emt_g_ic_d
(
audieme1
, "src");

404 
	`g_d_lk
(
c_d
, 
sk_d
);

405 
	`g_obje_uef
(
c_d
);

406 
	`g_obje_uef
(
sk_d
);

407 
sk_d
 = 
	`g_emt_g_que_d
(
add
, "sink%d");

408 
c_d
 = 
	`g_emt_g_ic_d
(
audieme2
, "src");

409 
	`g_d_lk
(
c_d
, 
sk_d
);

410 
	`g_obje_uef
(
c_d
);

411 
	`g_obje_uef
(
sk_d
);

412 
	`g_sigl_c
(
decodeb1
, "new-decoded-pad",

413 
	`G_CALLBACK
(
rc_ug_kamix_mix_d_added_cb
),

414 
audiocvt1
);

415 
	`g_sigl_c
(
decodeb2
, "new-decoded-pad",

416 
	`G_CALLBACK
(
rc_ug_kamix_mix_d_added_cb
),

417 
audiocvt2
);

418 
bus
 = 
	`g_pe_g_bus
(
	`GST_PIPELINE
(
pe
));

419 
	`g_bus_add_wch
(
bus
,

420 (
GBusFunc
)
rc_ug_kamix_mix_bus_hdr
, 
iv
);

421 
	`g_obje_uef
(
bus
);

422 
	`g_emt_t_e
(
pe
, 
GST_STATE_NULL
);

423 
iv
->
mix_pe
 = 
pe
;

424 
iv
->
mix_fesk
 = 
fesk
;

425 
iv
->
mix_fec1
 = 
fec1
;

426 
iv
->
mix_fec2
 = 
fec2
;

427  
TRUE
;

428 
	}
}

430 
gboޗn
 
	$rc_ug_kamix_echo_pe_
(

431 
RCPlugKaMixPrive
 *
iv
)

433 
GEmt
 *
voi_put
 = 
NULL
;

434 
GEmt
 *
audio_cvt
 = 
NULL
;

435 
GEmt
 *
audio_me
 = 
NULL
;

436 
GEmt
 *
vume
 = 
NULL
;

437 
GEmt
 *
audio_sk
 = 
NULL
;

438 
GEmt
 *
pe
 = 
NULL
;

439 
gboޗn
 
ag
 = 
FALSE
;

440 if(
iv
==
NULL
 ||riv->
echo_pe
!=NULL 
FALSE
;

441 
G_STMT_START


443 
ag
 = 
FALSE
;

444 
voi_put
 = 
	`g_emt_y_make
("autudioc", 
NULL
);

445 if(
voi_put
==
NULL
) ;

446 
audio_cvt
 = 
	`g_emt_y_make
("audiocvt", 
NULL
);

447 if(
audio_cvt
==
NULL
) ;

448 
audio_me
 = 
	`g_emt_y_make
("audieme", 
NULL
);

449 if(
audio_me
==
NULL
) ;

450 
vume
 = 
	`g_emt_y_make
("vume", 
NULL
);

451 if(
vume
==
NULL
) ;

452 
audio_sk
 = 
	`g_emt_y_make
("autudiosk", 
NULL
);

453 if(
audio_sk
==
NULL
) ;

454 
pe
 = 
	`g_pe_w
("echo-pipeline");

455 
ag
 = 
TRUE
;

457 
G_STMT_END
;

458 if(!
ag
)

460 if(
voi_put
!=
NULL

	`g_obje_uef
(voice_input);

461 if(
audio_cvt
!=
NULL

	`g_obje_uef
(audio_convert);

462 if(
audio_me
!=
NULL

	`g_obje_uef
(audio_resample);

463 if(
vume
!=
NULL

	`g_obje_uef
(volume);

464 if(
audio_sk
!=
NULL

	`g_obje_uef
(audio_sink);

465 if(
pe
!=
NULL

	`g_obje_uef
(pipeline);

466  
FALSE
;

468 
	`g_b_add_my
(
	`GST_BIN
(
pe
), 
voi_put
, 
audio_cvt
,

469 
audio_me
, 
vume
, 
audio_sk
, 
NULL
);

470 if(!
	`g_emt_lk_my
(
voi_put
, 
audio_cvt
, 
audio_me
,

471 
vume
, 
audio_sk
, 
NULL
))

473 
	`g_obje_uef
(
pe
);

474  
FALSE
;

476 
	`g_obje_t
(
vume
, "vume", 1.0, "mu", 
TRUE
, 
NULL
);

477 
	`g_emt_t_e
(
pe
, 
GST_STATE_NULL
);

478 
	`g_emt_t_e
(
pe
, 
GST_STATE_PLAYING
);

479 
iv
->
echo_pe
 = 
pe
;

480 
iv
->
echo_vume
 = 
vume
;

481  
TRUE
;

482 
	}
}

484 
	$rc_ug_kamix_ayback_t
(cڡ 
gch
 *
cfe1
,

485 cڡ 
gch
 *
cfe2
)

487 
RCPlugKaMixPrive
 *
iv
 = &
kamix_iv
;

488 if(
cfe1
==
NULL
 || 
cfe2
==NULL) ;

489 if(
iv
->
ayback_pe
==
NULL
) ;

490 
	`g_obje_t
(
iv
->
ayback_fec1
, "loti", 
cfe1
, 
NULL
);

491 
	`g_obje_t
(
iv
->
ayback_fec2
, "loti", 
cfe2
, 
NULL
);

492 
	`g_emt_t_e
(
iv
->
ayback_pe
, 
GST_STATE_PLAYING
);

493 
	}
}

495 
	$rc_ug_kamix_ayback_
()

497 
RCPlugKaMixPrive
 *
iv
 = &
kamix_iv
;

498 if(
iv
->
ayback_pe
==
NULL
) ;

499 
	`g_emt_t_e
(
iv
->
ayback_pe
, 
GST_STATE_NULL
);

500 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(
iv
->
ayback_image
),

501 
GTK_STOCK_MEDIA_PLAY
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

502 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
), 
	`_
("Ready"));

503 
	`gtk_widg_t_nsive
(
iv
->
cd_bu
, 
TRUE
);

504 
	`gtk_widg_t_nsive
(
iv
->
ayback_bu
, 
TRUE
);

505 
	`gtk_widg_t_nsive
(
iv
->
mix_bu
, 
TRUE
);

506 
	}
}

508 
gboޗn
 
	$rc_ug_kamix_ayback_bus_hdr
(
GBus
 *
bus
,

509 
GMesge
 *
msg
, 
gpor
 
da
)

511 
GS
 
e
, 
ndg
;

512 
GE
 *
r
 = 
NULL
;

513 
gch
 *
r_msg
;

514 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

515 if(
da
==
NULL
 || 
iv
->
ayback_pe
==NULL 
TRUE
;

516 
	`GST_MESSAGE_TYPE
(
msg
))

518 
GST_MESSAGE_EOS
:

519 
	`rc_ug_kamix_ayback_
();

521 
GST_MESSAGE_ERROR
:

522 
	`rc_ug_kamix_ayback_
();

523 
r_msg
 = 
	`g_rdup_tf
(
	`_
("Cannotlayback: %s"),

524 
r
->
mesge
);

525 
	`g_r_
(
r
);

526 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
), 
r_msg
);

527 
	`g_
(
r_msg
);

529 
GST_MESSAGE_STATE_CHANGED
:

530 if(
iv
!=
NULL
 &&

531 
	`GST_MESSAGE_SRC
(
msg
)==
	`GST_OBJECT
(
iv
->
ayback_pe
))

533 
	`g_mesge_r_e_chged
(
msg
, 
NULL
, &
e
, &
ndg
);

534 if(
ndg
==
GST_STATE_VOID_PENDING
)

536 if(
e
==
GST_STATE_PLAYING
)

538 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(

539 
iv
->
ayback_image
), 
GTK_STOCK_MEDIA_STOP
,

540 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

541 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

542 
	`_
("Playbacking..."));

543 
	`gtk_widg_t_nsive
(
iv
->
cd_bu
, 
FALSE
);

544 
	`gtk_widg_t_nsive
(
iv
->
mix_bu
, 
FALSE
);

548 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(

549 
iv
->
ayback_image
), 
GTK_STOCK_MEDIA_PLAY
,

550 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

551 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

552 
	`_
("Ready"));

553 
	`gtk_widg_t_nsive
(
iv
->
cd_bu
, 
TRUE
);

554 
	`gtk_widg_t_nsive
(
iv
->
ayback_bu
, 
TRUE
);

555 
	`gtk_widg_t_nsive
(
iv
->
mix_bu
, 
TRUE
);

562  
TRUE
;

563 
	}
}

565 
	$rc_ug_kamix_ayback_d_added_cb
(
GEmt
 *
demux
,

566 
GPad
 *
d
, 
gboޗn
 
ia
, 
GEmt
 *
cvt
)

568 
GPad
 *
cn_d
;

569 
cn_d
 = 
	`g_emt_g_comtib_d
(
cvt
, 
d
, 
NULL
);

570 
	`g_d_lk
(
d
, 
cn_d
);

571 
	`g_obje_uef
(
cn_d
);

572 
	}
}

574 
gboޗn
 
	$rc_ug_kamix_ayback_pe_
(

575 
RCPlugKaMixPrive
 *
iv
)

577 
GEmt
 *
fec1
 = 
NULL
, *
fec2
 = NULL;

578 
GEmt
 *
decodeb1
 = 
NULL
, *
decodeb2
 = NULL;

579 
GEmt
 *
audiocvt1
 = 
NULL
, *
audiocvt2
 = NULL;

580 
GEmt
 *
audieme1
 = 
NULL
, *
audieme2
 = NULL;

581 
GEmt
 *
add
 = 
NULL
;

582 
GEmt
 *
audio_sk
 = 
NULL
;

583 
GEmt
 *
pe
 = 
NULL
;

584 
GPad
 *
c_d
, *
sk_d
;

585 
gboޗn
 
ag
 = 
FALSE
;

586 if(
iv
==
NULL
 ||riv->
ayback_pe
!=NULL 
FALSE
;

587 
GBus
 *
bus
;

588 
G_STMT_START


590 
ag
 = 
FALSE
;

591 
fec1
 = 
	`g_emt_y_make
("fec", 
NULL
);

592 if(
fec1
==
NULL
) ;

593 
fec2
 = 
	`g_emt_y_make
("fec", 
NULL
);

594 if(
fec2
==
NULL
) ;

595 
decodeb1
 = 
	`g_emt_y_make
("decodeb2", 
NULL
);

596 if(
decodeb1
==
NULL
) ;

597 
decodeb2
 = 
	`g_emt_y_make
("decodeb2", 
NULL
);

598 if(
decodeb2
==
NULL
) ;

599 
audiocvt1
 = 
	`g_emt_y_make
("audiocvt", 
NULL
);

600 if(
audiocvt1
==
NULL
) ;

601 
audiocvt2
 = 
	`g_emt_y_make
("audiocvt", 
NULL
);

602 if(
audiocvt2
==
NULL
) ;

603 
audieme1
 = 
	`g_emt_y_make
("audieme", 
NULL
);

604 if(
audieme1
==
NULL
) ;

605 
audieme2
 = 
	`g_emt_y_make
("audieme", 
NULL
);

606 if(
audieme2
==
NULL
) ;

607 
add
 = 
	`g_emt_y_make
("add", 
NULL
);

608 if(
add
==
NULL
) ;

609 
audio_sk
 = 
	`g_emt_y_make
("autudiosk", 
NULL
);

610 if(
audio_sk
==
NULL
) ;

611 
pe
 = 
	`g_pe_w
("playback-pipeline");

612 if(
pe
==
NULL
) ;

613 
ag
 = 
TRUE
;

615 
G_STMT_END
;

616 if(!
ag
)

618 if(
fec1
!=
NULL

	`g_obje_uef
(filesrc1);

619 if(
fec2
!=
NULL

	`g_obje_uef
(filesrc2);

620 if(
decodeb1
!=
NULL

	`g_obje_uef
(decodebin1);

621 if(
decodeb2
!=
NULL

	`g_obje_uef
(decodebin2);

622 if(
audiocvt1
!=
NULL

	`g_obje_uef
(audioconvert1);

623 if(
audiocvt2
!=
NULL

	`g_obje_uef
(audioconvert2);

624 if(
audieme1
!=
NULL

	`g_obje_uef
(audioresample1);

625 if(
audieme2
!=
NULL

	`g_obje_uef
(audioresample2);

626 if(
add
!=
NULL

	`g_obje_uef
(adder);

627 if(
audio_sk
!=
NULL

	`g_obje_uef
(audio_sink);

628 if(
pe
!=
NULL

	`g_obje_uef
(pipeline);

629  
FALSE
;

631 
	`g_b_add_my
(
	`GST_BIN
(
pe
), 
fec1
, 
fec2
, 
decodeb1
,

632 
decodeb2
, 
audiocvt1
, 
audiocvt2
, 
audieme1
,

633 
audieme2
, 
add
, 
audio_sk
, 
NULL
);

634 if(!
	`g_emt_lk
(
fec1
, 
decodeb1
) ||

635 !
	`g_emt_lk
(
fec2
, 
decodeb2
) ||

636 !
	`g_emt_lk
(
audiocvt1
, 
audieme1
) ||

637 !
	`g_emt_lk
(
audiocvt2
, 
audieme2
) ||

638 !
	`g_emt_lk
(
add
, 
audio_sk
))

640 
	`g_obje_uef
(
pe
);

641  
FALSE
;

643 
sk_d
 = 
	`g_emt_g_que_d
(
add
, "sink%d");

644 
c_d
 = 
	`g_emt_g_ic_d
(
audieme1
, "src");

645 
	`g_d_lk
(
c_d
, 
sk_d
);

646 
	`g_obje_uef
(
c_d
);

647 
	`g_obje_uef
(
sk_d
);

648 
sk_d
 = 
	`g_emt_g_que_d
(
add
, "sink%d");

649 
c_d
 = 
	`g_emt_g_ic_d
(
audieme2
, "src");

650 
	`g_d_lk
(
c_d
, 
sk_d
);

651 
	`g_obje_uef
(
c_d
);

652 
	`g_obje_uef
(
sk_d
);

653 
	`g_sigl_c
(
decodeb1
, "new-decoded-pad",

654 
	`G_CALLBACK
(
rc_ug_kamix_ayback_d_added_cb
),

655 
audiocvt1
);

656 
	`g_sigl_c
(
decodeb2
, "new-decoded-pad",

657 
	`G_CALLBACK
(
rc_ug_kamix_ayback_d_added_cb
),

658 
audiocvt2
);

659 
bus
 = 
	`g_pe_g_bus
(
	`GST_PIPELINE
(
pe
));

660 
	`g_bus_add_wch
(
bus
,

661 (
GBusFunc
)
rc_ug_kamix_ayback_bus_hdr
, 
iv
);

662 
	`g_obje_uef
(
bus
);

663 
	`g_emt_t_e
(
pe
, 
GST_STATE_NULL
);

664 
iv
->
ayback_pe
 = 
pe
;

665 
iv
->
ayback_fec1
 = 
fec1
;

666 
iv
->
ayback_fec2
 = 
fec2
;

667  
TRUE
;

668 
	}
}

670 
	$rc_ug_kamix_cd_bu_icked
(
GtkBu
 *
bu
,

671 
gpor
 
da
)

673 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

674 
GS
 
e
;

675 cڡ 
gch
 *
fe
;

676 if(
da
==
NULL
) ;

677 if(!
	`g_emt_g_e
(
iv
->
cd_pe
, &
e
, 
NULL
, 0))

679 
fe
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
iv
->
voi_y
));

680 if(
e
!=
GST_STATE_PLAYING
)

681 
	`rc_ug_kamix_cd_t
(
fe
);

683 
	`rc_ug_kamix_cd_
();

684 
	}
}

686 
	$rc_ug_kamix_ayback_bu_icked
(
GtkBu
 *
bu
,

687 
gpor
 
da
)

689 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

690 
GS
 
e
;

691 cڡ 
gch
 *
music_fe
;

692 cڡ 
gch
 *
voi_fe
;

693 if(
da
==
NULL
) ;

694 if(!
	`g_emt_g_e
(
iv
->
ayback_pe
, &
e
, 
NULL
, 0))

696 
music_fe
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
iv
->
music_y
));

697 
voi_fe
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
iv
->
voi_y
));

698 if(
music_fe
==
NULL
 || 
voi_fe
==NULL || 
	`
(music_file)<1 ||

699 
	`
(
voi_fe
)<1)

703 if(
e
!=
GST_STATE_PLAYING
)

704 
	`rc_ug_kamix_ayback_t
(
voi_fe
, 
music_fe
);

706 
	`rc_ug_kamix_ayback_
();

707 
	}
}

709 
	$rc_ug_kamix_mix_bu_icked
(
GtkBu
 *
bu
,

710 
gpor
 
da
)

712 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

713 
GS
 
e
;

714 cڡ 
gch
 *
music_fe
;

715 cڡ 
gch
 *
voi_fe
;

716 cڡ 
gch
 *
mixed_fe
;

717 if(
da
==
NULL
) ;

718 if(!
	`g_emt_g_e
(
iv
->
mix_pe
, &
e
, 
NULL
, 0))

720 
music_fe
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
iv
->
music_y
));

721 
voi_fe
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
iv
->
voi_y
));

722 
mixed_fe
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
iv
->
mix_y
));

723 if(
music_fe
==
NULL
 || 
voi_fe
==NULL || 
mixed_fe
==NULL ||

724 
	`
(
music_fe
)<1 || sn(
voi_fe
)<1 || sn(
mixed_fe
)<1)

728 if(
e
!=
GST_STATE_PLAYING
)

729 
	`rc_ug_kamix_mix_t
(
voi_fe
, 
music_fe
, 
mixed_fe
);

731 
	`rc_ug_kamix_mix_
();

733 
	}
}

735 
	$rc_ug_kamix_echo_bu_toggd
(
GtkToggBu
 *
bu
,

736 
gpor
 
da
)

738 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

739 
gboޗn
 
ag
;

740 if(
da
==
NULL
) ;

741 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

742 
	`g_obje_t
(
iv
->
echo_vume
, "mu", !
ag
, 
NULL
);

743 
	}
}

745 
gboޗn
 
	$rc_ug_kamix_vume_chged
(
GtkSBu
 *
widg
,

746 
gdoub
 
vume
, 
gpor
 
da
)

748 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

749 if(
da
==
NULL
 
FALSE
;

750 
	`g_obje_t
(
iv
->
echo_vume
, "vume", 
vume
, 
NULL
);

751 
	`g_obje_t
(
iv
->
cd_vume
, "vume", 
vume
, 
NULL
);

752  
FALSE
;

753 
	}
}

755 
	$rc_ug_kamix_vw_mu_toggd
(
GtkToggAi
 *
togg
,

756 
gpor
 
da
)

758 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

759 
gboޗn
 
ag
;

760 if(
da
==
NULL
) ;

761 
ag
 = 
	`gtk_togg_ai_g_aive
(
togg
);

762 if(
ag
)

763 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
iv
->
wdow
));

765 
	`gtk_widg_hide
(
iv
->
wdow
);

766 
	}
}

768 
gboޗn
 
	$rc_ug_kamix_wdow_de_evt_cb
(
GtkWidg
 *
widg
,

769 
GdkEvt
 *
evt
, 
gpor
 
da
)

771 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

772 if(
da
==
NULL
 
TRUE
;

773 
	`gtk_togg_ai_t_aive
(
iv
->
ai
, 
FALSE
);

774  
TRUE
;

775 
	}
}

777 
	$rc_ug_kamix_wdow_deroy_cb
(
GtkWidg
 *
widg
,

778 
gpor
 
da
)

780 
RCPlugKaMixPrive
 *
iv
 = (RCPlugKaMixPriv*)
da
;

781 if(
da
==
NULL
) ;

782 
	`gtk_widg_deroyed
(
iv
->
wdow
, &(priv->window));

783 
	}
}

785 
	$rc_ug_kamix_ui_
(
RCPlugKaMixPrive
 *
iv
)

787 
GtkWidg
 *
ma_grid
;

788 
GtkWidg
 *
fe_grid
;

789 
GtkWidg
 *
bu_grid
;

790 
GtkWidg
 *
music_fe_b
;

791 
GtkWidg
 *
voi_fe_b
;

792 
GtkWidg
 *
mix_fe_b
;

793 
iv
->
wdow
 = 
	`gtk_wdow_w
(
GTK_WINDOW_TOPLEVEL
);

794 
iv
->
music_y
 = 
	`gtk_y_w
();

795 
iv
->
voi_y
 = 
	`gtk_y_w
();

796 
iv
->
mix_y
 = 
	`gtk_y_w
();

797 
iv
->
cd_bu
 = 
	`gtk_bu_w
();

798 
iv
->
ayback_bu
 = 
	`gtk_bu_w
();

799 
iv
->
mix_bu
 = 
	`gtk_bu_w
();

800 
iv
->
cd_image
 = 
	`gtk_image_w_om_ock
(

801 
GTK_STOCK_MEDIA_RECORD
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

802 
iv
->
ayback_image
 = 
	`gtk_image_w_om_ock
(

803 
GTK_STOCK_MEDIA_PLAY
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

804 
iv
->
mix_image
 = 
	`gtk_image_w_om_ock
(

805 
GTK_STOCK_CONVERT
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

806 
iv
->
vumebu
 = 
	`gtk_vume_bu_w
();

807 
iv
->
ouut_checkbu
 = 
	`gtk_check_bu_w_wh_mmic
(

808 
	`_
("Output _Voiceo Speaker"));

809 
iv
->
su_b
 = 
	`gtk_b_w
(
	`_
("Ready"));

810 
music_fe_b
 = 
	`gtk_b_w
(
	`_
("Music File: "));

811 
voi_fe_b
 = 
	`gtk_b_w
(
	`_
("Voice File: "));

812 
mix_fe_b
 = 
	`gtk_b_w
(
	`_
("Mix File: "));

813 
ma_grid
 = 
	`gtk_grid_w
();

814 
fe_grid
 = 
	`gtk_grid_w
();

815 
bu_grid
 = 
	`gtk_grid_w
();

816 
	`g_obje_t
(
iv
->
wdow
, "t", 
	`_
("Karaoke Mixer"),

817 "wdow-posi", 
GTK_WIN_POS_CENTER
, 
NULL
);

818 
	`g_obje_t
(
iv
->
su_b
, "hexnd-t", 
TRUE
, "hexpand",

819 
TRUE
, 
NULL
);

820 
	`g_obje_t
(
iv
->
music_y
, "hexnd-t", 
TRUE
, "hexpand",

821 
TRUE
, 
NULL
);

822 
	`g_obje_t
(
iv
->
voi_y
, "hexnd-t", 
TRUE
, "hexpand",

823 
TRUE
, 
NULL
);

824 
	`g_obje_t
(
iv
->
mix_y
, "hexnd-t", 
TRUE
, "hexpand",

825 
TRUE
, 
NULL
);

826 
	`g_obje_t
(
iv
->
cd_bu
, "lf", 
GTK_RELIEF_NONE
,

827 "n-focus", 
FALSE
, 
NULL
);

828 
	`g_obje_t
(
iv
->
ayback_bu
, "lf", 
GTK_RELIEF_NONE
,

829 "n-focus", 
FALSE
, 
NULL
);

830 
	`g_obje_t
(
iv
->
mix_bu
, "lf", 
GTK_RELIEF_NONE
,

831 "n-focus", 
FALSE
, 
NULL
);

832 
	`g_obje_t
(
iv
->
vumebu
, "n-focus", 
FALSE
, "size",

833 
GTK_ICON_SIZE_SMALL_TOOLBAR
, "lf", 
GTK_RELIEF_NONE
,

834 "u-symbic", 
TRUE
, "vue", 1.0, "hign", 
GTK_ALIGN_END
,

835 "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

836 
	`g_obje_t
(
fe_grid
, "hexnd-t", 
TRUE
, "hexpand",

837 
TRUE
, 
NULL
);

838 
	`g_obje_t
(
bu_grid
, "hexnd-t", 
TRUE
, "hexpand",

839 
TRUE
, 
NULL
);

840 
	`gtk_widg_t_size_que
(
iv
->
wdow
, 400, -1);

841 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
cd_bu
),

842 
iv
->
cd_image
);

843 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
ayback_bu
),

844 
iv
->
ayback_image
);

845 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
mix_bu
),

846 
iv
->
mix_image
);

847 
	`gtk_grid_ch
(
	`GTK_GRID
(
fe_grid
), 
music_fe_b
, 0, 0, 1, 1);

848 
	`gtk_grid_ch
(
	`GTK_GRID
(
fe_grid
), 
iv
->
music_y
, 1, 0, 1, 1);

849 
	`gtk_grid_ch
(
	`GTK_GRID
(
fe_grid
), 
voi_fe_b
, 0, 1, 1, 1);

850 
	`gtk_grid_ch
(
	`GTK_GRID
(
fe_grid
), 
iv
->
voi_y
, 1, 1, 1, 1);

851 
	`gtk_grid_ch
(
	`GTK_GRID
(
fe_grid
), 
mix_fe_b
, 0, 2, 1, 1);

852 
	`gtk_grid_ch
(
	`GTK_GRID
(
fe_grid
), 
iv
->
mix_y
, 1, 2, 1, 1);

853 
	`gtk_grid_ch
(
	`GTK_GRID
(
bu_grid
), 
iv
->
cd_bu
, 0, 0, 1, 1);

854 
	`gtk_grid_ch
(
	`GTK_GRID
(
bu_grid
), 
iv
->
ayback_bu
, 1, 0, 1, 1);

855 
	`gtk_grid_ch
(
	`GTK_GRID
(
bu_grid
), 
iv
->
mix_bu
, 2, 0, 1, 1);

856 
	`gtk_grid_ch
(
	`GTK_GRID
(
bu_grid
), 
iv
->
vumebu
, 3, 0, 1, 1);

857 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
fe_grid
, 0, 0, 1, 1);

858 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
bu_grid
, 0, 1, 1, 1);

859 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
iv
->
ouut_checkbu
,

861 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
iv
->
su_b
, 0, 3, 1, 1);

862 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
wdow
), 
ma_grid
);

863 
iv
->
ai
 = 
	`gtk_togg_ai_w
("RC2ViewPluginKaraokeMixer",

864 
	`_
("KaokMix"), _("Show/hidkaokmix wdow"), 
NULL
);

865 
iv
->
mu_id
 = 
	`rc_ui_mu_add_mu_ai
(
	`GTK_ACTION
riv->
ai
),

867 "RC2VwPlugKaokeMix", 
TRUE
);

868 
	`g_sigl_c
(
iv
->
ai
, "toggled",

869 
	`G_CALLBACK
(
rc_ug_kamix_vw_mu_toggd
), 
iv
);

870 
	`g_sigl_c
(
iv
->
ouut_checkbu
, "toggled",

871 
	`G_CALLBACK
(
rc_ug_kamix_echo_bu_toggd
), 
iv
);

872 
	`g_sigl_c
(
iv
->
vumebu
, "value-changed",

873 
	`G_CALLBACK
(
rc_ug_kamix_vume_chged
), 
iv
);

874 
	`g_sigl_c
(
iv
->
cd_bu
, "clicked",

875 
	`G_CALLBACK
(
rc_ug_kamix_cd_bu_icked
), 
iv
);

876 
	`g_sigl_c
(
iv
->
ayback_bu
, "clicked",

877 
	`G_CALLBACK
(
rc_ug_kamix_ayback_bu_icked
), 
iv
);

878 
	`g_sigl_c
(
iv
->
mix_bu
, "clicked",

879 
	`G_CALLBACK
(
rc_ug_kamix_mix_bu_icked
), 
iv
);

880 
	`g_sigl_c
(
iv
->
wdow
, "destroy",

881 
	`G_CALLBACK
(
rc_ug_kamix_wdow_deroy_cb
), 
iv
);

882 
	`g_sigl_c
(
iv
->
wdow
, "delete-event",

883 
	`G_CALLBACK
(
rc_ug_kamix_wdow_de_evt_cb
), 
iv
);

884 
	`gtk_widg_show_l
(
iv
->
wdow
);

885 
	`gtk_widg_hide
(
iv
->
wdow
);

886 
	}
}

888 
gboޗn
 
	$rc_ug_kamix_ld
(
RCLibPlugDa
 *
ug
)

890 
RCPlugKaMixPrive
 *
iv
 = &
kamix_iv
;

891 cڡ 
gch
 *
home_d
;

892 
home_d
 = 
	`g_gv
("HOME");

893 if(
home_d
==
NULL
)

894 
home_d
 = 
	`g_g_home_d
();

895 
gch
 *
fh
;

896 if(!
	`rc_ug_kamix_cd_pe_
(
iv
))

898 
	`g_wng
("Cannot startecordipeline!");

899  
FALSE
;

901 if(!
	`rc_ug_kamix_mix_pe_
(
iv
))

903 
	`g_wng
("Cannot start mixeripeline!");

904  
FALSE
;

906 if(!
	`rc_ug_kamix_ayback_pe_
(
iv
))

908 
	`g_wng
("Cannot startlaybackipeline!");

909  
FALSE
;

911 if(!
	`rc_ug_kamix_echo_pe_
(
iv
))

913 
	`g_wng
("Cannot startchoipeline!");

915 
	`rc_ug_kamix_ui_
(
iv
);

916 
fh
 = 
	`g_bud_fame
(
home_d
, "RC-Voi.OGG", 
NULL
);

917 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
voi_y
), 
fh
);

918 
	`g_
(
fh
);

919 
fh
 = 
	`g_bud_fame
(
home_d
, "RC-Mixed.OGG", 
NULL
);

920 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
mix_y
), 
fh
);

921 
	`g_
(
fh
);

922  
TRUE
;

923 
	}
}

925 
gboޗn
 
	$rc_ug_kamix_ud
(
RCLibPlugDa
 *
ug
)

927 
RCPlugKaMixPrive
 *
iv
 = &
kamix_iv
;

928 if(
iv
->
mu_id
>0)

930 
	`rc_ui_mu_move_mu_ai
(
	`GTK_ACTION
(
iv
->
ai
),

931 
iv
->
mu_id
);

932 
	`g_obje_uef
(
iv
->
ai
);

934 if(
iv
->
wdow
!=
NULL
)

936 
	`gtk_widg_deroy
(
iv
->
wdow
);

937 
iv
->
wdow
 = 
NULL
;

939 if(
iv
->
cd_pe
!=
NULL
)

941 
	`g_emt_t_e
(
iv
->
cd_pe
, 
GST_STATE_NULL
);

942 
	`g_obje_uef
(
iv
->
cd_pe
);

943 
iv
->
cd_pe
 = 
NULL
;

945 if(
iv
->
mix_pe
!=
NULL
)

947 
	`g_emt_t_e
(
iv
->
mix_pe
, 
GST_STATE_NULL
);

948 
	`g_obje_uef
(
iv
->
mix_pe
);

949 
iv
->
mix_pe
 = 
NULL
;

951 if(
iv
->
echo_pe
!=
NULL
)

953 
	`g_emt_t_e
(
iv
->
echo_pe
, 
GST_STATE_NULL
);

954 
	`g_obje_uef
(
iv
->
echo_pe
);

955 
iv
->
echo_pe
 = 
NULL
;

957 if(
iv
->
ayback_pe
!=
NULL
)

959 
	`g_emt_t_e
(
iv
->
ayback_pe
, 
GST_STATE_NULL
);

960 
	`g_obje_uef
(
iv
->
ayback_pe
);

961 
iv
->
ayback_pe
 = 
NULL
;

963  
TRUE
;

964 
	}
}

966 
gboޗn
 
	$rc_ug_kamix_
(
RCLibPlugDa
 *
ug
)

969  
TRUE
;

970 
	}
}

972 
	$rc_ug_kamix_deroy
(
RCLibPlugDa
 *
ug
)

975 
	}
}

977 
RCLibPlugInfo
 
	grlug_fo
 = {

978 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

979 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

980 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

981 .
	gty
 = 
RCLIB_PLUGIN_TYPE_MODULE
,

982 .
	gid
 = 
KARAMIXER_ID
,

983 .
	gme
 = 
N_
("Karaoke Mixer"),

984 .
	gvsi
 = "0.5",

985 .
	gdesti
 = 
N_
("Record your voicend mix it withny "

987 .
	gauth
 = "SuperCat",

988 .
	ghomage
 = "http://supercat-lab.org/",

989 .
	gld
 = 
rc_ug_kamix_ld
,

990 .
	gud
 = 
rc_ug_kamix_ud
,

991 .
	gcfigu
 = 
NULL
,

992 .
	gderoy
 = 
rc_ug_kamix_deroy
,

993 .
	gexa_fo
 = 
NULL


996 
RCPLUGIN_INIT_PLUGIN
(
rlug_fo
.
id
, 
rc_ug_kamix_
,cplugin_info);

	@plugins/devel/python3.c

26 
	~<Pyth.h
>

27 
	~<pythrun.h
>

28 
	~<sigl.h
>

29 
	~<wch.h
>

30 
	~<glib.h
>

31 
	~<glib/gtf.h
>

32 
	~<glib/gi18n.h
>

33 
	~<glib/gdio.h
>

34 
	~<rib.h
>

36 #ifde
G_LOG_DOMAIN


37 #unde
G_LOG_DOMAIN


40 
	#G_LOG_DOMAIN
 "Py3Ld"

	)

41 
	#PY3LD_ID
 "rc2-ld-pyth3-ld"

	)

43 
gboޗn
 
	gpyth_lded
 = 
FALSE
;

45 
	$py3ld_add_modu_th
(cڡ 
gch
 *
modu_th
)

47 
PyObje
 *
thli
, *
thrg
;

48 
thli
 = 
	`PySys_GObje
("path");

49 
thrg
 = 
	`PyUnicode_FromSg
(
modu_th
);

50 if(
	`PySequ_Cڏs
(
thli
, 
thrg
)==0)

51 
	`PyLi_In
(
thli
, 0, 
thrg
);

52 
	`Py_DECREF
(
thrg
);

53 
	}
}

55 
gboޗn
 
	$py3ld_check_is_imp܋d
(cڡ 
gch
 *
me
)

57 
PyObje
 *
modu_di
;

58 
PyObje
 *
key
;

59 
gboޗn
 
ag
 = 
FALSE
;

60 if(
me
==
NULL
 
FALSE
;

61 
modu_di
 = 
	`PyImpt_GModuDi
();

62 if(
modu_di
==
NULL
 
FALSE
;

63 
key
 = 
	`PyUnicode_FromSg
(
me
);

64 if(
	`PyDi_Cڏs
(
modu_di
, 
key
)>0)

65 
ag
 = 
TRUE
;

66 
	`Py_DECREF
(
key
);

67  
ag
;

68 
	}
}

70 
gboޗn
 
	$py3ld_ld
(
RCLibPlugDa
 *
ug
)

72 
	`g_debug
("Python3oaderoaded.");

73  
TRUE
;

74 
	}
}

76 
gboޗn
 
	$py3ld_ud
(
RCLibPlugDa
 *
ug
)

78 
	`g_debug
("Python3oader unloaded.");

79  
TRUE
;

80 
	}
}

82 
gboޗn
 
	$py3ld_
(
RCLibPlugDa
 *
ug
)

84 
gt
 
t
;

85 
gch
 *
ug_d
;

86 
wch_t
 *
gv
[] = {
L
"RhythmC2", 
NULL
 };

87 
sigai
 
d_sigt
;

88 if(
	`Py_IsInlized
())

90 
	`g_mesge
("Initializedlready!");

91  
FALSE
;

93 
t
 = 
	`sigai
(
SIGINT
, 
NULL
, &
d_sigt
);

94 if(
t
!=0)

96 
	`g_wng
("Cannot save SIGINT handler!");

97  
FALSE
;

99 
	`Py_Inlize
();

100 
pyth_lded
 = 
TRUE
;

101 
t
 = 
	`sigai
(
SIGINT
, &
d_sigt
, 
NULL
);

102 if(
t
!=0)

104 
	`g_wng
("Cannotestore SIGINT handler!");

105 if(
	`Py_IsInlized
()
	`Py_Fize
();

106  
FALSE
;

108 
	`PySys_SArgv
(1, 
gv
);

109 
	`PyRun_SimeSg
("import sys; sys.path.pop(0)\n");

110 
ug_d
 = 
	`g_th_g_dme
(
ug
->
th
);

111 if(
ug_d
!=
NULL
)

112 
	`py3ld_add_modu_th
(
ug_d
);

113 
	`g_
(
ug_d
);

114  
TRUE
;

115 
	}
}

117 
	$py3ld_deroy
(
RCLibPlugDa
 *
ug
)

119 if(
	`Py_IsInlized
(&& 
pyth_lded

	`Py_Fize
();

120 
	}
}

122 
gboޗn
 
	$py3ld_ug_obe
(
RCLibPlugDa
 *
ug
)

124 
RCLibPlugInfo
 *
fo
;

125 
PyObje
 *
py_modu
 = 
NULL
;

126 
PyObje
 *
omli
, *
lols
;

127 
PyObje
 *
ug_fo
;

128 
PyObje
 *
py_magic
, *
py_maj_v
, *
py_m_v
, *
py_id
;

129 
PyObje
 *
py_me
, *
py_vsi
, *
py_desc
, *
py_auth
, *
py_homage
;

130 
PyObje
 *
rg_utf8
;

131 
PyObje
 *
obe_func
, *
su
;

132 
gboޗn
 
ag
 = 
TRUE
;

133 
gch
 *
ug_d
;

134 
gch
 *
modu_me
;

135 if(
ug
==
NULL
 
FALSE
;

136 if(
ug
->
th
==
NULL
 
FALSE
;

137 
ug_d
 = 
	`g_th_g_dme
(
ug
->
th
);

138 if(
ug_d
!=
NULL
)

139 
	`py3ld_add_modu_th
(
ug_d
);

140 
	`g_
(
ug_d
);

141 
modu_me
 = 
	`rib_g_g_me_om_h
(
ug
->
th
);

142 if(!
	`py3ld_check_is_imp܋d
(
modu_me
))

144 
omli
 = 
	`PyTue_New
(0);

145 
py_modu
 = 
	`PyImpt_ImptModuEx
(
modu_me
, 
NULL
, NULL,

146 
omli
);

147 
	`Py_DECREF
(
omli
);

151 
	`g_tf
("Repeat import!\n");

153 
	`g_
(
modu_me
);

154 if(
py_modu
==
NULL
)

156 
	`PyE_Prt
();

157  
FALSE
;

159 
lols
 = 
	`PyModu_GDi
(
py_modu
);

160 if(
lols
==
NULL
)

162 
	`Py_DECREF
(
py_modu
);

163 
	`g_wng
("Cannot open module dict!");

164  
FALSE
;

166 
ug_fo
 = 
	`PyDi_GImSg
(
lols
, "RC2Py3PluginInfo");

167 if(
ug_fo
==
NULL
)

169 
	`Py_DECREF
(
py_modu
);

170 
	`g_wng
("Cannot findlug-in info (Dict: \"RC2Py3PluginInfo\")!");

171  
FALSE
;

173 if(!
	`PyDi_Check
(
ug_fo
))

175 
	`Py_DECREF
(
py_modu
);

176 
	`g_wng
("Wrongype oflug-in info (should be dictype)!");

177  
FALSE
;

179 
py_magic
 = 
	`PyDi_GImSg
(
ug_fo
, "magic");

180 
py_maj_v
 = 
	`PyDi_GImSg
(
ug_fo
, "major_version");

181 
py_m_v
 = 
	`PyDi_GImSg
(
ug_fo
, "minor_version");

182 
py_id
 = 
	`PyDi_GImSg
(
ug_fo
, "id");

183 
py_me
 = 
	`PyDi_GImSg
(
ug_fo
, "name");

184 
py_vsi
 = 
	`PyDi_GImSg
(
ug_fo
, "version");

185 
py_desc
 = 
	`PyDi_GImSg
(
ug_fo
, "description");

186 
py_auth
 = 
	`PyDi_GImSg
(
ug_fo
, "author");

187 
py_homage
 = 
	`PyDi_GImSg
(
ug_fo
, "homepage");

188 if(
py_magic
!=
NULL
 && 
py_maj_v
!=NULL && 
py_m_v
!=NULL &&

189 
py_id
!=
NULL
 && 
py_me
!=NULL && 
	`PyLg_Check
(
py_magic
) &&

190 
	`PyLg_Check
(
py_maj_v
&& PyLg_Check(
py_m_v
) &&

191 
	`PyUnicode_Check
(
py_id
&& PyUnicode_Check(
py_me
))

193 
fo
 = 
	`g_w0
(
RCLibPlugInfo
, 1);

194 
fo
->
ty
 = 
RCLIB_PLUGIN_TYPE_MODULE
;

195 
fo
->
magic
 = 
	`PyLg_AsLg
(
py_magic
);

196 
fo
->
maj_vsi
 = 
	`PyLg_AsLg
(
py_maj_v
);

197 
fo
->
m_vsi
 = 
	`PyLg_AsLg
(
py_m_v
);

198 
rg_utf8
 = 
	`PyUnicode_AsUTF8Sg
(
py_id
);

199 if(
rg_utf8
!=
NULL
)

201 
fo
->
id
 = 
	`g_rdup
(
	`PyBys_AsSg
(
rg_utf8
));

202 
	`Py_DECREF
(
rg_utf8
);

204 
rg_utf8
 = 
	`PyUnicode_AsUTF8Sg
(
py_me
);

205 if(
rg_utf8
!=
NULL
)

207 
fo
->
me
 = 
	`g_rdup
(
	`PyBys_AsSg
(
rg_utf8
));

208 
	`Py_DECREF
(
rg_utf8
);

210 
rg_utf8
 = 
	`PyUnicode_AsUTF8Sg
(
py_vsi
);

211 if(
rg_utf8
!=
NULL
)

213 
fo
->
vsi
 = 
	`g_rdup
(
	`PyBys_AsSg
(
rg_utf8
));

214 
	`Py_DECREF
(
rg_utf8
);

216 
rg_utf8
 = 
	`PyUnicode_AsUTF8Sg
(
py_desc
);

217 if(
rg_utf8
!=
NULL
)

219 
fo
->
desti
 = 
	`g_rdup
(
	`PyBys_AsSg
(
rg_utf8
));

220 
	`Py_DECREF
(
rg_utf8
);

222 
rg_utf8
 = 
	`PyUnicode_AsUTF8Sg
(
py_auth
);

223 if(
rg_utf8
!=
NULL
)

225 
fo
->
auth
 = 
	`g_rdup
(
	`PyBys_AsSg
(
rg_utf8
));

226 
	`Py_DECREF
(
rg_utf8
);

228 
rg_utf8
 = 
	`PyUnicode_AsUTF8Sg
(
py_homage
);

229 if(
rg_utf8
!=
NULL
)

231 
fo
->
homage
 = 
	`g_rdup
(
	`PyBys_AsSg
(
rg_utf8
));

232 
	`Py_DECREF
(
rg_utf8
);

234 
fo
->
dds
 = 
	`g_w0
(
gch
 *, 2);

235 
fo
->
dds
[0] = 
	`g_rdup
(
PY3LD_ID
);

239 
	`Py_DECREF
(
py_modu
);

240 
	`g_wng
("Necessary item in dict \"RC2Py3PluginInfo\" is missing!");

241  
FALSE
;

243 
obe_func
 = 
	`PyDi_GImSg
(
lols
, "Probe");

244 if(
obe_func
!=
NULL
)

246 
su
 = 
	`PyObje_ClFuni
(
obe_func
, 
NULL
);

247 if(
su
!=
NULL
)

249 if(
su
!=
Py_True

ag
 = 
FALSE
;

250 
	`Py_DECREF
(
su
);

253 if(!
ag
)

255 
	`Py_DECREF
(
py_modu
);

256 if(
fo
!=
NULL
)

258 
	`g_
(
fo
->
id
);

259 
	`g_
(
fo
->
me
);

260 
	`g_
(
fo
->
vsi
);

261 
	`g_
(
fo
->
desti
);

262 
	`g_
(
fo
->
auth
);

263 
	`g_
(
fo
->
homage
);

264 
	`g_rv
(
fo
->
dds
);

265 
	`g_
(
fo
);

267 
	`g_wng
("Probe function inlug-ineturned False!");

268  
FALSE
;

270 
ug
->
hd
 = 
py_modu
;

271 
ug
->
fo
 = info;

272  
TRUE
;

273 
	}
}

275 
gboޗn
 
	$py3ld_ug_ld
(
RCLibPlugDa
 *
ug
)

277 
PyObje
 *
lols
, *
ld_func
, *
su
;

278 
gboޗn
 
ag
 = 
FALSE
;

279 if(
ug
==
NULL
 
FALSE
;

280 if(
ug
->
th
==
NULL
 
FALSE
;

281 if(
ug
->
hd
==
NULL
 
FALSE
;

282 
lols
 = 
	`PyModu_GDi
((
PyObje
 *)
ug
->
hd
);

283 
ld_func
 = 
	`PyDi_GImSg
(
lols
, "Load");

284 if(
ld_func
!=
NULL
)

286 
su
 = 
	`PyObje_ClFuni
(
ld_func
, 
NULL
);

287 if(
su
!=
NULL
)

289 if(
su
==
Py_True

ag
 = 
TRUE
;

290 
	`Py_DECREF
(
su
);

293  
ag
;

294 
	}
}

296 
gboޗn
 
	$py3ld_ug_ud
(
RCLibPlugDa
 *
ug
)

298 
PyObje
 *
lols
, *
ud_func
, *
su
;

299 
gboޗn
 
ag
 = 
FALSE
;

300 if(
ug
==
NULL
 
FALSE
;

301 if(
ug
->
th
==
NULL
 
FALSE
;

302 if(
ug
->
hd
==
NULL
 
FALSE
;

303 
lols
 = 
	`PyModu_GDi
((
PyObje
 *)
ug
->
hd
);

304 
ud_func
 = 
	`PyDi_GImSg
(
lols
, "Unload");

305 if(
ud_func
!=
NULL
)

307 
su
 = 
	`PyObje_ClFuni
(
ud_func
, 
NULL
);

308 if(
su
!=
NULL
)

310 if(
su
==
Py_True

ag
 = 
TRUE
;

311 
	`Py_DECREF
(
su
);

314 
	`PyGC_C
());

315  
ag
;

316 
	}
}

318 
	$py3ld_ug_deroy
(
RCLibPlugDa
 *
ug
)

320 
PyObje
 *
lols
, *
deroy_func
, *
su
;

321 if(
ug
==
NULL
) ;

322 if(
ug
->
hd
!=
NULL
)

324 
lols
 = 
	`PyModu_GDi
((
PyObje
 *)
ug
->
hd
);

325 
deroy_func
 = 
	`PyDi_GImSg
(
lols
, "Destroy");

326 if(
deroy_func
!=
NULL
)

328 
su
 = 
	`PyObje_ClFuni
(
deroy_func
, 
NULL
);

329 if(
su
!=
NULL

	`Py_DECREF
(result);

332 
	`PyGC_C
());

333 if(
ug
->
fo
!=
NULL
)

335 
	`g_
(
ug
->
fo
->
id
);

336 
	`g_
(
ug
->
fo
->
me
);

337 
	`g_
(
ug
->
fo
->
vsi
);

338 
	`g_
(
ug
->
fo
->
desti
);

339 
	`g_
(
ug
->
fo
->
auth
);

340 
	`g_
(
ug
->
fo
->
homage
);

341 
	`g_rv
(
ug
->
fo
->
dds
);

342 
	`g_
(
ug
->
fo
);

344 if(
ug
->
hd
!=
NULL
)

345 
	`Py_DECREF
((
PyObje
 *)
ug
->
hd
);

346 
	}
}

348 cڡ 
gch
 *
	gpy3ld_exnsis
[] = {"py", "pyo", "pyc", "python",

349 
NULL
};

351 
RCLibPlugLdInfo
 
	grlug_ld_fo
 = {

352 .
exnsis
 = 
py3ld_exnsis
,

353 .
	gobe
 = 
py3ld_ug_obe
,

354 .
	gld
 = 
py3ld_ug_ld
,

355 .
	gud
 = 
py3ld_ug_ud
,

356 .
	gderoy
 = 
py3ld_ug_deroy


359 
RCLibPlugInfo
 
	grlug_fo
 = {

360 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

361 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

362 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

363 .
	gty
 = 
RCLIB_PLUGIN_TYPE_LOADER
,

364 .
	gid
 = 
PY3LD_ID
,

365 .
	gme
 = "Python3lug-inoader",

366 .
	gvsi
 = "0.1",

367 .
	gdesti
 = "Theoader foroading Python3lug-ins",

368 .
	gauth
 = "SuperCat",

369 .
	ghomage
 = "http://supercat-lab.org/",

370 .
	gld
 = 
py3ld_ld
,

371 .
	gud
 = 
py3ld_ud
,

372 .
	gderoy
 = 
py3ld_deroy
,

373 .
	gcfigu
 = 
NULL
,

374 .
	gdds
 = 
NULL
,

375 .
	gexa_fo
 = &
rlug_ld_fo


378 
RCPLUGIN_INIT_PLUGIN
(
PY3LD_ID
, 
py3ld_
, 
rlug_fo
);

	@plugins/extra/echoeffect.c

26 
	~<glib.h
>

27 
	~<gio/gio.h
>

28 
	~<gtk/gtk.h
>

29 
	~<rib.h
>

30 
	~<rc-ui-mu.h
>

32 
	#ECHOEFF_ID
 "rc2-tive-echo-ef"

	)

34 
	sRCPlugEchoEfPrive


36 
GEmt
 *
	mecho_emt
;

37 
GtkToggAi
 *
	mai
;

38 
gut
 
	mmu_id
;

39 
GtkWidg
 *
	mecho_wdow
;

40 
GtkWidg
 *
	mecho_day_s
;

41 
GtkWidg
 *
	mecho_fb_s
;

42 
GtkWidg
 *
	mecho_nsy_s
;

43 
gut64
 
	mday
;

44 
gt
 
	medback
;

45 
gt
 
	mnsy
;

46 
gulg
 
	mshutdown_id
;

47 
GKeyFe
 *
	mkeyfe
;

48 }
	tRCPlugEchoEfPrive
;

50 
RCPlugEchoEfPrive
 
	gechff_iv
 = {0};

52 
	$rc_ug_echff_ld_cf
(
RCPlugEchoEfPrive
 *
iv
)

54 
gt
 
ivue
;

55 
gdoub
 
dvue
;

56 if(
iv
==
NULL
 ||riv->
keyfe
==NULL) ;

57 
ivue
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
ECHOEFF_ID
, "Delay",

58 
NULL
);

59 if(
ivue
>=0 && ivalue<=1000)

60 
iv
->
day
 = 
ivue
 * 
GST_MSECOND
;

61 if(
iv
->
day
==0)riv->delay = 1;

62 
dvue
 = 
	`g_key_fe_g_doub
(
iv
->
keyfe
, 
ECHOEFF_ID
, "Feedback",

63 
NULL
);

64 if(
dvue
>=0.0 && dvalue<=1)

65 
iv
->
edback
 = 
dvue
;

66 
dvue
 = 
	`g_key_fe_g_doub
(
iv
->
keyfe
, 
ECHOEFF_ID
, "Intensity",

67 
NULL
);

68 if(
dvue
>=0.0 && dvalue<=1)

69 
iv
->
nsy
 = 
dvue
;

70 
	}
}

72 
	$rc_ug_echff_ve_cf
(
RCPlugEchoEfPrive
 *
iv
)

74 if(
iv
==
NULL
 ||riv->
keyfe
==NULL) ;

75 
	`g_key_fe_t_g
(
iv
->
keyfe
, 
ECHOEFF_ID
, "Delay",

76 (
gt
)(
iv
->
day
 / 
GST_MSECOND
));

77 
	`g_key_fe_t_doub
(
iv
->
keyfe
, 
ECHOEFF_ID
, "Feedback",

78 (
gdoub
)
iv
->
edback
);

79 
	`g_key_fe_t_doub
(
iv
->
keyfe
, 
ECHOEFF_ID
, "Intensity",

80 (
gdoub
)
iv
->
nsy
);

81 
	}
}

83 
	$rc_ug_echff_day_s_chged_cb
(
GtkRge
 *
nge
,

84 
gpor
 
da
)

86 
RCPlugEchoEfPrive
 *
iv
 = (RCPlugEchoEfPriv*)
da
;

87 
gdoub
 
vue
 = 0.0;

88 
gt64
 
day
;

89 if(
da
==
NULL
) ;

90 
vue
 = 
	`gtk_nge_g_vue
(
nge
);

91 
day
 = 
vue
 * 
GST_MSECOND
;

92 if(
day
==0) delay = 1;

93 
	`g_obje_t
(
iv
->
echo_emt
, "day", 
day
, 
NULL
);

94 
iv
->
day
 = delay;

95 
	}
}

97 
	$rc_ug_echff_fb_s_chged_cb
(
GtkRge
 *
nge
,

98 
gpor
 
da
)

100 
RCPlugEchoEfPrive
 *
iv
 = (RCPlugEchoEfPriv*)
da
;

101 
gdoub
 
vue
 = 0.0;

102 if(
da
==
NULL
) ;

103 
vue
 = 
	`gtk_nge_g_vue
(
nge
);

104 
	`g_obje_t
(
iv
->
echo_emt
, "edback", (
gt
)
vue
, 
NULL
);

105 
iv
->
edback
 = 
vue
;

106 
	}
}

108 
	$rc_ug_echff_nsy_s_chged_cb
(

109 
GtkRge
 *
nge
, 
gpor
 
da
)

111 
RCPlugEchoEfPrive
 *
iv
 = (RCPlugEchoEfPriv*)
da
;

112 
gdoub
 
vue
 = 0.0;

113 if(
da
==
NULL
) ;

114 
vue
 = 
	`gtk_nge_g_vue
(
nge
);

115 
	`g_obje_t
(
iv
->
echo_emt
, "nsy", (
gt
)
vue
, 
NULL
);

116 
iv
->
nsy
 = 
vue
;

117 
	}
}

119 
gboޗn
 
	$rc_ug_echff_wdow_de_evt_cb
(

120 
GtkWidg
 *
widg
, 
GdkEvt
 *
evt
, 
gpor
 
da
)

122 
RCPlugEchoEfPrive
 *
iv
 = (RCPlugEchoEfPriv*)
da
;

123 if(
da
==
NULL
 
TRUE
;

124 
	`gtk_togg_ai_t_aive
(
iv
->
ai
, 
FALSE
);

125  
TRUE
;

126 
	}
}

128 
le
 
	$rc_ug_echff_wdow_
(

129 
RCPlugEchoEfPrive
 *
iv
)

131 
GtkWidg
 *
echo_day_b
;

132 
GtkWidg
 *
echo_fb_b
, *
echo_nsy_b
;

133 
GtkWidg
 *
echo_ma_grid
;

134 if(
iv
->
echo_wdow
!=
NULL
) ;

135 
iv
->
echo_wdow
 = 
	`gtk_wdow_w
(
GTK_WINDOW_TOPLEVEL
);

136 
echo_day_b
 = 
	`gtk_b_w
(
	`_
("Delay"));

137 
echo_fb_b
 = 
	`gtk_b_w
(
	`_
("Feedback"));

138 
echo_nsy_b
 = 
	`gtk_b_w
(
	`_
("Intensity"));

139 
iv
->
echo_day_s
 = 
	`gtk_s_w_wh_nge
(

140 
GTK_ORIENTATION_HORIZONTAL
, 0, 1000.0, 1);

141 
iv
->
echo_fb_s
 = 
	`gtk_s_w_wh_nge
(

142 
GTK_ORIENTATION_HORIZONTAL
, 0, 1.0, 0.01);

143 
iv
->
echo_nsy_s
 = 
	`gtk_s_w_wh_nge
(

144 
GTK_ORIENTATION_HORIZONTAL
, 0, 1.0, 0.01);

145 
	`g_obje_t
(
iv
->
echo_wdow
, "t", 
	`_
("Echo Effect"),

146 "wdow-posi", 
GTK_WIN_POS_CENTER
, "has-size-gr", 
FALSE
,

147 "ty-ht", 
GDK_WINDOW_TYPE_HINT_DIALOG
, 
NULL
);

148 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
echo_day_s
),

149 
iv
->
day
 / 
GST_MSECOND
);

150 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
echo_fb_s
),

151 (
gdoub
)
iv
->
edback
);

152 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
echo_nsy_s
),

153 (
gdoub
)
iv
->
nsy
);

154 
	`gtk_widg_t_hexnd
(
iv
->
echo_day_s
, 
TRUE
);

155 
	`gtk_widg_t_hexnd
(
iv
->
echo_fb_s
, 
TRUE
);

156 
	`gtk_widg_t_hexnd
(
iv
->
echo_nsy_s
, 
TRUE
);

157 
	`gtk_s_t_dw_vue
(
	`GTK_SCALE
(
iv
->
echo_day_s
), 
TRUE
);

158 
	`gtk_s_t_dw_vue
(
	`GTK_SCALE
(
iv
->
echo_fb_s
), 
TRUE
);

159 
	`gtk_s_t_dw_vue
(
	`GTK_SCALE
(
iv
->
echo_nsy_s
), 
TRUE
);

160 
	`gtk_s_t_vue_pos
(
	`GTK_SCALE
(
iv
->
echo_day_s
),

161 
GTK_POS_RIGHT
);

162 
	`gtk_s_t_vue_pos
(
	`GTK_SCALE
(
iv
->
echo_fb_s
),

163 
GTK_POS_RIGHT
);

164 
	`gtk_s_t_vue_pos
(
	`GTK_SCALE
(
iv
->
echo_nsy_s
),

165 
GTK_POS_RIGHT
);

166 
echo_ma_grid
 = 
	`gtk_grid_w
();

167 
	`gtk_grid_t_cumn_acg
(
	`GTK_GRID
(
echo_ma_grid
), 3);

168 
	`gtk_grid_t_row_acg
(
	`GTK_GRID
(
echo_ma_grid
), 4);

169 
	`gtk_grid_ch
(
	`GTK_GRID
(
echo_ma_grid
), 
echo_day_b
, 0, 0, 1, 1);

170 
	`gtk_grid_ch
(
	`GTK_GRID
(
echo_ma_grid
), 
iv
->
echo_day_s
, 1, 0,

172 
	`gtk_grid_ch
(
	`GTK_GRID
(
echo_ma_grid
), 
echo_fb_b
, 0, 1, 1, 1);

173 
	`gtk_grid_ch
(
	`GTK_GRID
(
echo_ma_grid
), 
iv
->
echo_fb_s
, 1, 1,

175 
	`gtk_grid_ch
(
	`GTK_GRID
(
echo_ma_grid
), 
echo_nsy_b
, 0, 2, 1, 1);

176 
	`gtk_grid_ch
(
	`GTK_GRID
(
echo_ma_grid
), 
iv
->
echo_nsy_s
, 1, 2,

178 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
echo_wdow
), 
echo_ma_grid
);

179 
	`gtk_widg_t_size_que
(
iv
->
echo_wdow
, 300, 120);

180 
	`gtk_widg_show_l
(
echo_ma_grid
);

181 
	`g_sigl_c
(
iv
->
echo_wdow
, "delete-event",

182 
	`G_CALLBACK
(
rc_ug_echff_wdow_de_evt_cb
), 
iv
);

183 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
echo_day_s
), "value-changed",

184 
	`G_CALLBACK
(
rc_ug_echff_day_s_chged_cb
), 
iv
);

185 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
echo_fb_s
), "value-changed",

186 
	`G_CALLBACK
(
rc_ug_echff_fb_s_chged_cb
), 
iv
);

187 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
echo_nsy_s
), "value-changed",

188 
	`G_CALLBACK
(
rc_ug_echff_nsy_s_chged_cb
), 
iv
);

189 
	}
}

191 
	$rc_ug_echff_vw_mu_toggd
(
GtkToggAi
 *
togg
,

192 
gpor
 
da
)

194 
RCPlugEchoEfPrive
 *
iv
 = (RCPlugEchoEfPriv*)
da
;

195 
gboޗn
 
ag
;

196 if(
da
==
NULL
) ;

197 
ag
 = 
	`gtk_togg_ai_g_aive
(
togg
);

198 if(
ag
)

199 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
iv
->
echo_wdow
));

201 
	`gtk_widg_hide
(
iv
->
echo_wdow
);

202 
	}
}

204 
	$rc_ug_echff_shutdown_cb
(
RCLibPlug
 *
ug
, 
gpor
 
da
)

206 
RCPlugEchoEfPrive
 *
iv
 = (RCPlugEchoEfPriv*)
da
;

207 if(
da
==
NULL
) ;

208 
	`rc_ug_echff_ve_cf
(
iv
);

209 
	}
}

211 
gboޗn
 
	$rc_ug_echff_ld
(
RCLibPlugDa
 *
ug
)

213 
RCPlugEchoEfPrive
 *
iv
 = &
echff_iv
;

214 
gboޗn
 
ag
;

215 
iv
->
echo_emt
 = 
	`g_emt_y_make
("audicho", 
NULL
);

216 
ag
 = 
	`rib_ce_ef_ug_add
(
iv
->
echo_emt
);

217 if(!
ag
)

219 
	`g_obje_uef
(
iv
->
echo_emt
);

220 
iv
->
echo_emt
 = 
NULL
;

222 
	`g_obje_t
(
iv
->
echo_emt
, "max-day", 1 * 
GST_SECOND
,

223 "day", 
iv
->
day
, "edback",riv->
edback
, "intensity",

224 
iv
->
nsy
, 
NULL
);

225 
	`rc_ug_echff_wdow_
(
iv
);

226 
iv
->
ai
 = 
	`gtk_togg_ai_w
("RC2ViewPluginEchoEffect",

227 
	`_
("Echo Effect"), _("Show/hidechoudioffect "

228 "cfigui wdow"), 
NULL
);

229 
iv
->
mu_id
 = 
	`rc_ui_mu_add_mu_ai
(
	`GTK_ACTION
riv->
ai
),

231 "RC2VwPlugEchoEf", 
TRUE
);

232 
	`g_sigl_c
(
iv
->
ai
, "toggled",

233 
	`G_CALLBACK
(
rc_ug_echff_vw_mu_toggd
), 
iv
);

234  
ag
;

235 
	}
}

237 
gboޗn
 
	$rc_ug_echff_ud
(
RCLibPlugDa
 *
ug
)

239 
RCPlugEchoEfPrive
 *
iv
 = &
echff_iv
;

240 if(
iv
->
mu_id
>0)

242 
	`rc_ui_mu_move_mu_ai
(
	`GTK_ACTION
(
iv
->
ai
),

243 
iv
->
mu_id
);

244 
	`g_obje_uef
(
iv
->
ai
);

246 if(
iv
->
echo_wdow
!=
NULL
)

248 
	`gtk_widg_deroy
(
iv
->
echo_wdow
);

249 
iv
->
echo_wdow
 = 
NULL
;

251 if(
iv
->
echo_emt
!=
NULL
)

253 
	`rib_ce_ef_ug_move
(
iv
->
echo_emt
);

254 
iv
->
echo_emt
 = 
NULL
;

256  
TRUE
;

257 
	}
}

259 
gboޗn
 
	$rc_ug_echff_
(
RCLibPlugDa
 *
ug
)

261 
RCPlugEchoEfPrive
 *
iv
 = &
echff_iv
;

262 
iv
->
day
 = 1;

263 
iv
->
keyfe
 = 
	`rib_ug_g_keyfe
();

264 
	`rc_ug_echff_ld_cf
(
iv
);

265 
iv
->
shutdown_id
 = 
	`rib_ug_sigl_c
("shutdown",

266 
	`G_CALLBACK
(
rc_ug_echff_shutdown_cb
), 
iv
);

267  
TRUE
;

268 
	}
}

270 
	$rc_ug_echff_deroy
(
RCLibPlugDa
 *
ug
)

272 
RCPlugEchoEfPrive
 *
iv
 = &
echff_iv
;

273 if(
iv
->
shutdown_id
>0)

275 
	`rib_ug_sigl_disc
(
iv
->
shutdown_id
);

276 
iv
->
shutdown_id
 = 0;

278 
	}
}

280 
RCLibPlugInfo
 
	grlug_fo
 = {

281 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

282 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

283 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

284 .
	gty
 = 
RCLIB_PLUGIN_TYPE_MODULE
,

285 .
	gid
 = 
ECHOEFF_ID
,

286 .
	gme
 = 
N_
("Echo Audio Effect"),

287 .
	gvsi
 = "0.1",

288 .
	gdesti
 = 
N_
("Addchoudioffect inhe musiclayback."),

289 .
	gauth
 = "SuperCat",

290 .
	ghomage
 = "http://supercat-lab.org/",

291 .
	gld
 = 
rc_ug_echff_ld
,

292 .
	gud
 = 
rc_ug_echff_ud
,

293 .
	gcfigu
 = 
NULL
,

294 .
	gderoy
 = 
rc_ug_echff_deroy
,

295 .
	gexa_fo
 = 
NULL


298 
RCPLUGIN_INIT_PLUGIN
(
rlug_fo
.
id
, 
rc_ug_echff_
,cplugin_info);

	@plugins/extra/karaeffect.c

26 
	~<glib.h
>

27 
	~<gio/gio.h
>

28 
	~<gtk/gtk.h
>

29 
	~<rib.h
>

30 
	~<rc-ui-mu.h
>

32 
	#KARAEFF_ID
 "rc2-tive-kaoke-ef"

	)

34 
	sRCPlugKaEfPrive


36 
GEmt
 *
	mka_emt
;

37 
GtkToggAi
 *
	mai
;

38 
gut
 
	mmu_id
;

39 
GtkWidg
 *
	mka_wdow
;

40 
GtkWidg
 *
	mfr_bd_s
;

41 
GtkWidg
 *
	mfr_width_s
;

42 
GtkWidg
 *
	mv_s
;

43 
GtkWidg
 *
	mmo_v_s
;

44 
gt
 
	mfr_bd
;

45 
gt
 
	mfr_width
;

46 
gt
 
	mv
;

47 
gt
 
	mmo_v
;

48 
gulg
 
	mshutdown_id
;

49 
GKeyFe
 *
	mkeyfe
;

50 }
	tRCPlugKaEfPrive
;

52 
RCPlugKaEfPrive
 
	gkff_iv
 = {0};

54 
	$rc_ug_kff_ld_cf
(
RCPlugKaEfPrive
 *
iv
)

56 
gdoub
 
dvue
;

57 
GE
 *
r
 = 
NULL
;

58 if(
iv
==
NULL
 ||riv->
keyfe
==NULL) ;

59 
dvue
 = 
	`g_key_fe_g_doub
(
iv
->
keyfe
, 
KARAEFF_ID
, "FilterBand",

60 &
r
);

61 if(
r
==
NULL
 && 
dvue
>=0.0 && dvalue<=441.0)

62 
iv
->
fr_bd
 = 
dvue
;

63 if(
r
!=
NULL
)

65 
	`g_r_
(
r
);

66 
r
 = 
NULL
;

68 
dvue
 = 
	`g_key_fe_g_doub
(
iv
->
keyfe
, 
KARAEFF_ID
, "FilterWidth",

69 &
r
);

70 if(
r
==
NULL
 && 
dvue
>=0.0 && dvalue<=100.0)

71 
iv
->
fr_width
 = 
dvue
;

72 if(
r
!=
NULL
)

74 
	`g_r_
(
r
);

75 
r
 = 
NULL
;

77 
dvue
 = 
	`g_key_fe_g_doub
(
iv
->
keyfe
, 
KARAEFF_ID
, "Level",

78 &
r
);

79 if(
r
==
NULL
 && 
dvue
>=0.0 && dvalue<=1.0)

80 
iv
->
v
 = 
dvue
;

81 if(
r
!=
NULL
)

83 
	`g_r_
(
r
);

84 
r
 = 
NULL
;

86 
dvue
 = 
	`g_key_fe_g_doub
(
iv
->
keyfe
, 
KARAEFF_ID
, "MonoLevel",

87 &
r
);

88 if(
r
==
NULL
 && 
dvue
>=0.0 && dvalue<=1.0)

89 
iv
->
mo_v
 = 
dvue
;

90 if(
r
!=
NULL
)

92 
	`g_r_
(
r
);

93 
r
 = 
NULL
;

95 
	}
}

97 
	$rc_ug_kff_ve_cf
(
RCPlugKaEfPrive
 *
iv
)

99 if(
iv
==
NULL
 ||riv->
keyfe
==NULL) ;

100 
	`g_key_fe_t_doub
(
iv
->
keyfe
, 
KARAEFF_ID
, "FilterBand",

101 (
gdoub
)
iv
->
fr_bd
);

102 
	`g_key_fe_t_doub
(
iv
->
keyfe
, 
KARAEFF_ID
, "FilterWidth",

103 (
gdoub
)
iv
->
fr_width
);

104 
	`g_key_fe_t_doub
(
iv
->
keyfe
, 
KARAEFF_ID
, "Level",

105 (
gdoub
)
iv
->
v
);

106 
	`g_key_fe_t_doub
(
iv
->
keyfe
, 
KARAEFF_ID
, "MonoLevel",

107 (
gdoub
)
iv
->
mo_v
);

108 
	}
}

110 
	$rc_ug_kff_fb_s_chged_cb
(
GtkRge
 *
nge
,

111 
gpor
 
da
)

113 
RCPlugKaEfPrive
 *
iv
 = (RCPlugKaEfPriv*)
da
;

114 
gdoub
 
vue
 = 0.0;

115 if(
da
==
NULL
) ;

116 
vue
 = 
	`gtk_nge_g_vue
(
nge
);

117 
	`g_obje_t
(
iv
->
ka_emt
, "fr-bd", (
gt
)
vue
, 
NULL
);

118 
iv
->
fr_bd
 = 
vue
;

119 
	}
}

121 
	$rc_ug_kff_fw_s_chged_cb
(
GtkRge
 *
nge
,

122 
gpor
 
da
)

124 
RCPlugKaEfPrive
 *
iv
 = (RCPlugKaEfPriv*)
da
;

125 
gdoub
 
vue
 = 0.0;

126 if(
da
==
NULL
) ;

127 
vue
 = 
	`gtk_nge_g_vue
(
nge
);

128 
	`g_obje_t
(
iv
->
ka_emt
, "fr-width", (
gt
)
vue
, 
NULL
);

129 
iv
->
fr_width
 = 
vue
;

130 
	}
}

132 
	$rc_ug_kff_v_s_chged_cb
(
GtkRge
 *
nge
,

133 
gpor
 
da
)

135 
RCPlugKaEfPrive
 *
iv
 = (RCPlugKaEfPriv*)
da
;

136 
gdoub
 
vue
 = 0.0;

137 if(
da
==
NULL
) ;

138 
vue
 = 
	`gtk_nge_g_vue
(
nge
);

139 
	`g_obje_t
(
iv
->
ka_emt
, "v", (
gt
)
vue
, 
NULL
);

140 
iv
->
v
 = 
vue
;

141 
	}
}

143 
	$rc_ug_kff_mo_v_s_chged_cb
(
GtkRge
 *
nge
,

144 
gpor
 
da
)

146 
RCPlugKaEfPrive
 *
iv
 = (RCPlugKaEfPriv*)
da
;

147 
gdoub
 
vue
 = 0.0;

148 if(
da
==
NULL
) ;

149 
vue
 = 
	`gtk_nge_g_vue
(
nge
);

150 
	`g_obje_t
(
iv
->
ka_emt
, "mo-v", (
gt
)
vue
, 
NULL
);

151 
iv
->
mo_v
 = 
vue
;

152 
	}
}

154 
gboޗn
 
	$rc_ug_kff_wdow_de_evt_cb
(

155 
GtkWidg
 *
widg
, 
GdkEvt
 *
evt
, 
gpor
 
da
)

157 
RCPlugKaEfPrive
 *
iv
 = (RCPlugKaEfPriv*)
da
;

158 if(
da
==
NULL
 
TRUE
;

159 
	`gtk_togg_ai_t_aive
(
iv
->
ai
, 
FALSE
);

160  
TRUE
;

161 
	}
}

163 
le
 
	$rc_ug_kff_wdow_
(

164 
RCPlugKaEfPrive
 *
iv
)

166 
GtkWidg
 *
fr_bd_b
, *
fr_width_b
;

167 
GtkWidg
 *
v_b
, *
mo_v_b
;

168 
GtkWidg
 *
ka_ma_grid
;

169 if(
iv
->
ka_wdow
!=
NULL
) ;

170 
iv
->
ka_wdow
 = 
	`gtk_wdow_w
(
GTK_WINDOW_TOPLEVEL
);

171 
fr_bd_b
 = 
	`gtk_b_w
(
	`_
("Filter Band"));

172 
fr_width_b
 = 
	`gtk_b_w
(
	`_
("Filter Width"));

173 
v_b
 = 
	`gtk_b_w
(
	`_
("Level"));

174 
mo_v_b
 = 
	`gtk_b_w
(
	`_
("Mono Level"));

175 
iv
->
fr_bd_s
 = 
	`gtk_s_w_wh_nge
(

176 
GTK_ORIENTATION_HORIZONTAL
, 0, 441.0, 1);

177 
iv
->
fr_width_s
 = 
	`gtk_s_w_wh_nge
(

178 
GTK_ORIENTATION_HORIZONTAL
, 0, 100.0, 1);

179 
iv
->
v_s
 = 
	`gtk_s_w_wh_nge
(

180 
GTK_ORIENTATION_HORIZONTAL
, 0, 1.0, 0.01);

181 
iv
->
mo_v_s
 = 
	`gtk_s_w_wh_nge
(

182 
GTK_ORIENTATION_HORIZONTAL
, 0, 1.0, 0.01);

183 
	`g_obje_t
(
iv
->
ka_wdow
, "t", 
	`_
("Karaoke Audio Effect"),

184 "wdow-posi", 
GTK_WIN_POS_CENTER
, "has-size-gr", 
FALSE
,

185 "ty-ht", 
GDK_WINDOW_TYPE_HINT_DIALOG
, 
NULL
);

186 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
fr_bd_s
),

187 (
gdoub
)
iv
->
fr_bd
);

188 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
fr_width_s
),

189 (
gdoub
)
iv
->
fr_width
);

190 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
v_s
),

191 (
gdoub
)
iv
->
v
);

192 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
mo_v_s
),

193 (
gdoub
)
iv
->
mo_v
);

194 
	`gtk_widg_t_hexnd
(
iv
->
fr_bd_s
, 
TRUE
);

195 
	`gtk_widg_t_hexnd
(
iv
->
fr_width_s
, 
TRUE
);

196 
	`gtk_widg_t_hexnd
(
iv
->
v_s
, 
TRUE
);

197 
	`gtk_widg_t_hexnd
(
iv
->
mo_v_s
, 
TRUE
);

198 
	`gtk_s_t_dw_vue
(
	`GTK_SCALE
(
iv
->
fr_bd_s
), 
TRUE
);

199 
	`gtk_s_t_dw_vue
(
	`GTK_SCALE
(
iv
->
fr_width_s
), 
TRUE
);

200 
	`gtk_s_t_dw_vue
(
	`GTK_SCALE
(
iv
->
v_s
), 
TRUE
);

201 
	`gtk_s_t_dw_vue
(
	`GTK_SCALE
(
iv
->
mo_v_s
), 
TRUE
);

202 
	`gtk_s_t_vue_pos
(
	`GTK_SCALE
(
iv
->
fr_bd_s
),

203 
GTK_POS_RIGHT
);

204 
	`gtk_s_t_vue_pos
(
	`GTK_SCALE
(
iv
->
fr_width_s
),

205 
GTK_POS_RIGHT
);

206 
	`gtk_s_t_vue_pos
(
	`GTK_SCALE
(
iv
->
v_s
),

207 
GTK_POS_RIGHT
);

208 
	`gtk_s_t_vue_pos
(
	`GTK_SCALE
(
iv
->
mo_v_s
),

209 
GTK_POS_RIGHT
);

210 
ka_ma_grid
 = 
	`gtk_grid_w
();

211 
	`gtk_grid_t_cumn_acg
(
	`GTK_GRID
(
ka_ma_grid
), 3);

212 
	`gtk_grid_t_row_acg
(
	`GTK_GRID
(
ka_ma_grid
), 4);

213 
	`gtk_grid_ch
(
	`GTK_GRID
(
ka_ma_grid
), 
fr_bd_b
,

215 
	`gtk_grid_ch
(
	`GTK_GRID
(
ka_ma_grid
), 
iv
->
fr_bd_s
,

217 
	`gtk_grid_ch
(
	`GTK_GRID
(
ka_ma_grid
), 
fr_width_b
,

219 
	`gtk_grid_ch
(
	`GTK_GRID
(
ka_ma_grid
), 
iv
->
fr_width_s
,

221 
	`gtk_grid_ch
(
	`GTK_GRID
(
ka_ma_grid
), 
v_b
, 0, 2, 1, 1);

222 
	`gtk_grid_ch
(
	`GTK_GRID
(
ka_ma_grid
), 
iv
->
v_s
, 1, 2,

224 
	`gtk_grid_ch
(
	`GTK_GRID
(
ka_ma_grid
), 
mo_v_b
, 0, 3, 1, 1);

225 
	`gtk_grid_ch
(
	`GTK_GRID
(
ka_ma_grid
), 
iv
->
mo_v_s
, 1, 3,

227 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
ka_wdow
), 
ka_ma_grid
);

228 
	`gtk_widg_t_size_que
(
iv
->
ka_wdow
, 300, 150);

229 
	`gtk_widg_show_l
(
ka_ma_grid
);

231 
	`g_sigl_c
(
iv
->
ka_wdow
, "delete-event",

232 
	`G_CALLBACK
(
rc_ug_kff_wdow_de_evt_cb
), 
iv
);

233 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
fr_bd_s
), "value-changed",

234 
	`G_CALLBACK
(
rc_ug_kff_fb_s_chged_cb
), 
iv
);

235 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
fr_width_s
), "value-changed",

236 
	`G_CALLBACK
(
rc_ug_kff_fw_s_chged_cb
), 
iv
);

237 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
v_s
), "value-changed",

238 
	`G_CALLBACK
(
rc_ug_kff_v_s_chged_cb
), 
iv
);

239 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
mo_v_s
), "value-changed",

240 
	`G_CALLBACK
(
rc_ug_kff_mo_v_s_chged_cb
), 
iv
);

241 
	}
}

243 
	$rc_ug_kff_vw_mu_toggd
(
GtkToggAi
 *
togg
,

244 
gpor
 
da
)

246 
RCPlugKaEfPrive
 *
iv
 = (RCPlugKaEfPriv*)
da
;

247 
gboޗn
 
ag
;

248 if(
da
==
NULL
) ;

249 
ag
 = 
	`gtk_togg_ai_g_aive
(
togg
);

250 if(
ag
)

251 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
iv
->
ka_wdow
));

253 
	`gtk_widg_hide
(
iv
->
ka_wdow
);

254 
	}
}

256 
	$rc_ug_kff_shutdown_cb
(
RCLibPlug
 *
ug
, 
gpor
 
da
)

258 
RCPlugKaEfPrive
 *
iv
 = (RCPlugKaEfPriv*)
da
;

259 if(
da
==
NULL
) ;

260 
	`rc_ug_kff_ve_cf
(
iv
);

261 
	}
}

263 
gboޗn
 
	$rc_ug_kff_ld
(
RCLibPlugDa
 *
ug
)

265 
RCPlugKaEfPrive
 *
iv
 = &
kff_iv
;

266 
gboޗn
 
ag
;

267 
iv
->
ka_emt
 = 
	`g_emt_y_make
("audiokaoke", 
NULL
);

268 
ag
 = 
	`rib_ce_ef_ug_add
(
iv
->
ka_emt
);

269 if(!
ag
)

271 
	`g_obje_uef
(
iv
->
ka_emt
);

272 
iv
->
ka_emt
 = 
NULL
;

274 
	`g_obje_t
(
iv
->
ka_emt
, "fr-bd",riv->
fr_bd
,

275 "fr-width", 
iv
->
fr_width
, "v",riv->
v
,

276 "mo-v", 
iv
->
mo_v
, 
NULL
);

277 
	`rc_ug_kff_wdow_
(
iv
);

278 
iv
->
ai
 = 
	`gtk_togg_ai_w
("RC2ViewPluginKaraokeEffect",

279 
	`_
("Karaoke Effect"), _("Show/hide karaokeudioffect "

280 "cfigui wdow"), 
NULL
);

281 
iv
->
mu_id
 = 
	`rc_ui_mu_add_mu_ai
(
	`GTK_ACTION
riv->
ai
),

283 "RC2VwPlugKaokeEf", 
TRUE
);

284 
	`g_sigl_c
(
iv
->
ai
, "toggled",

285 
	`G_CALLBACK
(
rc_ug_kff_vw_mu_toggd
), 
iv
);

286  
ag
;

287 
	}
}

289 
gboޗn
 
	$rc_ug_kff_ud
(
RCLibPlugDa
 *
ug
)

291 
RCPlugKaEfPrive
 *
iv
 = &
kff_iv
;

292 if(
iv
->
mu_id
>0)

294 
	`rc_ui_mu_move_mu_ai
(
	`GTK_ACTION
(
iv
->
ai
),

295 
iv
->
mu_id
);

296 
	`g_obje_uef
(
iv
->
ai
);

298 if(
iv
->
ka_wdow
!=
NULL
)

300 
	`gtk_widg_deroy
(
iv
->
ka_wdow
);

301 
iv
->
ka_wdow
 = 
NULL
;

303 if(
iv
->
ka_emt
!=
NULL
)

305 
	`rib_ce_ef_ug_move
(
iv
->
ka_emt
);

306 
iv
->
ka_emt
 = 
NULL
;

308  
TRUE
;

309 
	}
}

311 
gboޗn
 
	$rc_ug_kff_
(
RCLibPlugDa
 *
ug
)

313 
RCPlugKaEfPrive
 *
iv
 = &
kff_iv
;

314 
iv
->
fr_bd
 = 220;

315 
iv
->
fr_width
 = 100;

316 
iv
->
v
 = 1;

317 
iv
->
mo_v
 = 1;

318 
iv
->
keyfe
 = 
	`rib_ug_g_keyfe
();

319 
	`rc_ug_kff_ld_cf
(
iv
);

320 
iv
->
shutdown_id
 = 
	`rib_ug_sigl_c
("shutdown",

321 
	`G_CALLBACK
(
rc_ug_kff_shutdown_cb
), 
iv
);

322  
TRUE
;

323 
	}
}

325 
	$rc_ug_kff_deroy
(
RCLibPlugDa
 *
ug
)

327 
RCPlugKaEfPrive
 *
iv
 = &
kff_iv
;

328 if(
iv
->
shutdown_id
>0)

330 
	`rib_ug_sigl_disc
(
iv
->
shutdown_id
);

331 
iv
->
shutdown_id
 = 0;

333 
	}
}

335 
RCLibPlugInfo
 
	grlug_fo
 = {

336 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

337 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

338 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

339 .
	gty
 = 
RCLIB_PLUGIN_TYPE_MODULE
,

340 .
	gid
 = 
KARAEFF_ID
,

341 .
	gme
 = 
N_
("Karaoke Audio Effect"),

342 .
	gvsi
 = "0.1",

343 .
	gdesti
 = 
N_
("Remove voice fromhe music."),

344 .
	gauth
 = "SuperCat",

345 .
	ghomage
 = "http://supercat-lab.org/",

346 .
	gld
 = 
rc_ug_kff_ld
,

347 .
	gud
 = 
rc_ug_kff_ud
,

348 .
	gcfigu
 = 
NULL
,

349 .
	gderoy
 = 
rc_ug_kff_deroy
,

350 .
	gexa_fo
 = 
NULL


353 
RCPLUGIN_INIT_PLUGIN
(
rlug_fo
.
id
, 
rc_ug_kff_
,cplugin_info);

	@plugins/extra/lrccrawler-common.c

26 
	~<glib/gdio.h
>

27 
	~<dlib.h
>

28 
	~<rg.h
>

29 
	~"cawr-comm.h
"

31 
gboޗn
 
	gawr_dowd_nl_ag
 = 
FALSE
;

32 
gt
 
	gawr_oxy_ty
 = -1;

33 
gch
 *
	gawr_oxy_addss
 = 
NULL
;

34 
gut16
 
	gawr_oxy_pt
 = 0;

35 
gch
 *
	gawr_oxy_uwd
 = 
NULL
;

37 
size_t
 
	$rc_cawr_comm_dowd_wre_cb
(*
bufr
,

38 
size_t
 
size
, size_
nmemb
, *
urda
)

40 
size_t
 
t_size
;

41 if(
awr_dowd_nl_ag
)  0;

42 
t_size
 = 
	`fwre
(
bufr
, 
size
, 
nmemb
, *(
FILE
 **)
urda
);

43  
t_size
;

44 
	}
}

46 
gboޗn
 
	$rc_cawr_comm_dowd_fe
(cڡ 
gch
 *
u
,

47 cڡ 
gch
 *
fe
)

49 
gboޗn
 
ag
 = 
FALSE
;

50 
CURL
 *
cu
;

51 
CURLcode
 
s
 = 0;

52 
gdoub
 
ngth
 = 0;

53 
FILE
 *

;

54 if(
fe
!=
NULL
)

55 

 = 
	`g_fݒ
(
fe
, "w");

57  
FALSE
;

58 if(

==
NULL
 
FALSE
;

59 
cu
 = 
	`cu_sy_
();

60 if(
cu
==
NULL
)

62 
	`fo
(

);

63  
FALSE
;

65 
awr_dowd_nl_ag
 = 
FALSE
;

66 
	`cu_sy_tt
(
cu
, 
CURLOPT_URL
, 
u
);

67 if(
awr_oxy_addss
!=
NULL
)

69 
	`cu_sy_tt
(
cu
, 
CURLOPT_PROXYTYPE
, 
awr_oxy_ty
);

70 
	`cu_sy_tt
(
cu
, 
CURLOPT_PROXY
, 
awr_oxy_addss
);

71 
	`cu_sy_tt
(
cu
, 
CURLOPT_PROXYPORT
, 
awr_oxy_pt
);

72 
	`cu_sy_tt
(
cu
, 
CURLOPT_PROXYUSERPWD
, 
awr_oxy_uwd
);

74 
	`cu_sy_tt
(
cu
, 
CURLOPT_FOLLOWLOCATION
, 1);

75 
	`cu_sy_tt
(
cu
, 
CURLOPT_USERAGENT
, "Mozilla/5.0 "

77 
	`cu_sy_tt
(
cu
, 
CURLOPT_WRITEFUNCTION
,

78 &
rc_cawr_comm_dowd_wre_cb
);

79 
	`cu_sy_tt
(
cu
, 
CURLOPT_WRITEDATA
, &

);

80 
s
 = 
	`cu_sy_rfm
(
cu
);

81 if(
s
==
CURLE_OK
)

83 
s
 = 
	`cu_sy_gfo
(
cu
, 
CURLINFO_CONTENT_LENGTH_DOWNLOAD
,

84 &
ngth
);

85 
ag
 = 
TRUE
;

87 
	`fo
(

);

88 
	`cu_sy_nup
(
cu
);

89  
ag
;

90 
	}
}

92 
gboޗn
 
	$rc_cawr_comm_po_da
(cڡ 
gch
 *
u
, cڡ gch *
r
,

93 cڡ 
gch
 *
ur_agt
, cڡ gch *
po_da
, 
gsize
 
po_n
,

94 cڡ 
gch
 *
fe
)

96 
gboޗn
 
ag
 = 
FALSE
;

97 
CURL
 *
cu
;

98 
CURLcode
 
s
 = 0;

99 
gdoub
 
ngth
 = 0;

100 
FILE
 *

;

101 if(
fe
!=
NULL
)

102 

 = 
	`g_fݒ
(
fe
, "w");

104  
FALSE
;

105 if(

==
NULL
 
FALSE
;

106 
cu
 = 
	`cu_sy_
();

107 if(
cu
==
NULL
)

109 
	`fo
(

);

110  
FALSE
;

112 
awr_dowd_nl_ag
 = 
FALSE
;

113 
	`cu_sy_tt
(
cu
, 
CURLOPT_URL
, 
u
);

114 if(
awr_oxy_addss
!=
NULL
)

116 
	`cu_sy_tt
(
cu
, 
CURLOPT_PROXYTYPE
, 
awr_oxy_ty
);

117 
	`cu_sy_tt
(
cu
, 
CURLOPT_PROXY
, 
awr_oxy_addss
);

118 
	`cu_sy_tt
(
cu
, 
CURLOPT_PROXYPORT
, 
awr_oxy_pt
);

119 
	`cu_sy_tt
(
cu
, 
CURLOPT_PROXYUSERPWD
, 
awr_oxy_uwd
);

121 if(
r
!=
NULL
)

122 
	`cu_sy_tt
(
cu
, 
CURLOPT_REFERER
, 
r
);

123 if(
ur_agt
!=
NULL
)

124 
	`cu_sy_tt
(
cu
, 
CURLOPT_USERAGENT
, 
ur_agt
);

125 if(
po_da
!=
NULL
)

127 
	`cu_sy_tt
(
cu
, 
CURLOPT_POSTFIELDS
, 
po_da
);

128 
	`cu_sy_tt
(
cu
, 
CURLOPT_POSTFIELDSIZE
, 
po_n
);

130 
	`cu_sy_tt
(
cu
, 
CURLOPT_WRITEFUNCTION
,

131 &
rc_cawr_comm_dowd_wre_cb
);

132 
	`cu_sy_tt
(
cu
, 
CURLOPT_WRITEDATA
, &

);

133 
s
 = 
	`cu_sy_rfm
(
cu
);

134 if(
s
==
CURLE_OK
)

136 
s
 = 
	`cu_sy_gfo
(
cu
, 
CURLINFO_CONTENT_LENGTH_DOWNLOAD
,

137 &
ngth
);

138 
ag
 = 
TRUE
;

140 
	`fo
(

);

141 
	`cu_sy_nup
(
cu
);

142  
ag
;

143 
	}
}

145 
	$rc_cawr_comm_ݔi_nl
()

147 if(!
awr_dowd_nl_ag
)

148 
awr_dowd_nl_ag
 = 
TRUE
;

149 
	}
}

151 
	$rc_cawr_comm_t_oxy
(
gt
 
ty
, cڡ 
gch
 *
addr
, 
gut16
 
pt
,

152 cڡ 
gch
 *
uame
, cڡ gch *
sswd
)

154 if(
awr_oxy_addss
!=
NULL

	`g_
(crawler_proxy_address);

155 if(
awr_oxy_uwd
!=
NULL

	`g_
(crawler_proxy_userpwd);

156 
awr_oxy_addss
 = 
NULL
;

157 
awr_oxy_uwd
 = 
NULL
;

158 if(
addr
==
NULL
)

160 
awr_oxy_ty
 = -1;

161 
awr_oxy_pt
 = 0;

164 
awr_oxy_ty
 = 
ty
;

165 
awr_oxy_addss
 = 
	`g_rdup
(
addr
);

166 
awr_oxy_pt
 = 
pt
;

167 if(
uame
!=
NULL
 && 
sswd
!=NULL)

168 
awr_oxy_uwd
 = 
	`g_rdup_tf
("%s:%s", 
uame
, 
sswd
);

169 
	}
}

	@plugins/extra/lrccrawler-common.h

26 #ide
HAVE_RC_CRAWLER_COMMON


27 
	#HAVE_RC_CRAWLER_COMMON


	)

29 
	~<glib.h
>

30 
	~<cu/cu.h
>

31 
	~<gmodu.h
>

33 
	#RC_LRCCRAWLER_MODULE_MAGIC_NUMBER
 0x03120405

	)

35 
	#RC_LRCCRAWLER_INIT_MODULE
(
modume
, 
func
, 
modu˚fo
) \

36 
G_MODULE_EXPORT
 
gboޗn
 
	`rc_cawr_modu_
( \

37 
RCLyricCwrModu
 *
modu
) \

39 
modu
->
fo
 = &(
modu˚fo
); \

40  
	`func
(
modu
); \

41 }

	)

43 
	sRCLyricCwrModuInfo


45 
gut32
 
	mmagic
;

46 cڡ 
gch
 *
	mme
;

47 cڡ 
gch
 *
	mdesc
;

48 cڡ 
gch
 *
	mauth
;

49 cڡ 
gch
 *
	mvsi
;

50 
	mGSLi
 *(*
	mch_g_u_li
)(cڡ 
gch
 *
	mt
, cڡ gch *
	mti
);

51 
gboޗn
 (*
dowd_fe
)(cڡ 
gch
 *
	mu
, cڡ gch *
	mfe
);

52 }
	tRCLyricCwrModuInfo
;

54 
	sRCLyricCwrModu


56 
gboޗn
 
	mlded
;

57 
GModu
 *
	mhd
;

58 
gch
 *
	mth
;

59 
RCLyricCwrModuInfo
 *
	mfo
;

60 }
	tRCLyricCwrModu
;

62 
	sRCLyricCwrSrchDa


64 
gch
 *
	mt
;

65 
gch
 *
	mti
;

66 
gch
 *
	mbum
;

67 
gch
 *
	mu
;

68 }
	tRCLyricCwrSrchDa
;

70 
gboޗn
 
rc_cawr_comm_dowd_fe
(cڡ 
gch
 *
u
,

71 cڡ 
gch
 *
fe
);

72 
gboޗn
 
rc_cawr_comm_po_da
(cڡ 
gch
 *
u
, cڡ gch *
r
,

73 cڡ 
gch
 *
ur_agt
, cڡ gch *
po_da
, 
gsize
 
po_n
,

74 cڡ 
gch
 *
fe
);

75 
rc_cawr_comm_ݔi_nl
();

76 
rc_cawr_comm_t_oxy
(
gt
 
ty
, cڡ 
gch
 *
addr
, 
gut16
 
pt
,

77 cڡ 
gch
 *
uame
, cڡ gch *
sswd
);

	@plugins/extra/lrccrawler-lrc123.c

26 
	~<rg.h
>

27 
	~<dlib.h
>

28 
	~<glib.h
>

29 
	~<cu/cu.h
>

30 
	~"cawr-comm.h
"

32 cڡ 
gch
 *
	gch_ba_u
 = "http://www.lrc123.com/?keyword=";

34 
GSLi
 *
	$rc_awr_modu_g_u_li
(cڡ 
gch
 *
t
,

35 cڡ 
gch
 *
ti
)

37 
gboޗn
 
ag
;

38 
gch
 *
tmp_fe
;

39 
gch
 *
xml_da
;

40 
gch
 *
ch_u
;

41 
gsize
 
xml_n
;

42 
gch
 *
esc_t
 = 
NULL
, *
esc_ti
 = NULL, *
u
 = NULL;

43 
GSLi
 *
c_u_li
 = 
NULL
;

44 
RCLyricCwrSrchDa
 *
c_u_da
;

45 
GRegex
 *
down_gex
, *
t_gex
, *
ti_gex
;

46 
GMchInfo
 *
down_mch_fo
, *
t_mch_fo
, *
ti_mch_fo
;

47 if(
t
==
NULL
 && 
ti
==NULL)  NULL;

48 if(
t
!=
NULL
)

49 
esc_t
 = 
	`g_uri_es_rg
(
t
, 
NULL
, 
FALSE
);

50 if(
ti
!=
NULL
)

51 
esc_ti
 = 
	`g_uri_es_rg
(
ti
, 
NULL
, 
FALSE
);

52 if(
esc_t
!=
NULL
 && 
esc_ti
!=NULL)

54 
ch_u
 = 
	`g_rct
(
ch_ba_u
, 
esc_t
, "%20",

55 
esc_ti
, "&fld", 
NULL
);

57 if(
esc_t
!=
NULL
)

58 
ch_u
 = 
	`g_rct
(
ch_ba_u
, 
esc_t
,

59 "&fld=sg", 
NULL
);

61 
ch_u
 = 
	`g_rct
(
ch_ba_u
, 
esc_ti
,

62 "&fld=sg", 
NULL
);

63 if(
esc_t
!=
NULL

	`g_
(esc_title);

64 if(
esc_ti
!=
NULL

	`g_
(esc_artist);

65 
tmp_fe
 = 
	`g_bud_fame
(
	`g_g_tmp_d
(), "RC-LRC123Web.tmp", 
NULL
);

66 
ag
 = 
	`rc_cawr_comm_dowd_fe
(
ch_u
, 
tmp_fe
);

67 
	`g_
(
ch_u
);

68 if(!
ag
)

70 
	`g_
(
tmp_fe
);

71  
NULL
;

73 
ag
 = 
	`g_fe_g_cڋs
(
tmp_fe
, &
xml_da
, &
xml_n
, 
NULL
);

74 
	`g_
(
tmp_fe
);

75 if(!
ag
 
NULL
;

76 
down_gex
 = 
	`g_gex_w
("(<a href=\"http://www.lrc123.com/download/"

77 "c/)[^\"]+", 
G_REGEX_MULTILINE
, 0, 
NULL
);

78 
t_gex
 = 
	`g_gex_w
("(field=song&keyword=)[^\"]+",

79 
G_REGEX_MULTILINE
, 0, 
NULL
);

80 
ti_gex
 = 
	`g_gex_w
("(field=singer&keyword=)[^\"]+",

81 
G_REGEX_MULTILINE
, 0, 
NULL
);

82 
	`g_gex_mch
(
down_gex
, 
xml_da
, 0, &
down_mch_fo
);

83 
	`g_gex_mch
(
t_gex
, 
xml_da
, 0, &
t_mch_fo
);

84 
	`g_gex_mch
(
ti_gex
, 
xml_da
, 0, &
ti_mch_fo
);

85 
	`g_mch_fo_mches
(
down_mch_fo
))

87 
esc_t
 = 
NULL
;

88 
esc_ti
 = 
NULL
;

89 
u
 = 
	`g_mch_fo_tch
(
down_mch_fo
, 0);

90 
	`g_mch_fo_xt
(
down_mch_fo
, 
NULL
);

91 if(
	`g_mch_fo_mches
(
t_mch_fo
))

93 
esc_t
 = 
	`g_mch_fo_tch
(
t_mch_fo
, 0);

94 
	`g_mch_fo_xt
(
t_mch_fo
, 
NULL
);

97 
esc_t
 = 
NULL
;

98 if(
	`g_mch_fo_mches
(
ti_mch_fo
))

100 
esc_ti
 = 
	`g_mch_fo_tch
(
ti_mch_fo
, 0);

101 
	`g_mch_fo_xt
(
ti_mch_fo
, 
NULL
);

104 
esc_ti
 = 
NULL
;

105 if(
u
==
NULL
)

107 if(
esc_t
!=
NULL

	`g_
(esc_title);

108 if(
esc_ti
!=
NULL

	`g_
(esc_artist);

111 
c_u_da
 = 
	`g_w0
(
RCLyricCwrSrchDa
, 1);

112 
c_u_da
->
u
 = 
	`g_rdup
(url+9);

113 
	`g_
(
u
);

114 if(
esc_t
!=
NULL
)

116 
c_u_da
->
t
 = 
	`g_uri_us_rg
(
esc_t
+19, 
NULL
);

117 
c_u_da
->
t
 = 
	`g_rdim
(lrc_url_data->title, "+", ' ');

118 
	`g_
(
esc_t
);

120 if(
esc_ti
!=
NULL
)

122 
c_u_da
->
ti
 = 
	`g_uri_us_rg
(
esc_ti
+21, 
NULL
);

123 
c_u_da
->
ti
 = 
	`g_rdim
(lrc_url_data->artist,

125 
	`g_
(
esc_ti
);

127 
c_u_li
 = 
	`g_i_nd
rc_u_li, 
c_u_da
);

129 
	`g_mch_fo_
(
down_mch_fo
);

130 
	`g_mch_fo_
(
t_mch_fo
);

131 
	`g_mch_fo_
(
ti_mch_fo
);

132 
	`g_gex_uef
(
down_gex
);

133 
	`g_gex_uef
(
t_gex
);

134 
	`g_gex_uef
(
ti_gex
);

135  
c_u_li
;

136 
	}
}

138 
gboޗn
 
	$rc_awr_modu_dowd_fe
(cڡ 
gch
 *
u
,

139 cڡ 
gch
 *
fe
)

141  
	`rc_cawr_comm_dowd_fe
(
u
, 
fe
);

142 
	}
}

144 
gboޗn
 
	$rc_awr_modu_
(
RCLyricCwrModu
 *
modu
)

146  
TRUE
;

147 
	}
}

149 
RCLyricCwrModuInfo
 
	grc_cawr_modu_fo
 = {

150 .
magic
 = 
RC_LRCCRAWLER_MODULE_MAGIC_NUMBER
,

151 .
	gme
 = "LRC123",

152 .
	gdesc
 = "Downloadyric from LRC123",

153 .
	gauth
 = "SuperCat",

154 .
	gvsi
 = "0.5",

155 .
	gch_g_u_li
 = 
rc_awr_modu_g_u_li
,

156 .
	gdowd_fe
 = 
rc_awr_modu_dowd_fe


159 
RC_LRCCRAWLER_INIT_MODULE
(
rc_cawr_modu_fo
.
me
,

160 
rc_awr_modu_
, 
rc_cawr_modu_fo
);

	@plugins/extra/lrccrawler.c

26 
	~<rg.h
>

27 
	~<dlib.h
>

28 
	~<glib.h
>

29 
	~<cu/cu.h
>

30 
	~<g/g.h
>

31 
	~<gtk/gtk.h
>

32 
	~<rib.h
>

33 
	~<rc-ui-mu.h
>

34 
	~"cawr-comm.h
"

36 #ifde
G_LOG_DOMAIN


37 #unde
G_LOG_DOMAIN


40 
	#G_LOG_DOMAIN
 "LyricCwr"

	)

41 
	#LRCCRAWLER_ID
 "rc2-tive-lyric-awr"

	)

45 
	mCRAWLER_RESULT_COLUMN_TITLE
,

46 
	mCRAWLER_RESULT_COLUMN_ARTIST
,

47 
	mCRAWLER_RESULT_COLUMN_URL
,

48 
	mCRAWLER_RESULT_COLUMN_LAST


53 
	mCRAWLER_SEARCH_COLUMN_TEXT
,

54 
	mCRAWLER_SEARCH_COLUMN_INDEX
,

55 
	mCRAWLER_SEARCH_COLUMN_MODULE
,

56 
	mCRAWLER_SEARCH_COLUMN_LAST


59 
	sRCPlugLyricCwrDownResuDa


61 
gboޗn
 
	msu
;

62 
gboޗn
 
	mauto_ag
;

63 
gch
 *
	mth
;

64 }
	tRCPlugLyricCwrDownResuDa
;

66 
	sRCPlugLyricCwrPrive


68 
GtkWidg
 *
	mch_wdow
;

69 
GtkWidg
 *
	mrv_combobox
;

70 
GtkWidg
 *
	msu_vw
;

71 
GtkWidg
 *
	mt_y
;

72 
GtkWidg
 *
	mti_y
;

73 
GtkWidg
 *
	mch_bu
;

74 
GtkWidg
 *
	mdowd_bu
;

75 
GtkWidg
 *
	mve_fe_y
;

76 
GtkWidg
 *
	msu_b
;

77 
GtkWidg
 *
	mauto_ch_checkbu
;

78 
GtkToggAi
 *
	mai
;

79 
GSLi
 *
	mawr_modu_li
;

80 
gboޗn
 
	mauto_ch
;

81 
gboޗn
 
	mauto_ch_mode
;

82 
RCLyricCwrModu
 *
	mcut_modu
;

83 
GThad
 *
	mch_thad
;

84 
GThad
 *
	mdowd_thad
;

85 
gulg
 
	mmissg_sigl
;

86 
gulg
 
	mshutdown_id
;

87 
gut
 
	mmu_id
;

88 
GKeyFe
 *
	mkeyfe
;

89 }
	tRCPlugLyricCwrPrive
;

91 
RCPlugLyricCwrPrive
 
	glyric_awr_iv
 = {0};

93 
gboޗn
 
	$rc_ug_cawr_ch_id_func
(
gpor
 
da
)

95 
GSLi
 *
li
 = 
da
;

96 
GSLi
 *
li_fܗch
;

97 
GtkTeIr
 

;

98 
gch
 *
tmp
;

99 
gut
 
n
 = 0;

100 
RCLyricCwrSrchDa
 *
ch_da
;

101 
GtkTePh
 *
th
;

102 
GtkLiSte
 *
e
 = 
NULL
;

103 
RCPlugLyricCwrPrive
 *
iv
 = &
lyric_awr_iv
;

104 if(
da
==
NULL
)

106 if(
iv
->
ch_wdow
!=
NULL
)

108 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

109 
	`_
("No matchedyric was found"));

110 
	`gtk_widg_t_nsive
(
iv
->
ch_bu
, 
TRUE
);

112  
FALSE
;

114 if(
iv
->
ch_wdow
!=
NULL
)

116 
e
 = 
	`GTK_LIST_STORE
(
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(

117 
iv
->
su_vw
)));

119 if(
e
!=
NULL

	`gtk_li_e_r
(store);

120 
li_fܗch
=
li
;li_fܗch!=
NULL
;

121 
li_fܗch
=
	`g_i_xt
(list_foreach))

123 
ch_da
 = 
li_fܗch
->
da
;

124 if(
ch_da
==
NULL
) ;

125 if(
e
!=
NULL
)

127 
	`gtk_li_e_nd
(
e
, &

);

128 
	`gtk_li_e_t
(
e
, &

, 
CRAWLER_RESULT_COLUMN_TITLE
,

129 
ch_da
->
t
, 
CRAWLER_RESULT_COLUMN_ARTIST
,

130 
ch_da
->
ti
, 
CRAWLER_RESULT_COLUMN_URL
,

131 
ch_da
->
u
, -1);

133 
	`g_
(
ch_da
->
u
);

134 
	`g_
(
ch_da
->
t
);

135 
	`g_
(
ch_da
->
ti
);

136 
	`g_
(
ch_da
);

137 
n
++;

139 
	`g_i_
(
li
);

140 if(
n
>0)

142 
tmp
 = 
	`g_rdup_tf
(
	`_
("Mchedyrinumb: %u"), 
n
);

143 if(
iv
->
ch_wdow
!=
NULL
)

144 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
), 
tmp
);

145 
	`g_
(
tmp
);

146 if(
iv
->
ch_wdow
!=
NULL
)

148 
	`gtk_widg_t_nsive
(
iv
->
ch_bu
, 
TRUE
);

149 
	`gtk_widg_t_nsive
(
iv
->
dowd_bu
, 
TRUE
);

150 
th
 = 
	`gtk__th_w_f
();

151 
	`gtk__vw_t_curs
(
	`GTK_TREE_VIEW
(
iv
->
su_vw
),

152 
th
, 
NULL
, 
FALSE
);

153 
	`gtk__th_
(
th
);

154 
	`gtk_togg_ai_t_aive
(
	`GTK_TOGGLE_ACTION
(
iv
->
ai
), 
TRUE
);

159 if(
iv
->
ch_wdow
!=
NULL
)

161 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

162 
	`_
("No matchedyric was found"));

165  
FALSE
;

166 
	}
}

168 
gboޗn
 
	$rc_ug_cawr_dowd_id_func
(
gpor
 
da
)

170 
RCPlugLyricCwrDownResuDa
 *
down_da
 =

171 (
RCPlugLyricCwrDownResuDa
 *)
da
;

172 
RCPlugLyricCwrPrive
 *
iv
 = &
lyric_awr_iv
;

173 if(
da
==
NULL
 
FALSE
;

174 if(
down_da
->
su
)

176 if(
iv
->
ch_wdow
!=
NULL
)

178 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

179 
	`_
("Downloaded successfully"));

181 if(
down_da
->
auto_ag
 && down_da->
th
!=
NULL
)

182 
	`rib_lyric_ld_fe
(
down_da
->
th
, 0);

186 if(
iv
->
ch_wdow
!=
NULL
)

188 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

189 
	`_
("Failedo downloaded"));

192 
	`g_
(
down_da
->
th
);

193 
	`g_
(
down_da
);

194 if(
iv
->
ch_wdow
!=
NULL
)

196 
	`gtk_widg_t_nsive
(
iv
->
ch_bu
, 
TRUE
);

197 
	`gtk_widg_t_nsive
(
iv
->
dowd_bu
, 
TRUE
);

199  
FALSE
;

200 
	}
}

202 
gpor
 
	$rc_ug_cawr_down_lyric_thad_func
(

203 
gpor
 
da
)

205 
gch
 **
gs
 = (gch **)
da
;

206 
gboޗn
 
ag
;

207 
RCPlugLyricCwrPrive
 *
iv
 = &
lyric_awr_iv
;

208 
RCPlugLyricCwrDownResuDa
 *
down_da
;

209 if(
gs
==
NULL
 ||rgs[0]==NULL ||rgs[1]==NULL ||

210 
iv
->
cut_modu
==
NULL
 ||riv->cut_modu->
fo
==NULL)

212 if(
gs
[0]!=
NULL

	`g_
(args[0]);

213 if(
gs
[1]!=
NULL

	`g_
(args[1]);

214 
	`g_
(
gs
);

215 
iv
->
dowd_thad
 = 
NULL
;

216 
	`g_thad_ex
(
NULL
);

217  
NULL
;

219 
	`g_debug
("Download Thread started, downloadingyric file....");

220 
ag
 = 
iv
->
cut_modu
->
fo
->
	`dowd_fe
(
gs
[0],rgs[1]);

221 if(
ag
)

222 
	`g_debug
("Downloadyric file successfully. :)");

224 
	`g_debug
("Cannot download or writeyric file. :(");

225 
down_da
 = 
	`g_w0
(
RCPlugLyricCwrDownResuDa
, 1);

226 
down_da
->
su
 = 
ag
;

227 
down_da
->
auto_ag
 = 
iv
->
auto_ch_mode
;

228 
down_da
->
th
 = 
	`g_rdup
(
gs
[1]);

229 
iv
->
auto_ch_mode
 = 
FALSE
;

230 
	`g_id_add
(
rc_ug_cawr_dowd_id_func
, 
down_da
);

231 
	`g_
(
gs
[0]);

232 
	`g_
(
gs
[1]);

233 
	`g_
(
gs
);

234 
iv
->
dowd_thad
 = 
NULL
;

235 
	`g_thad_ex
(
NULL
);

236  
NULL
;

237 
	}
}

239 
gpor
 
	$rc_ug_cawr_ch_lyric_thad_func
(

240 
gpor
 
da
)

242 
RCPlugLyricCwrPrive
 *
iv
 = &
lyric_awr_iv
;

243 
RCLibTagMada
 *
mmd
 = 
da
;

244 
GSLi
 *
li
;

245 if(
iv
->
cut_modu
==
NULL
 ||riv->cut_modu->
fo
==NULL ||

246 
mmd
==
NULL
)

248 
iv
->
ch_thad
 = 
NULL
;

249 
	`g_thad_ex
(
NULL
);

250  
NULL
;

252 
	`g_debug
("Search Thread started, searchingyrics....");

253 
li
 = 
iv
->
cut_modu
->
fo
->
	`ch_g_u_li
(

254 
mmd
->
t
, mmd->
ti
);

255 if(
li
!=
NULL
)

256 
	`g_debug
("Found %uesu(s srchg.", 
	`g_i_ngth
(
li
));

258 
	`g_debug
("Foundothing in searching. :(");

259 
	`g_id_add
(
rc_ug_cawr_ch_id_func
, 
li
);

260 
	`rib_g_
(
mmd
);

261 
iv
->
ch_thad
 = 
NULL
;

262 
	`g_thad_ex
(
NULL
);

263  
NULL
;

264 
	}
}

266 
gboޗn
 
	$rc_ug_cawr_ld_lyric_awr_modu
(

267 cڡ 
gch
 *
fe
)

269 
RCPlugLyricCwrPrive
 *
iv
 = &
lyric_awr_iv
;

270 
RCLyricCwrModu
 *
modu_da
;

271 
	`gboޗn
 (*
modu_
)(
RCLyricCwrModu
 *
modu

NULL
;

272 
GModu
 *
modu
 = 
NULL
;

273 
gpor
 
uued
 = 
NULL
;

274 if(
fe
==
NULL
 
FALSE
;

275 
modu
 = 
	`g_modu_ݒ
(
fe
, 
G_MODULE_BIND_LAZY
);

276 if(
modu
==
NULL
 
FALSE
;

277 if(!
	`g_modu_symb
(
modu
, "rc_cawr_modu_", &
uued
))

279 
	`g_modu_o
(
modu
);

280  
FALSE
;

282 
modu_
 = 
uued
;

283 
modu_da
 = 
	`g_w0
(
RCLyricCwrModu
, 1);

284 
modu_da
->
hd
 = 
modu
;

285 
modu_da
->
th
 = 
	`g_rdup
(
fe
);

286 if(!
	`modu_
(
modu_da
|| modu_da->
fo
->
magic
!=

287 
RC_LRCCRAWLER_MODULE_MAGIC_NUMBER
)

289 
	`g_modu_o
(
modu
);

290 
	`g_
(
modu_da
->
th
);

291 
	`g_
(
modu_da
);

292  
FALSE
;

294 
	`g_debug
("Ldedyriaw˸modu: %s", 
modu_da
->
fo
->
me
);

295 
iv
->
awr_modu_li
 = 
	`g_i_d
(priv->crawler_module_list,

296 
modu_da
);

297  
TRUE
;

298 
	}
}

300 
	$rc_ug_cawr_chge_ch_rv
(
GtkComboBox
 *
widg
,

301 
gpor
 
da
)

303 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

304 
GtkTeMod
 *
mod
;

305 
GtkTeIr
 

;

306 
RCLyricCwrModu
 *
modu
 = 
NULL
;

307 if(
da
==
NULL
) ;

308 
mod
 = 
	`gtk_combo_box_g_mod
(
widg
);

309 if(
mod
==
NULL
) ;

310 if(!
	`gtk_combo_box_g_aive_
(
widg
, &

)) ;

311 
	`gtk__mod_g
(
mod
, &

, 
CRAWLER_SEARCH_COLUMN_MODULE
,

312 &
modu
, -1);

313 if(
modu
==
NULL
) ;

314 
iv
->
cut_modu
 = 
modu
;

315 if(
iv
->
cut_modu
->
fo
!=
NULL
)

317 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

318 "LyricSv", 
iv
->
cut_modu
->
fo
->
me
);

320 
	}
}

322 
	$rc_ug_cawr_moud_g_ayg_g_cb
(
GtkBu
 *
bu
,

323 
gpor
 
da
)

325 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

326 
gch
 *
th
, *
tmp
;

327 cڡ 
gch
 *
home_d
 = 
NULL
;

328 cڡ 
RCLibCeMada
 *
mmd
 = 
	`rib_ce_g_mada
();

329 if(
da
==
NULL
) ;

330 
home_d
 = 
	`g_gv
("HOME");

331 if(
home_d
==
NULL
)

332 
home_d
 = 
	`g_g_home_d
();

333 if(
mmd
!=
NULL
)

335 if(
mmd
->
t
!=
NULL
)

337 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
t_y
), 
mmd
->
t
);

338 if(
mmd
->
ti
!=
NULL
 && 
	`
(mmd->artist)>0)

339 
tmp
 = 
	`g_rdup_tf
("%- %s.LRC", 
mmd
->
ti
, mmd->
t
);

340 if(
mmd
->
t
!=
NULL
 && 
	`
(mmd->title)>0)

341 
tmp
 = 
	`g_rdup_tf
("%s.LRC", 
mmd
->
t
);

343 
tmp
 = 
	`g_rdup
("New-Lyric.LRC");

344 
th
 = 
	`g_bud_fame
(
home_d
, ".RhythmCat2", "Lyrics",

345 
tmp
, 
NULL
);

346 
	`g_
(
tmp
);

347 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
ve_fe_y
), 
th
);

348 
	`g_
(
th
);

351 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
t_y
), "");

352 if(
mmd
->
ti
!=
NULL
)

353 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
ti_y
), 
mmd
->
ti
);

355 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
ti_y
), "");

357 
	}
}

359 
	$rc_ug_cawr_ch_bu_icked
(
GtkBu
 *
bu
,

360 
gpor
 
da
)

362 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

363 
RCLibTagMada
 *
mmd
;

364 cڡ 
gch
 *
xt
;

365 
GE
 *
r
 = 
NULL
;

366 if(
da
==
NULL
) ;

367 if(
iv
->
ch_thad
!=
NULL
) ;

368 if(
iv
->
cut_modu
==
NULL
) ;

369 
mmd
 = 
	`g_w0
(
RCLibTagMada
, 1);

370 
xt
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
iv
->
t_y
));

371 if(
xt
!=
NULL
 && 
	`
(text)>0)

372 
mmd
->
t
 = 
	`g_rdup
(
xt
);

373 
xt
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
iv
->
ti_y
));

374 if(
xt
!=
NULL
 && 
	`
(text)>0)

375 
mmd
->
ti
 = 
	`g_rdup
(
xt
);

376 
iv
->
ch_thad
 = 
	`g_thad_w
("LyricCrawler-Search-Thread",

377 
rc_ug_cawr_ch_lyric_thad_func
, (
gpor
)
mmd
);

378 
	`g_thad_uef
(
iv
->
ch_thad
);

379 if(
r
!=
NULL
)

381 
	`g_wng
("Cn s srchhad: %s", 
r
->
mesge
);

382 
	`rib_g_
(
mmd
);

383 
	`g_r_
(
r
);

386 
	`gtk_widg_t_nsive
(
iv
->
ch_bu
, 
FALSE
);

387 
	`gtk_widg_t_nsive
(
iv
->
dowd_bu
, 
FALSE
);

388 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
), 
	`_
("Searching..."));

389 
	}
}

391 
	$rc_ug_cawr_dowd_bu_icked
(

392 
GtkBu
 *
bu
, 
gpor
 
da
)

394 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

395 
gch
 **
gs
;

396 
GtkTeIr
 

;

397 
GtkTeMod
 *
mod
;

398 
gch
 *
u
;

399 cڡ 
gch
 *
th
;

400 
GE
 *
r
 = 
NULL
;

401 
GtkTeSei
 *
i
;

402 if(
da
==
NULL
) ;

403 if(
iv
->
dowd_thad
!=
NULL
) ;

404 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
iv
->
su_vw
));

405 if(
mod
==
NULL
) ;

406 
th
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
iv
->
ve_fe_y
));

407 if(
th
==
NULL
 || 
	`
(path)==0) ;

408 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

409 
iv
->
su_vw
));

410 if(
i
==
NULL
) ;

411 if(!
	`gtk__i_g_ed
(
i
, 
NULL
, &

)) ;

412 
	`gtk__mod_g
(
mod
, &

, 
CRAWLER_RESULT_COLUMN_URL
, &
u
, -1);

413 if(
u
==
NULL
) ;

414 
gs
 = 
	`g_w0
(
gch
 *, 2);

415 
gs
[0] = 
u
;

416 
gs
[1] = 
	`g_rdup
(
th
);

417 
iv
->
dowd_thad
 = 
	`g_thad_w
("LyricCrawler-Download-Thread",

418 
rc_ug_cawr_down_lyric_thad_func
, 
gs
);

419 
	`g_thad_uef
(
iv
->
dowd_thad
);

420 if(
r
!=
NULL
)

422 
	`g_wng
("Cn s dowdhad: %s", 
r
->
mesge
);

423 
	`g_r_
(
r
);

424 
	`g_
(
gs
[0]);

425 
	`g_
(
gs
[1]);

426 
	`g_
(
gs
);

429 
	`gtk_widg_t_nsive
(
iv
->
ch_bu
, 
FALSE
);

430 
	`gtk_widg_t_nsive
(
iv
->
dowd_bu
, 
FALSE
);

431 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
su_b
),

432 
	`_
("Downloadingyric file..."));

433 
	}
}

435 
	$rc_ug_cawr_t_oxy_cb
(
GtkBu
 *
bu
,

436 
gpor
 
da
)

438 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

439 
GtkWidg
 *
dlog
;

440 
GtkWidg
 *
cڋ_
;

441 
GtkWidg
 *
ma_grid
;

442 
GtkWidg
 *
grid1
, *
grid2
;

443 
GtkWidg
 *
fo_grid
;

444 
GtkWidg
 *
oxy_ty_b
;

445 
GtkWidg
 *
oxy_addr_b
;

446 
GtkWidg
 *
oxy_pt_b
;

447 
GtkWidg
 *
oxy_ur_b
;

448 
GtkWidg
 *
oxy_ss_b
;

449 
GtkWidg
 *
oxy_ty_combobox
;

450 
GtkWidg
 *
oxy_addr_y
;

451 
GtkWidg
 *
oxy_pt_
;

452 
GtkWidg
 *
oxy_ur_y
;

453 
GtkWidg
 *
oxy_ss_y
;

454 
GtkLiSte
 *
li_e
;

455 
GtkTeIr
 

;

456 
GtkClRd
 *
nd
;

457 
gch
 *
rg
;

458 
gt
 
t
, 
ty
;

459 cڡ 
gch
 *
oxy_addr_xt
;

460 cڡ 
gch
 *
oxy_ur_xt
;

461 cڡ 
gch
 *
oxy_ss_xt
;

462 if(
da
==
NULL
) ;

463 
dlog
 = 
	`gtk_dlog_w_wh_bus
(
	`_
("Proxy Stgs"), 
NULL
,

464 
GTK_DIALOG_MODAL
 | 
GTK_DIALOG_DESTROY_WITH_PARENT
, 
GTK_STOCK_OK
,

465 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_REJECT
, 
NULL
);

466 
oxy_ty_b
 = 
	`gtk_b_w
(
	`_
("Proxy Type: "));

467 
oxy_addr_b
 = 
	`gtk_b_w
(
	`_
("Address: "));

468 
oxy_pt_b
 = 
	`gtk_b_w
(
	`_
("Port: "));

469 
oxy_ur_b
 = 
	`gtk_b_w
(
	`_
("Userame: "));

470 
oxy_ss_b
 = 
	`gtk_b_w
(
	`_
("Password: "));

471 
li_e
 = 
	`gtk_li_e_w
(2, 
G_TYPE_STRING
, 
G_TYPE_INT
);

472 
	`gtk_li_e_nd
(
li_e
, &

);

473 
	`gtk_li_e_t
(
li_e
, &

, 0, "HTTP", 1, 0, -1);

474 
	`gtk_li_e_nd
(
li_e
, &

);

475 
	`gtk_li_e_t
(
li_e
, &

, 0, "HTTP (1.0)", 1, 1, -1);

476 
	`gtk_li_e_nd
(
li_e
, &

);

477 
	`gtk_li_e_t
(
li_e
, &

, 0, "Socks 4", 1, 2, -1);

478 
	`gtk_li_e_nd
(
li_e
, &

);

479 
	`gtk_li_e_t
(
li_e
, &

, 0, "Socks 4a", 1, 3, -1);

480 
	`gtk_li_e_nd
(
li_e
, &

);

481 
	`gtk_li_e_t
(
li_e
, &

, 0, "Socks 5", 1, 4, -1);

482 
	`gtk_li_e_nd
(
li_e
, &

);

483 
	`gtk_li_e_t
(
li_e
, &

, 0, "Socks 5 (Hostname)", 1, 5, -1);

484 
oxy_ty_combobox
 = 
	`gtk_combo_box_w_wh_mod
(

485 
	`GTK_TREE_MODEL
(
li_e
));

486 
	`g_obje_uef
(
li_e
);

487 
nd
 = 
	`gtk__nd_xt_w
();

488 
	`gtk__yout_ck_t
(
	`GTK_CELL_LAYOUT
(
oxy_ty_combobox
),

489 
nd
, 
TRUE
);

490 
	`gtk__yout_t_ibus
(
	`GTK_CELL_LAYOUT
(
oxy_ty_combobox
),

491 
nd
, "xt", 0, 
NULL
);

492 
oxy_addr_y
 = 
	`gtk_y_w
();

493 
oxy_ur_y
 = 
	`gtk_y_w
();

494 
oxy_ss_y
 = 
	`gtk_y_w
();

495 
oxy_pt_
 = 
	`gtk__bu_w_wh_nge
(0, 65535, 1);

496 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

497 "LyricProxyAddss", 
NULL
);

498 if(
rg
!=
NULL
 && 
	`
(string)>0)

499 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
oxy_addr_y
), 
rg
);

500 
	`g_
(
rg
);

501 
t
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

502 "LyricProxyTy", 
NULL
);

503 
t
)

505 
CURLPROXY_HTTP
:

506 
ty
 = 0;

508 
CURLPROXY_HTTP_1_0
:

509 
ty
 = 1;

511 
CURLPROXY_SOCKS4
:

512 
ty
 = 2;

514 
CURLPROXY_SOCKS4A
:

515 
ty
 = 3;

517 
CURLPROXY_SOCKS5
:

518 
ty
 = 4;

520 
CURLPROXY_SOCKS5_HOSTNAME
:

521 
ty
 = 5;

524 
ty
 = 0;

526 
	`gtk_combo_box_t_aive
(
	`GTK_COMBO_BOX
(
oxy_ty_combobox
), 
ty
);

527 
t
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

528 "LyricProxyPt", 
NULL
);

529 if(
t
<0 ||et>65535)et = 0;

530 
	`gtk__bu_t_vue
(
	`GTK_SPIN_BUTTON
(
oxy_pt_
), 
t
);

531 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

532 "LyricProxyUr", 
NULL
);

533 if(
rg
!=
NULL
)

535 if(
	`
(
rg
)>0)

536 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
oxy_ur_y
), 
rg
);

537 
	`g_
(
rg
);

539 
rg
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

540 "LyricProxyPasswd", 
NULL
);

541 if(
rg
!=
NULL
)

543 if(
	`
(
rg
)>0)

544 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
oxy_ss_y
), 
rg
);

545 
	`g_
(
rg
);

547 
ma_grid
 = 
	`gtk_grid_w
();

548 
grid1
 = 
	`gtk_grid_w
();

549 
grid2
 = 
	`gtk_grid_w
();

550 
fo_grid
 = 
	`gtk_grid_w
();

551 
	`g_obje_t
(
grid1
, "cumn-acg", 4, "hexnd-t", 
TRUE
,

552 "hexnd", 
TRUE
, 
NULL
);

553 
	`g_obje_t
(
grid2
, "cumn-acg", 4, "hexnd-t", 
TRUE
,

554 "hexnd", 
TRUE
, 
NULL
);

555 
	`g_obje_t
(
fo_grid
, "row-spacing", 2, "column-spacing", 4,

556 "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

557 
	`g_obje_t
(
ma_grid
, "row-acg", 2, 
NULL
);

558 
	`g_obje_t
(
oxy_ty_combobox
, "hexnd-t", 
TRUE
, "hexpand",

559 
TRUE
, 
NULL
);

560 
	`g_obje_t
(
oxy_addr_y
, "hexnd-t", 
TRUE
, "hexpand",

561 
TRUE
, 
NULL
);

562 
	`g_obje_t
(
oxy_pt_
, "numic", 
FALSE
, 
NULL
);

563 
	`g_obje_t
(
oxy_ur_y
, "hexnd-t", 
TRUE
, "hexpand",

564 
TRUE
, 
NULL
);

565 
	`g_obje_t
(
oxy_ss_y
, "hexnd-t", 
TRUE
, "hexpand",

566 
TRUE
, "visiby", 
FALSE
, 
NULL
);

567 
cڋ_
 = 
	`gtk_dlog_g_cڋ_
(
	`GTK_DIALOG
(
dlog
));

568 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid1
), 
oxy_ty_b
, 0, 0, 1, 1);

569 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid1
), 
oxy_ty_combobox
, 1, 0, 1, 1);

570 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid2
), 
oxy_addr_b
, 0, 0, 1, 1);

571 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid2
), 
oxy_addr_y
, 1, 0, 1, 1);

572 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid2
), 
oxy_pt_b
, 2, 0, 1, 1);

573 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid2
), 
oxy_pt_
, 3, 0, 1, 1);

574 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
oxy_ur_b
, 0, 0, 1, 1);

575 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
oxy_ur_y
, 1, 0, 1, 1);

576 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
oxy_ss_b
, 0, 1, 1, 1);

577 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
oxy_ss_y
, 1, 1, 1, 1);

578 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
grid1
, 0, 0, 1, 1);

579 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
grid2
, 0, 1, 1, 1);

580 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
fo_grid
, 0, 2, 1, 1);

581 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
cڋ_
), 
ma_grid
);

582 
	`gtk_widg_show_l
(
dlog
);

583 
t
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
dlog
));

584 if(
t
==
GTK_RESPONSE_ACCEPT
)

586 
t
 = 
	`gtk_combo_box_g_aive
(
	`GTK_COMBO_BOX
(
oxy_ty_combobox
));

587 
t
)

590 
ty
 = 
CURLPROXY_HTTP
;

593 
ty
 = 
CURLPROXY_HTTP_1_0
;

596 
ty
 = 
CURLPROXY_SOCKS4
;

599 
ty
 = 
CURLPROXY_SOCKS4A
;

602 
ty
 = 
CURLPROXY_SOCKS5
;

605 
ty
 = 
CURLPROXY_SOCKS5_HOSTNAME
;

608 
ty
 = 
CURLPROXY_HTTP
;

610 
oxy_addr_xt
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
oxy_addr_y
));

611 
oxy_ur_xt
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
oxy_ur_y
));

612 
oxy_ss_xt
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
oxy_ss_y
));

613 
t
 = 
	`gtk__bu_g_vue_as_t
(
	`GTK_SPIN_BUTTON
(

614 
oxy_pt_
));

615 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

616 "LyricProxyAddss", 
oxy_addr_xt
);

617 
	`g_key_fe_t_g
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

618 "LyricProxyTy", 
ty
);

619 
	`g_key_fe_t_g
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

620 "LyricProxyPt", 
t
);

621 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

622 "LyricProxyUr", 
oxy_ur_xt
);

623 
	`g_key_fe_t_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

624 "LyricProxyPasswd", 
oxy_ss_xt
);

625 if(
oxy_addr_xt
!=
NULL
 && 
	`
(proxy_addr_text)<1)

626 
oxy_addr_xt
 = 
NULL
;

627 if(
oxy_ur_xt
!=
NULL
 && 
	`
(proxy_user_text)<1)

628 
oxy_ur_xt
 = 
NULL
;

629 if(
oxy_ss_xt
!=
NULL
 && 
	`
(proxy_pass_text)<1)

630 
oxy_ss_xt
 = 
NULL
;

631 
	`rc_cawr_comm_t_oxy
(
ty
, 
oxy_addr_xt
, 
t
,

632 
oxy_ur_xt
, 
oxy_ss_xt
);

634 
	`gtk_widg_deroy
(
dlog
);

636 
	}
}

638 
	$rc_ug_cawr_auto_ch_check_bu_cb
(
GtkWidg
 *
widg
,

639 
gpor
 
da
)

641 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

642 if(
da
==
NULL
) ;

643 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
	`GTK_TOGGLE_BUTTON
(
widg
));

644 
iv
->
auto_ch
 = 
ag
;

645 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
LRCCRAWLER_ID
, "AutoSrch", 
ag
);

646 
	}
}

648 
	$rc_ug_cawr_o_bu_icked
(
GtkBu
 *
bu
,

649 
gpor
 
da
)

651 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

652 if(
da
==
NULL
) ;

653 
	`gtk_togg_ai_t_aive
(
iv
->
ai
, 
FALSE
);

654 
	}
}

656 
gboޗn
 
	$rc_ug_cawr_ch_wdow_de_evt_cb
(

657 
GtkWidg
 *
widg
, 
GdkEvt
 *
evt
, 
gpor
 
da
)

659 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

660 if(
da
==
NULL
 
TRUE
;

661 
	`gtk_togg_ai_t_aive
(
iv
->
ai
, 
FALSE
);

662  
TRUE
;

663 
	}
}

665 
le
 
	$rc_ug_cawr_ch_wdow_
(

666 
RCPlugLyricCwrPrive
 *
iv
)

668 
GtkWidg
 *
ma_grid
;

669 
GtkWidg
 *
rv_grid
;

670 
GtkWidg
 *
fo_grid
;

671 
GtkWidg
 *
fe_grid
;

672 
GtkWidg
 *
bu_grid
;

673 
GtkWidg
 *
bu_hbox
;

674 
GtkWidg
 *
sd_wdow
;

675 
GtkWidg
 *
rv_b
;

676 
GtkWidg
 *
oxy_bu
;

677 
GtkWidg
 *
t_b
;

678 
GtkWidg
 *
ti_b
;

679 
GtkWidg
 *
g_g_bu
;

680 
GtkWidg
 *
ve_b
;

681 
GtkWidg
 *
o_bu
;

682 
GtkTeVwCumn
 *
cumns
[3];

683 
GtkClRd
 *
nds
[3];

684 
GtkClRd
 *
nd
 = 
NULL
;

685 
GtkLiSte
 *
su_e
;

686 
GtkLiSte
 *
ch_modu_e
;

687 
GtkTeIr
 

;

688 
gch
 *
th
;

689 
gut
 
i
;

690 
GSLi
 *
li_fܗch
;

691 
gch
 *
cut_modu_me
;

692 
RCLyricCwrModu
 *
modu_da
;

693 cڡ 
gch
 *
home_d
 = 
NULL
;

694 cڡ 
gch
 *
modu_me
;

695 
home_d
 = 
	`g_gv
("HOME");

696 if(
home_d
==
NULL
)

697 
home_d
 = 
	`g_g_home_d
();

698 
iv
->
ch_wdow
 = 
	`gtk_wdow_w
(
GTK_WINDOW_TOPLEVEL
);

699 
ma_grid
 = 
	`gtk_grid_w
();

700 
rv_grid
 = 
	`gtk_grid_w
();

701 
fo_grid
 = 
	`gtk_grid_w
();

702 
fe_grid
 = 
	`gtk_grid_w
();

703 
bu_grid
 = 
	`gtk_grid_w
();

704 
bu_hbox
 = 
	`gtk_bu_box_w
(
GTK_ORIENTATION_HORIZONTAL
);

705 
sd_wdow
 = 
	`gtk_sd_wdow_w
(
NULL
, NULL);

706 
	`gtk_sd_wdow_t_picy
(
	`GTK_SCROLLED_WINDOW
(
sd_wdow
),

707 
GTK_POLICY_NEVER
, 
GTK_POLICY_AUTOMATIC
);

708 
	`g_obje_t
(
iv
->
ch_wdow
, "t", 
	`_
("Lyric Crawler"),

709 "wdow-posi", 
GTK_WIN_POS_CENTER
, 
NULL
);

710 
rv_b
 = 
	`gtk_b_w
(
	`_
("Lyric Server: "));

711 
t_b
 = 
	`gtk_b_w
(
	`_
("Title: "));

712 
ti_b
 = 
	`gtk_b_w
(
	`_
("Artist: "));

713 
ve_b
 = 
	`gtk_b_w
(
	`_
("Saveyric fileo: "));

714 
iv
->
su_b
 = 
	`gtk_b_w
(
	`_
("Ready"));

715 
	`g_obje_t
(
iv
->
su_b
, "xign", 0.0, "yign", 0.5, 
NULL
);

716 
th
 = 
	`g_bud_fame
(
home_d
, ".RhythmCat2", "Lyrics",

717 "New fe.LRC", 
NULL
);

718 
iv
->
ve_fe_y
 = 
	`gtk_y_w
();

719 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
ve_fe_y
), 
th
);

720 
	`g_
(
th
);

721 
oxy_bu
 = 
	`gtk_bu_w_wh_b
(
	`_
("Proxy Settings"));

722 
g_g_bu
 = 
	`gtk_bu_w_wh_b
(
	`_
("Get Playing Tag"));

723 
iv
->
ch_bu
 = 
	`gtk_bu_w_wh_b
(
	`_
("Search!"));

724 
iv
->
dowd_bu
 = 
	`gtk_bu_w_wh_b
(
	`_
("Download!"));

725 
o_bu
 = 
	`gtk_bu_w_wh_b
(
	`_
("Close"));

726 
iv
->
auto_ch_checkbu
 = 
	`gtk_check_bu_w_wh_b
(

727 
	`_
("Auto searchyric"));

728 
iv
->
t_y
 = 
	`gtk_y_w
();

729 
iv
->
ti_y
 = 
	`gtk_y_w
();

730 
ch_modu_e
 = 
	`gtk_li_e_w
(
CRAWLER_SEARCH_COLUMN_LAST
,

731 
G_TYPE_STRING
, 
G_TYPE_INT
, 
G_TYPE_POINTER
);

732 
cut_modu_me
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

733 "LyricSv", 
NULL
);

734 
li_fܗch
=
iv
->
awr_modu_li
, 
i
=0;li_fܗch!=
NULL
;

735 
li_fܗch
=
	`g_i_xt
(list_foreach))

737 
modu_da
 = 
li_fܗch
->
da
;

738 if(
modu_da
==
NULL
) ;

739 if(
modu_da
->
fo
!=
NULL
 && modu_da->fo->
me
!=NULL)

740 
modu_me
 = 
modu_da
->
fo
->
me
;

742 
modu_me
 = "";

743 if(
cut_modu_me
!=
NULL
 && 
modu_da
->
fo
!=NULL &&

744 
	`g_rcmp0
(
cut_modu_me
, 
modu_da
->
fo
->
me
)==0)

746 
iv
->
cut_modu
 = 
modu_da
;

748 
	`gtk_li_e_nd
(
ch_modu_e
, &

);

749 
	`gtk_li_e_t
(
ch_modu_e
, &

,

750 
CRAWLER_SEARCH_COLUMN_TEXT
, 
modu_me
,

751 
CRAWLER_SEARCH_COLUMN_INDEX
, 
i
, -1);

752 
i
++;

754 
	`g_
(
cut_modu_me
);

755 
iv
->
rv_combobox
 = 
	`gtk_combo_box_w_wh_mod
(

756 
	`GTK_TREE_MODEL
(
ch_modu_e
));

757 
	`g_obje_uef
(
ch_modu_e
);

758 
nd
 = 
	`gtk__nd_xt_w
();

759 
	`gtk__yout_ck_t
(
	`GTK_CELL_LAYOUT
(
iv
->
rv_combobox
),

760 
nd
, 
TRUE
);

761 
	`gtk__yout_t_ibus
(
	`GTK_CELL_LAYOUT
(
iv
->
rv_combobox
),

762 
nd
, "xt", 0, 
NULL
);

763 
	`gtk_combo_box_t_aive
(
	`GTK_COMBO_BOX
(
iv
->
rv_combobox
), 0);

764 if(
	`gtk__mod_g__f
(
	`GTK_TREE_MODEL
(
ch_modu_e
),

765 &

))

769 
	`gtk__mod_g
(
	`GTK_TREE_MODEL
(
ch_modu_e
), &

,

770 
CRAWLER_SEARCH_COLUMN_MODULE
, &
modu_da
, -1);

771 if(
modu_da
==
iv
->
cut_modu
)

773 
	`gtk_combo_box_t_aive_
(
	`GTK_COMBO_BOX
(

774 
iv
->
rv_combobox
), &

);

777 
	`gtk__mod__xt
(
	`GTK_TREE_MODEL
(
ch_modu_e
),

778 &

));

780 
su_e
 = 
	`gtk_li_e_w
(
CRAWLER_RESULT_COLUMN_LAST
,

781 
G_TYPE_STRING
, G_TYPE_STRING, G_TYPE_STRING);

782 
iv
->
su_vw
 = 
	`gtk__vw_w_wh_mod
(
	`GTK_TREE_MODEL
(

783 
su_e
));

784 
	`g_obje_uef
(
su_e
);

785 
i
=0;i<
CRAWLER_RESULT_COLUMN_LAST
;i++)

787 
nds
[
i
] = 
	`gtk__nd_xt_w
();

788 
cumns
[
i
] = 
	`gtk__vw_cumn_w
();

789 
	`g_obje_t
(
nds
[
i
], "lsize", 
PANGO_ELLIPSIZE_END
,

790 "lsize-t", 
TRUE
, 
NULL
);

791 
	`gtk__vw_cumn_ck_t
(
cumns
[
i
], 
nds
[i], 
TRUE
);

792 
	`gtk__vw_cumn_add_ibu
(
cumns
[
i
], 
nds
[i],

793 "xt", 
i
);

794 
	`gtk__vw_cumn_t_sizab
(
cumns
[
i
], 
TRUE
);

795 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
iv
->
su_vw
),

796 
cumns
[
i
]);

798 
	`gtk__vw_cumn_t_t
(
cumns
[0], 
	`_
("Title"));

799 
	`gtk__vw_cumn_t_t
(
cumns
[1], 
	`_
("Artist"));

800 
	`gtk__vw_cumn_t_t
(
cumns
[2], 
	`_
("URL"));

801 
	`gtk__vw_cumn_t_m_width
(
cumns
[0], 120);

802 
	`gtk__vw_cumn_t_m_width
(
cumns
[1], 80);

803 
	`gtk__vw_cumn_t_m_width
(
cumns
[2], 120);

804 
	`g_obje_t
(
ma_grid
, "row-acg", 2, 
NULL
);

805 
	`g_obje_t
(
rv_grid
, "cumn-acg", 2, "hexnd-t", 
TRUE
,

806 "hexnd", 
TRUE
, 
NULL
);

807 
	`g_obje_t
(
fo_grid
, "column-spacing", 2, "row-spacing", 2,

808 "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

809 
	`g_obje_t
(
fe_grid
, "cumn-acg", 2, "hexnd-t", 
TRUE
,

810 "hexnd", 
TRUE
, 
NULL
);

811 
	`g_obje_t
(
bu_grid
, "cumn-acg", 6, "hexnd-t", 
TRUE
,

812 "hexnd", 
TRUE
, 
NULL
);

813 
	`g_obje_t
(
iv
->
rv_combobox
, "hexnd-t", 
TRUE
, "hexpand",

814 
TRUE
, 
NULL
);

815 
	`g_obje_t
(
iv
->
t_y
, "hexnd-t", 
TRUE
, "hexpand",

816 
TRUE
, 
NULL
);

817 
	`g_obje_t
(
iv
->
ti_y
, "hexnd-t", 
TRUE
, "hexpand",

818 
TRUE
, 
NULL
);

819 
	`g_obje_t
(
iv
->
su_b
, "hexnd-t", 
TRUE
, "hexpand",

820 
TRUE
, 
NULL
);

821 
	`g_obje_t
(
sd_wdow
, "exnd", 
TRUE
, 
NULL
);

822 
	`g_obje_t
(
iv
->
ve_fe_y
, "hexnd-t", 
TRUE
, "hexpand",

823 
TRUE
, 
NULL
);

824 
	`g_obje_t
(
iv
->
dowd_bu
, "nsive", 
FALSE
, 
NULL
);

825 
	`g_obje_t
(
bu_hbox
, "hexnd-t", 
TRUE
, "hexpand",

826 
TRUE
, "yout-y", 
GTK_BUTTONBOX_END
, "acg", 4, 
NULL
);

827 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
sd_wdow
), 
iv
->
su_vw
);

828 
	`gtk_box_ck_t
(
	`GTK_BOX
(
bu_hbox
), 
iv
->
dowd_bu
,

829 
FALSE
, FALSE, 5);

830 
	`gtk_box_ck_t
(
	`GTK_BOX
(
bu_hbox
), 
o_bu
,

831 
FALSE
, FALSE, 5);

832 
	`gtk_grid_ch
(
	`GTK_GRID
(
rv_grid
), 
rv_b
, 0, 0, 1, 1);

833 
	`gtk_grid_ch
(
	`GTK_GRID
(
rv_grid
), 
iv
->
rv_combobox
, 1, 0,

835 
	`gtk_grid_ch
(
	`GTK_GRID
(
rv_grid
), 
oxy_bu
, 2, 0, 1, 1);

836 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
t_b
, 0, 0, 1, 1);

837 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
iv
->
t_y
, 1, 0, 1, 1);

838 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
g_g_bu
, 2, 0, 1, 1);

839 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
ti_b
, 0, 1, 1, 1);

840 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
iv
->
ti_y
, 1, 1, 1, 1);

841 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
iv
->
ch_bu
, 2, 1, 1, 1);

842 
	`gtk_grid_ch
(
	`GTK_GRID
(
fe_grid
), 
ve_b
, 0, 0, 1, 1);

843 
	`gtk_grid_ch
(
	`GTK_GRID
(
fe_grid
), 
iv
->
ve_fe_y
, 1, 0, 1, 1);

844 
	`gtk_grid_ch
(
	`GTK_GRID
(
bu_grid
), 
iv
->
auto_ch_checkbu
,

846 
	`gtk_grid_ch
(
	`GTK_GRID
(
bu_grid
), 
bu_hbox
, 1, 0, 1, 1);

847 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
rv_grid
, 0, 0, 1, 1);

848 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
fo_grid
, 0, 1, 1, 1);

849 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
sd_wdow
, 0, 2, 1, 1);

850 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
iv
->
su_b
, 0, 3, 1, 1);

851 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
fe_grid
, 0, 4, 1, 1);

852 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
bu_grid
, 0, 5, 1, 1);

853 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
ch_wdow
), 
ma_grid
);

854 
	`gtk_widg_show_l
(
ma_grid
);

855 
	`g_sigl_c
(
iv
->
ch_wdow
, "delete-event",

856 
	`G_CALLBACK
(
rc_ug_cawr_ch_wdow_de_evt_cb
),

857 
iv
);

858 
	`g_sigl_c
(
g_g_bu
, "clicked",

859 
	`G_CALLBACK
(
rc_ug_cawr_moud_g_ayg_g_cb
), 
iv
);

860 
	`g_sigl_c
(
iv
->
ch_bu
, "clicked",

861 
	`G_CALLBACK
(
rc_ug_cawr_ch_bu_icked
), 
iv
);

862 
	`g_sigl_c
(
oxy_bu
, "clicked",

863 
	`G_CALLBACK
(
rc_ug_cawr_t_oxy_cb
), 
iv
);

864 
	`g_sigl_c
(
iv
->
dowd_bu
, "clicked",

865 
	`G_CALLBACK
(
rc_ug_cawr_dowd_bu_icked
), 
iv
);

866 
	`g_sigl_c
(
o_bu
, "clicked",

867 
	`G_CALLBACK
(
rc_ug_cawr_o_bu_icked
), 
iv
);

868 
	`g_sigl_c
(
iv
->
rv_combobox
, "changed",

869 
	`G_CALLBACK
(
rc_ug_cawr_chge_ch_rv
), 
iv
);

870 
	`g_sigl_c
(
iv
->
auto_ch_checkbu
, "toggled",

871 
	`G_CALLBACK
(
rc_ug_cawr_auto_ch_check_bu_cb
),

872 
iv
);

873 
	}
}

875 
	$rc_ug_cawr_may_missg_cb
(
RCLibLyric
 *
lyric
,

876 
gpor
 
da
)

878 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

879 
gch
 *
uri
 = 
NULL
;

880 
gch
 *
fh
 = 
NULL
;

881 
GSequIr
 *

 = 
NULL
;

882 
gch
 *

;

883 
gch
 *
t
 = 
NULL
, *
ti
 = NULL;

884 
gch
 *
fu_th
;

885 
RCLibDbPyliDa
 *
ayli_da
 = 
NULL
;

886 cڡ 
gch
 *
home_d
;

887 if(
da
==
NULL
) ;

888 if(!
iv
->
auto_ch
) ;

889 if(
	`gtk_widg_g_visib
(
iv
->
ch_wdow
)) ;

890 
uri
 = 
	`rib_ce_g_uri
();

891 if(
uri
==
NULL
) ;

892 

 = 
	`rib_ce_g_db_n
();

893 if(

!=
NULL
)

894 
ayli_da
 = 
	`g_qu_g
(

);

895 if(
ayli_da
!=
NULL
 &&yli_da->
t
!=NULL &&

896 
	`
(
ayli_da
->
t
)>0)

898 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
t_y
),

899 
ayli_da
->
t
);

900 
t
 = 
	`g_rdup
(
ayli_da
->title);

904 
fh
 = 
	`g_fame_om_uri
(
uri
, 
NULL
, NULL);

905 

 = 
	`rib_g_g_me_om_h
(
fh
);

906 
	`g_
(
fh
);

907 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
t_y
), 

);

908 
t
 = 
	`g_rdup
(

);

909 
	`g_
(

);

911 if(
ayli_da
!=
NULL
 &&yli_da->
ti
!=NULL &&

912 
	`
(
ayli_da
->
ti
)>0)

914 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
ti_y
),

915 
ayli_da
->
ti
);

916 
ti
 = 
	`g_rdup
(
ayli_da
->artist);

920 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
ti_y
),

923 
	`g_
(
uri
);

924 
home_d
 = 
	`g_gv
("HOME");

925 if(
home_d
==
NULL
)

926 
home_d
 = 
	`g_g_home_d
();

927 if(
ti
!=
NULL
 && 
t
!=NULL)

928 
fh
 = 
	`g_rdup_tf
("%- %s.LRC", 
ti
, 
t
);

929 if(
t
!=
NULL
)

930 
fh
 = 
	`g_rdup_tf
("%s.LRC", 
t
);

932 
fh
 = 
	`g_rdup
("New file.LRC");

933 
	`g_
(
t
);

934 
	`g_
(
ti
);

935 
fu_th
 = 
	`g_bud_fame
(
home_d
, ".RhythmCat2", "Lyrics",

936 
fh
, 
NULL
);

937 
	`g_
(
fh
);

938 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
ve_fe_y
), 
fu_th
);

939 
	`g_
(
fu_th
);

940 
iv
->
auto_ch_mode
 = 
TRUE
;

941 
	`gtk_bu_icked
(
	`GTK_BUTTON
(
iv
->
ch_bu
));

942 
	}
}

944 
	$rc_ug_cawr_vw_mu_toggd
(
GtkToggAi
 *
togg
,

945 
gpor
 
da
)

947 
RCPlugLyricCwrPrive
 *
iv
 = (RCPlugLyricCwrPriv*)
da
;

948 
gboޗn
 
ag
;

949 if(
da
==
NULL
) ;

950 
ag
 = 
	`gtk_togg_ai_g_aive
(
togg
);

951 if(
ag
)

952 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
iv
->
ch_wdow
));

954 
	`gtk_widg_hide
(
iv
->
ch_wdow
);

955 
	}
}

957 
	$rc_ug_cawr_shutdown_cb
(
RCLibPlug
 *
ug
, 
gpor
 
da
)

960 
	}
}

962 
gboޗn
 
	$rc_ug_cawr_ld
(
RCLibPlugDa
 *
ug
)

964 
RCPlugLyricCwrPrive
 *
iv
 = &
lyric_awr_iv
;

965 
GE
 *
r
 = 
NULL
;

966 
gboޗn
 
bvue
;

967 
gt
 
oxy_ty
;

968 
gch
 *
oxy_addr
;

969 
gt
 
oxy_pt
;

970 
gch
 *
oxy_ur
;

971 
gch
 *
oxy_sswd
;

972 
	`rc_ug_cawr_ch_wdow_
(
iv
);

973 
iv
->
ai
 = 
	`gtk_togg_ai_w
("RC2ViewPluginLyricCrawler",

974 
	`_
("LyriCwr"), _("Show/hidlyriaw˸wdow"), 
NULL
);

975 
iv
->
mu_id
 = 
	`rc_ui_mu_add_mu_ai
(
	`GTK_ACTION
riv->
ai
),

977 "RC2VwPlugLyricCwr", 
TRUE
);

978 
bvue
 = 
	`g_key_fe_g_boޗn
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

979 "AutoSrch", &
r
);

980 if(
r
==
NULL
)

982 
iv
->
auto_ch
 = 
bvue
;

983 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(

984 
iv
->
auto_ch_checkbu
), 
bvue
);

988 
	`g_r_
(
r
);

989 
r
 = 
NULL
;

990 
	`g_key_fe_t_boޗn
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

991 "AutoSrch", 
TRUE
);

992 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(

993 
iv
->
auto_ch_checkbu
), 
TRUE
);

995 
oxy_addr
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

996 "LyricProxyAddss", 
NULL
);

997 if(
oxy_addr
!=
NULL
)

999 
oxy_ty
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

1000 "LyricProxyTy", 
NULL
);

1001 
oxy_pt
 = 
	`g_key_fe_g_g
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

1002 "LyricProxyPt", 
NULL
);

1003 
oxy_ur
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

1004 "LyricProxyUr", 
NULL
);

1005 
oxy_sswd
 = 
	`g_key_fe_g_rg
(
iv
->
keyfe
, 
LRCCRAWLER_ID
,

1006 "LyricProxyPasswd", 
NULL
);

1007 
	`rc_cawr_comm_t_oxy
(
oxy_ty
, 
oxy_addr
, 
oxy_pt
,

1008 
oxy_ur
, 
oxy_sswd
);

1009 
	`g_
(
oxy_addr
);

1010 
	`g_
(
oxy_ur
);

1011 
	`g_
(
oxy_sswd
);

1013 
	`g_sigl_c
(
iv
->
ai
, "toggled",

1014 
	`G_CALLBACK
(
rc_ug_cawr_vw_mu_toggd
), 
iv
);

1015 
iv
->
missg_sigl
 = 
	`rib_lyric_sigl_c
("lyric-may-missing",

1016 
	`G_CALLBACK
(
rc_ug_cawr_may_missg_cb
), 
iv
);

1017  
TRUE
;

1018 
	}
}

1020 
gboޗn
 
	$rc_ug_cawr_ud
(
RCLibPlugDa
 *
ug
)

1022 
RCPlugLyricCwrPrive
 *
iv
 = &
lyric_awr_iv
;

1023 if(
iv
->
missg_sigl
>0)

1024 
	`rib_lyric_sigl_disc
(
iv
->
missg_sigl
);

1025 if(
iv
->
mu_id
>0)

1027 
	`rc_ui_mu_move_mu_ai
(
	`GTK_ACTION
(
iv
->
ai
),

1028 
iv
->
mu_id
);

1029 
	`g_obje_uef
(
iv
->
ai
);

1031 
iv
->
missg_sigl
 = 0;

1032 if(
iv
->
ch_wdow
!=
NULL
)

1033 
	`gtk_widg_deroy
(
iv
->
ch_wdow
);

1034 
iv
->
ch_wdow
 = 
NULL
;

1035  
TRUE
;

1036 
	}
}

1038 
gboޗn
 
	$rc_ug_cawr_
(
RCLibPlugDa
 *
ug
)

1040 
RCPlugLyricCwrPrive
 *
iv
 = &
lyric_awr_iv
;

1041 
GD
 *
d
 = 
NULL
;

1042 
gch
 *
d_th
 = 
NULL
;

1043 
gch
 *
tmp
;

1044 cڡ 
gch
 *
fe_fܗch
;

1045 
gch
 *
modu_n
;

1046 
gch
 *
modu_fe
;

1047 
gt
 
t
;

1048 
t
 = 
	`cu_glob_
(
CURL_GLOBAL_ALL
);

1049 if(
t
!=0)

1051 
	`g_wng
("Cannot initialize CURL!");

1052  
FALSE
;

1054 
iv
->
keyfe
 = 
	`rib_ug_g_keyfe
();

1055 
tmp
 = 
	`g_th_g_dme
(
ug
->
th
);

1056 if(
tmp
!=
NULL
)

1057 
d_th
 = 
	`g_bud_fame
(
tmp
, "CwrModus", 
NULL
);

1058 
	`g_
(
tmp
);

1059 if(
d_th
!=
NULL
)

1060 
d
 = 
	`g_d_ݒ
(
d_th
, 0, 
NULL
);

1061 if(
d
!=
NULL
)

1063 
modu_n
 = 
	`g_rdup_tf
("lrccrawler-[^\\.]+\\.%s",

1064 
G_MODULE_SUFFIX
);

1065 (
fe_fܗch
=
	`g_d_ad_me
(
d
))!=
NULL
)

1067 if(
	`g_gex_mch_sime
(
modu_n
, 
fe_fܗch
,

1068 
G_REGEX_CASELESS
, 0))

1070 
modu_fe
 = 
	`g_bud_fame
(
d_th
, 
fe_fܗch
, 
NULL
);

1071 if(
modu_fe
!=
NULL
)

1073 
	`rc_ug_cawr_ld_lyric_awr_modu
(

1074 
modu_fe
);

1076 
	`g_
(
modu_fe
);

1079 
	`g_
(
modu_n
);

1080 
	`g_d_o
(
d
);

1082 if(
iv
->
awr_modu_li
!=
NULL
)

1083 
iv
->
cut_modu
 =riv->
awr_modu_li
->
da
;

1084 
iv
->
shutdown_id
 = 
	`rib_ug_sigl_c
("shutdown",

1085 
	`G_CALLBACK
(
rc_ug_cawr_shutdown_cb
), 
iv
);

1086  
TRUE
;

1087 
	}
}

1089 
	$rc_ug_cawr_deroy
(
RCLibPlugDa
 *
ug
)

1091 
RCPlugLyricCwrPrive
 *
iv
 = &
lyric_awr_iv
;

1092 
RCLyricCwrModu
 *
modu_da
;

1093 
GSLi
 *
li_fܗch
;

1094 
	`rc_cawr_comm_ݔi_nl
();

1095 if(
iv
->
shutdown_id
>0)

1096 
	`rib_ug_sigl_disc
(
iv
->
shutdown_id
);

1097 
li_fܗch
=
iv
->
awr_modu_li
;li_fܗch!=
NULL
;

1098 
li_fܗch
=
	`g_i_xt
(list_foreach))

1100 
modu_da
 = 
li_fܗch
->
da
;

1101 if(
modu_da
==
NULL
) ;

1102 if(
modu_da
->
hd
!=
NULL
)

1103 
	`g_modu_o
(
modu_da
->
hd
);

1104 
	`g_
(
modu_da
->
th
);

1105 
	`g_
(
modu_da
);

1107 
	`g_i_
(
iv
->
awr_modu_li
);

1108 
	`cu_glob_nup
();

1109 
	}
}

1111 
RCLibPlugInfo
 
	grlug_fo
 = {

1112 .
magic
 = 
RCLIB_PLUGIN_MAGIC
,

1113 .
	gmaj_vsi
 = 
RCLIB_PLUGIN_MAJOR_VERSION
,

1114 .
	gm_vsi
 = 
RCLIB_PLUGIN_MINOR_VERSION
,

1115 .
	gty
 = 
RCLIB_PLUGIN_TYPE_MODULE
,

1116 .
	gid
 = 
LRCCRAWLER_ID
,

1117 .
	gme
 = 
N_
("Lyric Crawler Plug-in"),

1118 .
	gvsi
 = "0.5",

1119 .
	gdesti
 = 
N_
("Searchnd downloadyric file from Internet sites."),

1120 .
	gauth
 = "SuperCat",

1121 .
	ghomage
 = "http://supercat-lab.org/",

1122 .
	gld
 = 
rc_ug_cawr_ld
,

1123 .
	gud
 = 
rc_ug_cawr_ud
,

1124 .
	gcfigu
 = 
NULL
,

1125 .
	gderoy
 = 
rc_ug_cawr_deroy
,

1126 .
	gexa_fo
 = 
NULL


1129 
RCPLUGIN_INIT_PLUGIN
(
rlug_fo
.
id
, 
rc_ug_cawr_
,cplugin_info);

	@plugins/restricted/lrccrawler-ttplayer.c

26 
	~<y.h
>

27 
	~<rg.h
>

28 
	~<dlib.h
>

29 
	~<glib.h
>

30 
	~<cu/cu.h
>

31 
	~<cawr-comm.h
>

34 cڡ 
gch
 *
	gmusic_ba_u
 = "http://ttlrcct.qianqian.com/dll/"

36 cڡ 
gch
 *
	gc_ba_u
 = "http://ttlrcct.qianqian.com/dll/"

39 
gt32
 
	$rc_awr_modu_ay_lc_dowd_code
(
gt
 
id
,

40 cڡ *
da
)

42 
gt32
 
coded_id
;

43 
gt32
 
coded_da
 = 0;

44 
gt32
 
coded_da2
 = 0;

45 
gt32
 
t
;

46 
gsize
 
n
;

47 
gt
 
i
;

48 
gut32
 
id1
 = 
id
 & 0xff;

49 
gut32
 
id2
 = (
id
 >> 8) & 0xff;

50 
gut32
 
id3
 = (
id
 >> 16) & 0xff;

51 
gut32
 
id4
 = (
id
 >> 24) & 0xff;

52 if(
id3
 =0id3 = ~
id2
 & 0xff;

53 if(
id4
 =0id4 = ~
id1
 & 0xff;

54 
coded_id
 = (
id1
 << 24| (
id3
 << 16| (
id2
 << 8| 
id4
;

55 
n
 = 
	`
(
da
);

56 
i
=
n
-1;i>=0;i--)

57 
coded_da
 =ncoded_d+ 
da
[
i
] + (encoded_data<<(i%2+4));

58 
i
=0;i<
n
;i++)

59 
coded_da2
 =ncoded_da2 + 
da
[
i
] + (encoded_data2<<(i%2+3));

60 
t
 = ((
coded_da
 ^ 
coded_id
+ (
coded_da2
 | 
id
)) *

61 (
coded_da2
 | 
coded_id
);

62 
t
 = * (
coded_da
 ^ 
id
);

63  
t
;

64 
	}
}

66 
	$rc_awr_modu_xml_r_t
(
GMkupPCڋxt
 *
cڋxt
,

67 cڡ 
gch
 *
emt_me
, cڡ gch **
ibu_mes
,

68 cڡ 
gch
 **
ibu_vues
, 
gpor
 
ur_da
, 
GE
 **
r
)

70 
gut
 
i
;

71 cڡ 
gch
 *
_me
;

72 
gboޗn
 
id_ag
 = 
FALSE
;

73 
gt
 
id
 = 0;

74 
gch
 *
t
 = 
NULL
;

75 
gch
 *
ti
 = 
NULL
;

76 
gch
 *
u
;

77 
GSLi
 *
li
 = *(GSLi **)
ur_da
;

78 
gch
 *
tmp
;

79 
RCLyricCwrSrchDa
 *
ch_da
;

80 if(
	`g_rcmp0
(
emt_me
, "lrc")==0)

82 
i
=0;
ibu_mes
[i]!=
NULL
;i++)

84 
_me
 = 
ibu_mes
[
i
];

85 if(
	`g_rcmp0
(
_me
, "id")==0 && 
ibu_vues
[
i
]!=
NULL
)

87 if(
	`ssnf
(
ibu_vues
[
i
], "%d", &
id
)>0)

89 
id_ag
 = 
TRUE
;

92 if(
	`g_rcmp0
(
_me
, "title")==0

93 && 
ibu_vues
[
i
]!=
NULL
)

95 if(
t
!=
NULL

	`g_
(title);

96 
t
 = 
	`g_rdup
(
ibu_vues
[
i
]);

98 if(
	`g_rcmp0
(
_me
, "artist")==0

99 && 
ibu_vues
[
i
]!=
NULL
)

101 if(
ti
!=
NULL

	`g_
(artist);

102 
ti
 = 
	`g_rdup
(
ibu_vues
[
i
]);

105 if(
id_ag
)

107 
tmp
 = 
	`g_rdup_tf
("%s%s", 
ti
, 
t
);

108 
u
 = 
	`g_rdup_tf
("%sId=%d&Code=%d",

109 
c_ba_u
, 
id
,

110 
	`rc_awr_modu_ay_lc_dowd_code
(
id
, 
tmp
));

111 
	`g_
(
tmp
);

112 
ch_da
 = 
	`g_w0
(
RCLyricCwrSrchDa
, 1);

113 
ch_da
->
t
 =itle;

114 
ch_da
->
ti
 =rtist;

115 
ch_da
->
u
 = url;

116 
li
 = 
	`g_i_nd
i, 
ch_da
);

117 *(
GSLi
 **)
ur_da
 = 
li
;

121 if(
t
!=
NULL

	`g_
(title);

122 if(
ti
!=
NULL

	`g_
(artist);

125 
	}
}

127 
gch
 *
	$rc_awr_modu_ch_cod
(cڡ 
gch
 *
xt
)

129 
gch
 *
utf16_r
;

130 
gch
 *
su
;

131 
gsize
 
utf16_n
;

132 
gsize
 
i
;

133 
gch
 *
tmp
;

134 
gut
 
x
, 
y
;

135 
gut
 
tmp_n
;

136 if(
xt
==
NULL
)  NULL;

137 
tmp
 = 
	`g_utf8_rdown
(
xt
, -1);

138 if(
tmp
==
NULL
)  NULL;

139 
tmp_n
 = 
	`
(
tmp
);

140 
x
=0, 
y
=0;x<
tmp_n
;x++)

142 if(!
	`isbnk
(
tmp
[
x
]))

144 
tmp
[
y
] =mp[
x
];

145 
y
++;

147 if(
tmp
[
x
]=='\0') ;

149 
tmp
[
y
] = '\0';

150 
utf16_r
 = 
	`g_cvt
(
tmp
, -1, "UTF16LE", "UTF-8", 
NULL
,

151 &
utf16_n
, 
NULL
);

152 
	`g_
(
tmp
);

153 if(
utf16_r
==
NULL
)  NULL;

154 if(
utf16_n
<=0)

156 
	`g_
(
utf16_r
);

157  
NULL
;

159 
su
 = 
	`g_w0
(
gch
, 2*
utf16_n
+1);

160 
i
=0;i<
utf16_n
;i++)

162 if((
guch
)
utf16_r
[
i
]!=
L
' ')

163 
	`g_tf
(
su
+2*
i
, 3, "%02X", (
guch
)
utf16_r
[i]);

165 
	`g_
(
utf16_r
);

166  
su
;

167 
	}
}

169 
GSLi
 *
	$rc_awr_modu_g_u_li
(cڡ 
gch
 *
t
,

170 cڡ 
gch
 *
ti
)

172 
gboޗn
 
ag
;

173 
gch
 *
tmp_fe
;

174 
gch
 *
xml_da
;

175 
gch
 *
ch_u
;

176 
gsize
 
xml_n
;

177 
gch
 *
esc_t
, *
esc_ti
;

178 
GMkupPCڋxt
 *
cڋxt
;

179 
GSLi
 *
c_u_li
 = 
NULL
;

180 
GMkupPr
 
rr
 =

182 .
t_emt
 = 
rc_awr_modu_xml_r_t
,

183 .
d_emt
 = 
NULL
,

184 .
xt
 = 
NULL
,

185 .
shrough
 = 
NULL
,

186 .
r
 = 
NULL


188 if(
t
==
NULL
 && 
ti
==NULL)  NULL;

189 if(
t
!=
NULL
)

190 
esc_t
 = 
	`rc_awr_modu_ch_cod
(
t
);

192 
esc_t
 = 
	`g_rdup
("");

193 if(
ti
!=
NULL
)

194 
esc_ti
 = 
	`rc_awr_modu_ch_cod
(
ti
);

196 
esc_ti
 = 
	`g_rdup
("");

197 
ch_u
 = 
	`g_rct
(
music_ba_u
, "Ai=", 
esc_ti
,

198 "&T=", 
esc_t
, "&Fgs=0", 
NULL
);

199 
	`g_
(
esc_t
);

200 
	`g_
(
esc_ti
);

201 
tmp_fe
 = 
	`g_bud_fame
(
	`g_g_tmp_d
(), "RC-TTLRCHTM.tmp", 
NULL
);

202 
ag
 = 
	`rc_cawr_comm_dowd_fe
(
ch_u
, 
tmp_fe
);

203 
	`g_
(
ch_u
);

204 if(!
ag
)

206 
	`g_
(
tmp_fe
);

207  
NULL
;

209 
ag
 = 
	`g_fe_g_cڋs
(
tmp_fe
, &
xml_da
, &
xml_n
, 
NULL
);

210 
	`g_
(
tmp_fe
);

211 if(!
ag
 
NULL
;

212 
cڋxt
 = 
	`g_mkup_r_cڋxt_w
(&
rr
, 0, &
c_u_li
, 
NULL
);

213 
ag
 = 
	`g_mkup_r_cڋxt_r
(
cڋxt
, 
xml_da
, -1, 
NULL
);

214 
	`g_
(
xml_da
);

215 
	`g_mkup_r_cڋxt_
(
cڋxt
);

216 if(!
ag
)

218  
NULL
;

220  
c_u_li
;

221 
	}
}

223 
gboޗn
 
	$rc_awr_modu_dowd_fe
(cڡ 
gch
 *
u
,

224 cڡ 
gch
 *
fe
)

226  
	`rc_cawr_comm_dowd_fe
(
u
, 
fe
);

227 
	}
}

229 
gboޗn
 
	$rc_awr_modu_
(
RCLyricCwrModu
 *
modu
)

231  
TRUE
;

232 
	}
}

234 
RCLyricCwrModuInfo
 
	grc_cawr_modu_fo
 = {

235 .
magic
 = 
RC_LRCCRAWLER_MODULE_MAGIC_NUMBER
,

236 .
	gme
 = "TTPlayer",

237 .
	gdesc
 = "Downloadyric from TTPlayer",

238 .
	gauth
 = "SuperCat",

239 .
	gvsi
 = "0.5",

240 .
	gch_g_u_li
 = 
rc_awr_modu_g_u_li
,

241 .
	gdowd_fe
 = 
rc_awr_modu_dowd_fe


244 
RC_LRCCRAWLER_INIT_MODULE
(
rc_cawr_modu_fo
.
me
,

245 
rc_awr_modu_
, 
rc_cawr_modu_fo
);

	@test/db-converter.c

1 
	~<glib.h
>

2 
	~<js-glib/js-glib.h
>

12 
	mRCLIB_DB_CATALOG_TYPE_PLAYLIST
 = 1

13 }
	tRCLibDbCogTy
;

25 
	mRCLIB_DB_PLAYLIST_TYPE_MISSING
 = 0,

26 
	mRCLIB_DB_PLAYLIST_TYPE_MUSIC
 = 1,

27 
	mRCLIB_DB_PLAYLIST_TYPE_CUE
 = 2

28 }
	tRCLibDbPyliTy
;

30 
_RCLibDbCogDa
 
	tRCLibDbCogDa
;

31 
_RCLibDbPyliDa
 
	tRCLibDbPyliDa
;

32 
_RCLibDb
 
	tRCLibDb
;

33 
_RCLibDbCss
 
	tRCLibDbCss
;

45 
	s_RCLibDbCogDa
 {

47 
gt
 
	mf_cou
;

50 
GSequ
 *
	mayli
;

51 
gch
 *
	mme
;

52 
RCLibDbCogTy
 
	mty
;

53 
gpor
 
	me
;

76 
	s_RCLibDbPyliDa
 {

78 
gt
 
	mf_cou
;

81 
GSequIr
 *
	mlog
;

82 
RCLibDbPyliTy
 
	mty
;

83 
gch
 *
	muri
;

84 
gch
 *
	mt
;

85 
gch
 *
	mti
;

86 
gch
 *
	mbum
;

87 
gch
 *
	my
;

88 
gt64
 
	mngth
;

89 
gt
 
	macknum
;

90 
gt
 
	myr
;

91 
gut
 
	mtg
;

92 
gch
 *
	mlyricfe
;

93 
gch
 *
	mlyriccfe
;

94 
gch
 *
	mbumfe
;

97 
GSequ
 *
	gcv_log
 = 
NULL
;

99 
RCLibDbCogDa
 *
rib_db_log_da_w
();

100 
RCLibDbCogDa
 *
rib_db_log_da_f
(RCLibDbCogD*
da
);

101 
rib_db_log_da_uef
(
RCLibDbCogDa
 *
da
);

102 
rib_db_log_da_
(
RCLibDbCogDa
 *
da
);

103 
RCLibDbPyliDa
 *
rib_db_ayli_da_w
();

104 
RCLibDbPyliDa
 *
rib_db_ayli_da_f
(RCLibDbPyliD*
da
);

105 
rib_db_ayli_da_uef
(
RCLibDbPyliDa
 *
da
);

106 
rib_db_ayli_da_
(
RCLibDbPyliDa
 *
da
);

108 
RCLibDbCogDa
 *
	$rib_db_log_da_w
()

110 
RCLibDbCogDa
 *
da
 = 
	`g_w0
(RCLibDbCatalogData, 1);

111 
da
->
f_cou
 = 1;

112  
da
;

113 
	}
}

115 
RCLibDbCogDa
 *
	$rib_db_log_da_f
(
RCLibDbCogDa
 *
da
)

117 if(
da
==
NULL
)  NULL;

118 
	`g_omic_t_add
(&(
da
->
f_cou
), 1);

119  
da
;

120 
	}
}

122 
	$rib_db_log_da_uef
(
RCLibDbCogDa
 *
da
)

124 if(
da
==
NULL
) ;

125 if(
	`g_omic_t_dec_d_
(&(
da
->
f_cou
)))

126 
	`rib_db_log_da_
(
da
);

127 
	}
}

129 
	$rib_db_log_da_
(
RCLibDbCogDa
 *
da
)

131 if(
da
==
NULL
) ;

132 
	`g_
(
da
->
me
);

133 if(
da
->
ayli
!=
NULL

	`g_qu_
(data->playlist);

134 
	`g_
(
da
);

135 
	}
}

137 
RCLibDbPyliDa
 *
	$rib_db_ayli_da_w
()

139 
RCLibDbPyliDa
 *
da
 = 
	`g_w0
(RCLibDbPlaylistData, 1);

140 
da
->
f_cou
 = 1;

141  
da
;

142 
	}
}

144 
RCLibDbPyliDa
 *
	$rib_db_ayli_da_f
(
RCLibDbPyliDa
 *
da
)

146 if(
da
==
NULL
)  NULL;

147 
	`g_omic_t_add
(&(
da
->
f_cou
), 1);

148  
da
;

149 
	}
}

151 
	$rib_db_ayli_da_uef
(
RCLibDbPyliDa
 *
da
)

153 if(
da
==
NULL
) ;

154 if(
	`g_omic_t_dec_d_
(&(
da
->
f_cou
)))

155 
	`rib_db_ayli_da_
(
da
);

156 
	}
}

158 
	$rib_db_ayli_da_
(
RCLibDbPyliDa
 *
da
)

160 if(
da
==
NULL
) ;

161 
	`g_
(
da
->
uri
);

162 
	`g_
(
da
->
t
);

163 
	`g_
(
da
->
ti
);

164 
	`g_
(
da
->
bum
);

165 
	`g_
(
da
->
y
);

166 
	`g_
(
da
->
lyricfe
);

167 
	`g_
(
da
->
lyriccfe
);

168 
	`g_
(
da
->
bumfe
);

169 
	`g_
(
da
);

170 
	}
}

172 
gboޗn
 
	$rib_db_ld_libry_db
(
GSequ
 *
log
,

173 cڡ 
gch
 *
fe
)

175 
JsObje
 *
ro_obje
, *
log_obje
, *
ayli_obje
;

176 
JsAay
 *
log_y
, *
ayli_y
;

177 
JsNode
 *
ro_node
;

178 
gut
 
i
, 
j
;

179 
gut
 
log_n
, 
ayli_n
;

180 
GE
 *
r
 = 
NULL
;

181 
GSequ
 *
ayli
;

182 
RCLibDbCogDa
 *
log_da
;

183 
RCLibDbPyliDa
 *
ayli_da
;

184 cڡ 
gch
 *
r
;

185 
GSequIr
 *
log_
;

186 
JsPr
 *
rr
;

187 
rr
 = 
	`js_rr_w
();

188 if(!
	`js_rr_ld_om_fe
(
rr
, 
fe
, &
r
))

190 
	`g_wng
("Cnنdyli: %s", 
r
->
mesge
);

191 
	`g_r_
(
r
);

192 
	`g_obje_uef
(
rr
);

193  
FALSE
;

196 
	`g_mesge
("Loadinglaylist....");

197 
ro_node
 = 
	`js_rr_g_ro
(
rr
);

198 if(
ro_node
==
NULL
)

200 
	`g_wng
("Cannotarselaylist!");

201 
	`g_obje_uef
(
rr
);

202  
FALSE
;

204 
G_STMT_START


206 
ro_obje
 = 
	`js_node_g_obje
(
ro_node
);

207 if(
ro_obje
==
NULL
) ;

208 
log_y
 = 
	`js_obje_g_y_memb
(
ro_obje
,

210 if(
log_y
==
NULL
) ;

211 
log_n
 = 
	`js_y_g_ngth
(
log_y
);

212 
i
=0;i<
log_n
;i++)

214 
log_obje
 = 
	`js_y_g_obje_emt
(
log_y
, 
i
);

215 if(
log_obje
==
NULL
) ;

216 
log_da
 = 
	`rib_db_log_da_w
();

217 
r
 = 
	`js_obje_g_rg_memb
(
log_obje
, "Name");

218 if(
r
==
NULL
) str = "Unnamedist";

219 
log_da
->
me
 = 
	`g_rdup
(
r
);

220 
log_da
->
ty
 = 
	`js_obje_g_t_memb
(
log_obje
,

222 
ayli
 = 
	`g_qu_w
((
GDeroyNify
)

223 
rib_db_ayli_da_uef
);

224 
log_da
->
ayli
 =laylist;

225 
log_
 = 
	`g_qu_nd
(
log
, 
log_da
);

226 
ayli_y
 = 
	`js_obje_g_y_memb
(
log_obje
,

228 if(
ayli_y
==
NULL
) ;

229 
ayli_n
 = 
	`js_y_g_ngth
(
ayli_y
);

230 
j
=0;j<
ayli_n
;j++)

232 
ayli_obje
 = 
	`js_y_g_obje_emt
(

233 
ayli_y
, 
j
);

234 if(
ayli_obje
==
NULL
) ;

235 
ayli_da
 = 
	`rib_db_ayli_da_w
();

236 
ayli_da
->
log
 = 
log_
;

237 
ayli_da
->
ty
 = 
	`js_obje_g_t_memb
(

238 
ayli_obje
, "Type");

239 if(
	`js_obje_has_memb
(
ayli_obje
, "URI"))

240 
r
 = 
	`js_obje_g_rg_memb
(
ayli_obje
,

243 
r
 = 
NULL
;

244 
ayli_da
->
uri
 = 
	`g_rdup
(
r
);

245 if(
	`js_obje_has_memb
(
ayli_obje
, "Title"))

246 
r
 = 
	`js_obje_g_rg_memb
(
ayli_obje
,

249 
r
 = 
NULL
;

250 
ayli_da
->
t
 = 
	`g_rdup
(
r
);

251 if(
	`js_obje_has_memb
(
ayli_obje
, "Artist"))

252 
r
 = 
	`js_obje_g_rg_memb
(
ayli_obje
,

255 
r
 = 
NULL
;

256 
ayli_da
->
ti
 = 
	`g_rdup
(
r
);

257 if(
	`js_obje_has_memb
(
ayli_obje
, "Album"))

258 
r
 = 
	`js_obje_g_rg_memb
(
ayli_obje
,

261 
r
 = 
NULL
;

262 
ayli_da
->
bum
 = 
	`g_rdup
(
r
);

263 if(
	`js_obje_has_memb
(
ayli_obje
, "FileType"))

264 
r
 = 
	`js_obje_g_rg_memb
(
ayli_obje
,

267 
r
 = 
NULL
;

268 
ayli_da
->
y
 = 
	`g_rdup
(
r
);

269 if(
	`js_obje_has_memb
(
ayli_obje
, "Length"))

270 
r
 = 
	`js_obje_g_rg_memb
(
ayli_obje
,

273 
r
 = 
NULL
;

274 if(
r
!=
NULL
)

275 
ayli_da
->
ngth
 = 
	`g_ascii_l
(
r
, 
NULL
, 10);

276 if(
	`js_obje_has_memb
(
ayli_obje
, "TrackNum"))

277 
ayli_da
->
acknum
 = 
	`js_obje_g_t_memb
(

278 
ayli_obje
, "TrackNum");

279 if(
	`js_obje_has_memb
(
ayli_obje
, "Year"))

280 
ayli_da
->
yr
 = 
	`js_obje_g_t_memb
(

281 
ayli_obje
, "Year");

282 if(
	`js_obje_has_memb
(
ayli_obje
, "Rating"))

283 
ayli_da
->
tg
 = 
	`js_obje_g_t_memb
(

284 
ayli_obje
, "Rating");

285 if(
	`js_obje_has_memb
(
ayli_obje
, "LyricFile"))

286 
r
 = 
	`js_obje_g_rg_memb
(
ayli_obje
,

289 
r
 = 
NULL
;

290 
ayli_da
->
lyricfe
 = 
	`g_rdup
(
r
);

291 if(
	`js_obje_has_memb
(
ayli_obje
, "LyricSecondFile"))

292 
r
 = 
	`js_obje_g_rg_memb
(
ayli_obje
,

295 
r
 = 
NULL
;

296 
ayli_da
->
lyriccfe
 = 
	`g_rdup
(
r
);

297 if(
	`js_obje_has_memb
(
ayli_obje
, "AlbumFile"))

298 
r
 = 
	`js_obje_g_rg_memb
(
ayli_obje
,

301 
r
 = 
NULL
;

302 
ayli_da
->
bumfe
 = 
	`g_rdup
(
r
);

303 
	`g_qu_nd
(
ayli
, 
ayli_da
);

307 
G_STMT_END
;

308 
	`g_obje_uef
(
rr
);

309  
TRUE
;

310 
	}
}

312 
le
 
GSg
 *
	$rib_db_bud_xml_da
(
GSequ
 *
log
)

314 
RCLibDbCogDa
 *
log_da
;

315 
RCLibDbPyliDa
 *
ayli_da
;

316 
GSequIr
 *
log_
, *
ayli_
;

317 
GSg
 *
da_r
;

318 
gch
 *
tmp
;

319 
gut
 
rib_maj_vsi
;

320 
gut
 
rib_m_vsi
;

321 
gut
 
rib_mio_vsi
;

322 
da_r
 = 
	`g_rg_w
("<?xml version=\"1.0\" standalone=\"yes\"?>\n");

323 
	`g_rg_nd_tf
(
da_r
, "<rclibdb version=\"1.9.4\">\n");

324 
log_
 = 
	`g_qu_g_beg_
(
log
);

325 !
	`g_qu__is_d
(
log_
);

326 
log_
 = 
	`g_qu__xt
(catalog_iter))

328 
log_da
 = 
	`g_qu_g
(
log_
);

329 
tmp
 = 
	`g_mkup_tf_esd
(" <playlistame=\"%s\"ype=\"%u\">\n",

330 
log_da
->
me
, cog_da->
ty
);

331 
	`g_rg_nd
(
da_r
, 
tmp
);

332 
	`g_
(
tmp
);

333 
ayli_
 = 
	`g_qu_g_beg_
(
log_da
->
ayli
);

334 !
	`g_qu__is_d
(
ayli_
);

335 
ayli_
 = 
	`g_qu__xt
(playlist_iter))

337 
ayli_da
 = 
	`g_qu_g
(
ayli_
);

338 
	`g_rg_nd_tf
(
da_r
, " <itemype=\"%u\" ",

339 
ayli_da
->
ty
);

340 if(
ayli_da
->
uri
!=
NULL
)

342 
tmp
 = 
	`g_mkup_tf_esd
("uri=\"%s\" ",

343 
ayli_da
->
uri
);

344 
	`g_rg_nd
(
da_r
, 
tmp
);

345 
	`g_
(
tmp
);

347 if(
ayli_da
->
t
!=
NULL
)

349 
tmp
 = 
	`g_mkup_tf_esd
("title=\"%s\" ",

350 
ayli_da
->
t
);

351 
	`g_rg_nd
(
da_r
, 
tmp
);

352 
	`g_
(
tmp
);

354 if(
ayli_da
->
ti
!=
NULL
)

356 
tmp
 = 
	`g_mkup_tf_esd
("artist=\"%s\" ",

357 
ayli_da
->
ti
);

358 
	`g_rg_nd
(
da_r
, 
tmp
);

359 
	`g_
(
tmp
);

361 if(
ayli_da
->
bum
!=
NULL
)

363 
tmp
 = 
	`g_mkup_tf_esd
("album=\"%s\" ",

364 
ayli_da
->
bum
);

365 
	`g_rg_nd
(
da_r
, 
tmp
);

366 
	`g_
(
tmp
);

368 if(
ayli_da
->
y
!=
NULL
)

370 
tmp
 = 
	`g_mkup_tf_esd
("filetype=\"%s\" ",

371 
ayli_da
->
y
);

372 
	`g_rg_nd
(
da_r
, 
tmp
);

373 
	`g_
(
tmp
);

375 
tmp
 = 
	`g_mkup_tf_esd
("ngth=\"%"
G_GINT64_FORMAT
"\" ",

376 
ayli_da
->
ngth
);

377 
	`g_rg_nd
(
da_r
, 
tmp
);

378 
	`g_
(
tmp
);

379 
tmp
 = 
	`g_mkup_tf_esd
("tracknum=\"%d\" year=\"%d\" "

380 "tg=\"%f\" ", 
ayli_da
->
acknum
,

381 
ayli_da
->
yr
,yli_da->
tg
);

382 
	`g_rg_nd
(
da_r
, 
tmp
);

383 
	`g_
(
tmp
);

384 if(
ayli_da
->
lyricfe
!=
NULL
)

386 
tmp
 = 
	`g_mkup_tf_esd
("lyricfile=\"%s\" ",

387 
ayli_da
->
lyricfe
);

388 
	`g_rg_nd
(
da_r
, 
tmp
);

389 
	`g_
(
tmp
);

391 if(
ayli_da
->
bumfe
!=
NULL
)

393 
tmp
 = 
	`g_mkup_tf_esd
("albumfile=\"%s\" ",

394 
ayli_da
->
bumfe
);

395 
	`g_rg_nd
(
da_r
, 
tmp
);

396 
	`g_
(
tmp
);

398 if(
ayli_da
->
lyriccfe
!=
NULL
)

400 
tmp
 = 
	`g_mkup_tf_esd
("lyricsecondfile=\"%s\" ",

401 
ayli_da
->
lyriccfe
);

402 
	`g_rg_nd
(
da_r
, 
tmp
);

403 
	`g_
(
tmp
);

405 
	`g_rg_nd
(
da_r
, "/>\n");

407 
	`g_rg_nd
(
da_r
, " </playlist>\n");

409 
	`g_rg_nd
(
da_r
, "</rclibdb>\n");

410  
da_r
;

411 
	}
}

413 
gboޗn
 
	$rib_db_ve_libry_db
(
GSequ
 *
log
,

414 cڡ 
gch
 *
fe
)

416 
GSg
 *
xml_r
;

417 
GZlibComess
 *
comess
;

418 
GFeOuutSm
 *
fe_oam
;

419 
GOuutSm
 *
comess_oam
;

420 
GFe
 *
ouut_fe
;

421 
gssize
 
wre_size
;

422 
GE
 *
r
 = 
NULL
;

423 
gboޗn
 
ag
 = 
TRUE
;

424 
ouut_fe
 = 
	`g_fe_w_f_th
(
fe
);

425 if(
ouut_fe
==
NULL
 
FALSE
;

426 
xml_r
 = 
	`rib_db_bud_xml_da
(
log
);

427 if(
xml_r
==
NULL
 
FALSE
;

428 
fe_oam
 = 
	`g_fe_a
(
ouut_fe
, 
NULL
, 
FALSE
,

429 
G_FILE_CREATE_PRIVATE
, 
NULL
, &
r
);

430 
	`g_obje_uef
(
ouut_fe
);

431 if(
fe_oam
==
NULL
)

433 
	`g_wng
("Cn oouufam: %s", 
r
->
mesge
);

434 
	`g_r_
(
r
);

435 
r
 = 
NULL
;

436  
FALSE
;

438 
comess
 = 
	`g_zlib_comess_w
(
G_ZLIB_COMPRESSOR_FORMAT_ZLIB
, 5);

439 
comess_oam
 = 
	`g_cvr_ouut_am_w
(
	`G_OUTPUT_STREAM
(

440 
fe_oam
), 
	`G_CONVERTER
(
comess
));

441 
	`g_obje_uef
(
fe_oam
);

442 
	`g_obje_uef
(
comess
);

443 
wre_size
 = 
	`g_ouut_am_wre
(
comess_oam
, 
xml_r
->
r
,

444 
xml_r
->
n
, 
NULL
, &
r
);

445 if(
r
!=
NULL
)

447 
	`g_wng
("Cn savayli: %s", 
r
->
mesge
);

448 
	`g_r_
(
r
);

449 
r
 = 
NULL
;

450 
ag
 = 
FALSE
;

452 
	`g_ouut_am_o
(
comess_oam
, 
NULL
, &
r
);

453 if(
r
!=
NULL
)

455 
	`g_wng
("Cn clo fam: %s", 
r
->
mesge
);

456 
	`g_r_
(
r
);

457 
r
 = 
NULL
;

458 
ag
 = 
FALSE
;

460 
	`g_obje_uef
(
comess_oam
);

461 if(
ag
)

463 
	`g_mesge
("Pyli saved, wrِ%ld bys.", (
glg
)
wre_size
);

465  
ag
;

466 
	}
}

468 
	$ma
()

470 cڡ 
gch
 *
home_d
 = 
NULL
;

471 
gch
 *
db_fe
, *
zdb_fe
;

472 
gboޗn
 
ag
;

473 
	`g_ty_
();

474 
cv_log
 = 
	`g_qu_w
((
GDeroyNify
)

475 
rib_db_log_da_uef
);

476 
	`g_mesge
("Loadinglaylist data...");

477 
home_d
 = 
	`g_gv
("HOME");

478 if(
home_d
==
NULL
)

479 
home_d
 = 
	`g_g_home_d
();

480 
db_fe
 = 
	`g_bud_fame
(
home_d
, ".RhythmC2", "libry.db", 
NULL
);

481 
ag
 = 
	`rib_db_ld_libry_db
(
cv_log
, 
db_fe
);

482 
	`g_
(
db_fe
);

483 if(!
ag
)

485 
	`g_r
("Cannoteadlaylist database data!");

488 
	`g_mesge
("Playlist dataoaded.");

489 
zdb_fe
 = 
	`g_bud_fame
(
home_d
, ".RhythmC2", "libry.zdb", 
NULL
);

490 
ag
 = 
	`rib_db_ve_libry_db
(
cv_log
, 
zdb_fe
);

491 
	`g_
(
zdb_fe
);

492 
	`g_qu_
(
cv_log
);

493 if(!
ag
)

495 
	`g_r
("Cannot save compressedlaylist database data!");

499 
	}
}

	@ui/main.c

26 
	~"rc-ma.h
"

28 
	$ma
(
gc
, *
gv
[])

30 
gt
 
t
;

31 
t
 = 
	`rc_ma_run
(&
gc
, &
gv
);

32 
	`rc_ma_ex
();

33  
t
;

34 
	}
}

	@ui/rc-common.h

25 #ide
HAVE_RC_COMMON_H


26 
	#HAVE_RC_COMMON_H


	)

28 
	~<glib.h
>

29 
	~<glib/gi18n.h
>

31 
	gG_BEGIN_DECLS


33 #ifde
G_LOG_DOMAIN


34 #unde
G_LOG_DOMAIN


37 
	#G_LOG_DOMAIN
 "RhythmC2"

	)

38 
	#GETTEXT_PACKAGE
 "RhythmC2"

	)

39 
	#PACKAGE
 "RhythmC2"

	)

41 
	gG_END_DECLS


	@ui/rc-main.c

26 
	~<glib.h
>

27 
	~<g/g.h
>

28 
	~<glib/gtf.h
>

29 
	~<rib.h
>

30 
	~"rc-ma.h
"

31 
	~"rc-ui-ay.h
"

32 
	~"rc-ui-wdow.h
"

33 
	~"rc-ui-livw.h
"

34 
	~"rc-comm.h
"

35 
	~"rc-ui-y.h
"

36 
	~"rc-ui-sours.h
"

37 
	~"rc-ui-dlog.h
"

38 
	~"rc-ui-erum.h
"

40 #ifde
ENABLE_INTROSPECTION


41 
	~<gosy.h
>

57 
	s_RCMaAlitiPrive


59 
gt
 
	mdummy
;

62 
GObje
 *
	gma_iti_
 = 
NULL
;

63 
gpor
 
	grc_ma_iti__ass
 = 
NULL
;

64 
gch
 
	gma_p_id
[] = "org.rhythmcat.RhythmCat2";

65 
gboޗn
 
	gma_debug_ag
 = 
FALSE
;

66 
gboޗn
 
	gma_mloc_ag
 = 
FALSE
;

67 
gch
 **
	gma_mag_gs
 = 
NULL
;

68 
gch
 *
	gma_da_d
 = 
NULL
;

69 
gch
 *
	gma_ur_d
 = 
NULL
;

71 
le
 
	$rc_ma_gs_
()

73 if(!
	`rib_gs_has_key
("MaUI", "MimizeToTy", 
NULL
))

74 
	`rib_gs_t_boޗn
("MaUI", "MimizeToTy", 
FALSE
);

75 if(!
	`rib_gs_has_key
("MaUI", "MimizeWhClo", 
NULL
))

76 
	`rib_gs_t_boޗn
("MaUI", "MimizeWhClo", 
FALSE
);

77 if(!
	`rib_gs_has_key
("MaUI", "SrumSty", 
NULL
))

79 
	`rib_gs_t_g
("MainUI", "SpectrumStyle",

80 
RC_UI_SPECTRUM_STYLE_WAVE_MULTI
);

82 
	}
}

84 
gboޗn
 
	$rc_ma_autove_id
(
gpor
 
da
)

86 
	`rc_ui_dlog_show_ld_autoved
();

87  
FALSE
;

88 
	}
}

90 
	$rc_ma_p_aive
(
GAliti
 *
iti
)

92 
GtkStgs
 *
gs
;

93 
gch
 *
theme
;

94 
gch
 *
theme_fe
;

95 
gch
 *
ug_d
;

96 
gch
 *
ug_cf
;

97 
GFe
 *
efixd_gfe
;

98 
GFe
 *
libd_gfe
;

99 
gch
 *
libd_me
 = 
NULL
;

100 
GSequIr
 *
log_
 = 
NULL
;

101 
GSequ
 *
log
 = 
NULL
;

102 
RCLibDbCogDa
 *
log_da
 = 
NULL
;

103 
GSequIr
 *
ayli_
 = 
NULL
;

104 
GFe
 *
fe
;

105 
gch
 *
uri
;

106 
gt
 
i
;

107 
gboޗn
 
theme_ag
 = 
FALSE
;

108 
gboޗn
 
cumn_ag
;

109 
gut
 
cumn_ags
 = 0;

110 
gut
 
ug_numb
 = 0;

111 
gch
 *
tmp_rg
;

112 
GE
 *
r
 = 
NULL
;

113 if(
iti
!=
NULL
)

114 
	`rc_ui_ay_
(
	`GTK_APPLICATION
(
iti
));

116 
	`rc_ui_ay_
(
NULL
);

117 if(!
	`rib_gs_g_boޗn
("MaUI", "DibTheme", 
NULL
))

119 
gs
 = 
	`gtk_gs_g_deu
();

120 
	`g_obje_t
(
gs
, "gtk-theme-name", "Adwaita",

121 "gtk-iti-er-dk-theme", 
TRUE
, 
NULL
);

122 
theme
 = 
	`rib_gs_g_rg
("MaUI", "Theme", 
NULL
);

123 if(
theme
!=
NULL
 && 
	`
(theme)>0)

125 if(
	`g_r_has_efix
(
theme
, "embedded-theme:"))

127 
theme_ag
 = 
	`rc_ui_y_embedded_theme_t_by_me
(

128 
theme
+14);

132 
theme_fe
 = 
	`g_bud_fame
(
theme
, "gtk3.css", 
NULL
);

133 
theme_ag
 = 
	`rc_ui_y_css_t_fe
(
theme_fe
);

134 
	`g_
(
theme_fe
);

136 if(!
theme_ag
)

138 
	`rc_ui_y_embedded_theme_t_deu
();

143 
	`rc_ui_y_embedded_theme_t_deu
();

145 
	`g_
(
theme
);

147 
	`rib_gs_y
();

148 if(
	`rib_gs_has_key
("MaUI", "HideCovImage", 
NULL
))

150 
	`rc_ui_ma_wdow_cov_image_t_visib
(

151 !
	`rib_gs_g_boޗn
("MaUI", "HideCovImage", 
NULL
));

153 if(
	`rib_gs_has_key
("MaUI", "HideLyricLabs", 
NULL
))

155 
	`rc_ui_ma_wdow_lyric_bs_t_visib
(

156 !
	`rib_gs_g_boޗn
("MaUI", "HideLyricLabs", 
NULL
));

158 if(
	`rib_gs_has_key
("MaUI", "HideSrumWidg", 
NULL
))

160 
	`rc_ui_ma_wdow_erum_t_visib
(

161 !
	`rib_gs_g_boޗn
("MainUI", "HideSpectrumWidget",

162 
NULL
));

164 if(
	`rib_gs_g_boޗn
("MaUI", "UMuiCumns", 
NULL
))

166 
	`rc_ui_livw_ayli_t_cumn_diy_mode
(
TRUE
);

167 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

168 "PyliCumnAiEbd", 
NULL
);

169 if(
cumn_ag
)

170 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
;

171 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

172 "PyliCumnAlbumEbd", 
NULL
);

173 if(
cumn_ag
)

174 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
;

175 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

176 "PyliCumnTckNumbEbd", 
NULL
);

177 if(
cumn_ag
)

178 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
;

179 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

180 "PyliCumnYrEbd", 
NULL
);

181 if(
cumn_ag
)

182 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
;

183 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

184 "PyliCumnFeTyEbd", 
NULL
);

185 if(
cumn_ag
)

186 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
;

187 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

188 "PyliCumnRgEbd", 
NULL
);

189 if(
cumn_ag
)

190 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
;

191 
	`rc_ui_livw_ayli_t_abd_cumns
(

192 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
 |

193 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
 |

194 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
 |

195 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
 |

196 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
 |

197 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
,

198 
cumn_ags
);

202 
tmp_rg
 = 
	`rib_gs_g_rg
("MainUI",

203 "PyliTFm", 
NULL
);

204 if(
tmp_rg
!=
NULL
 && 
	`g_rr_n
(tmp_string, -1, "%TITLE")!=NULL)

205 
	`rc_ui_livw_ayli_t_t_fm
(
tmp_rg
);

206 
	`g_
(
tmp_rg
);

208 
r
 = 
NULL
;

209 
i
 = 
	`rib_gs_g_g
("MainUI", "SpectrumStyle",

210 &
r
);

211 if(
r
==
NULL
)

213 
	`rc_ui_ma_wdow_erum_t_y
(
i
);

217 
	`rc_ui_ma_wdow_erum_t_y
(

218 
RC_UI_SPECTRUM_STYLE_WAVE_MULTI
);

219 
	`g_r_
(
r
);

220 
r
 = 
NULL
;

222 
ug_cf
 = 
	`g_bud_fame
(
ma_ur_d
, "plugins.conf",

223 
NULL
);

224 
	`rib_ug_
(
ug_cf
);

225 
	`g_
(
ug_cf
);

226 
ug_d
 = 
	`g_bud_fame
(
ma_ur_d
, "Plugs", 
NULL
);

227 
	`g_mkd_wh_s
(
ug_d
, 0700);

228 
	`rib_ug_ld_om_d
(
ug_d
);

229 
efixd_gfe
 = 
	`g_fe_w_f_th
(
PREFIXDIR
);

230 
libd_gfe
 = 
	`g_fe_w_f_th
(
LIBDIR
);

231 if(
efixd_gfe
!=
NULL
 && 
libd_gfe
!=NULL)

233 
libd_me
 = 
	`g_fe_g_tive_th
(
efixd_gfe
,

234 
libd_gfe
);

236 if(
efixd_gfe
!=
NULL

	`g_obje_uef
(prefixdir_gfile);

237 if(
libd_gfe
!=
NULL

	`g_obje_uef
(libdir_gfile);

238 if(
libd_me
==
NULL
libd_m
	`g_rdup
("lib");

239 
ug_d
 = 
	`g_bud_fame
(
ma_da_d
, "..", "..", 
libd_me
,

240 "RhythmC2", "ugs", 
NULL
);

241 
	`g_
(
libd_me
);

242 if(
	`g_fe_
(
ug_d
, 
G_FILE_TEST_IS_DIR
))

243 
ug_numb
 = 
	`rib_ug_ld_om_d
(
ug_d
);

244 
	`g_
(
ug_d
);

245 if(
ug_numb
==0)

247 
ug_d
 = 
	`g_bud_fame
(
LIBDIR
, "RhythmC2", "ugs", 
NULL
);

248 if(
	`g_fe_
(
ug_d
, 
G_FILE_TEST_IS_DIR
))

249 
	`rib_ug_ld_om_d
(
ug_d
);

250 
	`g_
(
ug_d
);

252 
	`rib_ug_ld_om_cfigu
();

253 
log
 = 
	`rib_db_g_log
();

254 if(
	`rib_gs_g_boޗn
("Py", "LdLaPosi", 
NULL
) &&

255 
log
!=
NULL
)

257 
log_
 = 
	`g_qu_g___pos
(
log
,

258 
	`rib_gs_g_g
("Py", "LaPyedCog", 
NULL
));

259 if(
log_
!=
NULL
)

260 
log_da
 = 
	`g_qu_g
(
log_
);

261 if(
log_da
!=
NULL
 && cog_da->
ayli
!=NULL)

263 
ayli_
 = 
	`g_qu_g___pos
(

264 
log_da
->
ayli
, 
	`rib_gs_g_g
(

265 "Py", "LaPyedMusic", 
NULL
));

267 if(
ayli_
!=
NULL
)

269 
	`rib_ay_ay_db
(
ayli_
);

270 if(!
	`rib_gs_g_boޗn
("Player", "AutoPlayWhenStartup",

271 
NULL
))

272 
	`rib_ce_u
();

276 if(
	`rib_gs_g_boޗn
("Player", "AutoPlayWhenStartup",

277 
NULL
&& 
log
!=NULL)

279 if(
log
!=
NULL
)

280 
log_
 = 
	`g_qu_g_beg_
(
log
);

281 if(
log_
!=
NULL
)

282 
log_da
 = 
	`g_qu_g
(
log_
);

283 if(
log_da
!=
NULL
 && cog_da->
ayli
!=NULL)

284 
ayli_
 = 
	`g_qu_g_beg_
(

285 
log_da
->
ayli
);

286 if(
ayli_
!=
NULL
)

287 
	`rib_ay_ay_db
(
ayli_
);

289 
	`rc_ui_ma_wdow_show
();

290 if(
ma_mag_gs
!=
NULL
)

292 if(
log
!=
NULL
)

293 
log_
 = 
	`g_qu_g_beg_
(
log
);

294 if(
log_
!=
NULL
)

296 
i
=0;
ma_mag_gs
[i]!=
NULL
;i++)

298 
fe
 = 
	`g_fe_w_f_commdle_g
(

299 
ma_mag_gs
[
i
]);

300 if(
fe
==
NULL
) ;

301 
uri
 = 
	`g_fe_g_uri
(
fe
);

302 if(
uri
!=
NULL
)

303 
	`rib_db_ayli_add_music
(
log_
, 
NULL
, 
uri
);

304 
	`g_
(
uri
);

305 
	`g_obje_uef
(
fe
);

309 if(
	`rib_db_autoved_exi
())

310 
	`g_id_add
(
rc_ma_autove_id
, 
NULL
);

311 
	}
}

313 
	$rc_ma_p_ݒ
(
GAliti
 *
iti
, 
GFe
 **
fes
,

314 
gt
 
n_fes
, cڡ 
gch
 *
ht
)

316 
GtkTeIr
 
_
;

317 
GSequIr
 *
log_
 = 
NULL
;

318 
GSequ
 *
log
;

319 
gt
 
i
;

320 
gch
 *
uri
;

321 if(
fes
==
NULL
) ;

322 if(
	`rc_ui_livw_log_g_curs
(&
_
))

323 
log_
 = 
_
.
ur_da
;

326 
log
 = 
	`rib_db_g_log
();

327 if(
log
!=
NULL
)

328 
log_
 = 
	`g_qu_g_beg_
(
log
);

330 if(
log_
==
NULL
) ;

331 
i
=0;i<
n_fes
;i++)

333 if(
fes
[
i
]==
NULL
) ;

334 
uri
 = 
	`g_fe_g_uri
(
fes
[
i
]);

335 if(
uri
==
NULL
) ;

336 
	`rib_db_ayli_add_music
(
log_
, 
NULL
, 
uri
);

337 
	`g_
(
uri
);

339 
	}
}

341 
gboޗn
 
	$rc_ma_t_vsi
(cڡ 
gch
 *
ti_me
,

342 cڡ 
gch
 *
vue
, 
gpor
 
da
, 
GE
 **
r
)

344 
	`g_t
(
	`_
("RhythmCat2,ibrary version %d.%d.%d\n"

347 
rib_maj_vsi
, 
rib_m_vsi
, 
rib_mio_vsi
);

348 
	`ex
(0);

349  
TRUE
;

350 
	}
}

352 
	$rc_ma_iti_fize
(
GObje
 *
obje
)

354 
	`G_OBJECT_CLASS
(
rc_ma_iti__ass
)->
	`fize
(
obje
);

355 
	}
}

357 
GObje
 *
	$rc_ma_iti_cڡru
(
GTy
 
ty
,

358 
gut
 
n_cڡru_ms
, 
GObjeCڡruPam
 *
cڡru_ms
)

360 
GObje
 *
tv
;

361 if(
ma_iti_
!=
NULL
)  main_application_instance;

362 
tv
 = 
	`G_OBJECT_CLASS
(
rc_ma_iti__ass
)->
cڡru


363 (
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

364 
ma_iti_
 = 
tv
;

365 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
ma_iti_
);

366  
tv
;

367 
	}
}

369 
	$rc_ma_iti_ass_
(
RCMaAlitiCss
 *
kss
)

371 
GObjeCss
 *
obje_ass
;

372 
GAlitiCss
 *
iti_ass
;

373 
obje_ass
 = 
	`G_OBJECT_CLASS
(
kss
);

374 
rc_ma_iti__ass
 = 
	`g_ty_ass_ek_
(
kss
);

375 
obje_ass
->
cڡru
 = 
rc_ma_iti_cڡru
;

376 
obje_ass
->
fize
 = 
rc_ma_iti_fize
;

378 
iti_ass
 = 
	`G_APPLICATION_CLASS
(
kss
);

379 
iti_ass
->
ݒ
 = 
rc_ma_p_ݒ
;

380 
iti_ass
->
aive
 = 
rc_ma_p_aive
;

382 
	`g_ty_ass_add_ive
(
kss
, (
RCMaAlitiPrive
));

383 
	}
}

385 
	$rc_ma_iti__
(
RCMaAliti
 *
p
)

387 
RCMaAlitiPrive
 *
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
p
,

388 
RC_TYPE_MAIN_APPLICATION
, 
RCMaAlitiPrive
);

389 
p
->
iv
 =riv;

390 
	}
}

392 
GTy
 
	$rc_ma_iti_g_ty
()

394 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

395 
GTy
 
g_defe_ty_id
;

396 cڡ 
GTyInfo
 
p_fo
 = {

397 .
ass_size
 = (
RCMaAlitiCss
),

398 .
ba_
 = 
NULL
,

399 .
ba_fize
 = 
NULL
,

400 .
ass_
 = (
GCssInFunc
)
rc_ma_iti_ass_
,

401 .
ass_fize
 = 
NULL
,

402 .
ass_da
 = 
NULL
,

403 .
_size
 = (
RCMaAliti
),

404 .
n_ocs
 = 0,

405 .
_
 = (
GInInFunc
)
rc_ma_iti__


407 if(
	`g___r
(&
g_defe_ty_id__vީe
))

409 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
GTK_TYPE_APPLICATION
,

410 
	`g__ic_rg
("RCMaAliti"), &
p_fo
, 0);

411 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

413  
g_defe_ty_id__vީe
;

414 
	}
}

429 
gt
 
	$rc_ma_run
(
gt
 *
gc
, 
gch
 **
gv
[])

431 
GOiEry
 
tis
[] =

433 {"debug", 'd', 0, 
G_OPTION_ARG_NONE
, &
ma_debug_ag
,

434 
	`N_
("Eb debug mode"), 
NULL
},

435 {"u-d-mloc", 0, 0, 
G_OPTION_ARG_NONE
, &
ma_mloc_ag
,

436 
	`N_
("U mlofuni idd Cibry"), 
NULL
},

437 {
G_OPTION_REMAINING
, 0, 0, 
G_OPTION_ARG_STRING_ARRAY
,

438 &
ma_mag_gs
, 
NULL
, "[URI...]"},

439 {"vsi", 0, 
G_OPTION_FLAG_NO_ARG
, 
G_OPTION_ARG_CALLBACK
,

440 
rc_ma_t_vsi
,

441 
	`N_
("Ouuvsi infmiڇndx"), 
NULL
},

442 {
NULL
}

444 
GOiCڋxt
 *
cڋxt
;

445 
GtkAliti
 *
p
;

446 
GSequ
 *
log
;

447 
GE
 *
r
 = 
NULL
;

448 cڡ 
gch
 *
home_d
 = 
NULL
;

449 
gt
 
us
;

450 
GFe
 **
me_fes
;

451 
gut
 
me_fe_num
;

452 
gut
 
i
;

453 
gch
 *
lo_d
;

454 
	`o
(
LC_ALL
, 
NULL
);

455 
ma_da_d
 = 
	`rib_ut_g_da_d
("RhythmC2", *
gv
[0]);

456 
lo_d
 = 
	`g_bud_fame
(
ma_da_d
, "..", "lo", 
NULL
);

457 if(
	`g_fe_
(
lo_d
, 
G_FILE_TEST_IS_DIR
))

459 
	`bdxtdoma
(
GETTEXT_PACKAGE
, 
lo_d
);

460 
	`g_
(
lo_d
);

464 
	`bdxtdoma
(
GETTEXT_PACKAGE
, 
LOCALEDIR
);

466 
	`bd_xtdoma_codet
(
GETTEXT_PACKAGE
, "UTF-8");

467 
	`xtdoma
(
GETTEXT_PACKAGE
);

468 
cڋxt
 = 
	`g_ti_cڋxt_w
(
NULL
);

469 
	`g_ti_cڋxt_add_ma_s
(
cڋxt
, 
tis
, 
GETTEXT_PACKAGE
);

470 
	`g_ti_cڋxt_add_group
(
cڋxt
, 
	`g__g_ti_group
());

471 
	`g_ti_cڋxt_add_group
(
cڋxt
, 
	`gtk_g_ti_group
(
TRUE
));

472 #ifde
ENABLE_INTROSPECTION


473 
	`g_ti_cڋxt_add_group
(
cڋxt
,

474 
	`g_osy_g_ti_group
());

476 if(!
	`g_ti_cڋxt_r
(
cڋxt
, 
gc
, 
gv
, &
r
))

478 
	`g_t
(
	`_
("%s\nRun '%s --help'o see fullist ofvailable "

479 "commdtis.\n"), 
r
->
mesge
, *
gv
[0]);

480 
	`g_r_
(
r
);

481 
	`g_ti_cڋxt_
(
cڋxt
);

482 
	`ex
(1);

484 
	`g_ti_cڋxt_
(
cڋxt
);

485 
	`g_ndom_t_ed
(
	`time
(0));

486 if(
ma_mloc_ag
)

487 
	`g_i_t_cfig
(
G_SLICE_CONFIG_ALWAYS_MALLOC
, 
TRUE
);

488 if(
ma_debug_ag
)

490 
	`g_t_iti_me
("RhythmCat2");

491 
	`g_t_gme
("RhythmCat2");

492 
p
 = 
	`g_obje_w
(
RC_TYPE_MAIN_APPLICATION
, "application-id",

493 
ma_p_id
, "ags", 
G_APPLICATION_HANDLES_OPEN
, 
NULL
);

494 if(
p
!=
NULL
)

496 if(!
	`g_iti_gi
(
	`G_APPLICATION
(
p
), 
NULL
, &
r
))

498 
	`g_wng
("Cnلegiy: %s", 
r
->
mesge
);

499 
	`g_r_
(
r
);

500 
r
 = 
NULL
;

502 if(
	`g_iti_g_is_gied
(
	`G_APPLICATION
(
p
)))

504 if(
	`g_iti_g_is_me
(
	`G_APPLICATION
(
p
)))

506 
	`g_mesge
("Thislayer isunninglready!");

507 if(
ma_mag_gs
==
NULL

	`ex
(0);

508 
me_fe_num
 = 
	`g_rv_ngth
(
ma_mag_gs
);

509 if(
me_fe_num
<1
	`ex
(0);

510 
me_fes
 = 
	`g_w0
(
GFe
 *, 
me_fe_num
);

511 
i
=0;
ma_mag_gs
[i]!=
NULL
;i++)

513 
me_fes
[
i
] = 
	`g_fe_w_f_commdle_g
(

514 
ma_mag_gs
[
i
]);

516 
	`g_iti_ݒ
(
	`G_APPLICATION
(
p
), 
me_fes
,

517 
me_fe_num
, "RhythmCat2::open");

518 
i
=0;i<
me_fe_num
;i++)

519 
	`g_obje_uef
(
me_fes
[
i
]);

520 
	`g_
(
me_fes
);

521 
	`ex
(0);

525 
home_d
 = 
	`g_gv
("HOME");

526 if(
home_d
==
NULL
)

527 
home_d
 = 
	`g_g_home_d
();

528 
ma_ur_d
 = 
	`g_bud_fame
(
home_d
, ".RhythmC2", 
NULL
);

529 if(!
	`rib_
(
gc
, 
gv
, 
ma_ur_d
, &
r
))

531 
	`g_r
("Cnنd ce: %s", 
r
->
mesge
);

532 
	`g_r_
(
r
);

533 
	`g_
(
ma_ur_d
);

534 
	`g_
(
ma_da_d
);

535 
ma_ur_d
 = 
NULL
;

538 
	`rc_ma_gs_
();

539 
	`gdk_thads_
();

540 
	`g_t
("LibRhythmCatoaded. Version: %d.%d.%d, build date: %s\n",

541 
rib_maj_vsi
, 
rib_m_vsi
, 
rib_mio_vsi
,

542 
rib_bud_de
);

543 
log
 = 
	`rib_db_g_log
();

544 if(
log
!=
NULL
 && 
	`g_qu_g_ngth
(catalog)==0)

545 
	`rib_db_log_add
(
	`_
("Deu Pyli"), 
NULL
,

546 
RCLIB_DB_CATALOG_TYPE_PLAYLIST
);

547 
	`g_sours_gi
(
	`rc_ui_sours_g_sour
());

548 if(
p
!=
NULL
)

549 
us
 = 
	`g_iti_run
(
	`G_APPLICATION
(
p
), *
gc
, *
gv
);

552 
	`gtk_
(
gc
, 
gv
);

553 
	`rc_ma_p_aive
(
NULL
);

554 
	`gtk_ma
();

555 
us
 = 0;

557 
	`g_sours_uegi
(
	`rc_ui_sours_g_sour
());

558 
	`g_obje_uef
(
p
);

559  
us
;

560 
	}
}

568 
	$rc_ma_ex
()

570 
	`rc_ui_ay_ex
();

571 
	`rib_ug_ex
();

572 
	`rib_ex
();

573 
	`g_
(
ma_da_d
);

574 
	`g_
(
ma_ur_d
);

575 
	}
}

585 cڡ 
gch
 *
	$rc_ma_g_da_d
()

587  
ma_da_d
;

588 
	}
}

599 cڡ 
gch
 *
	$rc_ma_g_ur_d
()

601  
ma_ur_d
;

602 
	}
}

	@ui/rc-main.h

25 #ide
HAVE_RC_MAIN_H


26 
	#HAVE_RC_MAIN_H


	)

28 
	~<glib.h
>

29 
	~<gtk/gtk.h
>

30 
	~<rib.h
>

32 
	gG_BEGIN_DECLS


34 
	#RC_TYPE_MAIN_APPLICATION
 (
	`rc_ma_iti_g_ty
())

	)

35 
	#RC_MAIN_APPLICATION
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

36 
RC_TYPE_MAIN_APPLICATION
, 
RCMaAliti
))

	)

37 
	#RC_MAIN_APPLICATION_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_CAST
((k), \

38 
RC_TYPE_MAIN_APPLICATION
, 
RCMaAlitiCss
))

	)

39 
	#RC_IS_MAIN_APPLICATION
(
o
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((o), \

40 
RC_TYPE_MAIN_APPLICATION
))

	)

41 
	#RC_IS_MAIN_APPLICATION_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_TYPE
((k), \

42 
RC_TYPE_MAIN_APPLICATION
))

	)

43 
	#RC_MAIN_APPLICATION_GET_CLASS
(
o
(
	`G_TYPE_INSTANCE_GET_CLASS
((o), \

44 
RC_TYPE_MAIN_APPLICATION
, 
RCMaAlitiCss
))

	)

46 
_RCMaAliti
 
	tRCMaAliti
;

47 
_RCMaAlitiCss
 
	tRCMaAlitiCss
;

48 
_RCMaAlitiPrive
 
	tRCMaAlitiPrive
;

56 
	s_RCMaAliti
 {

58 
GtkAliti
 
	m
;

59 
RCMaAlitiPrive
 *
	miv
;

68 
	s_RCMaAlitiCss
 {

70 
GtkAlitiCss
 
	m_ass
;

74 
GTy
 
rc_ma_iti_g_ty
();

76 
gt
 
rc_ma_run
(g*
gc
, 
gch
 **
gv
[]);

77 
rc_ma_ex
();

78 cڡ 
gch
 *
rc_ma_g_da_d
();

79 cڡ 
gch
 *
rc_ma_g_ur_d
();

81 
	gG_END_DECLS


	@ui/rc-marshal.c

2 
	~<glib-obje.h
>

5 #ifde
G_ENABLE_DEBUG


6 
	#g_msh_vue_ek_boޗn
(
v

	`g_vue_g_boޗn
 (v)

	)

7 
	#g_msh_vue_ek_ch
(
v

	`g_vue_g_sch
 (v)

	)

8 
	#g_msh_vue_ek_uch
(
v

	`g_vue_g_uch
 (v)

	)

9 
	#g_msh_vue_ek_t
(
v

	`g_vue_g_t
 (v)

	)

10 
	#g_msh_vue_ek_ut
(
v

	`g_vue_g_ut
 (v)

	)

11 
	#g_msh_vue_ek_lg
(
v

	`g_vue_g_lg
 (v)

	)

12 
	#g_msh_vue_ek_ulg
(
v

	`g_vue_g_ulg
 (v)

	)

13 
	#g_msh_vue_ek_t64
(
v

	`g_vue_g_t64
 (v)

	)

14 
	#g_msh_vue_ek_ut64
(
v

	`g_vue_g_ut64
 (v)

	)

15 
	#g_msh_vue_ek_um
(
v

	`g_vue_g_um
 (v)

	)

16 
	#g_msh_vue_ek_ags
(
v

	`g_vue_g_ags
 (v)

	)

17 
	#g_msh_vue_ek_t
(
v

	`g_vue_g_t
 (v)

	)

18 
	#g_msh_vue_ek_doub
(
v

	`g_vue_g_doub
 (v)

	)

19 
	#g_msh_vue_ek_rg
(
v
(*
	`g_vue_g_rg
 (v)

	)

20 
	#g_msh_vue_ek_m
(
v

	`g_vue_g_m
 (v)

	)

21 
	#g_msh_vue_ek_boxed
(
v

	`g_vue_g_boxed
 (v)

	)

22 
	#g_msh_vue_ek_por
(
v

	`g_vue_g_por
 (v)

	)

23 
	#g_msh_vue_ek_obje
(
v

	`g_vue_g_obje
 (v)

	)

24 
	#g_msh_vue_ek_v
(
v

	`g_vue_g_v
 (v)

	)

30 
	#g_msh_vue_ek_boޗn
(
v
(v)->
da
[0].
v_t


	)

31 
	#g_msh_vue_ek_ch
(
v
(v)->
da
[0].
v_t


	)

32 
	#g_msh_vue_ek_uch
(
v
(v)->
da
[0].
v_ut


	)

33 
	#g_msh_vue_ek_t
(
v
(v)->
da
[0].
v_t


	)

34 
	#g_msh_vue_ek_ut
(
v
(v)->
da
[0].
v_ut


	)

35 
	#g_msh_vue_ek_lg
(
v
(v)->
da
[0].
v_lg


	)

36 
	#g_msh_vue_ek_ulg
(
v
(v)->
da
[0].
v_ulg


	)

37 
	#g_msh_vue_ek_t64
(
v
(v)->
da
[0].
v_t64


	)

38 
	#g_msh_vue_ek_ut64
(
v
(v)->
da
[0].
v_ut64


	)

39 
	#g_msh_vue_ek_um
(
v
(v)->
da
[0].
v_lg


	)

40 
	#g_msh_vue_ek_ags
(
v
(v)->
da
[0].
v_ulg


	)

41 
	#g_msh_vue_ek_t
(
v
(v)->
da
[0].
v_t


	)

42 
	#g_msh_vue_ek_doub
(
v
(v)->
da
[0].
v_doub


	)

43 
	#g_msh_vue_ek_rg
(
v
(v)->
da
[0].
v_por


	)

44 
	#g_msh_vue_ek_m
(
v
(v)->
da
[0].
v_por


	)

45 
	#g_msh_vue_ek_boxed
(
v
(v)->
da
[0].
v_por


	)

46 
	#g_msh_vue_ek_por
(
v
(v)->
da
[0].
v_por


	)

47 
	#g_msh_vue_ek_obje
(
v
(v)->
da
[0].
v_por


	)

48 
	#g_msh_vue_ek_v
(
v
(v)->
da
[0].
v_por


	)

54 
	$rc_msh_VOID__STRING_FLOAT
 (
GClosu
 *
osu
,

55 
GVue
 *
tu_vue
 
G_GNUC_UNUSED
,

56 
gut
 
n_m_vues
,

57 cڡ 
GVue
 *
m_vues
,

58 
gpor
 
voti_ht
 
G_GNUC_UNUSED
,

59 
gpor
 
msh_da
)

61 (*
	tGMshFunc_VOID__STRING_FLOAT
(
	tgpor
 
	tda1
,

62 
	tgpor
 
	tg_1
,

63 
	tgt
 
	tg_2
,

64 
	tgpor
 
	tda2
);

65 
GMshFunc_VOID__STRING_FLOAT
 
back
;

66 
GCClosu
 *
cc
 = (GCClosu*
osu
;

67 
gpor
 
da1
, 
da2
;

69 
	`g_tu_if_
 (
n_m_vues
 == 3);

71 i(
	`G_CCLOSURE_SWAP_DATA
 (
osu
))

73 
da1
 = 
osu
->
da
;

74 
da2
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

78 
da1
 = 
	`g_vue_ek_por
 (
m_vues
 + 0);

79 
da2
 = 
osu
->
da
;

81 
back
 = (
GMshFunc_VOID__STRING_FLOAT
(
msh_da
 ? msh_d: 
cc
->callback);

83 
	`back
 (
da1
,

84 
	`g_msh_vue_ek_rg
 (
m_vues
 + 1),

85 
	`g_msh_vue_ek_t
 (
m_vues
 + 2),

86 
da2
);

87 
	}
}

	@ui/rc-marshal.h

2 #ide
__rc_msh_MARSHAL_H__


3 
	#__rc_msh_MARSHAL_H__


	)

5 
	~<glib-obje.h
>

7 
G_BEGIN_DECLS


10 
rc_msh_VOID__STRING_FLOAT
 (
GClosu
 *
osu
,

11 
GVue
 *
tu_vue
,

12 
gut
 
n_m_vues
,

13 cڡ 
GVue
 *
m_vues
,

14 
gpor
 
voti_ht
,

15 
gpor
 
msh_da
);

17 
	gG_END_DECLS


	@ui/rc-ui-cell-renderer-rating.c

26 
	~"rc-ui--nd-tg.h
"

27 
	~"rc-ui-unt--le.h
"

28 
	~"rc-ui-no--le.h
"

29 
	~"rc-ui-t--le.h
"

30 
	~"rc-msh.h
"

41 
	s_RCUiClRdRgPrive


43 
gt
 
	mtg
;

44 
GdkPixbuf
 *
	m_pixbuf
;

45 
GdkPixbuf
 *
	md_pixbuf
;

46 
GdkPixbuf
 *
	mbnk_pixbuf
;

51 
	mPROP_O
,

52 
	mPROP_RATING


57 
	mSIGNAL_RATED
,

58 
	mSIGNAL_LAST


61 
gpor
 
	grc_ui__nd_tg__ass
 = 
NULL
;

62 
gt
 
	gui__nd_tg_sigls
[
SIGNAL_LAST
] = {0};

65 
GdkPixbuf
 *
	$rc_ui_tg__cized_pixbuf
(
GdkPixbuf
 *
c
,

66 
gt
 
d_vue
, g
g_vue
, g
blue_vue
)

68 
gt
 
i
, 
j
;

69 
gt
 
width
, 
height
, 
has_pha
, 
c_row_ride
, 
d_row_ride
;

70 
guch
 *
rg_pixs
;

71 
guch
 *
ig_pixs
;

72 
guch
 *
pixc
;

73 
guch
 *
pixde
;

74 
GdkPixbuf
 *
de
;

75 
	`g_tu_v_if_
(
	`gdk_pixbuf_g_cܥa
(
c
)==
GDK_COLORSPACE_RGB
,

76 
NULL
);

77 
	`g_tu_v_if_
((!
	`gdk_pixbuf_g_has_pha
(
c
)

78 && 
	`gdk_pixbuf_g_n_chls
(
c
)== 3) ||

79 (
	`gdk_pixbuf_g_has_pha
(
c
) &&

80 
	`gdk_pixbuf_g_n_chls
(
c
)==4), 
NULL
);

81 
	`g_tu_v_if_
(
	`gdk_pixbuf_g_bs_r_me
(
c
)==8, 
NULL
);

82 
de
 = 
	`gdk_pixbuf_w
(
	`gdk_pixbuf_g_cܥa
(
c
),

83 
	`gdk_pixbuf_g_has_pha
(
c
), 
	`gdk_pixbuf_g_bs_r_me
(src),

84 
	`gdk_pixbuf_g_width
(
c
), 
	`gdk_pixbuf_g_height
(src));

86 
has_pha
 = 
	`gdk_pixbuf_g_has_pha
(
c
);

87 
width
 = 
	`gdk_pixbuf_g_width
(
c
);

88 
height
 = 
	`gdk_pixbuf_g_height
(
c
);

89 
c_row_ride
 = 
	`gdk_pixbuf_g_rowride
(
c
);

90 
d_row_ride
 = 
	`gdk_pixbuf_g_rowride
(
de
);

91 
rg_pixs
 = 
	`gdk_pixbuf_g_pixs
(
de
);

92 
ig_pixs
 = 
	`gdk_pixbuf_g_pixs
(
c
);

94 
i
=0;i<
height
;i++)

96 
pixde
 = 
rg_pixs
 + 
i
*
d_row_ride
;

97 
pixc
 = 
ig_pixs
 + 
i
*
c_row_ride
;

98 
j
=0;j<
width
;j++)

100 *
pixde
++ = (*
pixc
++ * 
d_vue
) >> 8;

101 *
pixde
++ = (*
pixc
++ * 
g_vue
) >> 8;

102 *
pixde
++ = (*
pixc
++ * 
blue_vue
) >> 8;

103 i(
has_pha
)

104 *
pixde
++ = *
pixc
++;

107  
de
;

108 
	}
}

111 
gboޗn
 
	$rc_ui_tg_nd_s
(
GtkWidg
 *
widg
, 
o_t
 *

,

112 
RCUiClRdRgPrive
 *
iv
, 
gt
 
x
, g
y
, g
x_offt
,

113 
gt
 
y_offt
, 
gboޗn
 
ed
)

115 
gt
 
i
, 
ic_width
;

116 
gboޗn
 
l
;

117 
GdkPixbuf
 *
buf
;

118 
GtkSTy
 
e
;

119 
gt
 
_offt
;

120 
gt
 
offt
;

121 
GdkRGBA
 
c
;

122 
	`g_tu_v_if_
(
widg
 !
NULL
, 
FALSE
);

123 
	`g_tu_v_if_
(
iv
!
NULL
, 
FALSE
);

125 
l
 = (
	`gtk_widg_g_dei
(
widg
)==
GTK_TEXT_DIR_RTL
);

126 
	`gtk_ic_size_lookup
(
GTK_ICON_SIZE_MENU
, &
ic_width
, 
NULL
);

128 
i
=0;i<5;i++)

130 if(
ed
)

132 
offt
 = 0;

133 if(
	`gtk_widg_has_focus
(
widg
))

134 
e
 = 
GTK_STATE_SELECTED
;

136 
e
 = 
GTK_STATE_ACTIVE
;

140 
offt
 = 120;

141 if(
	`gtk_widg_g_e
(
widg
)==
GTK_STATE_INSENSITIVE
)

142 
e
 = 
GTK_STATE_INSENSITIVE
;

144 
e
 = 
GTK_STATE_NORMAL
;

146 if(
i
<
iv
->
tg
)

147 
buf
 = 
iv
->
_pixbuf
;

148 if(
i
>=
iv
->
tg
 && i<5)

149 
buf
 = 
iv
->
d_pixbuf
;

151 
buf
 = 
iv
->
bnk_pixbuf
;

152 if(
buf
==
NULL
)

154  
FALSE
;

156 
	`gtk_y_cڋxt_g_c
(
	`gtk_widg_g_y_cڋxt
(
widg
),

157 
e
, &
c
);

158 
buf
 = 
	`rc_ui_tg__cized_pixbuf
(buf,

159 ((
gut16
)(
c
.
d
 * 
G_MAXUINT16
+ 
offt
) >> 8,

160 ((
gut16
)(
c
.
g
 * 
G_MAXUINT16
+ 
offt
) >> 8,

161 ((
gut16
)(
c
.
blue
 * 
G_MAXUINT16
+ 
offt
) >> 8);

162 i(
buf
 =
NULL
)

163  
FALSE
;

165 if(
l
)

166 
_offt
 = (5 - 
i
 - 1* 
ic_width
;

168 
_offt
 = 
i
 * 
ic_width
;

169 
	`gdk_o_t_sour_pixbuf
(

, 
buf
, 
x_offt
 + 
_offt
,

170 
y_offt
);

171 
	`o_t
(

);

172 
	`g_obje_uef
(
buf
);

174  
TRUE
;

175 
	}
}

177 
gdoub
 
	$rc_ui_tg_g_tg_om_widg
(
GtkWidg
 *
widg
,

178 
gt
 
widg_x
, g
widg_width
, 
gdoub
 
cut_tg
)

180 
gt
 
ic_width
;

181 
gdoub
 
tg
 = -1.0;

182 
gboޗn
 
l
;

183 
	`gtk_ic_size_lookup
(
GTK_ICON_SIZE_MENU
, &
ic_width
, 
NULL
);

185 if(
widg_x
>=0 && widg_x<=
widg_width
)

187 
tg
 = ((
widg_x
 / 
ic_width
) + 1;

188 
l
 =(
	`gtk_widg_g_dei
(
widg
)==
GTK_TEXT_DIR_RTL
);

189 if(
l
)

191 
tg
 = 5 -ating + 1;

193 if(
tg
<0)

194 
tg
 = 0;

195 if(
tg
>5)

196 
tg
 = 5;

197 if(
tg
==
cut_tg
)

199 
tg
--;

202  
tg
;

203 
	}
}

205 
	$rc_ui__nd_tg_g_ݔty
(
GObje
 *
obje
,

206 
gut
 
m_id
, 
GVue
 *
vue
, 
GPamSc
 *
pec
)

208 
RCUiClRdRgPrive
 *
iv
 =

209 
	`RC_UI_CELL_RENDERER_RATING
(
obje
)->
iv
;

210 
m_id
)

212 
PROP_RATING
:

213 
	`g_vue_t_t
(
vue
, 
iv
->
tg
);

216 
	`G_OBJECT_WARN_INVALID_PROPERTY_ID
(
obje
, 
m_id
, 
pec
);

219 
	}
}

221 
	$rc_ui__nd_tg_t_ݔty
(
GObje
 *
obje
,

222 
gut
 
m_id
, cڡ 
GVue
 *
vue
, 
GPamSc
 *
pec
)

224 
RCUiClRdRgPrive
 *
iv
 =

225 
	`RC_UI_CELL_RENDERER_RATING
(
obje
)->
iv
;

226 
m_id
)

228 
PROP_RATING
:

229 
iv
->
tg
 = 
	`g_vue_g_t
(
vue
);

230 if(
iv
->
tg
<0)

231 
iv
->
tg
 = 0;

234 
	`G_OBJECT_WARN_INVALID_PROPERTY_ID
(
obje
, 
m_id
, 
pec
);

237 
	}
}

239 
	$rc_ui__nd_tg_g_size
(
GtkClRd
 *

,

240 
GtkWidg
 *
widg
, cڡ 
GdkReg
 *
_
, 
gt
 *
x_offt
,

241 
gt
 *
y_offt
, g*
width
, g*
height
)

243 
gt
 
ic_width
;

244 
gt
 
xd
, 
yd
;

245 
	`gtk_ic_size_lookup
(
GTK_ICON_SIZE_MENU
, &
ic_width
, 
NULL
);

246 
	`gtk__nd_g_ddg
(

, &
xd
, &
yd
);

247 if(
x_offt
!=
NULL
)

248 *
x_offt
 = 0;

249 if(
y_offt
!=
NULL
)

250 *
y_offt
 = 0;

251 if(
width
!=
NULL
)

252 *
width
 = 
xd
*2 + 
ic_width
 * 5.0;

253 if(
height
!=
NULL
)

254 *
height
 = 
yd
*2 + 
ic_width
;

255 
	}
}

257 
	$rc_ui__nd_tg_nd
(
GtkClRd
 *

,

258 
o_t
 *

, 
GtkWidg
 *
widg
, cڡ 
GdkReg
 *
background_
,

259 cڡ 
GdkReg
 *
_
, 
GtkClRdS
 
ags
)

262 
RCUiClRdRg
 *
tg
 = (RCUiClRdRg *)

;

263 
RCUiClRdRgPrive
 *
iv
 = 
tg
->priv;

264 
gt
 
xd
, 
yd
;

265 
gboޗn
 
ed
;

266 
GdkReg
 
pix_
, 
dw_
;

267 
	`rc_ui__nd_tg_g_size
(

, 
widg
, 
_
, &
pix_
.
x
,

268 &
pix_
.
y
, &pix_.
width
, &pix_.
height
);

269 
pix_
.
x
 +
_
->x;

270 
pix_
.
y
 +
_
->y;

271 
	`gtk__nd_g_ddg
(

, &
xd
, &
yd
);

272 
pix_
.
width
 -
xd
 * 2;

273 
pix_
.
height
 -
yd
 * 2;

274 if(!
	`gdk_g_r
(
_
, &
pix_
, &
dw_
))

276 
ed
 = (
ags
 & 
GTK_CELL_RENDERER_SELECTED
);

277 
	`rc_ui_tg_nd_s
(
widg
, 

, 
iv
,

278 
dw_
.
x
 - 
pix_
.x, dw_.
y
 -ix_rect.y,

279 
dw_
.
x
, dw_.
y
, 
ed
);

280 
	}
}

282 
gboޗn
 
	$rc_ui__nd_tg_aive
(
GtkClRd
 *

,

283 
GdkEvt
 *
evt
, 
GtkWidg
 *
widg
, cڡ 
gch
 *
th
,

284 cڡ 
GdkReg
 *
background_
, cڡ GdkReg *
_
,

285 
GtkClRdS
 
ags
)

287 
RCUiClRdRg
 *
_tg
 = (RCUiClRdRg *)

;

288 
RCUiClRdRgPrive
 *
iv
 = 
_tg
->priv;

289 
gt
 
mou_x
, 
mou_y
;

290 
gt
 
tg
;

291 
	`g_tu_v_if_
(
	`RC_UI_IS_CELL_RENDERER_RATING
(
_tg
), 
FALSE
);

292 
mou_x
 = 
evt
->
bu
.
x
;

293 
mou_y
 = 
evt
->
bu
.
y
;

294 
	`gtk__vw_cvt_widg_to_b_wdow_cods
(
	`GTK_TREE_VIEW
(
widg
),

295 
mou_x
, 
mou_y
, &mouse_x, &mouse_y);

296 
tg
 = 
	`rc_ui_tg_g_tg_om_widg
(
widg
,

297 
mou_x
 - 
_
->
x
, cl_->
width
, 
iv
->
tg
);

298 if(
tg
!=-1.0)

300 
	`g_sigl_em
(
_tg
,

301 
ui__nd_tg_sigls
[
SIGNAL_RATED
], 0, 
th
, 
tg
);

303  
TRUE
;

304 
	}
}

306 
	$rc_ui__nd_tg_fize
(
GObje
 *
obje
)

308 
RCUiClRdRgPrive
 *
iv
 =

309 
	`RC_UI_CELL_RENDERER_RATING
(
obje
)->
iv
;

310 if(
iv
->
_pixbuf
!=
NULL

	`g_obje_uef
(priv->star_pixbuf);

311 if(
iv
->
d_pixbuf
!=
NULL

	`g_obje_uef
(priv->dot_pixbuf);

312 if(
iv
->
bnk_pixbuf
!=
NULL

	`g_obje_uef
(priv->blank_pixbuf);

313 
	`G_OBJECT_CLASS
(
rc_ui__nd_tg__ass
)->
	`fize
(

314 
obje
);

315 
	}
}

317 
	$rc_ui__nd_tg_ass_
(

318 
RCUiClRdRgCss
 *
kss
)

320 
GObjeCss
 *
obje_ass
 = 
	`G_OBJECT_CLASS
(
kss
);

321 
GtkClRdCss
 *
_ass
 = 
	`GTK_CELL_RENDERER_CLASS
(
kss
);

323 
rc_ui__nd_tg__ass
 = 
	`g_ty_ass_ek_
(
kss
);

325 
obje_ass
->
fize
 = 
rc_ui__nd_tg_fize
;

326 
obje_ass
->
g_ݔty
 = 
rc_ui__nd_tg_g_ݔty
;

327 
obje_ass
->
t_ݔty
 = 
rc_ui__nd_tg_t_ݔty
;

329 
_ass
->
g_size
 = 
rc_ui__nd_tg_g_size
;

330 
_ass
->
nd
 = 
rc_ui__nd_tg_nd
;

331 
_ass
->
aive
 = 
rc_ui__nd_tg_aive
;

339 
	`g_obje_ass_l_ݔty
(
obje_ass
, 
PROP_RATING
,

340 
	`g_m_ec_t
("rating", "Rating Value", "Rating Value",

341 0.0, 5.0, 3.0, 
G_PARAM_READWRITE
));

351 
ui__nd_tg_sigls
[
SIGNAL_RATED
] = 
	`g_sigl_w
("rated",

352 
	`G_OBJECT_CLASS_TYPE
(
obje_ass
), 
G_SIGNAL_RUN_LAST
,

353 
	`G_STRUCT_OFFSET
(
RCUiClRdRgCss
, 
d
), 
NULL
, NULL,

354 
rc_msh_VOID__STRING_FLOAT
, 
G_TYPE_NONE
, 2, 
G_TYPE_STRING
,

355 
G_TYPE_FLOAT
);

357 
	`g_ty_ass_add_ive
(
kss
, (
RCUiClRdRgPrive
));

358 
	}
}

361 
	$rc_ui__nd_tg_
(
RCUiClRdRg
 *

)

363 
RCUiClRdRgPrive
 *
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(

,

364 
RC_UI_TYPE_CELL_RENDERER_RATING
, 
RCUiClRdRgPrive
);

365 

->
iv
 =riv;

366 
GtkIcTheme
 *
theme
;

367 
gt
 
width
;

368 
GdkPixbuf
 *
pixbuf
;

369 
theme
 = 
	`gtk_ic_theme_g_deu
();

370 
	`gtk_ic_size_lookup
(
GTK_ICON_SIZE_MENU
, 
NULL
, &
width
);

372 
iv
->
_pixbuf
 = 
	`gtk_ic_theme_ld_ic
(
theme
, "RCSSr", 
width
,

373 0, 
NULL
);

374 if(
iv
->
_pixbuf
==
NULL
)

376 
pixbuf
 = 
	`gdk_pixbuf_w_om_le
(-1, 
rc_ui_t__le
,

377 
FALSE
, 
NULL
);

378 if(
pixbuf
!=
NULL
)

380 
iv
->
_pixbuf
 = 
	`gdk_pixbuf_s_sime
(
pixbuf
, 
width
, width,

381 
GDK_INTERP_HYPER
);

382 
	`g_obje_uef
(
pixbuf
);

386 
iv
->
d_pixbuf
 = 
	`gtk_ic_theme_ld_ic
(
theme
, "RCUntSr", 
width
,

387 0, 
NULL
);

388 if(
iv
->
d_pixbuf
==
NULL
)

390 
pixbuf
 = 
	`gdk_pixbuf_w_om_le
(-1, 
rc_ui_unt__le
,

391 
FALSE
, 
NULL
);

392 if(
pixbuf
!=
NULL
)

394 
iv
->
d_pixbuf
 = 
	`gdk_pixbuf_s_sime
(
pixbuf
, 
width
, width,

395 
GDK_INTERP_HYPER
);

396 
	`g_obje_uef
(
pixbuf
);

400 
iv
->
bnk_pixbuf
 = 
	`gtk_ic_theme_ld_ic
(
theme
, "RCNoSr", 
width
,

401 0, 
NULL
);

402 if(
iv
->
bnk_pixbuf
==
NULL
)

404 
pixbuf
 = 
	`gdk_pixbuf_w_om_le
(-1, 
rc_ui_no__le
,

405 
FALSE
, 
NULL
);

406 if(
pixbuf
!=
NULL
)

408 
iv
->
bnk_pixbuf
 = 
	`gdk_pixbuf_s_sime
(
pixbuf
, 
width
, width,

409 
GDK_INTERP_HYPER
);

410 
	`g_obje_uef
(
pixbuf
);

414 
	`g_obje_t
(

, "mode", 
GTK_CELL_RENDERER_MODE_ACTIVATABLE
, 
NULL
);

415 
	}
}

417 
GTy
 
	$rc_ui__nd_tg_g_ty
()

419 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

420 
GTy
 
g_defe_ty_id
;

421 cڡ 
GTyInfo
 
obje_fo
 = {

422 .
ass_size
 = (
RCUiClRdRgCss
),

423 .
ba_
 = 
NULL
,

424 .
ba_fize
 = 
NULL
,

425 .
ass_
 = (
GCssInFunc
)
rc_ui__nd_tg_ass_
,

426 .
ass_fize
 = 
NULL
,

427 .
ass_da
 = 
NULL
,

428 .
_size
 = (
RCUiClRdRg
),

429 .
n_ocs
 = 0,

430 .
_
 = (
GInInFunc
)
rc_ui__nd_tg_


432 if(
	`g___r
(&
g_defe_ty_id__vީe
))

434 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
GTK_TYPE_CELL_RENDERER
,

435 
	`g__ic_rg
("RCUiClRdRg"), &
obje_fo
,

437 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

439  
g_defe_ty_id__vީe
;

440 
	}
}

453 
GtkClRd
 *
	$rc_ui__nd_tg_w
()

455  
	`GTK_CELL_RENDERER
(
	`g_obje_w
(
RC_UI_TYPE_CELL_RENDERER_RATING
, 
NULL
));

456 
	}
}

	@ui/rc-ui-cell-renderer-rating.h

26 #ide
HAVE_RC_UI_CELL_RENDERER_RATING_H


27 
	#HAVE_RC_UI_CELL_RENDERER_RATING_H


	)

29 
	~<glib.h
>

30 
	~<glib-obje.h
>

31 
	~<gdk/gdk.h
>

32 
	~<gtk/gtk.h
>

34 
	gG_BEGIN_DECLS


36 
	#RC_UI_TYPE_CELL_RENDERER_RATING
 ( \

37 
	`rc_ui__nd_tg_g_ty
())

	)

38 
	#RC_UI_CELL_RENDERER_RATING
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

39 
RC_UI_TYPE_CELL_RENDERER_RATING
, 
RCUiClRdRg
))

	)

40 
	#RC_UI_CELL_RENDERER_RATING_CLASS
(
kss
) ( \

41 
	`G_TYPE_CHECK_CLASS_CAST
((
kss
), 
RC_UI_TYPE_CELL_RENDERER_RATING
, \

42 
RCUiClRdRgCss
))

	)

43 
	#RC_UI_IS_CELL_RENDERER_RATING
(
obj
) ( \

44 
	`G_TYPE_CHECK_INSTANCE_TYPE
((
obj
), 
RC_UI_TYPE_CELL_RENDERER_RATING
))

	)

45 
	#RC_UI_IS_CELL_RENDERER_RATING_CLASS
(
kss
) ( \

46 
	`G_TYPE_CHECK_CLASS_TYPE
((
kss
), 
RC_UI_TYPE_CELL_RENDERER_RATING
))

	)

47 
	#RC_UI_CELL_RENDERER_RATING_GET_CLASS
(
obj
) ( \

48 
	`G_TYPE_INSTANCE_GET_CLASS
((
obj
), 
RC_UI_TYPE_CELL_RENDERER_RATING
, \

49 
RCUiClRdRgCss
))

	)

51 
_RCUiClRdRg
 
	tRCUiClRdRg
;

52 
_RCUiClRdRgCss
 
	tRCUiClRdRgCss
;

53 
_RCUiClRdRgPrive
 
	tRCUiClRdRgPrive
;

55 
	s_RCUiClRdRg
 {

57 
GtkClRd
 
	m
;

58 
RCUiClRdRgPrive
 *
	miv
;

61 
	s_RCUiClRdRgCss
 {

63 
GtkClRdCss
 
	m_ass
;

65 (*
	md
)(
RCUiClRdRg
 *
	mnd
, cڡ *
	mth
,

66 
gt
 
	mtg
);

70 
GTy
 
rc_ui__nd_tg_g_ty
();

73 
GtkClRd
 *
rc_ui__nd_tg_w
();

75 
	gG_END_DECLS


	@ui/rc-ui-dialog.c

26 
	~"rc-ui-dlog.h
"

27 
	~"rc-ui-livw.h
"

28 
	~"rc-ui-wdow.h
"

29 
	~"rc-ui-ay.h
"

30 
	~"rc-comm.h
"

41 cڡ 
gch
 *
	gdlog_about_lin
 =

56 cڡ 
gch
 cڡ *
	gdlog_about_auths
[] = {"SurC", 
NULL
};

57 cڡ 
gch
 cڡ *
	gdlog_about_documrs
[] = {"SurC", 
NULL
};

58 cڡ 
gch
 cڡ *
	gdlog_about_tis
[] = {"SurC", 
NULL
};

66 
	$rc_ui_dlog_about_ay
()

68 
GtkWidg
 *
about_dlog
;

69 
gch
 *
vsi
;

70 
about_dlog
 = 
	`gtk_about_dlog_w
();

71 
vsi
 = 
	`g_rdup_tf
("LibRhythmCat %d.%d.%d - build date: %s",

72 
rib_maj_vsi
, 
rib_m_vsi
, 
rib_mio_vsi
,

73 
rib_bud_de
);

74 
	`g_obje_t
(
about_dlog
, "program-name", "RhythmCat2 Music Player",

75 "logo", 
	`rc_ui_ay_g_ic_image
(), "authors",

76 
dlog_about_auths
, "documrs", 
dlog_about_documrs
,

77 "tis", 
dlog_about_tis
, "comments",

78 
	`_
("A musiclayer based on GTK+ 3.0 & GStreamer 0.10"), "website",

79 "hp://surt-b.g", "lin-ty", 
GTK_LICENSE_GPL_3_0
,

80 "lin", 
dlog_about_lin
, "vsi", 
vsi
, 
NULL
);

81 
	`g_
(
vsi
);

82 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
about_dlog
));

83 
	`gtk_widg_deroy
(
about_dlog
);

84 
	}
}

96 
	$rc_ui_dlog_show_mesge
(
GtkMesgeTy
 
ty
, cڡ 
gch
 *
t
,

97 cڡ 
gch
 *
fm
, ...)

99 
GtkWidg
 *
dlog
;

100 
va_li
 
g_r
;

101 
	`va_t
(
g_r
, 
fm
);

102 
dlog
 = 
	`gtk_mesge_dlog_w
(
NULL
,

103 
GTK_DIALOG_MODAL
 | 
GTK_DIALOG_DESTROY_WITH_PARENT
, 
ty
,

104 
GTK_BUTTONS_CLOSE
, 
fm
, 
g_r
);

105 
	`gtk_wdow_t_t
(
	`GTK_WINDOW
(
dlog
), 
t
);

106 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
dlog
));

107 
	`gtk_widg_deroy
(
dlog
);

108 
	}
}

110 
gboޗn
 
	$rc_ui_dlog_music_fe_fr
(cڡ 
GtkFeFrInfo
 *
fo
,

111 
gpor
 
da
)

113  
	`rib_ut_is_su܋d_med
(
fo
->
diy_me
);

114 
	}
}

122 
	$rc_ui_dlog_add_music
()

124 
GtkTeIr
 

;

125 
GtkWidg
 *
fe_choor
;

126 
GtkFeFr
 *
fe_fr1
;

127 
gt
 
su
 = 0;

128 
GSLi
 *
fi
 = 
NULL
;

129 cڡ 
GSLi
 *
fi_fܗch
 = 
NULL
;

130 
gch
 *
uri
 = 
NULL
;

131 
gch
 *
dlog_t
 = 
NULL
;

132 cڡ 
gch
 *
home_d
;

133 if(!
	`rc_ui_livw_log_g_curs
(&

)) ;

134 if(

.
ur_da
==
NULL
) ;

135 
fe_fr1
 = 
	`gtk_fe_fr_w
();

136 
	`gtk_fe_fr_t_me
(
fe_fr1
,

137 
	`_
("All supported music files(*.FLAC;*.OGG;*.MP3;*.WAV;*.WMA...)"));

138 
	`gtk_fe_fr_add_cuom
(
fe_fr1
, 
GTK_FILE_FILTER_DISPLAY_NAME
,

139 
rc_ui_dlog_music_fe_fr
, 
NULL
, NULL);

140 
dlog_t
 = 
	`_
("Selecthe music you wantodd...");

141 
fe_choor
 = 
	`gtk_fe_choor_dlog_w
(
dlog_t
, 
NULL
,

142 
GTK_FILE_CHOOSER_ACTION_OPEN
, 
GTK_STOCK_OPEN
, 
GTK_RESPONSE_ACCEPT
,

143 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_CANCEL
, 
NULL
);

144 
home_d
 = 
	`g_gv
("HOME");

145 if(
home_d
==
NULL
)

146 
home_d
 = 
	`g_g_home_d
();

147 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
fe_choor
),

148 
home_d
);

149 
	`gtk_fe_choor_t__muɝ
(
	`GTK_FILE_CHOOSER
(
fe_choor
),
TRUE
);

150 
	`gtk_fe_choor_add_fr
(
	`GTK_FILE_CHOOSER
(
fe_choor
), 
fe_fr1
);

151 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
fe_choor
));

152 
su
)

154 
GTK_RESPONSE_ACCEPT
:

155 
fi
 = 
	`gtk_fe_choor_g_uris
(

156 
	`GTK_FILE_CHOOSER
(
fe_choor
));

157 
fi_fܗch
=
fi
;fi_fܗch!=
NULL
;

158 
fi_fܗch
=
	`g_i_xt
(filelist_foreach))

160 
uri
 = 
fi_fܗch
->
da
;

161 
	`rib_db_ayli_add_music
((
GSequIr
 *)

.
ur_da
,

162 
NULL
, 
uri
);

163 
	`g_
(
uri
);

165 
	`g_i_
(
fi
);

167 
GTK_RESPONSE_CANCEL
:

171 
	`gtk_widg_deroy
(
fe_choor
);

172 
	}
}

180 
	$rc_ui_dlog_add_dey
()

182 
GtkWidg
 *
fe_choor
;

183 
GtkTeIr
 

;

184 
gt
 
su
 = 0;

185 
gch
 *
dey_th
 = 
NULL
;

186 cڡ 
gch
 *
home_d
;

187 if(!
	`rc_ui_livw_log_g_curs
(&

)) ;

188 if(

.
ur_da
==
NULL
) ;

189 
fe_choor
 = 
	`gtk_fe_choor_dlog_w
(

190 
	`_
("Selecthe directory you wanto import..."),

191 
NULL
, 
GTK_FILE_CHOOSER_ACTION_SELECT_FOLDER
,

192 
GTK_STOCK_OPEN
, 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
,

193 
GTK_RESPONSE_CANCEL
, 
NULL
);

194 
home_d
 = 
	`g_gv
("HOME");

195 if(
home_d
==
NULL
)

196 
home_d
 = 
	`g_g_home_d
();

197 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
fe_choor
),

198 
home_d
);

199 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
fe_choor
));

200 
su
)

202 
GTK_RESPONSE_ACCEPT
:

203 
dey_th
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

204 
fe_choor
));

205 
	`rib_db_ayli_add_dey
((
GSequIr
 *)

.
ur_da
,

206 
NULL
, 
dey_th
);

207 
	`g_
(
dey_th
);

209 
GTK_RESPONSE_CANCEL
:

213 
	`gtk_widg_deroy
(
fe_choor
);

214 
	}
}

216 
gboޗn
 
	$rc_ui_dlog_ayli_fe_fr
(

217 cڡ 
GtkFeFrInfo
 *
fo
, 
gpor
 
da
)

219  
	`rib_ut_is_su܋d_li
(
fo
->
diy_me
);

220 
	}
}

229 
	$rc_ui_dlog_ld_ayli
()

231 
GtkTeIr
 

;

232 
GtkWidg
 *
fe_choor
;

233 
GtkFeFr
 *
fe_fr1
;

234 
gt
 
su
 = 0;

235 
gch
 *
fe_me
 = 
NULL
;

236 cڡ 
gch
 *
home_d
;

237 if(!
	`rc_ui_livw_log_g_curs
(&

)) ;

238 if(

.
ur_da
==
NULL
) ;

239 
fe_fr1
 = 
	`gtk_fe_fr_w
();

240 
	`gtk_fe_fr_t_me
(
fe_fr1
,

241 
	`_
("M3U Playlist(*.M3U)"));

242 
	`gtk_fe_fr_add_cuom
(
fe_fr1
, 
GTK_FILE_FILTER_DISPLAY_NAME
,

243 
rc_ui_dlog_ayli_fe_fr
, 
NULL
, NULL);

244 
fe_choor
 = 
	`gtk_fe_choor_dlog_w
(
	`_
("Loadhelaylist..."),

245 
NULL
, 
GTK_FILE_CHOOSER_ACTION_OPEN
, 
GTK_STOCK_OPEN
,

246 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_CANCEL
, 
NULL
);

247 
home_d
 = 
	`g_gv
("HOME");

248 if(
home_d
==
NULL
)

249 
home_d
 = 
	`g_g_home_d
();

250 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
fe_choor
),

251 
home_d
);

252 
	`gtk_fe_choor_add_fr
(
	`GTK_FILE_CHOOSER
(
fe_choor
), 
fe_fr1
);

253 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
fe_choor
));

254 
su
)

256 
GTK_RESPONSE_ACCEPT
:

257 
fe_me
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

258 
fe_choor
));

259 
	`rib_db_ayli_add_m3u_fe
(

.
ur_da
, 
NULL
, 
fe_me
);

260 
	`g_
(
fe_me
);

262 
GTK_RESPONSE_CANCEL
:

266 
	`gtk_widg_deroy
(
fe_choor
);

267 
	}
}

276 
	$rc_ui_dlog_ve_ayli
()

278 
GtkWidg
 *
fe_choor
;

279 
GtkFeFr
 *
fe_fr1
;

280 
gt
 
su
 = 0;

281 
gch
 *
fe_me
 = 
NULL
;

282 cڡ 
gch
 *
home_d
;

283 
GtkTeIr
 

;

284 if(!
	`rc_ui_livw_log_g_curs
(&

)) ;

285 if(

.
ur_da
==
NULL
) ;

286 
fe_fr1
 = 
	`gtk_fe_fr_w
();

287 
	`gtk_fe_fr_t_me
(
fe_fr1
,

288 
	`_
("M3U Playlist(*.M3U)"));

289 
	`gtk_fe_fr_add_cuom
(
fe_fr1
, 
GTK_FILE_FILTER_DISPLAY_NAME
,

290 
rc_ui_dlog_ayli_fe_fr
, 
NULL
, NULL);

291 
fe_choor
 = 
	`gtk_fe_choor_dlog_w
(
	`_
("Savehelaylist..."),

292 
NULL
, 
GTK_FILE_CHOOSER_ACTION_SAVE
, 
GTK_STOCK_SAVE
,

293 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_CANCEL
, 
NULL
);

294 
home_d
 = 
	`g_gv
("HOME");

295 if(
home_d
==
NULL
)

296 
home_d
 = 
	`g_g_home_d
();

297 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
fe_choor
),

298 
home_d
);

299 
	`gtk_fe_choor_add_fr
(
	`GTK_FILE_CHOOSER
(
fe_choor
), 
fe_fr1
);

300 
	`gtk_fe_choor_t_do_ovwre_cfmi
(

301 
	`GTK_FILE_CHOOSER
(
fe_choor
), 
TRUE
);

302 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
fe_choor
));

303 
su
)

305 
GTK_RESPONSE_ACCEPT
:

306 
fe_me
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

307 
fe_choor
));

308 
	`rib_db_ayli_expt_m3u_fe
(

.
ur_da
, 
fe_me
);

309 
	`g_
(
fe_me
);

311 
GTK_RESPONSE_CANCEL
:

315 
	`gtk_widg_deroy
(
fe_choor
);

316 
	}
}

325 
	$rc_ui_dlog_ve_l_ayli
()

327 
GtkWidg
 *
fe_choor
;

328 
gt
 
su
 = 0;

329 cڡ 
gch
 *
home_d
;

330 
gch
 *
dey_me
 = 
NULL
;

331 
fe_choor
 = 
	`gtk_fe_choor_dlog_w
(

332 
	`_
("Selecthe directory you wanto storehelaylists..."),

333 
NULL
, 
GTK_FILE_CHOOSER_ACTION_SELECT_FOLDER
, 
GTK_STOCK_SAVE
,

334 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_CANCEL
, 
NULL
);

335 
home_d
 = 
	`g_gv
("HOME");

336 if(
home_d
==
NULL
)

337 
home_d
 = 
	`g_g_home_d
();

338 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
fe_choor
),

339 
home_d
);

340 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
fe_choor
));

341 
su
)

343 
GTK_RESPONSE_ACCEPT
:

344 
dey_me
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

345 
fe_choor
));

346 
	`rib_db_ayli_expt_l_m3u_fes
(
dey_me
);

347 
	`g_
(
dey_me
);

349 
GTK_RESPONSE_CANCEL
:

353 
	`gtk_widg_deroy
(
fe_choor
);

354 
	}
}

364 
	$rc_ui_dlog_bd_lyric
()

366 
GtkWidg
 *
dlog
;

367 
GtkWidg
 *
cڋ_
;

368 
GtkWidg
 *
ma_grid
;

369 
GtkWidg
 *
ame1
, *
ame2
;

370 
GtkWidg
 *
grid1
, *
grid2
;

371 
GtkWidg
 *
dio_bus
[4];

372 
GtkWidg
 *
febu
[2];

373 
GtkTeIr
 

;

374 
gt
 
t
;

375 
gt
 
i
;

376 cڡ 
gch
 *
home_d
;

377 cڡ 
gch
 *
lyric_fe1
 = 
NULL
;

378 cڡ 
gch
 *
lyric_fe2
 = 
NULL
;

379 
gch
 *
w_fe
;

380 
GtkFeFr
 *
fe_fr
;

381 
GtkTePh
 *
th
;

382 
GtkTeMod
 *
mod
;

383 
GtkTeRowRen
 *
n
;

384 if(!
	`rc_ui_livw_ayli_g_curs
(&

)) ;

385 if(

.
ur_da
==
NULL
) ;

386 
mod
 = 
	`rc_ui_livw_ayli_g_mod
();

387 if(
mod
==
NULL
) ;

388 
th
 = 
	`gtk__mod_g_th
(
mod
, &

);

389 
n
 = 
	`gtk__row_n_w
(
mod
, 
th
);

390 
	`gtk__th_
(
th
);

391 
dlog
 = 
	`gtk_dlog_w_wh_bus
(
	`_
("Setyric file binding"),

392 
	`GTK_WINDOW
(
	`rc_ui_ma_wdow_g_widg
()), 
GTK_DIALOG_MODAL
 |

393 
GTK_DIALOG_DESTROY_WITH_PARENT
, 
GTK_STOCK_OK
, 
GTK_RESPONSE_ACCEPT
,

394 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_REJECT
, 
NULL
);

395 
dio_bus
[0] = 
	`gtk_dio_bu_w_wh_mmic
(
NULL
,

396 
	`_
("_Bindyric fileohe music"));

397 
dio_bus
[1] = 
	`gtk_dio_bu_w_wh_mmic_om_widg
(

398 
	`GTK_RADIO_BUTTON
(
dio_bus
[0]), 
	`_
("_Doot bindyric file"));

399 
dio_bus
[2] = 
	`gtk_dio_bu_w_wh_mmic
(
NULL
,

400 
	`_
("Bind _secondaryyric fileohe music"));

401 
dio_bus
[3] = 
	`gtk_dio_bu_w_wh_mmic_om_widg
(

402 
	`GTK_RADIO_BUTTON
(
dio_bus
[2]),

403 
	`_
("Do _not bind secondaryyric file"));

404 
febu
[0] = 
	`gtk_fe_choor_bu_w
(
	`_
("Selectyric file"),

405 
GTK_FILE_CHOOSER_ACTION_OPEN
);

406 
febu
[1] = 
	`gtk_fe_choor_bu_w
(
	`_
("Selectyric file"),

407 
GTK_FILE_CHOOSER_ACTION_OPEN
);

408 
ame1
 = 
	`gtk_ame_w
(
	`_
("The firstyric file binding"));

409 
ame2
 = 
	`gtk_ame_w
(
	`_
("The secondyric file binding"));

410 
cڋ_
 = 
	`gtk_dlog_g_cڋ_
(
	`GTK_DIALOG
(
dlog
));

411 
ma_grid
 = 
	`gtk_grid_w
();

412 
grid1
 = 
	`gtk_grid_w
();

413 
grid2
 = 
	`gtk_grid_w
();

414 
	`gtk_grid_t_row_acg
(
	`GTK_GRID
(
ma_grid
), 2);

415 
	`gtk_grid_t_row_acg
(
	`GTK_GRID
(
grid1
), 2);

416 
	`gtk_grid_t_row_acg
(
	`GTK_GRID
(
grid2
), 2);

417 
i
=0;i<4;i++)

418 
	`gtk_widg_t_hexnd
(
dio_bus
[
i
], 
TRUE
);

419 
i
=0;i<2;i++)

420 
	`gtk_widg_t_hexnd
(
febu
[
i
], 
TRUE
);

421 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(
dio_bus
[1]), 
TRUE
);

422 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(
dio_bus
[3]), 
TRUE
);

423 
home_d
 = 
	`g_gv
("HOME");

424 if(
home_d
==
NULL
)

425 
home_d
 = 
	`g_g_home_d
();

426 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
febu
[0]),

427 
home_d
);

428 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
febu
[1]),

429 
home_d
);

430 
fe_fr
 = 
	`gtk_fe_fr_w
();

431 
	`gtk_fe_fr_t_me
(
fe_fr
,

432 
	`_
("Image File (*.JPG, *.BMP, *.PNG)..."));

433 
	`gtk_fe_fr_t_me
(
fe_fr
, 
	`_
("Lyric File (*.LRC)"));

434 
	`gtk_fe_fr_add_n
(
fe_fr
, "*.[L,l][R,r][C,c]");

435 
	`gtk_fe_choor_add_fr
(
	`GTK_FILE_CHOOSER
(
febu
[0]), 
fe_fr
);

436 
fe_fr
 = 
	`gtk_fe_fr_w
();

437 
	`gtk_fe_fr_t_me
(
fe_fr
,

438 
	`_
("Image File (*.JPG, *.BMP, *.PNG)..."));

439 
	`gtk_fe_fr_t_me
(
fe_fr
, 
	`_
("Lyric File (*.LRC)"));

440 
	`gtk_fe_fr_add_n
(
fe_fr
, "*.[L,l][R,r][C,c]");

441 
	`gtk_fe_choor_add_fr
(
	`GTK_FILE_CHOOSER
(
febu
[1]), 
fe_fr
);

442 
lyric_fe1
 = 
	`rib_db_ayli_g_lyric_bd
((
GSequIr
 *)

443 

.
ur_da
);

444 
lyric_fe2
 = 
	`rib_db_ayli_g_lyric_cdy_bd
(

445 (
GSequIr
 *)

.
ur_da
);

446 if(
lyric_fe1
!=
NULL
)

448 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(
dio_bus
[0]),

449 
TRUE
);

450 
	`gtk_fe_choor_t_fame
(
	`GTK_FILE_CHOOSER
(
febu
[0]),

451 
lyric_fe1
);

453 if(
lyric_fe2
!=
NULL
)

455 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(
dio_bus
[2]),

456 
TRUE
);

457 
	`gtk_fe_choor_t_fame
(
	`GTK_FILE_CHOOSER
(
febu
[1]),

458 
lyric_fe2
);

460 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid1
), 
dio_bus
[0], 0, 0, 1, 1);

461 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid1
), 
febu
[0], 0, 1, 1, 1);

462 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid1
), 
dio_bus
[1], 0, 2, 1, 1);

463 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid2
), 
dio_bus
[2], 0, 0, 1, 1);

464 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid2
), 
febu
[1], 0, 1, 1, 1);

465 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid2
), 
dio_bus
[3], 0, 2, 1, 1);

466 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
ame1
), 
grid1
);

467 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
ame2
), 
grid2
);

468 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
ame1
, 0, 0, 1, 1);

469 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
ame2
, 0, 1, 1, 1);

470 
	`gtk_widg_t_size_que
(
dlog
, 300, -1);

471 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
cڋ_
), 
ma_grid
);

472 
	`gtk_widg_show_l
(
cڋ_
);

473 
t
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
dlog
));

474 if(
t
==
GTK_RESPONSE_ACCEPT
)

476 if(
	`gtk_togg_bu_g_aive
(
	`GTK_TOGGLE_BUTTON
(
dio_bus
[0])))

478 
w_fe
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

479 
febu
[0]));

480 if(
w_fe
!=
NULL
)

482 if(
	`gtk__row_n_vid
(
n
))

484 
th
 = 
	`gtk__row_n_g_th
(
n
);

485 
mod
 = 
	`gtk__row_n_g_mod
(
n
);

486 if(
th
!=
NULL
 && 
mod
!=NULL)

488 if(
	`gtk__mod_g_
(
mod
, &

, 
th
))

490 
	`rib_db_ayli_t_lyric_bd
(

491 (
GSequIr
 *)

.
ur_da
, 
w_fe
);

496 
	`g_
(
w_fe
);

500 if(
	`gtk__row_n_vid
(
n
))

502 
th
 = 
	`gtk__row_n_g_th
(
n
);

503 
mod
 = 
	`gtk__row_n_g_mod
(
n
);

504 if(
th
!=
NULL
 && 
mod
!=NULL)

506 if(
	`gtk__mod_g_
(
mod
, &

, 
th
))

508 
	`rib_db_ayli_t_lyric_bd
(

509 (
GSequIr
 *)

.
ur_da
, 
NULL
);

515 if(
	`gtk_togg_bu_g_aive
(
	`GTK_TOGGLE_BUTTON
(
dio_bus
[2])))

517 
w_fe
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

518 
febu
[1]));

519 if(
w_fe
!=
NULL
)

521 if(
	`gtk__row_n_vid
(
n
))

523 
th
 = 
	`gtk__row_n_g_th
(
n
);

524 
mod
 = 
	`gtk__row_n_g_mod
(
n
);

525 if(
th
!=
NULL
 && 
mod
!=NULL)

527 if(
	`gtk__mod_g_
(
mod
, &

, 
th
))

529 
	`rib_db_ayli_t_lyric_cdy_bd
(

530 (
GSequIr
 *)

.
ur_da
, 
w_fe
);

535 
	`g_
(
w_fe
);

539 if(
	`gtk__row_n_vid
(
n
))

541 
th
 = 
	`gtk__row_n_g_th
(
n
);

542 
mod
 = 
	`gtk__row_n_g_mod
(
n
);

543 if(
th
!=
NULL
 && 
mod
!=NULL)

545 if(
	`gtk__mod_g_
(
mod
, &

, 
th
))

547 
	`rib_db_ayli_t_lyric_cdy_bd
(

548 (
GSequIr
 *)

.
ur_da
, 
NULL
);

554 
	`gtk__row_n_
(
n
);

555 
	`gtk_widg_deroy
(
dlog
);

556 
	}
}

565 
	$rc_ui_dlog_bd_bum
()

567 
GtkWidg
 *
dlog
;

568 
GtkWidg
 *
cڋ_
;

569 
GtkWidg
 *
grid
;

570 
GtkWidg
 *
dio_bus
[2];

571 
GtkWidg
 *
febu
;

572 
GtkTeIr
 

;

573 
gt
 
t
;

574 cڡ 
gch
 *
home_d
;

575 cڡ 
gch
 *
bum_fe
 = 
NULL
;

576 
gch
 *
w_fe
;

577 
GtkFeFr
 *
fe_fr
;

578 
GtkTePh
 *
th
;

579 
GtkTeMod
 *
mod
;

580 
GtkTeRowRen
 *
n
;

581 if(!
	`rc_ui_livw_ayli_g_curs
(&

)) ;

582 if(

.
ur_da
==
NULL
) ;

583 
mod
 = 
	`rc_ui_livw_ayli_g_mod
();

584 if(
mod
==
NULL
) ;

585 
th
 = 
	`gtk__mod_g_th
(
mod
, &

);

586 
n
 = 
	`gtk__row_n_w
(
mod
, 
th
);

587 
	`gtk__th_
(
th
);

588 
dlog
 = 
	`gtk_dlog_w_wh_bus
(
	`_
("Setlbum file binding"),

589 
	`GTK_WINDOW
(
	`rc_ui_ma_wdow_g_widg
()), 
GTK_DIALOG_MODAL
 |

590 
GTK_DIALOG_DESTROY_WITH_PARENT
, 
GTK_STOCK_OK
, 
GTK_RESPONSE_ACCEPT
,

591 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_REJECT
, 
NULL
);

592 
dio_bus
[0] = 
	`gtk_dio_bu_w_wh_mmic
(
NULL
,

593 
	`_
("_Bindlbum image fileohe music"));

594 
dio_bus
[1] = 
	`gtk_dio_bu_w_wh_mmic_om_widg
(

595 
	`GTK_RADIO_BUTTON
(
dio_bus
[0]), 
	`_
("_Doot bindlbum file"));

596 
febu
 = 
	`gtk_fe_choor_bu_w
(
	`_
("Selectlbum image file"),

597 
GTK_FILE_CHOOSER_ACTION_OPEN
);

598 
cڋ_
 = 
	`gtk_dlog_g_cڋ_
(
	`GTK_DIALOG
(
dlog
));

599 
grid
 = 
	`gtk_grid_w
();

600 
	`gtk_grid_t_row_acg
(
	`GTK_GRID
(
grid
), 2);

601 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(
dio_bus
[1]), 
TRUE
);

602 
fe_fr
 = 
	`gtk_fe_fr_w
();

603 
	`gtk_fe_fr_t_me
(
fe_fr
,

604 
	`_
("Image File (*.JPG, *.BMP, *.PNG)..."));

605 
	`gtk_fe_fr_add_n
(
fe_fr
, "*.[J,j][P,p][G,g]");

606 
	`gtk_fe_fr_add_n
(
fe_fr
, "*.[J,j][P,p][E,e][G,g]");

607 
	`gtk_fe_fr_add_n
(
fe_fr
, "*.[B,b][M,m][P,p]");

608 
	`gtk_fe_fr_add_n
(
fe_fr
, "*.[P,p][N,n][G,g]");

609 
home_d
 = 
	`g_gv
("HOME");

610 if(
home_d
==
NULL
)

611 
home_d
 = 
	`g_g_home_d
();

612 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
febu
),

613 
home_d
);

614 
	`gtk_fe_choor_add_fr
(
	`GTK_FILE_CHOOSER
(
febu
), 
fe_fr
);

615 
bum_fe
 = 
	`rib_db_ayli_g_bum_bd
((
GSequIr
 *)

616 

.
ur_da
);

617 if(
bum_fe
!=
NULL
)

619 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(
dio_bus
[0]),

620 
TRUE
);

621 
	`gtk_fe_choor_t_fame
(
	`GTK_FILE_CHOOSER
(
febu
),

622 
bum_fe
);

624 
	`gtk_widg_t_hexnd
(
dio_bus
[0], 
TRUE
);

625 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
dio_bus
[0], 0, 0, 1, 1);

626 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
febu
, 0, 1, 1, 1);

627 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
dio_bus
[1], 0, 2, 1, 1);

628 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
cڋ_
), 
grid
);

629 
	`gtk_widg_t_size_que
(
dlog
, 300, -1);

630 
	`gtk_widg_show_l
(
cڋ_
);

631 
t
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
dlog
));

632 if(
t
==
GTK_RESPONSE_ACCEPT
)

634 if(
	`gtk_togg_bu_g_aive
(
	`GTK_TOGGLE_BUTTON
(
dio_bus
[0])))

636 
w_fe
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

637 
febu
));

638 if(
w_fe
!=
NULL
)

640 if(
	`gtk__row_n_vid
(
n
))

642 
th
 = 
	`gtk__row_n_g_th
(
n
);

643 
mod
 = 
	`gtk__row_n_g_mod
(
n
);

644 if(
th
!=
NULL
 && 
mod
!=NULL)

646 if(
	`gtk__mod_g_
(
mod
, &

, 
th
))

648 
	`rib_db_ayli_t_bum_bd
(

649 (
GSequIr
 *)

.
ur_da
, 
w_fe
);

654 
	`g_
(
w_fe
);

658 if(
	`gtk__row_n_vid
(
n
))

660 
th
 = 
	`gtk__row_n_g_th
(
n
);

661 
mod
 = 
	`gtk__row_n_g_mod
(
n
);

662 if(
th
!=
NULL
 && 
mod
!=NULL)

664 if(
	`gtk__mod_g_
(
mod
, &

, 
th
))

666 
	`rib_db_ayli_t_bum_bd
(

667 (
GSequIr
 *)

.
ur_da
, 
NULL
);

673 
	`gtk__row_n_
(
n
);

674 
	`gtk_widg_deroy
(
dlog
);

675 
	}
}

683 
	$rc_ui_dlog_ve_bum
()

685 
GtkWidg
 *
fe_choor
;

686 
gt
 
su
 = 0;

687 
gch
 *
fe_me
 = 
NULL
;

688 cڡ 
gch
 *
home_d
;

689 if(!
	`rib_bum_g_bum_da
(
NULL
, NULL)) ;

690 
fe_choor
 = 
	`gtk_fe_choor_dlog_w
(
	`_
("Savehelaylist..."),

691 
NULL
, 
GTK_FILE_CHOOSER_ACTION_SAVE
, 
GTK_STOCK_SAVE
,

692 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_CANCEL
, 
NULL
);

693 
home_d
 = 
	`g_gv
("HOME");

694 if(
home_d
==
NULL
)

695 
home_d
 = 
	`g_g_home_d
();

696 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
fe_choor
),

697 
home_d
);

698 
	`gtk_fe_choor_t_do_ovwre_cfmi
(

699 
	`GTK_FILE_CHOOSER
(
fe_choor
), 
TRUE
);

700 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
fe_choor
));

701 
su
)

703 
GTK_RESPONSE_ACCEPT
:

704 
fe_me
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

705 
fe_choor
));

706 
	`rib_bum_ve_fe
(
fe_me
);

707 
	`g_
(
fe_me
);

709 
GTK_RESPONSE_CANCEL
:

713 
	`gtk_widg_deroy
(
fe_choor
);

714 
	}
}

722 
	$rc_ui_dlog_ݒ_music
()

724 
GtkTeIr
 

;

725 
GtkWidg
 *
fe_choor
;

726 
GtkFeFr
 *
fe_fr1
;

727 
gt
 
su
 = 0;

728 
gch
 *
uri
 = 
NULL
;

729 
gch
 *
dlog_t
 = 
NULL
;

730 cڡ 
gch
 *
home_d
;

731 if(!
	`rc_ui_livw_log_g_curs
(&

)) ;

732 if(

.
ur_da
==
NULL
) ;

733 
fe_fr1
 = 
	`gtk_fe_fr_w
();

734 
	`gtk_fe_fr_t_me
(
fe_fr1
,

735 
	`_
("All supported music files(*.FLAC;*.OGG;*.MP3;*.WAV;*.WMA...)"));

736 
	`gtk_fe_fr_add_cuom
(
fe_fr1
, 
GTK_FILE_FILTER_DISPLAY_NAME
,

737 
rc_ui_dlog_music_fe_fr
, 
NULL
, NULL);

738 
dlog_t
 = 
	`_
("Selecthe music you wantodd...");

739 
fe_choor
 = 
	`gtk_fe_choor_dlog_w
(
dlog_t
, 
NULL
,

740 
GTK_FILE_CHOOSER_ACTION_OPEN
, 
GTK_STOCK_OPEN
, 
GTK_RESPONSE_ACCEPT
,

741 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_CANCEL
, 
NULL
);

742 
home_d
 = 
	`g_gv
("HOME");

743 if(
home_d
==
NULL
)

744 
home_d
 = 
	`g_g_home_d
();

745 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
fe_choor
),

746 
home_d
);

747 
	`gtk_fe_choor_add_fr
(
	`GTK_FILE_CHOOSER
(
fe_choor
), 
fe_fr1
);

748 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
fe_choor
));

749 
su
)

751 
GTK_RESPONSE_ACCEPT
:

752 
uri
 = 
	`gtk_fe_choor_g_uri
(

753 
	`GTK_FILE_CHOOSER
(
fe_choor
));

754 if(
uri
!=
NULL
)

756 
	`rib_ce_t_uri
(
uri
);

757 
	`rib_ce_ay
();

759 
	`g_
(
uri
);

761 
GTK_RESPONSE_CANCEL
:

765 
	`gtk_widg_deroy
(
fe_choor
);

766 
	}
}

774 
	$rc_ui_dlog_ݒ_loti
()

776 
GtkWidg
 *
dlog
;

777 
GtkWidg
 *
grid
;

778 
GtkWidg
 *
cڋ_
;

779 
GtkWidg
 *
b
;

780 
GtkWidg
 *
y
;

781 cڡ 
gch
 *
uri
;

782 
gt
 
t
;

783 
dlog
 = 
	`gtk_dlog_w_wh_bus
(
	`_
("Open Location"),

784 
	`GTK_WINDOW
(
	`rc_ui_ma_wdow_g_widg
()), 
GTK_DIALOG_MODAL
 |

785 
GTK_DIALOG_DESTROY_WITH_PARENT
, 
GTK_STOCK_OPEN
, 
GTK_RESPONSE_ACCEPT
,

786 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_REJECT
, 
NULL
);

787 
cڋ_
 = 
	`gtk_dlog_g_cڋ_
(
	`GTK_DIALOG
(
dlog
));

788 
grid
 = 
	`gtk_grid_w
();

789 
b
 = 
	`gtk_b_w
(
	`_
("Enterhe URL ofhe file you "

791 
y
 = 
	`gtk_y_w
();

792 
	`g_obje_t
(
y
, "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

793 
	`g_obje_t
(
grid
, "row-acg", 3, 
NULL
);

794 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
b
, 0, 0, 1, 1);

795 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
y
, 0, 1, 1, 1);

796 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
cڋ_
), 
grid
);

797 
	`gtk_widg_t_size_que
(
dlog
, 300, -1);

798 
	`gtk_widg_show_l
(
cڋ_
);

799 
t
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
dlog
));

800 if(
t
==
GTK_RESPONSE_ACCEPT
)

802 
uri
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
y
));

803 
	`rib_ce_t_uri
(
uri
);

804 
	`rib_ce_ay
();

806 
	`gtk_widg_deroy
(
dlog
);

807 
	}
}

809 
	$rc_ui_dlog_show_su܋d_fm_o_bu_icked
(

810 
GtkWidg
 *
widg
, 
gpor
 
da
)

812 if(
da
==
NULL
) ;

813 
	`gtk_widg_deroy
(
	`GTK_WIDGET
(
da
));

814 
	}
}

822 
	$rc_ui_dlog_show_su܋d_fm
()

824 
GtkWidg
 *
dlog
 = 
NULL
;

825 
GtkWidg
 *
ma_grid
;

826 
GtkWidg
 *
bu_hbox
;

827 
GtkWidg
 *
sd_wdow
;

828 
GtkWidg
 *
vw
;

829 
GtkWidg
 *
o_bu
;

830 
GtkLiSte
 *
li_e
;

831 
GtkTeVwCumn
 *
cumns
[2];

832 
GtkClRd
 *
nds
[2];

833 
GtkTeIr
 

;

834 
gboޗn
 
ag
;

835 
gt
 
i
;

836 if(
dlog
!=
NULL
)

838 
	`gtk_widg_show_l
(
dlog
);

841 
dlog
 = 
	`gtk_wdow_w
(
GTK_WINDOW_TOPLEVEL
);

842 
li_e
 = 
	`gtk_li_e_w
(2, 
G_TYPE_STRING
, 
G_TYPE_BOOLEAN
);

843 
nds
[0] = 
	`gtk__nd_xt_w
();

844 
nds
[1] = 
	`gtk__nd_togg_w
();

845 
cumns
[0] = 
	`gtk__vw_cumn_w_wh_ibus
(

846 
	`_
("Fm"), 
nds
[0], "xt", 0, 
NULL
);

847 
cumns
[1] = 
	`gtk__vw_cumn_w_wh_ibus
(

848 
	`_
("Su܋d"), 
nds
[1], "aive", 1, 
NULL
);

849 
	`gtk__vw_cumn_t_exnd
(
cumns
[0], 
TRUE
);

850 
vw
 = 
	`gtk__vw_w_wh_mod
(
	`GTK_TREE_MODEL
(
li_e
));

851 
i
=0;i<2;i++)

852 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
cumns
[
i
]);

853 
o_bu
 = 
	`gtk_bu_w_om_ock
(
GTK_STOCK_CLOSE
);

854 
sd_wdow
 = 
	`gtk_sd_wdow_w
(
NULL
, NULL);

855 
ma_grid
 = 
	`gtk_grid_w
();

856 
bu_hbox
 = 
	`gtk_bu_box_w
(
GTK_ORIENTATION_HORIZONTAL
);

857 
	`gtk_wdow_t_posi
(
	`GTK_WINDOW
(
dlog
), 
GTK_WIN_POS_CENTER
);

858 
	`gtk_wdow_t_t
(
	`GTK_WINDOW
(
dlog
), 
	`_
("Supported Audio Format"));

859 
	`gtk_sd_wdow_t_picy
(
	`GTK_SCROLLED_WINDOW
(
sd_wdow
),

860 
GTK_POLICY_NEVER
, 
GTK_POLICY_AUTOMATIC
);

861 
	`gtk_widg_t_size_que
(
dlog
, 350, 250);

862 
	`gtk_wdow_t_sizab
(
	`GTK_WINDOW
(
dlog
), 
FALSE
);

863 
	`g_obje_t
(
ma_grid
, "row-acg", 2, 
NULL
);

864 
	`g_obje_t
(
sd_wdow
, "exnd", 
TRUE
, 
NULL
);

865 
	`g_obje_t
(
bu_hbox
, "yout-y", 
GTK_BUTTONBOX_END
, "spacing",

866 5, 
NULL
);

867 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
sd_wdow
), 
vw
);

868 
	`gtk_box_ck_t
(
	`GTK_BOX
(
bu_hbox
), 
o_bu
, 
FALSE
, FALSE, 2);

869 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
sd_wdow
, 0, 0, 1, 1);

870 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
bu_hbox
, 0, 1, 1, 1);

871 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
dlog
), 
ma_grid
);

872 
	`g_sigl_c
(
o_bu
, "clicked",

873 
	`G_CALLBACK
(
rc_ui_dlog_show_su܋d_fm_o_bu_icked
),

874 
dlog
);

875 
	`g_sigl_c
(
dlog
, "destroy",

876 
	`G_CALLBACK
(
gtk_widg_deroyed
), &
dlog
);

879 
	`gtk_li_e_nd
(
li_e
, &

);

880 
ag
 = 
	`g_deu_giry_check_u_vsi
("flacdec", 0, 10, 0);

881 if(!
ag
)

883 
ag
 = 
	`g_deu_giry_check_u_vsi
("ffdec_flac", 0,

886 
	`gtk_li_e_t
(
li_e
, &

, 0, "FLAC", 1, 
ag
, -1);

889 
	`gtk_li_e_nd
(
li_e
, &

);

890 
ag
 = 
	`g_deu_giry_check_u_vsi
("oggdemux", 0, 10, 0)

891 && 
	`g_deu_giry_check_u_vsi
("vorbisdec", 0, 10, 0);

892 
	`gtk_li_e_t
(
li_e
, &

, 0, "OGG Vbis", 1, 
ag
, -1);

895 
	`gtk_li_e_nd
(
li_e
, &

);

896 
ag
 = 
	`g_deu_giry_check_u_vsi
("flump3dec", 0, 10, 0);

897 if(!
ag
)

899 
ag
 = 
	`g_deu_giry_check_u_vsi
("mad", 0, 10, 0);

901 if(!
ag
)

903 
ag
 = 
	`g_deu_giry_check_u_vsi
("ffdec_mp3", 0,

906 
	`gtk_li_e_t
(
li_e
, &

, 0, "MP3", 1, 
ag
, -1);

909 
	`gtk_li_e_nd
(
li_e
, &

);

910 
ag
 = 
	`g_deu_giry_check_u_vsi
("fluwmadec", 0, 10, 0);

911 if(!
ag
)

913 
ag
 = 
	`g_deu_giry_check_u_vsi
("ffdec_wmapro", 0,

914 10, 0&& 
	`g_deu_giry_check_u_vsi
("ffdec_wmav1",

915 0, 10, 0&& 
	`g_deu_giry_check_u_vsi
(

917 
	`g_deu_giry_check_u_vsi
("ffdec_wmavoice", 0,

920 if(!
ag
)

922 
ag
 = 
	`g_deu_giry_check_u_vsi
("ffdec_mp3", 0,

925 
	`gtk_li_e_t
(
li_e
, &

, 0, "WMA", 1, 
ag
, -1);

928 
	`gtk_li_e_nd
(
li_e
, &

);

929 
ag
 = 
	`g_deu_giry_check_u_vsi
("wavpackdec", 0, 10, 0);

930 
	`gtk_li_e_t
(
li_e
, &

, 0, "Wavck", 1, 
ag
, -1);

933 
	`gtk_li_e_nd
(
li_e
, &

);

934 
ag
 = 
	`g_deu_giry_check_u_vsi
("ffdec_ape", 0, 10, 0)

935 && 
	`g_deu_giry_check_u_vsi
("ffdemux_ape", 0, 10, 0);

936 
	`gtk_li_e_t
(
li_e
, &

, 0, "APE", 1, 
ag
, -1);

939 
	`gtk_li_e_nd
(
li_e
, &

);

940 
ag
 = 
	`g_deu_giry_check_u_vsi
("ttadec", 0, 10, 0) &&

941 
	`g_deu_giry_check_u_vsi
("ttaparse", 0, 10, 0);

942 if(!
ag
)

944 
ag
 = 
	`g_deu_giry_check_u_vsi
("ffdemux_tta", 0,

945 10, 0&& 
	`g_deu_giry_check_u_vsi
("ffdec_tta",

948 
	`gtk_li_e_t
(
li_e
, &

, 0, "TTA", 1, 
ag
, -1);

951 
	`gtk_li_e_nd
(
li_e
, &

);

952 
ag
 = 
	`g_deu_giry_check_u_vsi
("fluaacdec", 0, 10, 0);

953 if(!
ag
)

955 
ag
 = 
	`g_deu_giry_check_u_vsi
("ffdec_aac", 0,

958 
	`gtk_li_e_t
(
li_e
, &

, 0, "AAC", 1, 
ag
, -1);

961 
	`gtk_li_e_nd
(
li_e
, &

);

962 
ag
 = 
	`g_deu_giry_check_u_vsi
("ffdec_ac3", 0, 10, 0);

963 
	`gtk_li_e_t
(
li_e
, &

, 0, "AC3", 1, 
ag
, -1);

966 
	`gtk_li_e_nd
(
li_e
, &

);

967 
ag
 = 
	`g_deu_giry_check_u_vsi
("fluidsynth", 0, 10, 0);

968 if(!
ag
)

970 
ag
 = 
	`g_deu_giry_check_u_vsi
("wildmidi", 0,

973 
	`gtk_li_e_t
(
li_e
, &

, 0, "MIDI", 1, 
ag
, -1);

975 
	`g_obje_uef
(
li_e
);

976 
	`gtk_widg_show_l
(
dlog
);

977 
	}
}

979 
	$rc_ui_dlog_autoved_ڣ_cb
(
GtkDlog
 *
dlog
,

980 
gt
 
ڣ_id
, 
gpor
 
ur_da
)

982 if(
ڣ_id
==
GTK_RESPONSE_YES
)

984 
	`rib_db_ld_autoved
();

985 
	`rc_ui_livw_esh
();

987 
	`rib_db_autoved_move
();

988 
	`gtk_widg_deroy
(
	`GTK_WIDGET
(
dlog
));

989 
	}
}

997 
	$rc_ui_dlog_show_ld_autoved
()

999 
GtkWidg
 *
dlog
;

1000 
dlog
 = 
	`gtk_mesge_dlog_w
(
NULL
, 
GTK_DIALOG_MODAL
,

1001 
GTK_MESSAGE_QUESTION
, 
GTK_BUTTONS_YES_NO
,

1002 
	`_
("Thelayer doesotxitormally, "

1004 
	`g_sigl_c
(
dlog
, "response",

1005 
	`G_CALLBACK
(
rc_ui_dlog_autoved_ڣ_cb
), 
NULL
);

1006 
	`gtk_widg_show_l
(
dlog
);

1007 
	}
}

1015 
	$rc_ui_dlog_show_ld_gacy
()

1017 
GtkWidg
 *
dlog
;

1018 
gt
 
t
;

1019 
dlog
 = 
	`gtk_mesge_dlog_w
(
NULL
, 
GTK_DIALOG_MODAL
,

1020 
GTK_MESSAGE_QUESTION
, 
GTK_BUTTONS_YES_NO
,

1021 
	`_
("Do you wantooadlaylist data fromegacy version "

1023 
t
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
dlog
));

1024 if(
t
==
GTK_RESPONSE_YES
)

1026 
	`rib_db_ld_gacy
();

1028 
	`gtk_widg_deroy
(
dlog
);

1029 
	}
}

1031 
	$rc_ui_dlog_tg_limed_ayg_ab_toggd_cb
(

1032 
GtkToggBu
 *
bu
, 
gpor
 
da
)

1034 
GtkWidg
 *
grid
 = 
	`GTK_WIDGET
(
da
);

1035 
gboޗn
 
abd
;

1036 if(
da
==
NULL
) ;

1037 
abd
 = 
	`gtk_togg_bu_g_aive
(
bu
);

1038 
	`gtk_widg_t_nsive
(
grid
, 
abd
);

1039 
	}
}

1047 
	$rc_ui_dlog_tg_limed_ayg
()

1049 
GtkWidg
 *
dlog
;

1050 
GtkWidg
 *
cڋ_
;

1051 
GtkWidg
 *
ma_grid
;

1052 
GtkWidg
 *
grid
;

1053 
GtkWidg
 *
ab_checkbu
;

1054 
GtkWidg
 *
cdi_diobu1
;

1055 
GtkWidg
 *
cdi_diobu2
;

1056 
GtkWidg
 *
_b
;

1057 
GtkWidg
 *
_bu
;

1058 
gt
 
t
;

1059 
gboޗn
 
cdi
 = 
FALSE
;

1060 
gt
 
tg
 = 3.0;

1061 
dlog
 = 
	`gtk_dlog_w_wh_bus
(
	`_
("Rating Limited Playing Mode"),

1062 
	`GTK_WINDOW
(
	`rc_ui_ma_wdow_g_widg
()), 
GTK_DIALOG_MODAL
 |

1063 
GTK_DIALOG_DESTROY_WITH_PARENT
, 
GTK_STOCK_OK
, 
GTK_RESPONSE_ACCEPT
,

1064 
GTK_STOCK_CANCEL
, 
GTK_RESPONSE_REJECT
, 
NULL
);

1065 
ab_checkbu
 = 
	`gtk_check_bu_w_wh_mmic
(
	`_
("_Enable "

1067 
cdi_diobu1
 = 
	`gtk_dio_bu_w_wh_mmic
(
NULL
,

1068 
	`_
("Playhe music whoseating is _greaterhan orqual\ntohe "

1070 
cdi_diobu2
 = 
	`gtk_dio_bu_w_wh_mmic_om_widg
(

1071 
	`GTK_RADIO_BUTTON
(
cdi_diobu1
), 
	`_
("Playhe music whose "

1073 
_b
 = 
	`gtk_b_w
(
	`_
("Ratingimit value"));

1074 
_bu
 = 
	`gtk__bu_w_wh_nge
(0.0, 5.0, 0.1);

1075 
cڋ_
 = 
	`gtk_dlog_g_cڋ_
(
	`GTK_DIALOG
(
dlog
));

1076 
ma_grid
 = 
	`gtk_grid_w
();

1077 
grid
 = 
	`gtk_grid_w
();

1078 
	`gtk_grid_t_row_acg
(
	`GTK_GRID
(
ma_grid
), 2);

1079 
	`gtk_grid_t_cumn_acg
(
	`GTK_GRID
(
grid
), 5);

1080 
	`gtk_grid_t_row_acg
(
	`GTK_GRID
(
grid
), 2);

1081 
	`gtk_widg_t_hexnd
(
cdi_diobu1
, 
TRUE
);

1082 
	`gtk_widg_t_hexnd
(
cdi_diobu2
, 
TRUE
);

1083 
	`gtk_widg_t_hexnd
(
grid
, 
TRUE
);

1084 
	`gtk_widg_t_vexnd
(
grid
, 
TRUE
);

1085 if(
	`rib_ay_g_tg_lim
(&
tg
, &
cdi
))

1087 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(

1088 
ab_checkbu
), 
TRUE
);

1089 
	`gtk_widg_t_nsive
(
grid
, 
TRUE
);

1093 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(

1094 
ab_checkbu
), 
FALSE
);

1095 
	`gtk_widg_t_nsive
(
grid
, 
FALSE
);

1097 if(
cdi
)

1099 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(

1100 
cdi_diobu2
), 
TRUE
);

1104 
	`gtk_togg_bu_t_aive
(
	`GTK_TOGGLE_BUTTON
(

1105 
cdi_diobu1
), 
TRUE
);

1107 
	`gtk__bu_t_vue
(
	`GTK_SPIN_BUTTON
(
_bu
), 
tg
);

1108 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
cdi_diobu1
,

1110 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
cdi_diobu2
,

1112 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
_b
,

1114 
	`gtk_grid_ch
(
	`GTK_GRID
(
grid
), 
_bu
,

1116 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
ab_checkbu
,

1118 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
grid
,

1120 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
cڋ_
), 
ma_grid
);

1121 
	`gtk_widg_t_size_que
(
dlog
, 300, -1);

1122 
	`g_sigl_c
(
ab_checkbu
, "toggled",

1123 
	`G_CALLBACK
(
rc_ui_dlog_tg_limed_ayg_ab_toggd_cb
),

1124 
grid
);

1125 
	`gtk_widg_show_l
(
cڋ_
);

1126 
t
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
dlog
));

1127 if(
t
==
GTK_RESPONSE_ACCEPT
)

1129 
	`rib_ay_t_tg_lim
(

1130 
	`gtk_togg_bu_g_aive
(
	`GTK_TOGGLE_BUTTON
(

1131 
ab_checkbu
)), 
	`gtk__bu_g_vue
(

1132 
	`GTK_SPIN_BUTTON
(
_bu
)), 
	`gtk_togg_bu_g_aive
(

1133 
	`GTK_TOGGLE_BUTTON
(
cdi_diobu2
)));

1135 
	`gtk_widg_deroy
(
dlog
);

1136 
	}
}

	@ui/rc-ui-dialog.h

25 #ide
HAVE_RC_UI_DIALOG_H


26 
	#HAVE_RC_UI_DIALOG_H


	)

28 
	~<glib.h
>

29 
	~<glib/gi18n.h
>

30 
	~<gtk/gtk.h
>

31 
	~<rib.h
>

33 
G_BEGIN_DECLS


35 
rc_ui_dlog_about_ay
();

36 
rc_ui_dlog_show_mesge
(
GtkMesgeTy
 
ty
, cڡ 
gch
 *
t
,

37 cڡ 
gch
 *
fm
, ...);

38 
rc_ui_dlog_add_music
();

39 
rc_ui_dlog_add_dey
();

40 
rc_ui_dlog_ld_ayli
();

41 
rc_ui_dlog_ve_ayli
();

42 
rc_ui_dlog_ve_l_ayli
();

43 
rc_ui_dlog_bd_lyric
();

44 
rc_ui_dlog_bd_bum
();

45 
rc_ui_dlog_ve_bum
();

46 
rc_ui_dlog_ݒ_music
();

47 
rc_ui_dlog_ݒ_loti
();

48 
rc_ui_dlog_show_su܋d_fm
();

49 
rc_ui_dlog_show_ld_autoved
();

50 
rc_ui_dlog_show_ld_gacy
();

51 
rc_ui_dlog_tg_limed_ayg
();

53 
	gG_END_DECLS


	@ui/rc-ui-effect.c

26 
	~"rc-ui-ef.h
"

27 
	~"rc-comm.h
"

38 
	sRCUiAudioEfPrive


40 
GtkWidg
 *
	mef_wdow
;

41 
GtkWidg
 *
	meq_combo_box
;

42 
GtkWidg
 *
	meq_ss
[10];

43 
GtkWidg
 *
	mb_s
;

44 
gulg
 
	meq_id
;

45 
gulg
 
	mb_id
;

46 }
	tRCUiAudioEfPrive
;

48 
RCUiAudioEfPrive
 
	gef_iv
 = {0};

50 
	$rc_ui_ef_wdow_eq_combo_box_chged_cb
(
GtkComboBox
 *
widg
,

51 
gpor
 
da
)

53 
gt
 
dex
 = 0;

54 
dex
 = 
	`gtk_combo_box_g_aive
(
widg
);

55 
	`rib_ce_t_eq
(
dex
, 
NULL
);

56 
	}
}

58 
	$rc_ui_ef_wdow_eq_s_chged_cb
(
GtkRge
 *
nge
,

59 
gpor
 
da
)

61 
gdoub
 
bds
[10] = {0.0};

62 
gdoub
 
vue
 = 0.0;

63 
gt
 
i
;

64 
	`rib_ce_g_eq
(
NULL
, 
bds
);

65 
i
 = 
	`GPOINTER_TO_INT
(
da
);

66 if(
i
<0 || i>=10) ;

67 
vue
 = 
	`gtk_nge_g_vue
(
nge
);

68 
bds
[
i
] = 
vue
;

69 
	`rib_ce_t_eq
(
RCLIB_CORE_EQ_TYPE_CUSTOM
, 
bds
);

70 
	}
}

72 
	$rc_ui_ef_wdow_b_s_chged_cb
(
GtkRge
 *
nge
,

73 
gpor
 
da
)

75 
gdoub
 
vue
 = 0.0;

76 
vue
 = 
	`gtk_nge_g_vue
(
nge
);

77 
	`g_sigl_hdrs_block_by_func
(
nge
,

78 
	`G_CALLBACK
(
rc_ui_ef_wdow_b_s_chged_cb
), 
da
);

79 
	`rib_ce_t_b
(
vue
);

80 
	`g_sigl_hdrs_unblock_by_func
(
nge
,

81 
	`G_CALLBACK
(
rc_ui_ef_wdow_b_s_chged_cb
), 
da
);

82 
	}
}

84 
	$rc_ui_ef_eq_chged_cb
(
RCLibCe
 *
ce
, 
RCLibCeEQTy
 
ty
,

85 
gdoub
 *
vues
, 
gpor
 
da
)

87 
RCUiAudioEfPrive
 *
iv
 = &
ef_iv
;

88 
gt
 
i
;

89 if(
vues
==
NULL
) ;

90 
i
=0;i<10;i++)

92 
	`g_sigl_hdrs_block_by_func
(
iv
->
eq_ss
[
i
],

93 
	`G_CALLBACK
(
rc_ui_ef_wdow_eq_s_chged_cb
),

94 
	`GINT_TO_POINTER
(
i
));

95 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
eq_ss
[
i
]),

96 
vues
[
i
]);

97 
	`g_sigl_hdrs_unblock_by_func
(
iv
->
eq_ss
[
i
],

98 
	`G_CALLBACK
(
rc_ui_ef_wdow_eq_s_chged_cb
),

99 
	`GINT_TO_POINTER
(
i
));

101 
	`g_sigl_hdrs_block_by_func
(
iv
->
eq_combo_box
,

102 
	`G_CALLBACK
(
rc_ui_ef_wdow_eq_combo_box_chged_cb
), 
NULL
);

103 
	`gtk_combo_box_t_aive
(
	`GTK_COMBO_BOX
(
iv
->
eq_combo_box
), 
ty
);

104 
	`g_sigl_hdrs_unblock_by_func
(
iv
->
eq_combo_box
,

105 
	`G_CALLBACK
(
rc_ui_ef_wdow_eq_combo_box_chged_cb
), 
NULL
);

106 
	}
}

108 
	$rc_ui_ef_b_chged_cb
(
RCLibCe
 *
ce
, 
gt
 
b
,

109 
gpor
 
da
)

111 
RCUiAudioEfPrive
 *
iv
 = &
ef_iv
;

112 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
b_s
), 
b
);

113 
	}
}

115 
	$rc_ui_ef_eq_ve_g
()

117 
RCUiAudioEfPrive
 *
iv
 = &
ef_iv
;

118 
GtkWidg
 *
fe_choor
;

119 
GtkFeFr
 *
fe_fr1
;

120 
i
 = 0;

121 
eq_fe_da
[299] = {0};

122 
gdoub
 
eq_da
[10] = {0.0};

123 
gt
 
su
 = 0;

124 
gch
 *
fe_me
 = 
NULL
;

125 cڡ 
gch
 *
home_d
;

126 
	`g_tf
(
eq_fe_da
, 64, "Winamp EQibrary file v1.1\x1A!--Entry1");

127 
eq_fe_da
[298] = 0x1F;

128 
fe_fr1
 = 
	`gtk_fe_fr_w
();

129 
	`gtk_fe_fr_t_me
(
fe_fr1
,

130 
	`_
("EQ Setting File (*.EQF)"));

131 
	`gtk_fe_fr_add_n
(
fe_fr1
, "*.[E,e][Q,q][F,f]");

132 
fe_choor
 = 
	`gtk_fe_choor_dlog_w
(
	`_
("Save Equalizer Setting..."),

133 
	`GTK_WINDOW
(
iv
->
ef_wdow
), 
GTK_FILE_CHOOSER_ACTION_SAVE
,

134 
GTK_STOCK_SAVE
, 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
,

135 
GTK_RESPONSE_CANCEL
, 
NULL
);

136 
home_d
 = 
	`g_gv
("HOME");

137 if(
home_d
==
NULL
)

138 
home_d
 = 
	`g_g_home_d
();

139 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
fe_choor
),

140 
home_d
);

141 
	`gtk_fe_choor_add_fr
(
	`GTK_FILE_CHOOSER
(
fe_choor
), 
fe_fr1
);

142 
	`gtk_fe_choor_t_do_ovwre_cfmi
(

143 
	`GTK_FILE_CHOOSER
(
fe_choor
), 
TRUE
);

144 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
fe_choor
));

145 
su
)

147 
GTK_RESPONSE_ACCEPT
:

148 
fe_me
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

149 
fe_choor
));

150 
	`rib_ce_g_eq
(
NULL
, 
eq_da
);

151 
i
=0;i<10;i++)

153 
eq_fe_da
[288+
i
] =

154 ()((12 - 
eq_da
[
i
]) / 24 * 0x3F);

156 
	`g_fe_t_cڋs
(
fe_me
, 
eq_fe_da
, 299, 
NULL
);

157 
	`g_
(
fe_me
);

159 
GTK_RESPONSE_CANCEL
:

163 
	`gtk_widg_deroy
(
fe_choor
);

164 
	}
}

166 
	$rc_ui_ef_eq_ld_g
()

168 
RCUiAudioEfPrive
 *
iv
 = &
ef_iv
;

169 
GtkWidg
 *
fe_choor
;

170 
GtkFeFr
 *
fe_fr1
;

171 
gt
 
su
 = 0;

172 
eq_fe_da
[299];

173 
FILE
 *

;

174 
i
;

175 
gch
 *
fe_me
 = 
NULL
;

176 
gdoub
 
eq_da
[10];

177 cڡ 
gch
 *
home_d
;

178 
fe_fr1
 = 
	`gtk_fe_fr_w
();

179 
	`gtk_fe_fr_t_me
(
fe_fr1
,

180 
	`_
("EQ Setting File (*.EQF)"));

181 
	`gtk_fe_fr_add_n
(
fe_fr1
, "*.[E,e][Q,q][F,f]");

182 
fe_choor
 = 
	`gtk_fe_choor_dlog_w
(
	`_
("Load Equalizer Setting..."),

183 
	`GTK_WINDOW
(
iv
->
ef_wdow
), 
GTK_FILE_CHOOSER_ACTION_OPEN
,

184 
GTK_STOCK_OPEN
, 
GTK_RESPONSE_ACCEPT
, 
GTK_STOCK_CANCEL
,

185 
GTK_RESPONSE_CANCEL
, 
NULL
);

186 
home_d
 = 
	`g_gv
("HOME");

187 if(
home_d
==
NULL
)

188 
home_d
 = 
	`g_g_home_d
();

189 
	`gtk_fe_choor_t_cut_fd
(
	`GTK_FILE_CHOOSER
(
fe_choor
),

190 
home_d
);

191 
	`gtk_fe_choor_add_fr
(
	`GTK_FILE_CHOOSER
(
fe_choor
), 
fe_fr1
);

192 
su
 = 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
fe_choor
));

193 
su
)

195 
GTK_RESPONSE_ACCEPT
:

196 
fe_me
 = 
	`gtk_fe_choor_g_fame
(
	`GTK_FILE_CHOOSER
(

197 
fe_choor
));

198 

 = 
	`fݒ
(
fe_me
, "r");

199 if(

!=
NULL
)

201 if(
	`d
(
eq_fe_da
, 299, 1, 

)<=0) ;

202 if(
	`cmp
(
eq_fe_da
, "Winamp EQibrary file", 22)==0)

204 
i
=0;i<10;i++)

206 
eq_da
[
i
] = 12 -

207 (
gdoub
)
eq_fe_da
[288+
i
] / 0x3F * 24;

209 
	`rib_ce_t_eq
(
RCLIB_CORE_EQ_TYPE_CUSTOM
, 
eq_da
);

211 
	`fo
(

);

213 
	`g_
(
fe_me
);

215 
GTK_RESPONSE_CANCEL
:

219 
	`gtk_widg_deroy
(
fe_choor
);

220 
	}
}

222 
	$rc_ui_ef_wdow_deroy_cb
(
GtkWidg
 *
widg
, 
gpor
 
da
)

224 
RCUiAudioEfPrive
 *
iv
 = &
ef_iv
;

225 if(
iv
->
eq_id
>0)

226 
	`rib_ce_sigl_disc
(
iv
->
eq_id
);

227 if(
iv
->
b_id
>0)

228 
	`rib_ce_sigl_disc
(
iv
->
b_id
);

229 
	`gtk_widg_deroyed
(
iv
->
ef_wdow
, &(priv->effect_window));

230 
	}
}

232 
gboޗn
 
	$rc_ui_ef_wdow_key_ess_cb
(
GtkWidg
 *
widg
,

233 
GdkEvt
 *
evt
, 
gpor
 
da
)

235 
gut
 
keyv
 = 
evt
->
key
.keyval;

236 
RCUiAudioEfPrive
 *
iv
 = &
ef_iv
;

237 if(
keyv
==
GDK_KEY_Es
)

238 
	`gtk_widg_deroy
(
iv
->
ef_wdow
);

239  
FALSE
;

240 
	}
}

242 
	$rc_ui_ef_wdow_
()

244 
GtkWidg
 *
ef_nebook
;

245 
GtkWidg
 *
eq_b
, *
b_b
;

246 
GtkWidg
 *
eq_bs
[10];

247 
GtkWidg
 *
eq_s_grid
;

248 
GtkWidg
 *
eq_ve_bu
, *
eq_ݒ_bu
;

249 
GtkWidg
 *
eq_bu_hbox
;

250 
GtkWidg
 *
eq_hd_grid
;

251 
GtkWidg
 *
eq_ma_grid
;

252 
GtkWidg
 *
b_ma_grid
;

253 
GtkLiSte
 *
e
;

254 
GtkClRd
 *
nd
;

255 
GtkTeIr
 

;

256 
RCUiAudioEfPrive
 *
iv
 = &
ef_iv
;

257 
gt
 
i
;

258 
RCLibCeEQTy
 
eq_ty
;

259 
gdoub
 
eq_bds
[10] = {0.0};

260 
gt
 
b
 = 0.0;

261 if(
iv
->
ef_wdow
!=
NULL
) ;

262 
	`rib_ce_g_eq
(&
eq_ty
, 
eq_bds
);

263 
	`rib_ce_g_b
(&
b
);

264 
iv
->
ef_wdow
 = 
	`gtk_wdow_w
(
GTK_WINDOW_TOPLEVEL
);

265 
ef_nebook
 = 
	`gtk_nebook_w
();

266 
e
 = 
	`gtk_li_e_w
(2, 
G_TYPE_STRING
, 
G_TYPE_INT
);

267 
nd
 = 
	`gtk__nd_xt_w
();

268 
iv
->
eq_combo_box
 = 
	`gtk_combo_box_w_wh_mod
(
	`GTK_TREE_MODEL
(
e
));

269 
	`g_obje_uef
(
e
);

270 
	`gtk__yout_ck_t
(
	`GTK_CELL_LAYOUT
(
iv
->
eq_combo_box
),

271 
nd
, 
TRUE
);

272 
	`gtk__yout_t_ibus
(
	`GTK_CELL_LAYOUT
(
iv
->
eq_combo_box
),

273 
nd
, "xt", 0, 
NULL
);

274 
eq_ve_bu
 = 
	`gtk_bu_w_om_ock
(
GTK_STOCK_SAVE
);

275 
eq_ݒ_bu
 = 
	`gtk_bu_w_om_ock
(
GTK_STOCK_OPEN
);

276 
eq_b
 = 
	`gtk_b_w
(
	`_
("Equalizer"));

277 
b_b
 = 
	`gtk_b_w
(
	`_
("Balance"));

278 
eq_bs
[0] = 
	`gtk_b_w
("29Hz");

279 
eq_bs
[1] = 
	`gtk_b_w
("59Hz");

280 
eq_bs
[2] = 
	`gtk_b_w
("119Hz");

281 
eq_bs
[3] = 
	`gtk_b_w
("227Hz");

282 
eq_bs
[4] = 
	`gtk_b_w
("474Hz");

283 
eq_bs
[5] = 
	`gtk_b_w
("947Hz");

284 
eq_bs
[6] = 
	`gtk_b_w
("1.9KHz");

285 
eq_bs
[7] = 
	`gtk_b_w
("3.8KHz");

286 
eq_bs
[8] = 
	`gtk_b_w
("7.5KHz");

287 
eq_bs
[9] = 
	`gtk_b_w
("15KHz");

288 
eq_s_grid
 = 
	`gtk_grid_w
();

289 
	`gtk_grid_t_cumn_acg
(
	`GTK_GRID
(
eq_s_grid
), 12);

290 
	`gtk_widg_t_vexnd
(
eq_s_grid
, 
TRUE
);

291 
i
=0;i<10;i++)

293 
	`gtk_b_t_g
(
	`GTK_LABEL
(
eq_bs
[
i
]), 90.0);

294 
iv
->
eq_ss
[
i
] = 
	`gtk_s_w_wh_nge
(

295 
GTK_ORIENTATION_VERTICAL
, -12.0, 12.0, 0.1);

296 
	`gtk_widg_t_vexnd
(
iv
->
eq_ss
[
i
], 
TRUE
);

297 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
eq_ss
[
i
]),

298 
eq_bds
[
i
]);

299 
	`gtk_s_t_dw_vue
(
	`GTK_SCALE
(
iv
->
eq_ss
[
i
]), 
TRUE
);

300 
	`gtk_s_t_vue_pos
(
	`GTK_SCALE
(
iv
->
eq_ss
[
i
]),

301 
GTK_POS_BOTTOM
);

302 
	`gtk_nge_t_vd
(
	`GTK_RANGE
(
iv
->
eq_ss
[
i
]), 
TRUE
);

303 
	`gtk_widg_t_size_que
(
iv
->
eq_ss
[
i
], -1, 120);

304 
	`gtk_grid_ch
(
	`GTK_GRID
(
eq_s_grid
), 
eq_bs
[
i
], i, 0, 1, 1);

305 
	`gtk_grid_ch
(
	`GTK_GRID
(
eq_s_grid
), 
iv
->
eq_ss
[
i
],

306 
i
, 1, 1, 1);

308 
iv
->
b_s
 = 
	`gtk_s_w_wh_nge
(
GTK_ORIENTATION_HORIZONTAL
,

310 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
b_s
), 
b
);

311 
	`gtk_s_t_dw_vue
(
	`GTK_SCALE
(
iv
->
b_s
), 
FALSE
);

312 
	`gtk_s_add_mk
(
	`GTK_SCALE
(
iv
->
b_s
), -1.0, 
GTK_POS_BOTTOM
,

313 
	`_
("Left"));

314 
	`gtk_s_add_mk
(
	`GTK_SCALE
(
iv
->
b_s
), 1.0, 
GTK_POS_BOTTOM
,

315 
	`_
("Right"));

316 
	`gtk_s_add_mk
(
	`GTK_SCALE
(
iv
->
b_s
), 0.0, 
GTK_POS_BOTTOM
,

317 
NULL
);

318 
	`g_obje_t
(
iv
->
b_s
, "exnd", 
TRUE
, 
NULL
);

319 
eq_bu_hbox
 = 
	`gtk_bu_box_w
(
GTK_ORIENTATION_HORIZONTAL
);

320 
	`g_obje_t
(
eq_bu_hbox
, "yout-y", 
GTK_BUTTONBOX_END
,

321 "hexnd-t", 
TRUE
, "hexnd", TRUE, "acg", 4, 
NULL
);

322 
i
=
RCLIB_CORE_EQ_TYPE_NONE
;i<=
RCLIB_CORE_EQ_TYPE_CUSTOM
;i++)

324 
	`gtk_li_e_nd
(
e
, &

);

325 
	`gtk_li_e_t
(
e
, &

, 0, 
	`rib_ce_g_eq_me
(
i
), 1,

326 
i
, -1);

328 if(
eq_ty
>=
RCLIB_CORE_EQ_TYPE_NONE
 &&q_ty<
RCLIB_CORE_EQ_TYPE_CUSTOM
)

329 
	`gtk_combo_box_t_aive
(
	`GTK_COMBO_BOX
(
iv
->
eq_combo_box
),

330 
eq_ty
);

332 
	`gtk_combo_box_t_aive
(
	`GTK_COMBO_BOX
(
iv
->
eq_combo_box
),

333 
RCLIB_CORE_EQ_TYPE_CUSTOM
);

334 
eq_hd_grid
 = 
	`gtk_grid_w
();

335 
eq_ma_grid
 = 
	`gtk_grid_w
();

336 
b_ma_grid
 = 
	`gtk_grid_w
();

337 
	`gtk_grid_t_cumn_acg
(
	`GTK_GRID
(
eq_hd_grid
), 8);

338 
	`g_obje_t
(
eq_hd_grid
, "margin-left", 2, "margin-right", 2,

339 "mg-t", 4, "mg-btom", 4, 
NULL
);

340 
	`gtk_grid_t_row_acg
(
	`GTK_GRID
(
eq_ma_grid
), 6);

341 
	`g_obje_t
(
iv
->
ef_wdow
, "t", 
	`_
("Audio Effects"),

342 "wdow-posi", 
GTK_WIN_POS_CENTER
, "has-size-gr", 
FALSE
,

343 "ty-ht", 
GDK_WINDOW_TYPE_HINT_DIALOG
, 
NULL
);

344 
	`gtk_box_ck_t
(
	`GTK_BOX
(
eq_bu_hbox
), 
eq_ve_bu
, 
FALSE
,

345 
FALSE
, 2);

346 
	`gtk_box_ck_t
(
	`GTK_BOX
(
eq_bu_hbox
), 
eq_ݒ_bu
, 
FALSE
,

347 
FALSE
, 2);

348 
	`gtk_grid_ch
(
	`GTK_GRID
(
eq_hd_grid
), 
iv
->
eq_combo_box
, 0, 0, 1, 1);

349 
	`gtk_grid_ch
(
	`GTK_GRID
(
eq_hd_grid
), 
eq_bu_hbox
, 1, 0, 1, 1);

350 
	`gtk_grid_ch
(
	`GTK_GRID
(
eq_ma_grid
), 
eq_hd_grid
, 0, 0, 1, 1);

351 
	`gtk_grid_ch
(
	`GTK_GRID
(
eq_ma_grid
), 
eq_s_grid
, 0, 1, 1, 1);

352 
	`gtk_grid_ch
(
	`GTK_GRID
(
b_ma_grid
), 
iv
->
b_s
, 0, 0, 1, 1);

353 
	`gtk_nebook_nd_ge
(
	`GTK_NOTEBOOK
(
ef_nebook
), 
eq_ma_grid
,

354 
eq_b
);

355 
	`gtk_nebook_nd_ge
(
	`GTK_NOTEBOOK
(
ef_nebook
), 
b_ma_grid
,

356 
b_b
);

357 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
ef_wdow
), 
ef_nebook
);

358 
i
=0;i<10;i++)

360 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
eq_ss
[
i
]), "value-changed",

361 
	`G_CALLBACK
(
rc_ui_ef_wdow_eq_s_chged_cb
),

362 
	`GINT_TO_POINTER
(
i
));

364 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
eq_combo_box
), "changed",

365 
	`G_CALLBACK
(
rc_ui_ef_wdow_eq_combo_box_chged_cb
), 
NULL
);

366 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
b_s
), "value-changed",

367 
	`G_CALLBACK
(
rc_ui_ef_wdow_b_s_chged_cb
), 
NULL
);

368 
	`g_sigl_c
(
	`G_OBJECT
(
eq_ve_bu
), "clicked",

369 
	`G_CALLBACK
(
rc_ui_ef_eq_ve_g
), 
NULL
);

370 
	`g_sigl_c
(
	`G_OBJECT
(
eq_ݒ_bu
), "clicked",

371 
	`G_CALLBACK
(
rc_ui_ef_eq_ld_g
), 
NULL
);

372 
	`g_sigl_c
(
iv
->
ef_wdow
, "key-press-event",

373 
	`G_CALLBACK
(
rc_ui_ef_wdow_key_ess_cb
), 
NULL
);

374 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
ef_wdow
), "destroy",

375 
	`G_CALLBACK
(
rc_ui_ef_wdow_deroy_cb
), 
NULL
);

376 
ef_iv
.
eq_id
 = 
	`rib_ce_sigl_c
("eq-changed",

377 
	`G_CALLBACK
(
rc_ui_ef_eq_chged_cb
), 
NULL
);

378 
ef_iv
.
b_id
 = 
	`rib_ce_sigl_c
("balance-changed",

379 
	`G_CALLBACK
(
rc_ui_ef_b_chged_cb
), 
NULL
);

380 
	`gtk_widg_show_l
(
iv
->
ef_wdow
);

381 
	`gtk_widg_hide
(
iv
->
ef_wdow
);

382 
	}
}

390 
	$rc_ui_ef_wdow_show
()

392 if(
ef_iv
.
ef_wdow
==
NULL
)

394 
	`rc_ui_ef_wdow_
();

395 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
ef_iv
.
ef_wdow
));

398 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
ef_iv
.
ef_wdow
));

399 
	}
}

407 
	$rc_ui_ef_wdow_deroy
()

409 if(
ef_iv
.
ef_wdow
!=
NULL
)

410 
	`gtk_widg_deroy
(
ef_iv
.
ef_wdow
);

411 
	}
}

	@ui/rc-ui-effect.h

25 #ide
HAVE_RC_UI_EFFECT_H


26 
	#HAVE_RC_UI_EFFECT_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<gtk/gtk.h
>

31 
	~<rib.h
>

33 
G_BEGIN_DECLS


35 
rc_ui_ef_wdow_show
();

36 
rc_ui_ef_wdow_deroy
();

38 
	gG_END_DECLS


	@ui/rc-ui-listmodel.c

26 
	~"rc-ui-limod.h
"

27 
	~"rc-comm.h
"

41 
	s_RCUiCogStePrive


43 
GSequ
 *
	mlog
;

44 
gt
 
	mamp
;

45 
gt
 
	mn_cumns
;

48 
	s_RCUiPyliStePrive


50 
GSequ
 *
	mayli
;

51 
GSequIr
 *
	mlog_
;

52 
gt
 
	mamp
;

53 
gt
 
	mn_cumns
;

56 
GtkTeMod
 *
	glog_mod
 = 
NULL
;

57 
gch
 *
	gfm_rg
 = 
NULL
;

58 
gpor
 
	grc_ui_log_e__ass
 = 
NULL
;

59 
gpor
 
	grc_ui_ayli_e__ass
 = 
NULL
;

61 
GtkTeModFgs
 
	$rc_ui_log_e_g_ags
(
GtkTeMod
 *
mod
)

63 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
),

64 (
GtkTeModFgs
)0);

65  (
GTK_TREE_MODEL_LIST_ONLY
 | 
GTK_TREE_MODEL_ITERS_PERSIST
);

66 
	}
}

68 
GtkTeModFgs
 
	$rc_ui_ayli_e_g_ags
(
GtkTeMod
 *
mod
)

70 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
),

71 (
GtkTeModFgs
)0);

72  (
GTK_TREE_MODEL_LIST_ONLY
 | 
GTK_TREE_MODEL_ITERS_PERSIST
);

73 
	}
}

75 
gt
 
	$rc_ui_log_e_g_n_cumns
(
GtkTeMod
 *
mod
)

77 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
), 0);

78  
RC_UI_CATALOG_COLUMN_LAST
;

79 
	}
}

81 
gt
 
	$rc_ui_ayli_e_g_n_cumns
(
GtkTeMod
 *
mod
)

83 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
), 0);

84  
RC_UI_PLAYLIST_COLUMN_LAST
;

85 
	}
}

87 
GTy
 
	$rc_ui_log_e_g_cumn_ty
(
GtkTeMod
 *
mod
,

88 
gt
 
dex
)

90 
GTy
 
ty
;

91 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
), 
G_TYPE_INVALID
);

92 
dex
)

94 
RC_UI_CATALOG_COLUMN_TYPE
:

95 
ty
 = 
G_TYPE_INT
;

97 
RC_UI_CATALOG_COLUMN_STATE
:

98 
RC_UI_CATALOG_COLUMN_NAME
:

99 
ty
 = 
G_TYPE_STRING
;

101 
RC_UI_CATALOG_COLUMN_PLAYING_FLAG
:

102 
ty
 = 
G_TYPE_BOOLEAN
;

105 
ty
 = 
G_TYPE_INVALID
;

108  
ty
;

109 
	}
}

111 
GTy
 
	$rc_ui_ayli_e_g_cumn_ty
(
GtkTeMod
 *
mod
,

112 
gt
 
dex
)

114 
GTy
 
ty
;

115 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
), 
G_TYPE_INVALID
);

116 
dex
)

118 
RC_UI_PLAYLIST_COLUMN_TYPE
:

119 
RC_UI_PLAYLIST_COLUMN_TRACK
:

120 
RC_UI_PLAYLIST_COLUMN_YEAR
:

121 
ty
 = 
G_TYPE_INT
;

123 
RC_UI_PLAYLIST_COLUMN_STATE
:

124 
RC_UI_PLAYLIST_COLUMN_FTITLE
:

125 
RC_UI_PLAYLIST_COLUMN_TITLE
:

126 
RC_UI_PLAYLIST_COLUMN_ARTIST
:

127 
RC_UI_PLAYLIST_COLUMN_ALBUM
:

128 
RC_UI_PLAYLIST_COLUMN_FTYPE
:

129 
RC_UI_PLAYLIST_COLUMN_LENGTH
:

130 
ty
 = 
G_TYPE_STRING
;

132 
RC_UI_PLAYLIST_COLUMN_PLAYING_FLAG
:

133 
ty
 = 
G_TYPE_BOOLEAN
;

135 
RC_UI_PLAYLIST_COLUMN_RATING
:

136 
ty
 = 
G_TYPE_FLOAT
;

139 
ty
 = 
G_TYPE_INVALID
;

142  
ty
;

143 
	}
}

145 
gboޗn
 
	$rc_ui_log_e_g_
(
GtkTeMod
 *
mod
,

146 
GtkTeIr
 *

, 
GtkTePh
 *
th
)

148 
RCUiCogSte
 *
e
;

149 
RCUiCogStePrive
 *
iv
;

150 
gt
 
i
;

151 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
), 
FALSE
);

152 
	`g_tu_v_if_
(
th
!=
NULL
, 
FALSE
);

153 
e
 = 
	`RC_UI_CATALOG_STORE
(
mod
);

154 
iv
 = 
e
->priv;

155 
i
 = 
	`gtk__th_g_dis
(
th
)[0];

156 if(
i
>=
	`g_qu_g_ngth
(
iv
->
log
))

157  
FALSE
;

158 

->
amp
 = 
iv
->stamp;

159 

->
ur_da
 = 
	`g_qu_g___pos
(
iv
->
log
, 
i
);

160 

->
ur_da2
 = 
NULL
;

161 

->
ur_da3
 = 
NULL
;

162  
TRUE
;

163 
	}
}

165 
gboޗn
 
	$rc_ui_ayli_e_g_
(
GtkTeMod
 *
mod
,

166 
GtkTeIr
 *

, 
GtkTePh
 *
th
)

168 
RCUiPyliSte
 *
e
;

169 
RCUiPyliStePrive
 *
iv
;

170 
gt
 
i
;

171 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
), 
FALSE
);

172 
	`g_tu_v_if_
(
th
!=
NULL
, 
FALSE
);

173 
e
 = 
	`RC_UI_PLAYLIST_STORE
(
mod
);

174 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
e
)->priv;

175 
i
 = 
	`gtk__th_g_dis
(
th
)[0];

176 if(
i
>=
	`g_qu_g_ngth
(
iv
->
ayli
))

177  
FALSE
;

178 

->
amp
 = 
iv
->stamp;

179 

->
ur_da
 = 
	`g_qu_g___pos
(
iv
->
ayli
, 
i
);

180 

->
ur_da2
 = 
NULL
;

181 

->
ur_da3
 = 
NULL
;

182  
TRUE
;

183 
	}
}

185 
GtkTePh
 *
	$rc_ui_log_e_g_th
(
GtkTeMod
 *
mod
,

186 
GtkTeIr
 *

)

188 
RCUiCogSte
 *
e
;

189 
RCUiCogStePrive
 *
iv
;

190 
GtkTePh
 *
th
;

191 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
), 
NULL
);

192 
e
 = 
	`RC_UI_CATALOG_STORE
(
mod
);

193 
iv
 = 
e
->priv;

194 
	`g_tu_v_if_
(
iv
!=
NULL
, NULL);

195 
	`g_tu_v_if_
(

->
amp
==
iv
->amp, 
NULL
);

196 if(
	`g_qu__is_d
(

->
ur_da
) 
NULL
;

197 
th
 = 
	`gtk__th_w
();

198 
	`gtk__th_nd_dex
(
th
,

199 
	`g_qu__g_posi
(

->
ur_da
));

200  
th
;

201 
	}
}

203 
GtkTePh
 *
	$rc_ui_ayli_e_g_th
(
GtkTeMod
 *
mod
,

204 
GtkTeIr
 *

)

206 
RCUiPyliSte
 *
e
;

207 
RCUiPyliStePrive
 *
iv
;

208 
GtkTePh
 *
th
;

209 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
), 
NULL
);

210 
e
 = 
	`RC_UI_PLAYLIST_STORE
(
mod
);

211 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
e
)->priv;

212 
	`g_tu_v_if_
(
iv
!=
NULL
, NULL);

213 
	`g_tu_v_if_
(

->
amp
==
iv
->amp, 
NULL
);

214 if(
	`g_qu__is_d
(

->
ur_da
) 
NULL
;

215 
th
 = 
	`gtk__th_w
();

216 
	`gtk__th_nd_dex
(
th
,

217 
	`g_qu__g_posi
(

->
ur_da
));

218  
th
;

219 
	}
}

221 
	$rc_ui_log_e_g_vue
(
GtkTeMod
 *
mod
,

222 
GtkTeIr
 *

, 
gt
 
cumn
, 
GVue
 *
vue
)

224 
RCUiCogSte
 *
e
;

225 
RCUiCogStePrive
 *
iv
;

226 
RCLibDbCogDa
 *
_da
;

227 
GSequIr
 *
q_
, *
n_
;

228 
GS
 
e
;

229 
RCLibDbPyliDa
 *
n
 = 
NULL
;

230 
	`g_tu_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
));

231 
	`g_tu_if_
(

!=
NULL
);

232 
e
 = 
	`RC_UI_CATALOG_STORE
(
mod
);

233 
iv
 = 
e
->priv;

234 
	`g_tu_if_
(
iv
!=
NULL
);

235 
	`g_tu_if_
(
cumn
<
iv
->
n_cumns
);

236 
q_
 = 

->
ur_da
;

237 
_da
 = 
	`g_qu_g
(
q_
);

238 
	`g_tu_if_
(
_da
!=
NULL
);

239 
cumn
)

241 
RC_UI_CATALOG_COLUMN_TYPE
:

242 
	`g_vue_
(
vue
, 
G_TYPE_INT
);

243 
	`g_vue_t_t
(
vue
, 
_da
->
ty
);

245 
RC_UI_CATALOG_COLUMN_STATE
:

246 
	`g_vue_
(
vue
, 
G_TYPE_STRING
);

247 
n_
 = 
	`rib_ce_g_db_n
();

248 if(
n_
!=
NULL
 &&

249 
	`rib_db_ayli_is_vid_
(
n_
))

251 
n
 = 
	`g_qu_g
(
n_
);

253 if(
n_
==
NULL
 || 
n
==NULL ||

254 
n
->
log
!=
q_
)

256 
	`g_vue_t_rg
(
vue
, 
NULL
);

259 if(!
	`rib_ce_g_e
(&
e
, 
NULL
, 0))

261 
	`g_vue_t_rg
(
vue
, 
NULL
);

264 
e
)

266 
GST_STATE_PLAYING
:

267 
	`g_vue_t_rg
(
vue
, 
GTK_STOCK_MEDIA_PLAY
);

269 
GST_STATE_PAUSED
:

270 
	`g_vue_t_rg
(
vue
, 
GTK_STOCK_MEDIA_PAUSE
);

273 
	`g_vue_t_rg
(
vue
, 
NULL
);

276 
RC_UI_CATALOG_COLUMN_NAME
:

277 
	`g_vue_
(
vue
, 
G_TYPE_STRING
);

278 
	`g_vue_t_rg
(
vue
, 
_da
->
me
);

280 
RC_UI_CATALOG_COLUMN_PLAYING_FLAG
:

281 
	`g_vue_
(
vue
, 
G_TYPE_BOOLEAN
);

282 
	`g_vue_t_boޗn
(
vue
, 
FALSE
);

283 
n_
 = 
	`rib_ce_g_db_n
();

284 if(
n_
!=
NULL
 &&

285 
	`rib_db_ayli_is_vid_
(
n_
))

287 
n
 = 
	`g_qu_g
(
n_
);

289 if(
n_
==
NULL
 || 
n
==NULL ||

290 
n
->
log
!=
q_
)

294 if(!
	`rib_ce_g_e
(&
e
, 
NULL
, 0))

296 if(
e
==
GST_STATE_PLAYING
 || s==
GST_STATE_PAUSED
)

298 
	`g_vue_t_boޗn
(
vue
, 
TRUE
);

304 
	}
}

306 
	$rc_ui_ayli_e_g_vue
(
GtkTeMod
 *
mod
,

307 
GtkTeIr
 *

, 
gt
 
cumn
, 
GVue
 *
vue
)

309 
RCUiPyliSte
 *
e
;

310 
RCUiPyliStePrive
 *
iv
;

311 
RCLibDbPyliDa
 *
li_da
;

312 
GSequIr
 *
q_
, *
n
;

313 
gch
 *
rg
;

314 
gt
 
c
, 
m
;

315 
gsize
 
i
, 
n
;

316 
GS
 
e
;

317 
gch
 *

 = 
NULL
;

318 
gch
 *
i
, *
lbum
;

319 
GSg
 *

;

320 
	`g_tu_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
));

321 
	`g_tu_if_
(

!=
NULL
);

322 
e
 = 
	`RC_UI_PLAYLIST_STORE
(
mod
);

323 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
e
)->priv;

324 
	`g_tu_if_
(
iv
!=
NULL
);

325 
	`g_tu_if_
(
cumn
<
iv
->
n_cumns
);

326 
q_
 = 

->
ur_da
;

327 
li_da
 = 
	`g_qu_g
(
q_
);

328 
	`g_tu_if_
(
li_da
!=
NULL
);

329 
cumn
)

331 
RC_UI_PLAYLIST_COLUMN_TYPE
:

332 
	`g_vue_
(
vue
, 
G_TYPE_INT
);

333 
	`g_vue_t_t
(
vue
, 
li_da
->
ty
);

335 
RC_UI_PLAYLIST_COLUMN_STATE
:

336 
	`g_vue_
(
vue
, 
G_TYPE_STRING
);

337 if(
li_da
->
ty
==
RCLIB_DB_PLAYLIST_TYPE_MISSING
)

339 
	`g_vue_t_rg
(
vue
, 
GTK_STOCK_CANCEL
);

342 
n
 = 
	`rib_ce_g_db_n
();

343 if(
n
!=
q_
)

345 
	`g_vue_t_rg
(
vue
, 
NULL
);

348 if(!
	`rib_ce_g_e
(&
e
, 
NULL
, 0))

350 
	`g_vue_t_rg
(
vue
, 
NULL
);

353 
e
)

355 
GST_STATE_PLAYING
:

356 
	`g_vue_t_rg
(
vue
, 
GTK_STOCK_MEDIA_PLAY
);

358 
GST_STATE_PAUSED
:

359 
	`g_vue_t_rg
(
vue
, 
GTK_STOCK_MEDIA_PAUSE
);

362 
	`g_vue_t_rg
(
vue
, 
NULL
);

365 
RC_UI_PLAYLIST_COLUMN_FTITLE
:

366 if(
li_da
->
t
!=
NULL
 && 
	`
(list_data->title)>0)

367 

 = 
	`g_rdup
(
li_da
->
t
);

370 if(
li_da
->
uri
!=
NULL
)

371 

 = 
	`rib_g_g_me_om_uri
(
li_da
->
uri
);

373 if(

==
NULL
蹙 = 
	`g_rdup
(
	`_
("Unknown Title"));

374 if(
li_da
->
ti
!=
NULL
 && 
	`
(list_data->artist)>0)

375 
i
 = 
	`g_rdup
(
li_da
->
ti
);

377 
i
 = 
	`g_rdup
(
	`_
("Unknown Artist"));

378 if(
li_da
->
bum
!=
NULL
 && 
	`
(list_data->album)>0)

379 
lbum
 = 
	`g_rdup
(
li_da
->
bum
);

381 
lbum
 = 
	`g_rdup
(
	`_
("Unknown Album"));

382 
n
 = 
	`
(
fm_rg
);

383 

 = 
	`g_rg_w
(
NULL
);

384 
i
=0;i<
n
;i++)

386 if(
fm_rg
[
i
]!='%')

387 
	`g_rg_nd_c
(

, 
fm_rg
[
i
]);

390 if(
	`cmp
(
fm_rg
+
i
, "%TITLE", 6)==0)

392 
	`g_rg_nd
(

, 

);

393 
i
+=5;

395 if(
	`cmp
(
fm_rg
+
i
, "%ARTIST", 7)==0)

397 
	`g_rg_nd
(

, 
i
);

398 
i
+=6;

400 if(
	`cmp
(
fm_rg
+
i
, "%ALBUM", 6)==0)

402 
	`g_rg_nd
(

, 
lbum
);

403 
i
+=5;

406 
	`g_rg_nd_c
(

, 
fm_rg
[
i
]);

409 
	`g_
(

);

410 
	`g_
(
i
);

411 
	`g_
(
lbum
);

412 
	`g_vue_
(
vue
, 
G_TYPE_STRING
);

413 
	`g_vue_t_rg
(
vue
, 

->
r
);

414 
	`g_rg_
(

, 
TRUE
);

416 
RC_UI_PLAYLIST_COLUMN_TITLE
:

417 
	`g_vue_
(
vue
, 
G_TYPE_STRING
);

418 
	`g_vue_t_rg
(
vue
, 
li_da
->
t
);

420 
RC_UI_PLAYLIST_COLUMN_ARTIST
:

421 
	`g_vue_
(
vue
, 
G_TYPE_STRING
);

422 
	`g_vue_t_rg
(
vue
, 
li_da
->
ti
);

424 
RC_UI_PLAYLIST_COLUMN_ALBUM
:

425 
	`g_vue_
(
vue
, 
G_TYPE_STRING
);

426 
	`g_vue_t_rg
(
vue
, 
li_da
->
bum
);

428 
RC_UI_PLAYLIST_COLUMN_FTYPE
:

429 
	`g_vue_
(
vue
, 
G_TYPE_STRING
);

430 
	`g_vue_t_rg
(
vue
, 
li_da
->
y
);

432 
RC_UI_PLAYLIST_COLUMN_LENGTH
:

433 
c
 = (
gt
)(
li_da
->
ngth
 / 
GST_SECOND
);

434 
m
 = 
c
 / 60;

435 
c
 = sec % 60;

436 
rg
 = 
	`g_rdup_tf
("%02d:%02d", 
m
, 
c
);

437 
	`g_vue_
(
vue
, 
G_TYPE_STRING
);

438 
	`g_vue_t_rg
(
vue
, 
rg
);

439 
	`g_
(
rg
);

441 
RC_UI_PLAYLIST_COLUMN_TRACK
:

442 
	`g_vue_
(
vue
, 
G_TYPE_INT
);

443 
	`g_vue_t_t
(
vue
, 
li_da
->
acknum
);

445 
RC_UI_PLAYLIST_COLUMN_YEAR
:

446 
	`g_vue_
(
vue
, 
G_TYPE_INT
);

447 
	`g_vue_t_t
(
vue
, 
li_da
->
yr
);

449 
RC_UI_PLAYLIST_COLUMN_RATING
:

450 
	`g_vue_
(
vue
, 
G_TYPE_FLOAT
);

451 
	`g_vue_t_t
(
vue
, 
li_da
->
tg
);

453 
RC_UI_PLAYLIST_COLUMN_PLAYING_FLAG
:

454 
	`g_vue_
(
vue
, 
G_TYPE_BOOLEAN
);

455 
	`g_vue_t_boޗn
(
vue
, 
FALSE
);

456 if(
li_da
->
ty
==
RCLIB_DB_PLAYLIST_TYPE_MISSING
) ;

457 
n
 = 
	`rib_ce_g_db_n
();

458 if(
n
!=
q_
) ;

459 if(!
	`rib_ce_g_e
(&
e
, 
NULL
, 0))

461 if(
e
==
GST_STATE_PLAYING
 || s==
GST_STATE_PAUSED
)

462 
	`g_vue_t_boޗn
(
vue
, 
TRUE
);

467 
	}
}

469 
gboޗn
 
	$rc_ui_log_e__xt
(
GtkTeMod
 *
mod
,

470 
GtkTeIr
 *

)

472 
RCUiCogSte
 *
e
;

473 
RCUiCogStePrive
 *
iv
;

474 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
), 
FALSE
);

475 
	`g_tu_v_if_
(

!=
NULL
, 
FALSE
);

476 
e
 = 
	`RC_UI_CATALOG_STORE
(
mod
);

477 
iv
 = 
e
->priv;

478 
	`g_tu_v_if_
(
iv
!=
NULL
, 
FALSE
);

479 
	`g_tu_v_if_
(
iv
->
amp
==

->amp, 
FALSE
);

480 

->
ur_da
 = 
	`g_qu__xt
(iter->user_data);

481 

->
ur_da2
 = 
NULL
;

482 

->
ur_da3
 = 
NULL
;

483 if(
	`g_qu__is_d
(

->
ur_da
))

485 

->
amp
 = 0;

486  
FALSE
;

488  
TRUE
;

489 
	}
}

491 
gboޗn
 
	$rc_ui_ayli_e__xt
(
GtkTeMod
 *
mod
,

492 
GtkTeIr
 *

)

494 
RCUiPyliSte
 *
e
;

495 
RCUiPyliStePrive
 *
iv
;

496 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
), 
FALSE
);

497 
	`g_tu_v_if_
(

!=
NULL
, 
FALSE
);

498 
e
 = 
	`RC_UI_PLAYLIST_STORE
(
mod
);

499 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
e
)->priv;

500 
	`g_tu_v_if_
(
iv
!=
NULL
, 
FALSE
);

501 
	`g_tu_v_if_
(
iv
->
amp
==

->amp, 
FALSE
);

502 

->
ur_da
 = 
	`g_qu__xt
(iter->user_data);

503 

->
ur_da2
 = 
NULL
;

504 

->
ur_da3
 = 
NULL
;

505 if(
	`g_qu__is_d
(

->
ur_da
))

507 

->
amp
 = 0;

508  
FALSE
;

510  
TRUE
;

511 
	}
}

513 
gboޗn
 
	$rc_ui_log_e__ev
(
GtkTeMod
 *
mod
,

514 
GtkTeIr
 *

)

516 
RCUiCogSte
 *
e
;

517 
RCUiCogStePrive
 *
iv
;

518 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
), 
FALSE
);

519 
	`g_tu_v_if_
(

!=
NULL
, 
FALSE
);

520 
e
 = 
	`RC_UI_CATALOG_STORE
(
mod
);

521 
iv
 = 
e
->priv;

522 
	`g_tu_v_if_
(
iv
!=
NULL
, 
FALSE
);

523 
	`g_tu_v_if_
(
iv
->
amp
==

->amp, 
FALSE
);

524 if(
	`g_qu__is_beg
(

->
ur_da
))

526 

->
amp
 = 0;

527  
FALSE
;

529 

->
ur_da
 = 
	`g_qu__ev
(iter->user_data);

530 

->
ur_da2
 = 
NULL
;

531 

->
ur_da3
 = 
NULL
;

532  
TRUE
;

533 
	}
}

535 
gboޗn
 
	$rc_ui_ayli_e__ev
(
GtkTeMod
 *
mod
,

536 
GtkTeIr
 *

)

538 
RCUiPyliSte
 *
e
;

539 
RCUiPyliStePrive
 *
iv
;

540 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
), 
FALSE
);

541 
	`g_tu_v_if_
(

!=
NULL
, 
FALSE
);

542 
e
 = 
	`RC_UI_PLAYLIST_STORE
(
mod
);

543 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
e
)->priv;

544 
	`g_tu_v_if_
(
iv
!=
NULL
, 
FALSE
);

545 
	`g_tu_v_if_
(
iv
->
amp
==

->amp, 
FALSE
);

546 if(
	`g_qu__is_beg
(

->
ur_da
))

548 

->
amp
 = 0;

549  
FALSE
;

551 

->
ur_da
 = 
	`g_qu__ev
(iter->user_data);

552 

->
ur_da2
 = 
NULL
;

553 

->
ur_da3
 = 
NULL
;

554  
TRUE
;

555 
	}
}

557 
gboޗn
 
	$rc_ui_log_e__chdn
(
GtkTeMod
 *
mod
,

558 
GtkTeIr
 *

, GtkTeI*

)

560 
RCUiCogSte
 *
e
;

561 
RCUiCogStePrive
 *
iv
;

562 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
), 
FALSE
);

563 
e
 = 
	`RC_UI_CATALOG_STORE
(
mod
);

564 
iv
 = 
	`RC_UI_CATALOG_STORE
(
e
)->priv;

565 
	`g_tu_v_if_
(
iv
!=
NULL
, 
FALSE
);

566 if(

!=
NULL
)

568 

->
amp
 = 0;

569  
FALSE
;

571 if(
	`g_qu_g_ngth
(
iv
->
log
)>0)

573 

->
amp
 = 
iv
->stamp;

574 

->
ur_da
 = 
	`g_qu_g_beg_
(
iv
->
log
);

575  
TRUE
;

579 

->
amp
 = 0;

580  
FALSE
;

582 
	}
}

584 
gboޗn
 
	$rc_ui_ayli_e__chdn
(
GtkTeMod
 *
mod
,

585 
GtkTeIr
 *

, GtkTeI*

)

587 
RCUiPyliSte
 *
e
;

588 
RCUiPyliStePrive
 *
iv
;

589 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
), 
FALSE
);

590 
e
 = 
	`RC_UI_PLAYLIST_STORE
(
mod
);

591 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
e
)->priv;

592 
	`g_tu_v_if_
(
iv
!=
NULL
, 
FALSE
);

593 if(

!=
NULL
)

595 

->
amp
 = 0;

596  
FALSE
;

598 if(
	`g_qu_g_ngth
(
iv
->
ayli
)>0)

600 

->
amp
 = 
iv
->stamp;

601 

->
ur_da
 = 
	`g_qu_g_beg_
(
iv
->
ayli
);

602  
TRUE
;

606 

->
amp
 = 0;

607  
FALSE
;

609 
	}
}

611 
gboޗn
 
	$rc_ui_log_e__has_chd
(
GtkTeMod
 *
mod
,

612 
GtkTeIr
 *

)

614  
FALSE
;

615 
	}
}

617 
gboޗn
 
	$rc_ui_ayli_e__has_chd
(
GtkTeMod
 *
mod
,

618 
GtkTeIr
 *

)

620  
FALSE
;

621 
	}
}

623 
gt
 
	$rc_ui_log_e__n_chdn
(
GtkTeMod
 *
mod
,

624 
GtkTeIr
 *

)

626 
RCUiCogStePrive
 *
iv
;

627 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
), -1);

628 
iv
 = 
	`RC_UI_CATALOG_STORE
(
mod
)->priv;

629 
	`g_tu_v_if_
(
iv
!=
NULL
, -1);

630 if(

==
NULL
)

631  
	`g_qu_g_ngth
(
iv
->
log
);

632 
	`g_tu_v_if_
(
iv
->
amp
==

->stamp, -1);

634 
	}
}

636 
gt
 
	$rc_ui_ayli_e__n_chdn
(
GtkTeMod
 *
mod
,

637 
GtkTeIr
 *

)

639 
RCUiPyliStePrive
 *
iv
;

640 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
), -1);

641 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
mod
)->priv;

642 
	`g_tu_v_if_
(
iv
!=
NULL
, -1);

643 if(

==
NULL
)

644  
	`g_qu_g_ngth
(
iv
->
ayli
);

645 
	`g_tu_v_if_
(
iv
->
amp
==

->stamp, -1);

647 
	}
}

649 
gboޗn
 
	$rc_ui_log_e__h_chd
 (
GtkTeMod
 *
mod
,

650 
GtkTeIr
 *

, GtkTeI*

, 
gt
 
n
)

652 
RCUiCogSte
 *
e
;

653 
RCUiCogStePrive
 *
iv
;

654 
GSequIr
 *
chd
;

655 
	`g_tu_v_if_
(
	`RC_UI_IS_CATALOG_STORE
(
mod
), 
FALSE
);

656 
e
 = 
	`RC_UI_CATALOG_STORE
(
mod
);

657 
iv
 = 
e
->priv;

658 
	`g_tu_v_if_
(
iv
!=
NULL
, 
FALSE
);

659 if(

!=
NULL
 
FALSE
;

660 
chd
 = 
	`g_qu_g___pos
(
iv
->
log
, 
n
);

661 if(
	`g_qu__is_d
(
chd
) 
FALSE
;

662 

->
amp
 = 
iv
->stamp;

663 

->
ur_da
 = 
chd
;

664  
TRUE
;

665 
	}
}

667 
gboޗn
 
	$rc_ui_ayli_e__h_chd
 (
GtkTeMod
 *
mod
,

668 
GtkTeIr
 *

, GtkTeI*

, 
gt
 
n
)

670 
RCUiPyliSte
 *
e
;

671 
RCUiPyliStePrive
 *
iv
;

672 
GSequIr
 *
chd
;

673 
	`g_tu_v_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
mod
), 
FALSE
);

674 
e
 = 
	`RC_UI_PLAYLIST_STORE
(
mod
);

675 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
e
)->priv;

676 
	`g_tu_v_if_
(
iv
!=
NULL
, 
FALSE
);

677 if(

!=
NULL
 
FALSE
;

678 
chd
 = 
	`g_qu_g___pos
(
iv
->
ayli
, 
n
);

679 if(
	`g_qu__is_d
(
chd
) 
FALSE
;

680 

->
amp
 = 
iv
->stamp;

681 

->
ur_da
 = 
chd
;

682  
TRUE
;

683 
	}
}

685 
gboޗn
 
	$rc_ui_log_e__
(
GtkTeMod
 *
mod
,

686 
GtkTeIr
 *

, GtkTeI*
chd
)

688 

->
amp
 = 0;

689  
FALSE
;

690 
	}
}

692 
gboޗn
 
	$rc_ui_ayli_e__
(
GtkTeMod
 *
mod
,

693 
GtkTeIr
 *

, GtkTeI*
chd
)

695 

->
amp
 = 0;

696  
FALSE
;

697 
	}
}

699 
	$rc_ui_log_e__mod_
(
GtkTeModI
 *
i
)

701 
i
->
g_ags
 = 
rc_ui_log_e_g_ags
;

702 
i
->
g_n_cumns
 = 
rc_ui_log_e_g_n_cumns
;

703 
i
->
g_cumn_ty
 = 
rc_ui_log_e_g_cumn_ty
;

704 
i
->
g_
 = 
rc_ui_log_e_g_
;

705 
i
->
g_th
 = 
rc_ui_log_e_g_th
;

706 
i
->
g_vue
 = 
rc_ui_log_e_g_vue
;

707 
i
->
_xt
 = 
rc_ui_log_e__xt
;

708 
i
->
_evious
 = 
rc_ui_log_e__ev
;

709 
i
->
_chdn
 = 
rc_ui_log_e__chdn
;

710 
i
->
_has_chd
 = 
rc_ui_log_e__has_chd
;

711 
i
->
_n_chdn
 = 
rc_ui_log_e__n_chdn
;

712 
i
->
_h_chd
 = 
rc_ui_log_e__h_chd
;

713 
i
->
_
 = 
rc_ui_log_e__
;

714 
	}
}

716 
	$rc_ui_ayli_e__mod_
(
GtkTeModI
 *
i
)

718 
i
->
g_ags
 = 
rc_ui_ayli_e_g_ags
;

719 
i
->
g_n_cumns
 = 
rc_ui_ayli_e_g_n_cumns
;

720 
i
->
g_cumn_ty
 = 
rc_ui_ayli_e_g_cumn_ty
;

721 
i
->
g_
 = 
rc_ui_ayli_e_g_
;

722 
i
->
g_th
 = 
rc_ui_ayli_e_g_th
;

723 
i
->
g_vue
 = 
rc_ui_ayli_e_g_vue
;

724 
i
->
_xt
 = 
rc_ui_ayli_e__xt
;

725 
i
->
_evious
 = 
rc_ui_ayli_e__ev
;

726 
i
->
_chdn
 = 
rc_ui_ayli_e__chdn
;

727 
i
->
_has_chd
 = 
rc_ui_ayli_e__has_chd
;

728 
i
->
_n_chdn
 = 
rc_ui_ayli_e__n_chdn
;

729 
i
->
_h_chd
 = 
rc_ui_ayli_e__h_chd
;

730 
i
->
_
 = 
rc_ui_ayli_e__
;

731 
	}
}

733 
	$rc_ui_log_e_fize
(
GObje
 *
obje
)

735 
	`g_tu_if_
(
	`RC_UI_IS_CATALOG_STORE
(
obje
));

736 
	`G_OBJECT_CLASS
(
rc_ui_log_e__ass
)->
	`fize
(
obje
);

737 
	}
}

739 
	$rc_ui_ayli_e_fize
(
GObje
 *
obje
)

741 
	`g_tu_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
obje
));

742 
	`G_OBJECT_CLASS
(
rc_ui_ayli_e__ass
)->
	`fize
(
obje
);

743 
	}
}

745 
	$rc_ui_log_e_ass_
(
RCUiCogSteCss
 *
kss
)

747 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

748 
rc_ui_log_e__ass
 = 
	`g_ty_ass_ek_
(
kss
);

749 
obje_ass
->
fize
 = 
rc_ui_log_e_fize
;

750 
	`g_ty_ass_add_ive
(
kss
, (
RCUiCogStePrive
));

751 
	}
}

753 
	$rc_ui_ayli_e_ass_
(
RCUiPyliSteCss
 *
kss
)

755 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

756 
rc_ui_ayli_e__ass
 = 
	`g_ty_ass_ek_
(
kss
);

757 
obje_ass
->
fize
 = 
rc_ui_ayli_e_fize
;

758 
	`g_ty_ass_add_ive
(
kss
, (
RCUiPyliStePrive
));

759 
	}
}

762 
	$rc_ui_log_e_
(
RCUiCogSte
 *
e
)

764 
RCUiCogStePrive
 *
iv
;

765 
	`g_tu_if_
(
	`RC_UI_IS_CATALOG_STORE
(
e
));

766 
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
e
, 
RC_UI_TYPE_CATALOG_STORE
,

767 
RCUiCogStePrive
);

768 
e
->
iv
 =riv;

769 
	`g_tu_if_
(
iv
!=
NULL
);

770 
iv
->
log
 = 
NULL
;

771 
iv
->
amp
 = 
	`g_ndom_t
();

772 
iv
->
n_cumns
 = 
RC_UI_CATALOG_COLUMN_LAST
;

773 
	}
}

775 
	$rc_ui_ayli_e_
(
RCUiPyliSte
 *
e
)

777 
RCUiPyliStePrive
 *
iv
;

778 
	`g_tu_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
e
));

779 
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
e
, 
RC_UI_TYPE_PLAYLIST_STORE
,

780 
RCUiPyliStePrive
);

781 
e
->
iv
 =riv;

782 
	`g_tu_if_
(
iv
!=
NULL
);

783 
iv
->
amp
 = 
	`g_ndom_t
();

784 
iv
->
ayli
 = 
NULL
;

785 
iv
->
n_cumns
 = 
RC_UI_PLAYLIST_COLUMN_LAST
;

786 
	}
}

788 
GTy
 
	$rc_ui_log_e_g_ty
()

790 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

791 
GTy
 
g_defe_ty_id
;

792 cڡ 
GTyInfo
 
ty_fo
 = {

793 .
ass_size
 = (
RCUiCogSteCss
),

794 .
ba_
 = 
NULL
,

795 .
ba_fize
 = 
NULL
,

796 .
ass_
 = (
GCssInFunc
)
rc_ui_log_e_ass_
,

797 .
ass_fize
 = 
NULL
,

798 .
ass_da
 = 
NULL
,

799 .
_size
 = (
RCUiCogSte
),

800 .
n_ocs
 = 1,

801 .
_
 = (
GInInFunc
)
rc_ui_log_e_


803 cڡ 
GIInfo
 
_mod_fo
 = {

804 .
r_
 = (
GIInFunc
)

805 
rc_ui_log_e__mod_
,

806 .
r_fize
 = 
NULL
,

807 .
r_da
 = 
NULL


809 if(
	`g___r
(&
g_defe_ty_id__vީe
))

811 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
G_TYPE_OBJECT
,

812 
	`g__ic_rg
("RCUiCogSte"), &
ty_fo
, 0);

813 
	`g_ty_add_r_ic
(
g_defe_ty_id
, 
GTK_TYPE_TREE_MODEL
,

814 &
_mod_fo
);

815 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

817  
g_defe_ty_id__vީe
;

818 
	}
}

820 
GTy
 
	$rc_ui_ayli_e_g_ty
()

822 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

823 
GTy
 
g_defe_ty_id
;

824 cڡ 
GTyInfo
 
ty_fo
 = {

825 .
ass_size
 = (
RCUiPyliSteCss
),

826 .
ba_
 = 
NULL
,

827 .
ba_fize
 = 
NULL
,

828 .
ass_
 = (
GCssInFunc
)
rc_ui_ayli_e_ass_
,

829 .
ass_fize
 = 
NULL
,

830 .
ass_da
 = 
NULL
,

831 .
_size
 = (
RCUiPyliSte
),

832 .
n_ocs
 = 1,

833 .
_
 = (
GInInFunc
)
rc_ui_ayli_e_


835 cڡ 
GIInfo
 
_mod_fo
 = {

836 .
r_
 = (
GIInFunc
)

837 
rc_ui_ayli_e__mod_
,

838 .
r_fize
 = 
NULL
,

839 .
r_da
 = 
NULL


841 if(
	`g___r
(&
g_defe_ty_id__vީe
))

843 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
G_TYPE_OBJECT
,

844 
	`g__ic_rg
("RCUiPyliSte"), &
ty_fo
, 0);

845 
	`g_ty_add_r_ic
(
g_defe_ty_id
, 
GTK_TYPE_TREE_MODEL
,

846 &
_mod_fo
);

847 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

849  
g_defe_ty_id__vީe
;

850 
	}
}

852 
	$rc_ui_li_mod_log_added_cb
(
RCLibDb
 *
db
,

853 
GSequIr
 *

, 
gpor
 
da
)

855 
RCUiCogStePrive
 *
iv
;

856 
RCUiPyliStePrive
 *
ayli_iv
;

857 
RCLibDbCogDa
 *
log_da
;

858 
GtkTeMod
 *
ayli_mod
;

859 
GtkTePh
 *
th
;

860 
GtkTeIr
 
_
;

861 
gt
 
pos
;

862 
	`g_tu_if_
(

!=
NULL
);

863 
	`g_tu_if_
(
	`RC_UI_IS_CATALOG_STORE
(
log_mod
));

864 
iv
 = 
	`RC_UI_CATALOG_STORE
(
log_mod
)->priv;

865 
	`g_tu_if_
(
iv
!=
NULL
);

866 
log_da
 = 
	`g_qu_g
(

);

867 
ayli_mod
 = 
	`GTK_TREE_MODEL
(
	`g_obje_w
(

868 
RC_UI_TYPE_PLAYLIST_STORE
, 
NULL
));

869 
ayli_iv
 = 
	`RC_UI_PLAYLIST_STORE
(
ayli_mod
)->
iv
;

870 
ayli_iv
->
ayli
 = (
GSequ
 *)
log_da
->playlist;

871 
ayli_iv
->
log_
 = 

;

872 
log_da
->
e
 = 
ayli_mod
;

873 
pos
 = 
	`g_qu__g_posi
(

);

874 
th
 = 
	`gtk__th_w
();

875 
	`gtk__th_nd_dex
(
th
, 
pos
);

876 
_
.
ur_da
 = 

;

877 
_
.
amp
 = 
iv
->stamp;

878 
	`gtk__mod_row_ed
(
log_mod
, 
th
, &
_
);

879 
	`gtk__th_
(
th
);

880 
	}
}

882 
	$rc_ui_li_mod_log_chged_cb
(
RCLibDb
 *
db
,

883 
GSequIr
 *

, 
gpor
 
da
)

885 
RCUiCogStePrive
 *
iv
;

886 
GtkTePh
 *
th
;

887 
GtkTeIr
 
_
;

888 
gt
 
pos
;

889 
	`g_tu_if_
(

!=
NULL
);

890 
	`g_tu_if_
(
	`RC_UI_IS_CATALOG_STORE
(
log_mod
));

891 
iv
 = 
	`RC_UI_CATALOG_STORE
(
log_mod
)->priv;

892 
	`g_tu_if_
(
iv
!=
NULL
);

893 
pos
 = 
	`g_qu__g_posi
(

);

894 
th
 = 
	`gtk__th_w
();

895 
	`gtk__th_nd_dex
(
th
, 
pos
);

896 
_
.
ur_da
 = 

;

897 
_
.
amp
 = 
iv
->stamp;

898 
	`gtk__mod_row_chged
(
log_mod
, 
th
, &
_
);

899 
	`gtk__th_
(
th
);

900 
	}
}

902 
	$rc_ui_li_mod_log_de_cb
(
RCLibDb
 *
db
,

903 
GSequIr
 *

, 
gpor
 
da
)

905 
RCLibDbCogDa
 *
log_da
;

906 
GtkTePh
 *
th
;

907 
gt
 
pos
;

908 
	`g_tu_if_
(

!=
NULL
);

909 
	`g_tu_if_
(
	`RC_UI_IS_CATALOG_STORE
(
log_mod
));

910 
log_da
 = 
	`g_qu_g
(

);

911 
	`g_obje_uef
(
	`G_OBJECT
(
log_da
->
e
));

912 
pos
 = 
	`g_qu__g_posi
(

);

913 
th
 = 
	`gtk__th_w
();

914 
	`gtk__th_nd_dex
(
th
, 
pos
);

915 
	`gtk__mod_row_ded
(
log_mod
, 
th
);

916 
	`gtk__th_
(
th
);

917 
	}
}

919 
	$rc_ui_li_mod_log_ded_cb
(
RCLibDb
 *
db
,

920 
gt
 *
w_d
, 
gpor
 
da
)

922 
GtkTePh
 *
th
;

923 
	`g_tu_if_
(
	`RC_UI_IS_CATALOG_STORE
(
log_mod
));

924 
	`g_tu_if_
(
w_d
!=
NULL
);

925 
th
 = 
	`gtk__th_w
();

926 
	`gtk__mod_rows_ded
(
log_mod
, 
th
, 
NULL
, 
w_d
);

927 
	`gtk__th_
(
th
);

928 
	}
}

930 
	$rc_ui_li_mod_ayli_added_cb
(
RCLibDb
 *
db
,

931 
GSequIr
 *

, 
gpor
 
da
)

933 
RCUiPyliStePrive
 *
iv
;

934 
RCLibDbCogDa
 *
log_da
;

935 
RCLibDbPyliDa
 *
ayli_da
;

936 
GtkTePh
 *
th
;

937 
GtkTeMod
 *
ayli_mod
;

938 
GtkTeIr
 
_
;

939 
gt
 
pos
;

940 
	`g_tu_if_
(

!=
NULL
);

941 
ayli_da
 = 
	`g_qu_g
(

);

942 
	`g_tu_if_
(
ayli_da
!=
NULL
);

943 
log_da
 = 
	`g_qu_g
(
ayli_da
->
log
);

944 
ayli_mod
 = 
	`GTK_TREE_MODEL
(
log_da
->
e
);

945 
	`g_tu_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
ayli_mod
));

946 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
ayli_mod
)->priv;

947 
	`g_tu_if_
(
iv
!=
NULL
);

948 
pos
 = 
	`g_qu__g_posi
(

);

949 
th
 = 
	`gtk__th_w
();

950 
	`gtk__th_nd_dex
(
th
, 
pos
);

951 
_
.
ur_da
 = 

;

952 
_
.
amp
 = 
iv
->stamp;

953 
	`gtk__mod_row_ed
(
ayli_mod
, 
th
, &
_
);

954 
	`gtk__th_
(
th
);

955 
	}
}

957 
	$rc_ui_li_mod_ayli_chged_cb
(
RCLibDb
 *
db
,

958 
GSequIr
 *

, 
gpor
 
da
)

960 
RCUiPyliStePrive
 *
iv
;

961 
RCLibDbCogDa
 *
log_da
;

962 
RCLibDbPyliDa
 *
ayli_da
;

963 
GtkTePh
 *
th
;

964 
GtkTeMod
 *
ayli_mod
;

965 
GtkTeIr
 
_
;

966 
gt
 
pos
;

967 
	`g_tu_if_
(

!=
NULL
);

968 
ayli_da
 = 
	`g_qu_g
(

);

969 
	`g_tu_if_
(
ayli_da
!=
NULL
);

970 
log_da
 = 
	`g_qu_g
(
ayli_da
->
log
);

971 
ayli_mod
 = 
	`GTK_TREE_MODEL
(
log_da
->
e
);

972 
	`g_tu_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
ayli_mod
));

973 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
ayli_mod
)->priv;

974 
	`g_tu_if_
(
iv
!=
NULL
);

975 
pos
 = 
	`g_qu__g_posi
(

);

976 
th
 = 
	`gtk__th_w
();

977 
	`gtk__th_nd_dex
(
th
, 
pos
);

978 
_
.
ur_da
 = 

;

979 
_
.
amp
 = 
iv
->stamp;

980 
	`gtk__mod_row_chged
(
ayli_mod
, 
th
, &
_
);

981 
	`gtk__th_
(
th
);

982 
	}
}

984 
	$rc_ui_li_mod_ayli_de_cb
(
RCLibDb
 *
db
,

985 
GSequIr
 *

, 
gpor
 
da
)

987 
RCUiPyliStePrive
 *
iv
;

988 
RCLibDbCogDa
 *
log_da
;

989 
RCLibDbPyliDa
 *
ayli_da
;

990 
GtkTePh
 *
th
;

991 
GtkTeMod
 *
ayli_mod
;

992 
gt
 
pos
;

993 
	`g_tu_if_
(

!=
NULL
);

994 
ayli_da
 = 
	`g_qu_g
(

);

995 
	`g_tu_if_
(
ayli_da
!=
NULL
);

996 
log_da
 = 
	`g_qu_g
(
ayli_da
->
log
);

997 
ayli_mod
 = 
	`GTK_TREE_MODEL
(
log_da
->
e
);

998 
	`g_tu_if_
(
	`RC_UI_IS_PLAYLIST_STORE
(
ayli_mod
));

999 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
ayli_mod
)->priv;

1000 
	`g_tu_if_
(
iv
!=
NULL
);

1001 
pos
 = 
	`g_qu__g_posi
(

);

1002 
th
 = 
	`gtk__th_w
();

1003 
	`gtk__th_nd_dex
(
th
, 
pos
);

1004 
	`gtk__mod_row_ded
(
ayli_mod
, 
th
);

1005 
	`gtk__th_
(
th
);

1006 
	}
}

1008 
	$rc_ui_li_mod_ayli_ded_cb
(
RCLibDb
 *
db
,

1009 
GSequIr
 *

, 
gt
 *
w_d
, 
gpor
 
da
)

1011 
RCLibDbCogDa
 *
log_da
;

1012 
GtkTePh
 *
th
;

1013 
GtkTeMod
 *
ayli_mod
;

1014 
	`g_tu_if_
(

!=
NULL
);

1015 
	`g_tu_if_
(
w_d
!=
NULL
);

1016 
log_da
 = 
	`g_qu_g
(

);

1017 
	`g_tu_if_
(
log_da
!=
NULL
);

1018 
ayli_mod
 = 
	`GTK_TREE_MODEL
(
log_da
->
e
);

1019 
	`g_tu_if_
(
ayli_mod
!=
NULL
);

1020 
th
 = 
	`gtk__th_w
();

1021 
	`gtk__mod_rows_ded
(
ayli_mod
, 
th
, 
NULL
, 
w_d
);

1022 
	`gtk__th_
(
th
);

1023 
	}
}

1025 
gboޗn
 
	$rc_ui_li_mod_
()

1027 
RCUiCogStePrive
 *
log_iv
;

1028 
RCUiPyliStePrive
 *
ayli_iv
;

1029 
RCLibDbCogDa
 *
log_da
;

1030 
GSequ
 *
log_q
;

1031 
GSequIr
 *
log_
;

1032 
GtkTeMod
 *
ayli_mod
;

1033 if(
log_mod
!=
NULL
 
FALSE
;

1034 
log_q
 = 
	`rib_db_g_log
();

1035 if(
log_q
==
NULL
)

1037 
	`g_wng
("Cannotoad catalog from music database!");

1038  
FALSE
;

1040 if(
fm_rg
==
NULL
)

1041 
fm_rg
 = 
	`g_rdup
("%TITLE");

1042 
log_mod
 = 
	`GTK_TREE_MODEL
(
	`g_obje_w
(

1043 
RC_UI_TYPE_CATALOG_STORE
, 
NULL
));

1044 
log_iv
 = 
	`RC_UI_CATALOG_STORE
(
log_mod
)->
iv
;

1045 
log_iv
->
log
 = 
log_q
;

1046 
log_
 = 
	`g_qu_g_beg_
(
log_q
);

1047 !
	`g_qu__is_d
(
log_
);

1048 
log_
 = 
	`g_qu__xt
(catalog_iter))

1050 
ayli_mod
 = 
	`GTK_TREE_MODEL
(
	`g_obje_w
(

1051 
RC_UI_TYPE_PLAYLIST_STORE
, 
NULL
));

1052 
ayli_iv
 = 
	`RC_UI_PLAYLIST_STORE
(
ayli_mod
)->
iv
;

1053 
log_da
 = 
	`g_qu_g
(
log_
);

1054 
log_da
->
e
 = 
ayli_mod
;

1055 
ayli_iv
->
ayli
 = 
log_da
->playlist;

1056 
ayli_iv
->
log_
 = catalog_iter;

1058 
	`rib_db_sigl_c
("catalog-added",

1059 
	`G_CALLBACK
(
rc_ui_li_mod_log_added_cb
), 
NULL
);

1060 
	`rib_db_sigl_c
("catalog-changed",

1061 
	`G_CALLBACK
(
rc_ui_li_mod_log_chged_cb
), 
NULL
);

1062 
	`rib_db_sigl_c
("catalog-delete",

1063 
	`G_CALLBACK
(
rc_ui_li_mod_log_de_cb
), 
NULL
);

1064 
	`rib_db_sigl_c
("catalog-reordered",

1065 
	`G_CALLBACK
(
rc_ui_li_mod_log_ded_cb
), 
NULL
);

1066 
	`rib_db_sigl_c
("playlist-added",

1067 
	`G_CALLBACK
(
rc_ui_li_mod_ayli_added_cb
), 
NULL
);

1068 
	`rib_db_sigl_c
("playlist-changed",

1069 
	`G_CALLBACK
(
rc_ui_li_mod_ayli_chged_cb
), 
NULL
);

1070 
	`rib_db_sigl_c
("playlist-delete",

1071 
	`G_CALLBACK
(
rc_ui_li_mod_ayli_de_cb
), 
NULL
);

1072 
	`rib_db_sigl_c
("playlist-reordered",

1073 
	`G_CALLBACK
(
rc_ui_li_mod_ayli_ded_cb
), 
NULL
);

1074  
TRUE
;

1075 
	}
}

1086 
GtkTeMod
 *
	$rc_ui_li_mod_g_log_e
()

1088 if(
log_mod
==
NULL
)

1089 if(!
	`rc_ui_li_mod_
() 
NULL
;

1090  
log_mod
;

1091 
	}
}

1103 
GtkTeMod
 *
	$rc_ui_li_mod_g_ayli_e
(
GtkTeIr
 *

)

1105 
RCLibDbCogDa
 *
log_da
;

1106 
GSequIr
 *
q_
;

1107 if(

==
NULL
 || ir->
ur_da
==NULL)  NULL;

1108 if(
log_mod
==
NULL
)

1109 if(!
	`rc_ui_li_mod_
() 
NULL
;

1110 
q_
 = 

->
ur_da
;

1111 
log_da
 = 
	`g_qu_g
(
q_
);

1112 if(
log_da
==
NULL
)  NULL;

1113  
	`GTK_TREE_MODEL
(
log_da
->
e
);

1114 
	}
}

1126 
GSequIr
 *
	$rc_ui_li_mod_g_log_by_mod
(
GtkTeMod
 *
mod
)

1128 
RCUiPyliSte
 *
e
;

1129 
RCUiPyliStePrive
 *
iv
;

1130 if(
mod
==
NULL
)  NULL;

1131 if(!
	`RC_UI_IS_PLAYLIST_STORE
(
mod
) 
NULL
;

1132 
e
 = 
	`RC_UI_PLAYLIST_STORE
(
mod
);

1133 
iv
 = 
	`RC_UI_PLAYLIST_STORE
(
e
)->priv;

1134 if(
iv
==
NULL
)  NULL;

1135  
iv
->
log_
;

1136 
	}
}

1147 
	$rc_ui_li_mod_t_ayli_t_fm
(cڡ 
gch
 *
fm
)

1149 if(
fm
==
NULL
 || 
	`g_rr_n
(format, -1, "%TITLE")==NULL)

1151 
	`g_
(
fm_rg
);

1152 
fm_rg
 = 
	`g_rdup
(
fm
);

1153 
	}
}

1163 cڡ 
gch
 *
	$rc_ui_li_mod_g_ayli_t_fm
()

1165  
fm_rg
;

1166 
	}
}

	@ui/rc-ui-listmodel.h

25 #ide
HAVE_RC_UI_LISTMODEL_H


26 
	#HAVE_RC_UI_LISTMODEL_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<glib/gi18n.h
>

31 
	~<gtk/gtk.h
>

32 
	~<rib.h
>

34 
	gG_BEGIN_DECLS


36 
	#RC_UI_TYPE_CATALOG_STORE
 (
	`rc_ui_log_e_g_ty
())

	)

37 
	#RC_UI_CATALOG_STORE
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

38 
RC_UI_TYPE_CATALOG_STORE
, 
RCUiCogSte
))

	)

39 
	#RC_UI_CATALOG_STORE_CLASS
(
kss
(
	`G_TYPE_CHECK_CLASS_CAST
((klass), \

40 
RC_UI_TYPE_CATALOG_STORE
, 
RCUiCogSteCss
))

	)

41 
	#RC_UI_IS_CATALOG_STORE
(
obj
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((obj), \

42 
RC_UI_TYPE_CATALOG_STORE
))

	)

43 
	#RC_UI_IS_CATALOG_STORE_CLASS
(
kss
) \

44 (
	`G_TYPE_CHECK_CLASS_TYPE
((
kss
), 
RC_UI_TYPE_CATALOG_STORE
))

	)

45 
	#RC_UI_CATALOG_STORE_GET_CLASS
(
obj
) \

46 (
	`G_TYPE_INSTANCE_GET_CLASS
((
obj
), 
RC_UI_TYPE_CATALOG_STORE
, \

47 
RCUiCogSte
))

	)

49 
	#RC_UI_TYPE_PLAYLIST_STORE
 (
	`rc_ui_ayli_e_g_ty
())

	)

50 
	#RC_UI_PLAYLIST_STORE
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

51 
RC_UI_TYPE_PLAYLIST_STORE
, 
RCUiPyliSte
))

	)

52 
	#RC_UI_PLAYLIST_STORE_CLASS
(
kss
(
	`G_TYPE_CHECK_CLASS_CAST
((klass), \

53 
RC_UI_TYPE_PLAYLIST_STORE
, 
RCUiPyliSteCss
))

	)

54 
	#RC_UI_IS_PLAYLIST_STORE
(
obj
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((obj), \

55 
RC_UI_TYPE_PLAYLIST_STORE
))

	)

56 
	#RC_UI_IS_PLAYLIST_STORE_CLASS
(
kss
) \

57 (
	`G_TYPE_CHECK_CLASS_TYPE
((
kss
), 
RC_UI_TYPE_PLAYLIST_STORE
))

	)

58 
	#RC_UI_PLAYLIST_STORE_GET_CLASS
(
obj
) \

59 (
	`G_TYPE_INSTANCE_GET_CLASS
((
obj
), 
RC_UI_TYPE_PLAYLIST_STORE
, \

60 
RCUiPyliSte
))

	)

74 
	mRC_UI_CATALOG_COLUMN_TYPE
,

75 
	mRC_UI_CATALOG_COLUMN_STATE
,

76 
	mRC_UI_CATALOG_COLUMN_NAME
,

77 
	mRC_UI_CATALOG_COLUMN_PLAYING_FLAG
,

78 
	mRC_UI_CATALOG_COLUMN_LAST


79 }
	tRCUiCogCumns
;

101 
	mRC_UI_PLAYLIST_COLUMN_TYPE
,

102 
	mRC_UI_PLAYLIST_COLUMN_STATE
,

103 
	mRC_UI_PLAYLIST_COLUMN_FTITLE
,

104 
	mRC_UI_PLAYLIST_COLUMN_TITLE
,

105 
	mRC_UI_PLAYLIST_COLUMN_ARTIST
,

106 
	mRC_UI_PLAYLIST_COLUMN_ALBUM
,

107 
	mRC_UI_PLAYLIST_COLUMN_FTYPE
,

108 
	mRC_UI_PLAYLIST_COLUMN_LENGTH
,

109 
	mRC_UI_PLAYLIST_COLUMN_TRACK
,

110 
	mRC_UI_PLAYLIST_COLUMN_RATING
,

111 
	mRC_UI_PLAYLIST_COLUMN_YEAR
,

112 
	mRC_UI_PLAYLIST_COLUMN_PLAYING_FLAG
,

113 
	mRC_UI_PLAYLIST_COLUMN_LAST


114 }
	tRCUiPyliCumns
;

116 
_RCUiCogSte
 
	tRCUiCogSte
;

117 
_RCUiPyliSte
 
	tRCUiPyliSte
;

118 
_RCUiCogSteCss
 
	tRCUiCogSteCss
;

119 
_RCUiPyliSteCss
 
	tRCUiPyliSteCss
;

120 
_RCUiCogStePrive
 
	tRCUiCogStePrive
;

121 
_RCUiPyliStePrive
 
	tRCUiPyliStePrive
;

129 
	s_RCUiCogSte
 {

131 
GObje
 
	m
;

132 
RCUiCogStePrive
 *
	miv
;

141 
	s_RCUiPyliSte
 {

143 
GObje
 
	m
;

144 
RCUiPyliStePrive
 *
	miv
;

153 
	s_RCUiCogSteCss
 {

155 
GObjeCss
 
	m_ass
;

164 
	s_RCUiPyliSteCss
 {

166 
GObjeCss
 
	m_ass
;

170 
GTy
 
rc_ui_log_e_g_ty
();

171 
GTy
 
rc_ui_ayli_e_g_ty
();

174 
GtkTeMod
 *
rc_ui_li_mod_g_log_e
();

175 
GtkTeMod
 *
rc_ui_li_mod_g_ayli_e
(
GtkTeIr
 *

);

176 
GSequIr
 *
rc_ui_li_mod_g_log_by_mod
(
GtkTeMod
 *
mod
);

177 
rc_ui_li_mod_t_ayli_t_fm
(cڡ 
gch
 *
fm
);

178 cڡ 
gch
 *
rc_ui_li_mod_g_ayli_t_fm
();

180 
	gG_END_DECLS


	@ui/rc-ui-listview.c

26 
	~"rc-ui-livw.h
"

27 
	~"rc-ui-limod.h
"

28 
	~"rc-ui--nd-tg.h
"

29 
	~"rc-ui-mu.h
"

30 
	~"rc-ui-wdow.h
"

31 
	~"rc-comm.h
"

46 
	mRC_UI_LISTVIEW_TARGET_INFO_CATALOG
,

47 
	mRC_UI_LISTVIEW_TARGET_INFO_PLAYLIST
,

48 
	mRC_UI_LISTVIEW_TARGET_INFO_FILE
,

49 
	mRC_UI_LISTVIEW_TARGET_INFO_URILIST


52 
	s_RCUiCogVwPrive


54 
GtkClRd
 *
	me_nd
;

55 
GtkClRd
 *
	mme_nd
;

56 
GtkTeVwCumn
 *
	me_cumn
;

57 
GtkTeVwCumn
 *
	mme_cumn
;

58 
gulg
 
	mlog_de_id
;

61 
	s_RCUiPyliVwPrive


63 
GtkClRd
 *
	me_nd
;

64 
GtkClRd
 *
	mt_nd
;

65 
GtkClRd
 *
	mti_nd
;

66 
GtkClRd
 *
	mbum_nd
;

67 
GtkClRd
 *
	macknum_nd
;

68 
GtkClRd
 *
	myr_nd
;

69 
GtkClRd
 *
	my_nd
;

70 
GtkClRd
 *
	mngth_nd
;

71 
GtkClRd
 *
	mtg_nd
;

72 
GtkTeVwCumn
 *
	me_cumn
;

73 
GtkTeVwCumn
 *
	mt_cumn
;

74 
GtkTeVwCumn
 *
	mti_cumn
;

75 
GtkTeVwCumn
 *
	mbum_cumn
;

76 
GtkTeVwCumn
 *
	macknum_cumn
;

77 
GtkTeVwCumn
 *
	myr_cumn
;

78 
GtkTeVwCumn
 *
	my_cumn
;

79 
GtkTeVwCumn
 *
	mngth_cumn
;

80 
GtkTeVwCumn
 *
	mtg_cumn
;

81 
gboޗn
 
	mdiy_mode
;

84 
GObje
 *
	gui_log_vw_
 = 
NULL
;

85 
GObje
 *
	gui_ayli_vw_
 = 
NULL
;

86 
gpor
 
	grc_ui_log_vw__ass
 = 
NULL
;

87 
gpor
 
	grc_ui_ayli_vw__ass
 = 
NULL
;

89 
gboޗn
 
	$rc_ui_livw_muidg_i_block
(

90 
GtkTeSei
 *
i
, 
GtkTeMod
 *
mod
, 
GtkTePh
 *
th
,

91 
gboޗn
 
pcs
, 
gpor
 
da
)

93  *(cڡ 
gboޗn
 *)
da
;

94 
	}
}

96 
	$rc_ui_livw_block_i
(
GtkWidg
 *
widg
,

97 
gboޗn
 
block
, 
gt
 
x
, g
y
)

99 
GtkTeSei
 *
i
;

100 
gt
 *
whe
;

101 cڡ 
gboޗn
 
which
[] = {
FALSE
, 
TRUE
};

102 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(
widg
));

103 
	`gtk__i_t__funi
(
i
,

104 
rc_ui_livw_muidg_i_block
,

105 (
gboޗn
 *)&
which
[!!
block
], 
NULL
);

106 
whe
 = 
	`g_obje_g_da
(
	`G_OBJECT
(
widg
), "multidrag-where");

107 if(
whe
==
NULL
)

109 
whe
 = 
	`g_w
(
gt
, 2);

110 
	`g_obje_t_da_fu
(
	`G_OBJECT
(
widg
), "multidrag-where",

111 
whe
, 
g_
);

113 
whe
[0] = 
x
;

114 
whe
[1] = 
y
;

115 
	}
}

117 
	$rc_ui_livw_dnd_da_g
(
GtkWidg
 *
widg
,

118 
GdkDgCڋxt
 *
cڋxt
, 
GtkSeiDa
 *
sda
, 
gut
 
fo
,

119 
gut
 
time
, 
gpor
 
da
)

121 
GtkTeSei
 *
i
;

122 
GLi
 *
th_li
 = 
NULL
;

123 if(
th_li
!=
NULL
)

125 
	`g_li_fܗch
(
th_li
, (
GFunc
)
gtk__th_
, 
NULL
);

126 
	`g_li_
(
th_li
);

127 
th_li
 = 
NULL
;

129 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(
widg
));

130 if(
i
==
NULL
) ;

131 
th_li
 = 
	`gtk__i_g_ed_rows
(
i
, 
NULL
);

132 if(
th_li
==
NULL
) ;

133 
	`gtk_i_da_t
(
sda
, 
	`gdk_om_
("Playlist indexrray",

134 
FALSE
), 8, (
gpor
)&
th_li
, (
GLi
 *));

135 
	}
}

137 
	$rc_ui_livw_dnd_mi
(
GtkWidg
 *
widg
, 
GdkDgCڋxt
 *
cڋxt
,

138 
gt
 
x
, g
y
, 
gut
 
time
, 
gpor
 
da
)

140 
GtkTeVwDrPosi
 
pos
;

141 
GtkTePh
 *
th_dr
 = 
NULL
;

142 
	`gtk__vw_g_de_row__pos
(
	`GTK_TREE_VIEW
(
widg
), 
x
, 
y
,

143 &
th_dr
, &
pos
);

144 if(
pos
==
GTK_TREE_VIEW_DROP_INTO_OR_BEFORE
)

145 
pos
 = 
GTK_TREE_VIEW_DROP_BEFORE
;

146 if(
pos
==
GTK_TREE_VIEW_DROP_INTO_OR_AFTER
)

147 
pos
 = 
GTK_TREE_VIEW_DROP_AFTER
;

148 if(
th_dr
!=
NULL
)

150 
	`gtk__vw_t_dg_de_row
(
	`GTK_TREE_VIEW
(
widg
),

151 
th_dr
, 
pos
);

152 if(
pos
==
GTK_TREE_VIEW_DROP_AFTER
)

153 
	`gtk__th_xt
(
th_dr
);

155 
	`gtk__th_ev
(
th_dr
);

156 
	`gtk__vw_sl_to_
(
	`GTK_TREE_VIEW
(
widg
), 
th_dr
, 
NULL
,

157 
FALSE
, 0.0, 0.0);

158 
	`gtk__th_
(
th_dr
);

160 
	}
}

162 
	$rc_ui_livw_dnd_de
(
GtkWidg
 *
widg
, 
GdkDgCڋxt
 *
cڋxt
,

163 
gpor
 
da
)

165 
	`g_sigl__emissi_by_me
(
widg
, "drag-data-delete");

166 
	}
}

168 
gt
 
	$rc_ui_livw_st_comp_func
(cڡ 
gt
 
a
, cڡ g
b
,

169 
gpor
 
da
)

171  
a
 - 
b
;

172 
	}
}

174 
le
 
gt
 *
	$rc_ui_livw_d_by_i
(
GtkTeMod
 *
mod
,

175 
GtkSeiDa
 *
lda
, 
gt
 
rg
, 
GtkTeVwDrPosi
 
pos
)

177 
GLi
 *
th_li_fܗch
 = 
NULL
;

178 
GLi
 *
th_li
 = 
NULL
;

179 
GtkTePh
 *
th_t
 = 
NULL
;

180 
gut
 
ngth
 = 0;

181 
gt
 
i
 = 0, 
j
 = 0, 
k
 = 0, 
cou
 = 0;

182 
gt
 
li_ngth
 = 0;

183 
gt
 *
dis
 = 
NULL
;

184 
gt
 *
dex
 = 
NULL
;

185 
gt
 *
d_y
 = 
NULL
;

186 
gboޗn
 
_ag
 = 
FALSE
;

187 if(
mod
==
NULL
 || 
lda
==NULL)  NULL;

188 
	`memy
(&
th_li
, 
	`gtk_i_da_g_da
(
lda
),

189 (
th_li
));

190 if(
th_li
==
NULL
)  NULL;

191 
ngth
 = 
	`g_li_ngth
(
th_li
);

192 if(
ngth
<1 
NULL
;

193 
dis
 = 
	`g_w
(
gt
, 
ngth
);

194 
th_li_fܗch
=
th_li
;th_li_fܗch!=
NULL
;

195 
th_li_fܗch
=
	`g_li_xt
(path_list_foreach))

197 
th_t
 = 
th_li_fܗch
->
da
;

198 
dex
 = 
	`gtk__th_g_dis
(
th_t
);

199 
dis
[
cou
] = 
dex
[0];

200 
cou
++;

202 
	`g_qst_wh_da
(
dis
, 
ngth
, (
gt
),

203 (
GComDaFunc
)
rc_ui_livw_st_comp_func
, 
NULL
);

204 if(
pos
==
GTK_TREE_VIEW_DROP_AFTER
 ||

205 
pos
==
GTK_TREE_VIEW_DROP_INTO_OR_AFTER

rg
++;

206 
li_ngth
 = 
	`gtk__mod__n_chdn
(
mod
, 
NULL
);

207 if(
rg
<0rg = 
li_ngth
;

208 
d_y
 = 
	`g_w0
(
gt
, 
li_ngth
);

209 
cou
 = 0;

210 
i
<
li_ngth
)

212 if((
j
>=
ngth
 || 
cou
!=
dis
[j]&& cou!=
rg
)

214 
d_y
[
i
] = 
cou
;

215 
cou
++;

216 
i
++;

218 if(
cou
==
rg
 && !
_ag
)

220 
k
=0;k<
ngth
;k++)

222 if(
rg
==
dis
[
k
])

224 
rg
++;

225 
cou
++;

227 
d_y
[
i
] = 
dis
[
k
];

228 
i
++;

230 if(
i
<
li_ngth

d_y
[i] = 
rg
;

231 
i
++;

232 
cou
++;

233 
_ag
 = 
TRUE
;

235 if(
j
<
ngth
 && 
cou
==
dis
[j])

237 
cou
++;

238 
j
++;

242 
	`g_
(
dis
);

243  
d_y
;

244 
	}
}

246 
le
 
	$rc_ui_livw_ayli_move_to_h_log
(

247 
GtkSeiDa
 *
lda
, 
GtkTeIr
 *
rg_
)

249 
GLi
 *
th_li
 = 
NULL
;

250 
GSequIr
 **
s
;

251 
GtkTeIr
 

;

252 
GtkTePh
 *
th
;

253 
GLi
 *
li_fܗch
;

254 
GtkTeMod
 *
mod
;

255 
gut
 
ngth
 = 0;

256 
gt
 
i
;

257 if(
lda
==
NULL
 || 
rg_
==NULL) ;

258 if(
rg_
->
ur_da
==
NULL
) ;

259 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(

260 
ui_ayli_vw_
));

261 if(
mod
==
NULL
) ;

262 
	`memy
(&
th_li
, 
	`gtk_i_da_g_da
(
lda
),

263 (
th_li
));

264 if(
th_li
==
NULL
) ;

265 
ngth
 = 
	`g_li_ngth
(
th_li
);

266 
th_li
 = 
	`g_li_st_wh_da
թh_li, (
GComDaFunc
)

267 
gtk__th_com
, 
NULL
);

268 
s
 = 
	`g_w0
(
GSequIr
 *, 
ngth
);

269 
li_fܗch
=
th_li
, 
i
=0;li_fܗch!=
NULL
;

270 
li_fܗch
=
	`g_li_xt
i_fܗch), 
i
++)

272 
th
 = 
li_fܗch
->
da
;

273 if(
th
==
NULL
) ;

274 if(!
	`gtk__mod_g_
(
mod
, &

, 
th
)) ;

275 
s
[
i
] = 

.
ur_da
;

277 
	`rib_db_ayli_move_to_h_log
(
s
, 
ngth
,

278 
rg_
->
ur_da
);

279 
	}
}

281 
le
 
	$rc_ui_livw_ayli_add_uris_by_i
(

282 
GtkSeiDa
 *
lda
, 
GSequIr
 *
log_
,

283 
GtkTeIr
 *

, 
GtkTeVwDrPosi
 
pos
)

285 
GtkTeMod
 *
mod
;

286 
gch
 *
uris
;

287 
gch
 **
uri_y
;

288 
gt
 
i
;

289 
gch
 *
fame
;

290 if(
lda
==
NULL
 || 
log_
==NULL) ;

291 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(

292 
ui_ayli_vw_
));

293 if(
mod
==
NULL
) ;

294 
uris
 = 
	`gdk_utf8_to_rg_rg
((
gch
 *)

295 
	`gtk_i_da_g_da
(
lda
));

296 if((

!=
NULL
 && ir->
ur_da
!=NULL) &&

297 (
pos
==
GTK_TREE_VIEW_DROP_AFTER
 ||

298 
pos
==
GTK_TREE_VIEW_DROP_INTO_OR_AFTER
))

300 if(!
	`gtk__mod__xt
(
mod
, 

))

302 

->
ur_da
 = 
NULL
;

303 

->
amp
 = 0;

306 
uri_y
 = 
	`g_uri_li_exa_uris
(
uris
);

307 
	`g_
(
uris
);

308 
i
=0;
uri_y
[i]!=
NULL
;i++)

310 if(
uri_y
[
i
]!=
NULL
)

312 if(
	`rib_ut_is_su܋d_med
(
uri_y
[
i
]))

314 if(

!=
NULL
 && ir->
ur_da
!=NULL)

315 
	`rib_db_ayli_add_music
(
log_
,

316 (
GSequIr
 *)

->
ur_da
, 
uri_y
[
i
]);

318 
	`rib_db_ayli_add_music
(
log_
, 
NULL
, 
uri_y
[
i
]);

320 if(
	`rib_ut_is_su܋d_li
(
uri_y
[
i
]))

322 
fame
 = 
	`g_fame_om_uri
(
uri_y
[
i
], 
NULL
, NULL);

323 if(
fame
!=
NULL
)

325 if(

!=
NULL
 && ir->
ur_da
!=NULL)

326 
	`rib_db_ayli_add_m3u_fe
(
log_
,

327 (
GSequIr
 *)

->
ur_da
, 
fame
);

329 
	`rib_db_ayli_add_m3u_fe
(
log_
, 
NULL
,

330 
fame
);

331 
	`g_
(
fame
);

336 
	`g_rv
(
uri_y
);

337 
	}
}

339 
	$rc_ui_livw_log_dnd_da_ived
(
GtkWidg
 *
widg
,

340 
GdkDgCڋxt
 *
cڋxt
, 
gt
 
x
, g
y
, 
GtkSeiDa
 *
lda
,

341 
gut
 
fo
, gu
time
, 
gpor
 
da
)

343 
gt
 *
d_y
 = 
NULL
;

344 
gt
 *
dex
 = 
NULL
;

345 
gt
 
rg
 = 0;

346 
GtkTeVwDrPosi
 
pos
;

347 
GtkTePh
 *
th_dr
 = 
NULL
;

348 
GtkTeMod
 *
mod
;

349 
GtkTeIr
 
rg_
;

350 
	`g_sigl__emissi_by_me
(
	`G_OBJECT
(
widg
), "drag-data-received");

351 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
widg
));

352 
	`gtk__vw_g_de_row__pos
(
	`GTK_TREE_VIEW
(
widg
), 
x
, 
y
,

353 &
th_dr
, &
pos
);

354 if(
th_dr
!=
NULL
)

356 if(!
	`gtk__mod_g_
(
mod
, &
rg_
, 
th_dr
))

358 
rg_
.
ur_da
 = 
NULL
;

359 
rg_
.
amp
 = 0;

361 
dex
 = 
	`gtk__th_g_dis
(
th_dr
);

362 
rg
 = 
dex
[0];

363 
	`gtk__th_
(
th_dr
);

365 
rg
 = -2;

366 
fo
)

368 
RC_UI_LISTVIEW_TARGET_INFO_CATALOG
:

369 
d_y
 = 
	`rc_ui_livw_d_by_i
(
mod
,

370 
lda
, 
rg
, 
pos
);

371 if(
d_y
==
NULL
) ;

372 
	`rib_db_log_d
(
d_y
);

373 
	`g_
(
d_y
);

375 
RC_UI_LISTVIEW_TARGET_INFO_PLAYLIST
:

376 
	`rc_ui_livw_ayli_move_to_h_log
(
lda
,

377 &
rg_
);

382 
	}
}

384 
	$rc_ui_livw_ayli_dnd_da_ived
(
GtkWidg
 *
widg
,

385 
GdkDgCڋxt
 *
cڋxt
, 
gt
 
x
, g
y
, 
GtkSeiDa
 *
lda
,

386 
gut
 
fo
, gu
time
, 
gpor
 
da
)

388 
gt
 *
d_y
 = 
NULL
;

389 
gt
 *
dex
 = 
NULL
;

390 
gt
 
rg
 = 0;

391 
GtkTeVwDrPosi
 
pos
;

392 
GtkTePh
 *
th_dr
 = 
NULL
;

393 
GtkTeMod
 *
mod
;

394 
GSequIr
 *
q_
;

395 
GtkTeIr
 
rg_
 = {0};

396 
	`g_sigl__emissi_by_me
(
	`G_OBJECT
(
widg
), "drag-data-received");

397 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
widg
));

398 
	`gtk__vw_g_de_row__pos
(
	`GTK_TREE_VIEW
(
widg
), 
x
, 
y
,

399 &
th_dr
, &
pos
);

400 if(
th_dr
!=
NULL
)

402 if(!
	`gtk__mod_g_
(
mod
, &
rg_
, 
th_dr
))

404 
rg_
.
ur_da
 = 
NULL
;

405 
rg_
.
amp
 = 0;

407 
dex
 = 
	`gtk__th_g_dis
(
th_dr
);

408 
rg
 = 
dex
[0];

409 
	`gtk__th_
(
th_dr
);

411 
rg
 = -2;

412 
fo
)

414 
RC_UI_LISTVIEW_TARGET_INFO_PLAYLIST
:

415 
d_y
 = 
	`rc_ui_livw_d_by_i
(
mod
,

416 
lda
, 
rg
, 
pos
);

417 if(
d_y
==
NULL
) ;

418 
q_
 = 
	`rc_ui_li_mod_g_log_by_mod
(
mod
);

419 
	`rib_db_ayli_d
(
q_
, 
d_y
);

420 
	`g_
(
d_y
);

422 
RC_UI_LISTVIEW_TARGET_INFO_FILE
:

423 
q_
 = 
	`rc_ui_li_mod_g_log_by_mod
(
mod
);

424 
	`rc_ui_livw_ayli_add_uris_by_i
(
lda
,

425 
q_
, &
rg_
, 
pos
);

430 
	}
}

432 
gboޗn
 
	$rc_ui_livw_bu_esd_evt
(

433 
GtkWidg
 *
widg
, 
GdkEvtBu
 *
evt
, 
gpor
 
da
)

435 
GtkTePh
 *
th
 = 
NULL
;

436 
GtkTeSei
 *
i
;

437 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(
widg
));

438 if(
i
==
NULL
 
FALSE
;

439 
	`rc_ui_livw_block_i
(
widg
, 
TRUE
, -1, -1);

440 if(
evt
->
bu
!=3 &&vt->bu!=1 
FALSE
;

441 if(
evt
->
bu
==1)

443 if(
evt
->
e
 & (
GDK_SHIFT_MASK
 | 
GDK_CONTROL_MASK
))

444  
FALSE
;

445 if(!
	`gtk__vw_g_th__pos
(
	`GTK_TREE_VIEW
(
widg
), 
evt
->
x
,

446 
evt
->
y
, &
th
, 
NULL
, NULL, NULL))

447  
FALSE
;

449 if(
	`gtk__i_th_is_ed
(
i
, 
th
))

451 
	`rc_ui_livw_block_i
(
widg
, 
FALSE
, 
evt
->
x
,

452 
evt
->
y
);

454 if(
th
!=
NULL

	`gtk__th_
(path);

455  
FALSE
;

457 if(
	`gtk__i_cou_ed_rows
(
i
)>1)

458  
TRUE
;

459  
FALSE
;

460 
	}
}

462 
gboޗn
 
	$rc_ui_livw_log_bu_a_evt
(

463 
GtkWidg
 *
widg
, 
GdkEvtBu
 *
evt
, 
gpor
 
da
)

465 
GtkTePh
 *
th
 = 
NULL
;

466 
GtkTeVwCumn
 *
c
;

467 
gt
 
x
, 
y
;

468 
gt
 *
whe
 = 
	`g_obje_g_da
(
	`G_OBJECT
(
widg
), "multidrag-where");

469 if(
whe
 && where[0] != -1)

471 
x
 = 
whe
[0];

472 
y
 = 
whe
[1];

473 
	`rc_ui_livw_block_i
(
widg
, 
TRUE
, -1, -1);

474 if(
x
==
evt
->x && 
y
==event->y)

477 if(
	`gtk__vw_g_th__pos
(
	`GTK_TREE_VIEW
(
widg
),

478 
evt
->
x
,vt->
y
, &
th
, &
c
, 
NULL
, NULL))

480 
	`gtk__vw_t_curs
(
	`GTK_TREE_VIEW
(
widg
), 
th
,

481 
c
, 
FALSE
);

483 if(
th

	`gtk__th_
(path);

486 if(
evt
->
bu
==3)

488 
	`gtk_mu_pup
(
	`GTK_MENU
(
	`gtk_ui_mag_g_widg
(

489 
	`rc_ui_mu_g_ui_mag
(), "/CatalogPopupMenu")),

490 
NULL
, NULL, NULL, NULL, 3, 
	`gtk_g_cut_evt_time
());

492  
FALSE
;

493 
	}
}

495 
gboޗn
 
	$rc_ui_livw_ayli_bu_a_evt
(

496 
GtkWidg
 *
widg
, 
GdkEvtBu
 *
evt
, 
gpor
 
da
)

498 
GtkTePh
 *
th
 = 
NULL
;

499 
GtkTeVwCumn
 *
c
;

500 
gt
 
x
, 
y
;

501 
gt
 *
whe
 = 
	`g_obje_g_da
(
	`G_OBJECT
(
widg
), "multidrag-where");

502 if(
whe
 && where[0] != -1)

504 
x
 = 
whe
[0];

505 
y
 = 
whe
[1];

506 
	`rc_ui_livw_block_i
(
widg
, 
TRUE
, -1, -1);

507 if(
x
==
evt
->x && 
y
==event->y)

510 if(
	`gtk__vw_g_th__pos
(
	`GTK_TREE_VIEW
(
widg
),

511 
evt
->
x
,vt->
y
, &
th
, &
c
, 
NULL
, NULL))

513 
	`gtk__vw_t_curs
(
	`GTK_TREE_VIEW
(
widg
), 
th
,

514 
c
, 
FALSE
);

516 if(
th

	`gtk__th_
(path);

519 if(
evt
->
bu
==3)

521 
	`gtk_mu_pup
(
	`GTK_MENU
(
	`gtk_ui_mag_g_widg
(

522 
	`rc_ui_mu_g_ui_mag
(), "/PlaylistPopupMenu")),

523 
NULL
, NULL, NULL, NULL, 3, 
	`gtk_g_cut_evt_time
());

525  
FALSE
;

526 
	}
}

528 
	$rc_ui_livw_log_t_dg
(
GtkWidg
 *
widg
)

530 
GtkTgEry
 
y
[2];

531 
y
[0].
rg
 = "RhythmCat2/CatalogItem";

532 
y
[0].
ags
 = 
GTK_TARGET_SAME_WIDGET
;

533 
y
[0].
fo
 = 
RC_UI_LISTVIEW_TARGET_INFO_CATALOG
;

534 
y
[1].
rg
 = "RhythmCat2/PlaylistItem";

535 
y
[1].
ags
 = 
GTK_TARGET_SAME_APP
;

536 
y
[1].
fo
 = 
RC_UI_LISTVIEW_TARGET_INFO_PLAYLIST
;

537 
	`gtk_dg_sour_t
(
widg
, 
GDK_BUTTON1_MASK
, 
y
, 1,

538 
GDK_ACTION_MOVE
);

539 
	`gtk_dg_de_t
(
widg
, 
GTK_DEST_DEFAULT_ALL
, 
y
, 2,

540 
GDK_ACTION_COPY
 | 
GDK_ACTION_MOVE
 | 
GDK_ACTION_LINK
);

541 
	}
}

543 
	$rc_ui_livw_ayli_t_dg
(
GtkWidg
 *
widg
)

545 
GtkTgEry
 
y
[4];

546 
y
[0].
rg
 = "RhythmCat2/PlaylistItem";

547 
y
[0].
ags
 = 
GTK_TARGET_SAME_APP
;

548 
y
[0].
fo
 = 
RC_UI_LISTVIEW_TARGET_INFO_PLAYLIST
;

549 
y
[1].
rg
 = "STRING";

550 
y
[1].
ags
 = 0;

551 
y
[1].
fo
 = 
RC_UI_LISTVIEW_TARGET_INFO_FILE
;

552 
y
[2].
rg
 = "text/plain";

553 
y
[2].
ags
 = 0;

554 
y
[2].
fo
 = 
RC_UI_LISTVIEW_TARGET_INFO_FILE
;

555 
y
[3].
rg
 = "text/uri-list";

556 
y
[3].
ags
 = 0;

557 
y
[3].
fo
 = 
RC_UI_LISTVIEW_TARGET_INFO_URILIST
;

558 
	`gtk_dg_sour_t
(
widg
, 
GDK_BUTTON1_MASK
, 
y
, 1,

559 
GDK_ACTION_MOVE
);

560 
	`gtk_dg_de_t
(
widg
, 
GTK_DEST_DEFAULT_ALL
, 
y
, 4,

561 
GDK_ACTION_COPY
 | 
GDK_ACTION_MOVE
 | 
GDK_ACTION_LINK
);

562 
	}
}

564 
	$rc_ui_livw_log_row_ed
(
GtkTeVw
 *
vw
,

565 
gpor
 
da
)

567 
GtkTeIr
 

;

568 
GSequIr
 *
log_
;

569 
RCLibDbCogDa
 *
log_da
;

570 if(!
	`rc_ui_livw_log_g_curs
(&

)) ;

571 
log_
 = 

.
ur_da
;

572 if(
log_
==
NULL
) ;

573 
log_da
 = 
	`g_qu_g
(
log_
);

574 if(!
	`RC_UI_IS_PLAYLIST_STORE
(
log_da
->
e
)) ;

575 
	`gtk__vw_t_mod
(
	`GTK_TREE_VIEW
(
ui_ayli_vw_
),

576 
	`GTK_TREE_MODEL
(
log_da
->
e
));

577 
	}
}

579 
	$rc_ui_livw_ayli_row_aived
(
GtkTeVw
 *
widg
,

580 
GtkTePh
 *
th
, 
GtkTeVwCumn
 *
cumn
, 
gpor
 
da
)

582 
GtkTeIr
 

;

583 
GtkTeMod
 *
mod
;

584 
mod
 = 
	`gtk__vw_g_mod
(
widg
);

585 if(
mod
==
NULL
) ;

586 if(!
	`gtk__mod_g_
(
mod
, &

, 
th
)) ;

587 
	`rib_ay_ay_db
((
GSequIr
 *)

.
ur_da
);

588 
	}
}

590 
	$rc_ui_livw_log_row_eded
(
GtkClRdText
 *
nd
,

591 
gch
 *
th_r
, gch *
w_xt
, 
gpor
 
da
)

593 
GtkTeIr
 

 = {0};

594 if(
w_xt
==
NULL
 || 
	`
(new_text)<=0) ;

595 if(!
	`gtk__mod_g__om_rg
(

596 
	`rc_ui_li_mod_g_log_e
(), &

, 
th_r
))

598 if(

.
ur_da
==
NULL
) ;

599 
	`rib_db_log_t_me
((
GSequIr
 *)

.
ur_da
, 
w_xt
);

600 
	}
}

602 
	$rc_ui_livw_log_me__da_func
(

603 
GtkTeVwCumn
 *
cumn
, 
GtkClRd
 *
nd
,

604 
GtkTeMod
 *
mod
, 
GtkTeIr
 *

, 
gpor
 
da
)

606 
gboޗn
 
ag
;

607 
	`gtk__mod_g
(
mod
, 

, 
RC_UI_CATALOG_COLUMN_PLAYING_FLAG
,

608 &
ag
, -1);

609 if(
ag
)

610 
	`g_obje_t
(
	`G_OBJECT
(
nd
), "weight", 
PANGO_WEIGHT_BOLD
, 
NULL
);

612 
	`g_obje_t
(
	`G_OBJECT
(
nd
), "weight", 
PANGO_WEIGHT_NORMAL
, 
NULL
);

613 
	}
}

615 
	$rc_ui_livw_ayli_xt__da_func
(

616 
GtkTeVwCumn
 *
cumn
, 
GtkClRd
 *
nd
,

617 
GtkTeMod
 *
mod
, 
GtkTeIr
 *

, 
gpor
 
da
)

619 
gboޗn
 
ag
;

620 
	`gtk__mod_g
(
mod
, 

, 
RC_UI_PLAYLIST_COLUMN_PLAYING_FLAG
,

621 &
ag
, -1);

622 if(
ag
)

623 
	`g_obje_t
(
	`G_OBJECT
(
nd
), "weight", 
PANGO_WEIGHT_BOLD
, 
NULL
);

625 
	`g_obje_t
(
	`G_OBJECT
(
nd
), "weight", 
PANGO_WEIGHT_NORMAL
, 
NULL
);

626 
	}
}

628 
	$rc_ui_livw_log_de_cb
(
RCLibDb
 *
db
,

629 
GSequIr
 *

, 
gpor
 
da
)

631 
GtkTeMod
 *
mod
;

632 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
ui_ayli_vw_
));

633 if(
mod
==
NULL
) ;

634 if(

==
	`rc_ui_li_mod_g_log_by_mod
(
mod
))

636 
	`gtk__vw_t_mod
(
	`GTK_TREE_VIEW
(
ui_ayli_vw_
),

637 
NULL
);

639 
	}
}

641 
gboޗn
 
	$rc_ui_livw_log_ch_comris_func
(

642 
GtkTeMod
 *
mod
, 
gt
 
cumn
, cڡ 
gch
 *
key
, 
GtkTeIr
 *

,

643 
gpor
 
ch_da
)

645 
gch
 *
me
 = 
NULL
;

646 
gch
 *
me_down
, *
key_down
;

647 
gboޗn
 
ag
;

648 
	`gtk__mod_g
(
mod
, 

, 
RC_UI_CATALOG_COLUMN_NAME
, &
me
, -1);

649 if(
me
==
NULL
 
TRUE
;

650 
me_down
 = 
	`g_utf8_rdown
(
me
, -1);

651 
key_down
 = 
	`g_utf8_rdown
(
key
, -1);

652 
	`g_
(
me
);

653 if(
	`g_rr_n
(
me_down
, -1, 
key_down
)!=
NULL
)

654 
ag
 = 
FALSE
;

656 
ag
 = 
TRUE
;

657 
	`g_
(
me_down
);

658 
	`g_
(
key_down
);

659  
ag
;

660 
	}
}

662 
gboޗn
 
	$rc_ui_livw_ayli_ch_comris_func
(

663 
GtkTeMod
 *
mod
, 
gt
 
cumn
, cڡ 
gch
 *
key
, 
GtkTeIr
 *

,

664 
gpor
 
ch_da
)

666 
gch
 *
me
 = 
NULL
;

667 
gch
 *
me_down
, *
key_down
;

668 
gboޗn
 
ag
;

669 
	`gtk__mod_g
(
mod
, 

, 
RC_UI_PLAYLIST_COLUMN_FTITLE
, &
me
, -1);

670 if(
me
==
NULL
 
TRUE
;

671 
me_down
 = 
	`g_utf8_rdown
(
me
, -1);

672 
key_down
 = 
	`g_utf8_rdown
(
key
, -1);

673 
	`g_
(
me
);

674 if(
	`g_rr_n
(
me_down
, -1, 
key_down
)!=
NULL
)

675 
ag
 = 
FALSE
;

677 
ag
 = 
TRUE
;

678 
	`g_
(
me_down
);

679 
	`g_
(
key_down
);

680  
ag
;

681 
	}
}

683 
	$rc_ui_ayli_vw_d_cb
(
RCUiClRdRg
 *
nd
,

684 cڡ *
th
, 
gt
 
tg
, 
gpor
 
da
)

686 
GtkTeMod
 *
mod
;

687 
GtkTeIr
 

 = {0};

688 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(

689 
ui_ayli_vw_
));

690 if(
mod
==
NULL
) ;

691 if(!
	`gtk__mod_g__om_rg
(
mod
, &

, 
th
))

693 
	`rib_db_ayli_t_tg
((
GSequIr
 *)

.
ur_da
, 
tg
);

694 
	}
}

696 
	$rc_ui_log_vw_fize
(
GObje
 *
obje
)

698 
RCUiCogVwPrive
 *
iv
 = 
NULL
;

699 
iv
 = 
	`RC_UI_CATALOG_VIEW
(
obje
)->priv;

700 if(
iv
->
log_de_id
>0)

701 
	`rib_db_sigl_disc
(
iv
->
log_de_id
);

702 
	`G_OBJECT_CLASS
(
rc_ui_log_vw__ass
)->
	`fize
(
obje
);

703 
	}
}

705 
	$rc_ui_ayli_vw_fize
(
GObje
 *
obje
)

707 
	`G_OBJECT_CLASS
(
rc_ui_ayli_vw__ass
)->
	`fize
(
obje
);

708 
	}
}

710 
GObje
 *
	$rc_ui_log_vw_cڡru
(
GTy
 
ty
,

711 
gut
 
n_cڡru_ms
, 
GObjeCڡruPam
 *
cڡru_ms
)

713 
GObje
 *
tv
;

714 if(
ui_log_vw_
!=
NULL
)  ui_catalog_view_instance;

715 
tv
 = 
	`G_OBJECT_CLASS
(
rc_ui_log_vw__ass
)->
	`cڡru
(

716 
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

717 
ui_log_vw_
 = 
tv
;

718 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
ui_log_vw_
);

719  
tv
;

720 
	}
}

722 
GObje
 *
	$rc_ui_ayli_vw_cڡru
(
GTy
 
ty
,

723 
gut
 
n_cڡru_ms
, 
GObjeCڡruPam
 *
cڡru_ms
)

725 
GObje
 *
tv
;

726 if(
ui_ayli_vw_
!=
NULL
)  ui_playlist_view_instance;

727 
tv
 = 
	`G_OBJECT_CLASS
(
rc_ui_ayli_vw__ass
)->
	`cڡru
(

728 
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

729 
ui_ayli_vw_
 = 
tv
;

730 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
ui_ayli_vw_
);

731  
tv
;

732 
	}
}

734 
	$rc_ui_log_vw_ass_
(
RCUiCogVwCss
 *
kss
)

736 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

737 
rc_ui_log_vw__ass
 = 
	`g_ty_ass_ek_
(
kss
);

738 
obje_ass
->
fize
 = 
rc_ui_log_vw_fize
;

739 
obje_ass
->
cڡru
 = 
rc_ui_log_vw_cڡru
;

740 
	`g_ty_ass_add_ive
(
kss
, (
RCUiCogVwPrive
));

741 
	}
}

743 
	$rc_ui_ayli_vw_ass_
(
RCUiPyliVwCss
 *
kss
)

745 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

746 
rc_ui_ayli_vw__ass
 = 
	`g_ty_ass_ek_
(
kss
);

747 
obje_ass
->
fize
 = 
rc_ui_ayli_vw_fize
;

748 
obje_ass
->
cڡru
 = 
rc_ui_ayli_vw_cڡru
;

749 
	`g_ty_ass_add_ive
(
kss
, (
RCUiPyliVwPrive
));

750 
	}
}

752 
	$rc_ui_log_vw__
(
RCUiCogVw
 *
vw
)

754 
RCUiCogVwPrive
 *
iv
 = 
NULL
;

755 
GtkTeSei
 *
i
;

756 
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
vw
, 
RC_UI_TYPE_CATALOG_VIEW
,

757 
RCUiCogVwPrive
);

758 
vw
->
iv
 =riv;

759 
	`g_obje_t
(
vw
, "name", "RC2CatalogListView", "headers-visible",

760 
FALSE
, "dab", FALSE, "rus-ht", 
TRUE
, "enable-search",

761 
TRUE
, 
NULL
);

762 
iv
->
e_nd
 = 
	`gtk__nd_pixbuf_w
();

763 
iv
->
me_nd
 = 
	`gtk__nd_xt_w
();

764 
	`gtk__nd_t_fixed_size
(
iv
->
e_nd
, 16, -1);

765 
	`gtk__nd_t_fixed_size
(
iv
->
me_nd
, 80, -1);

766 
	`g_obje_t
(
iv
->
me_nd
, "lsize", 
PANGO_ELLIPSIZE_END
,

767 "lsize-t", 
TRUE
, "weight", 
PANGO_WEIGHT_NORMAL
, "weight-set",

768 
TRUE
, 
NULL
);

769 
iv
->
e_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
("#",

770 
iv
->
e_nd
, "ock-id", 
RC_UI_CATALOG_COLUMN_STATE
, 
NULL
);

771 
iv
->
me_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(
	`_
("Name"),

772 
iv
->
me_nd
, "xt", 
RC_UI_CATALOG_COLUMN_NAME
, 
NULL
);

773 
	`gtk__vw_cumn_t__da_func
(
iv
->
me_cumn
,

774 
iv
->
me_nd
,

775 
rc_ui_livw_log_me__da_func
, 
NULL
, NULL);

776 
	`g_obje_t
(
iv
->
e_cumn
, "sizg", 
GTK_TREE_VIEW_COLUMN_FIXED
,

777 "fixed-width", 30, "m-width", 30, "max-width", 30, 
NULL
);

778 
	`g_obje_t
(
iv
->
me_cumn
, "exnd", 
TRUE
, 
NULL
);

779 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
e_cumn
);

780 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
me_cumn
);

781 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(
vw
));

782 
	`gtk__i_t_mode
(
i
, 
GTK_SELECTION_MULTIPLE
);

783 
	`gtk__vw_cumns_autosize
(
	`GTK_TREE_VIEW
(
vw
));

784 
	`gtk__vw_t_ch_equ_func
(
	`GTK_TREE_VIEW
(
vw
),

785 
rc_ui_livw_log_ch_comris_func
, 
NULL
, NULL);

786 
	`rc_ui_livw_log_t_dg
(
	`GTK_WIDGET
(
vw
));

787 
	`g_sigl_c
(
iv
->
me_nd
, "edited",

788 
	`G_CALLBACK
(
rc_ui_livw_log_row_eded
), 
NULL
);

789 
	`g_sigl_c
(
vw
, "drag-motion",

790 
	`G_CALLBACK
(
rc_ui_livw_dnd_mi
), 
NULL
);

791 
	`g_sigl_c
(
vw
, "drag-data-get",

792 
	`G_CALLBACK
(
rc_ui_livw_dnd_da_g
), 
NULL
);

793 
	`g_sigl_c
(
vw
, "drag-data-delete",

794 
	`G_CALLBACK
(
rc_ui_livw_dnd_de
), 
NULL
);

795 
	`g_sigl_c
(
vw
, "drag-data-received",

796 
	`G_CALLBACK
(
rc_ui_livw_log_dnd_da_ived
), 
NULL
);

797 
	`g_sigl_c
(
vw
, "button-press-event",

798 
	`G_CALLBACK
(
rc_ui_livw_bu_esd_evt
), 
NULL
);

799 
	`g_sigl_c
(
vw
, "button-release-event",

800 
	`G_CALLBACK
(
rc_ui_livw_log_bu_a_evt
), 
NULL
);

801 
	`g_sigl_c
(
vw
, "cursor-changed",

802 
	`G_CALLBACK
(
rc_ui_livw_log_row_ed
), 
NULL
);

803 
iv
->
log_de_id
 = 
	`rib_db_sigl_c
("catalog-delete",

804 
	`G_CALLBACK
(
rc_ui_livw_log_de_cb
), 
NULL
);

805 
	}
}

807 
	$rc_ui_ayli_vw__
(
RCUiPyliVw
 *
vw
)

809 
RCUiPyliVwPrive
 *
iv
 = 
NULL
;

810 
GtkTeSei
 *
i
;

811 
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
vw
, 
RC_UI_TYPE_PLAYLIST_VIEW
,

812 
RCUiPyliVwPrive
);

813 
vw
->
iv
 =riv;

814 
	`g_obje_t
(
vw
, "name", "RC2PlaylistListView", "headers-visible",

815 
FALSE
, "dab", FALSE, "rus-ht", 
TRUE
, "enable-search",

816 
TRUE
, 
NULL
);

817 
iv
->
e_nd
 = 
	`gtk__nd_pixbuf_w
();

818 
iv
->
t_nd
 = 
	`gtk__nd_xt_w
();

819 
iv
->
ti_nd
 = 
	`gtk__nd_xt_w
();

820 
iv
->
bum_nd
 = 
	`gtk__nd_xt_w
();

821 
iv
->
acknum_nd
 = 
	`gtk__nd_xt_w
();

822 
iv
->
yr_nd
 = 
	`gtk__nd_xt_w
();

823 
iv
->
y_nd
 = 
	`gtk__nd_xt_w
();

824 
iv
->
ngth_nd
 = 
	`gtk__nd_xt_w
();

825 
iv
->
tg_nd
 = 
	`rc_ui__nd_tg_w
();

826 
	`gtk__nd_t_fixed_size
(
iv
->
e_nd
, 16, -1);

827 
	`gtk__nd_t_fixed_size
(
iv
->
t_nd
, 120, -1);

828 
	`gtk__nd_t_fixed_size
(
iv
->
ti_nd
, 60, -1);

829 
	`gtk__nd_t_fixed_size
(
iv
->
bum_nd
, 60, -1);

830 
	`gtk__nd_t_fixed_size
(
iv
->
acknum_nd
,

832 
	`gtk__nd_t_fixed_size
(
iv
->
yr_nd
, 50, -1);

833 
	`gtk__nd_t_fixed_size
(
iv
->
y_nd
, 60, -1);

834 
	`gtk__nd_t_fixed_size
(
iv
->
ngth_nd
, 55, -1);

835 
	`g_obje_t
(
iv
->
t_nd
, "ellipsize",

836 
PANGO_ELLIPSIZE_END
, "lsize-t", 
TRUE
, "weight",

837 
PANGO_WEIGHT_NORMAL
, "weight-t", 
TRUE
, 
NULL
);

838 
	`g_obje_t
(
iv
->
ti_nd
, "ellipsize",

839 
PANGO_ELLIPSIZE_END
, "lsize-t", 
TRUE
, "weight",

840 
PANGO_WEIGHT_NORMAL
, "weight-t", 
TRUE
, 
NULL
);

841 
	`g_obje_t
(
iv
->
bum_nd
, "ellipsize",

842 
PANGO_ELLIPSIZE_END
, "lsize-t", 
TRUE
, "weight",

843 
PANGO_WEIGHT_NORMAL
, "weight-t", 
TRUE
, 
NULL
);

844 
	`g_obje_t
(
iv
->
acknum_nd
, "ellipsize",

845 
PANGO_ELLIPSIZE_END
, "lsize-t", 
TRUE
, "weight",

846 
PANGO_WEIGHT_NORMAL
, "weight-t", 
TRUE
, 
NULL
);

847 
	`g_obje_t
(
iv
->
yr_nd
, "ellipsize",

848 
PANGO_ELLIPSIZE_END
, "lsize-t", 
TRUE
, "weight",

849 
PANGO_WEIGHT_NORMAL
, "weight-t", 
TRUE
, 
NULL
);

850 
	`g_obje_t
(
iv
->
y_nd
, "ellipsize",

851 
PANGO_ELLIPSIZE_END
, "lsize-t", 
TRUE
, "weight",

852 
PANGO_WEIGHT_NORMAL
, "weight-t", 
TRUE
, 
NULL
);

853 
	`g_obje_t
(
iv
->
ngth_nd
, "xalign", 1.0,

854 "width-chs", 6, 
NULL
);

855 
iv
->
e_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

856 "#", 
iv
->
e_nd
, "stock-id",

857 
RC_UI_PLAYLIST_COLUMN_STATE
, 
NULL
);

858 
iv
->
t_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

859 
	`_
("T"), 
iv
->
t_nd
, "text",

860 
RC_UI_PLAYLIST_COLUMN_FTITLE
, 
NULL
);

861 
iv
->
ti_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

862 
	`_
("Ai"), 
iv
->
ti_nd
, "text",

863 
RC_UI_PLAYLIST_COLUMN_ARTIST
, 
NULL
);

864 
iv
->
bum_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

865 
	`_
("Album"), 
iv
->
ti_nd
, "text",

866 
RC_UI_PLAYLIST_COLUMN_ALBUM
, 
NULL
);

867 
iv
->
acknum_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

868 
	`_
("Tck"), 
iv
->
acknum_nd
, "text",

869 
RC_UI_PLAYLIST_COLUMN_TRACK
, 
NULL
);

870 
iv
->
yr_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

871 
	`_
("Yr"), 
iv
->
yr_nd
, "text",

872 
RC_UI_PLAYLIST_COLUMN_YEAR
, 
NULL
);

873 
iv
->
y_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

874 
	`_
("Fm"), 
iv
->
y_nd
, "text",

875 
RC_UI_PLAYLIST_COLUMN_FTYPE
, 
NULL
);

876 
iv
->
ngth_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

877 
	`_
("Lgth"), 
iv
->
ngth_nd
, "text",

878 
RC_UI_PLAYLIST_COLUMN_LENGTH
, 
NULL
);

879 
iv
->
tg_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

880 
	`_
("Rg"), 
iv
->
tg_nd
, "rating",

881 
RC_UI_PLAYLIST_COLUMN_RATING
, 
NULL
);

882 
	`gtk__vw_cumn_t__da_func
(
iv
->
t_cumn
,

883 
iv
->
t_nd
, 
rc_ui_livw_ayli_xt__da_func
,

884 
NULL
, NULL);

885 
	`gtk__vw_cumn_t__da_func
(
iv
->
ti_cumn
,

886 
iv
->
ti_nd
, 
rc_ui_livw_ayli_xt__da_func
,

887 
NULL
, NULL);

888 
	`gtk__vw_cumn_t__da_func
(
iv
->
bum_cumn
,

889 
iv
->
bum_nd
, 
rc_ui_livw_ayli_xt__da_func
,

890 
NULL
, NULL);

891 
	`gtk__vw_cumn_t__da_func
(
iv
->
acknum_cumn
,

892 
iv
->
acknum_nd
, 
rc_ui_livw_ayli_xt__da_func
,

893 
NULL
, NULL);

894 
	`gtk__vw_cumn_t__da_func
(
iv
->
yr_cumn
,

895 
iv
->
yr_nd
, 
rc_ui_livw_ayli_xt__da_func
,

896 
NULL
, NULL);

897 
	`gtk__vw_cumn_t__da_func
(
iv
->
y_cumn
,

898 
iv
->
y_nd
, 
rc_ui_livw_ayli_xt__da_func
,

899 
NULL
, NULL);

900 
	`gtk__vw_cumn_t__da_func
(
iv
->
ngth_cumn
,

901 
iv
->
ngth_nd
, 
rc_ui_livw_ayli_xt__da_func
,

902 
NULL
, NULL);

903 
	`g_obje_t
(
iv
->
e_cumn
, "sizing",

904 
GTK_TREE_VIEW_COLUMN_FIXED
, "fixed-width", 30, "min-width", 30,

905 "max-width", 30, 
NULL
);

906 
	`g_obje_t
(
iv
->
t_cumn
, "exnd", 
TRUE
, 
NULL
);

907 
	`g_obje_t
(
iv
->
ti_cumn
, "exnd", 
TRUE
, "visible",

908 
FALSE
, "sizab", 
TRUE
, 
NULL
);

909 
	`g_obje_t
(
iv
->
bum_cumn
, "exnd", 
TRUE
, "visible",

910 
FALSE
, "sizab", 
TRUE
, 
NULL
);

911 
	`g_obje_t
(
iv
->
acknum_cumn
, "exnd", 
TRUE
, "visible",

912 
FALSE
, "sizab", 
TRUE
, 
NULL
);

913 
	`g_obje_t
(
iv
->
yr_cumn
, "exnd", 
TRUE
, "visible",

914 
FALSE
, "sizab", 
TRUE
, 
NULL
);

915 
	`g_obje_t
(
iv
->
y_cumn
, "exnd", 
TRUE
, "visible",

916 
FALSE
, "sizab", 
TRUE
, 
NULL
);

917 
	`g_obje_t
(
iv
->
ngth_cumn
, "sizing",

918 
GTK_TREE_VIEW_COLUMN_FIXED
, "fixed-width", 55, "alignment",

919 1.0, 
NULL
);

920 
	`g_obje_t
(
iv
->
tg_cumn
, "sizing",

921 
GTK_TREE_VIEW_COLUMN_FIXED
, "fixed-width", 80, "alignment",

922 1.0, "visib", 
FALSE
, 
NULL
);

923 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
e_cumn
);

924 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
t_cumn
);

925 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
ti_cumn
);

926 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
bum_cumn
);

927 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
acknum_cumn
);

928 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
yr_cumn
);

929 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
y_cumn
);

930 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
ngth_cumn
);

931 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
vw
), 
iv
->
tg_cumn
);

932 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(
vw
));

933 
	`gtk__i_t_mode
(
i
, 
GTK_SELECTION_MULTIPLE
);

934 
	`gtk__vw_cumns_autosize
(
	`GTK_TREE_VIEW
(
vw
));

935 
	`gtk__vw_t_ch_equ_func
(
	`GTK_TREE_VIEW
(
vw
),

936 
rc_ui_livw_ayli_ch_comris_func
, 
NULL
, NULL);

937 
	`rc_ui_livw_ayli_t_dg
(
	`GTK_WIDGET
(
vw
));

938 
	`g_sigl_c
(
vw
, "drag-motion",

939 
	`G_CALLBACK
(
rc_ui_livw_dnd_mi
), 
NULL
);

940 
	`g_sigl_c
(
vw
, "drag-data-get",

941 
	`G_CALLBACK
(
rc_ui_livw_dnd_da_g
), 
NULL
);

942 
	`g_sigl_c
(
vw
, "drag-data-delete",

943 
	`G_CALLBACK
(
rc_ui_livw_dnd_de
), 
NULL
);

944 
	`g_sigl_c
(
vw
, "drag-data-received",

945 
	`G_CALLBACK
(
rc_ui_livw_ayli_dnd_da_ived
), 
NULL
);

946 
	`g_sigl_c
(
vw
, "button-press-event",

947 
	`G_CALLBACK
(
rc_ui_livw_bu_esd_evt
), 
NULL
);

948 
	`g_sigl_c
(
vw
, "button-release-event",

949 
	`G_CALLBACK
(
rc_ui_livw_ayli_bu_a_evt
), 
NULL
);

950 
	`g_sigl_c
(
vw
, "row-activated",

951 
	`G_CALLBACK
(
rc_ui_livw_ayli_row_aived
), 
NULL
);

952 
	`g_sigl_c
(
iv
->
tg_nd
, "rated",

953 
	`G_CALLBACK
(
rc_ui_ayli_vw_d_cb
), 
iv
);

954 
	}
}

956 
GTy
 
	$rc_ui_log_vw_g_ty
()

958 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

959 
GTy
 
g_defe_ty_id
;

960 cڡ 
GTyInfo
 
vw_fo
 = {

961 .
ass_size
 = (
RCUiCogVwCss
),

962 .
ba_
 = 
NULL
,

963 .
ba_fize
 = 
NULL
,

964 .
ass_
 = (
GCssInFunc
)
rc_ui_log_vw_ass_
,

965 .
ass_fize
 = 
NULL
,

966 .
ass_da
 = 
NULL
,

967 .
_size
 = (
RCUiCogVw
),

968 .
n_ocs
 = 0,

969 .
_
 = (
GInInFunc
)
rc_ui_log_vw__


971 if(
	`g___r
(&
g_defe_ty_id__vީe
))

973 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
GTK_TYPE_TREE_VIEW
,

974 
	`g__ic_rg
("RCUiCogVw"), &
vw_fo
, 0);

975 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

977  
g_defe_ty_id__vީe
;

978 
	}
}

980 
GTy
 
	$rc_ui_ayli_vw_g_ty
()

982 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

983 
GTy
 
g_defe_ty_id
;

984 cڡ 
GTyInfo
 
vw_fo
 = {

985 .
ass_size
 = (
RCUiPyliVwCss
),

986 .
ba_
 = 
NULL
,

987 .
ba_fize
 = 
NULL
,

988 .
ass_
 = (
GCssInFunc
)
rc_ui_ayli_vw_ass_
,

989 .
ass_fize
 = 
NULL
,

990 .
ass_da
 = 
NULL
,

991 .
_size
 = (
RCUiPyliVw
),

992 .
n_ocs
 = 0,

993 .
_
 = (
GInInFunc
)
rc_ui_ayli_vw__


995 if(
	`g___r
(&
g_defe_ty_id__vީe
))

997 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
GTK_TYPE_TREE_VIEW
,

998 
	`g__ic_rg
("RCUiPyliVw"), &
vw_fo
, 0);

999 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

1001  
g_defe_ty_id__vީe
;

1002 
	}
}

1004 
	$rc_ui_livw_
()

1006 
GtkTeMod
 *
log_mod
;

1007 
GtkTeMod
 *
ayli_mod
;

1008 
GtkTeSei
 *
log_i
;

1009 
GtkTeSei
 *
ayli_i
;

1010 
GtkTeIr
 
log_
, 
ayli_
;

1011 
ui_log_vw_
 = 
	`g_obje_w
(
RC_UI_TYPE_CATALOG_VIEW
, 
NULL
);

1012 
ui_ayli_vw_
 = 
	`g_obje_w
(
RC_UI_TYPE_PLAYLIST_VIEW
, 
NULL
);

1013 
log_i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

1014 
ui_log_vw_
));

1015 
log_mod
 = 
	`rc_ui_li_mod_g_log_e
();

1016 if(
log_mod
!=
NULL
)

1018 
	`gtk__vw_t_mod
(
	`GTK_TREE_VIEW
(
ui_log_vw_
),

1019 
log_mod
);

1020 if(
	`gtk__mod_g__f
(
log_mod
, &
log_
))

1022 
ayli_mod
 = 
	`rc_ui_li_mod_g_ayli_e
(

1023 &
log_
);

1024 
	`gtk__i__
(
log_i
, &
log_
);

1025 if(
ayli_mod
!=
NULL
)

1027 
	`gtk__vw_t_mod
(
	`GTK_TREE_VIEW
(

1028 
ui_ayli_vw_
), 
ayli_mod
);

1029 
ayli_i
 = 
	`gtk__vw_g_i
(

1030 
	`GTK_TREE_VIEW
(
ui_ayli_vw_
));

1031 if(
	`gtk__mod_g__f
(
ayli_mod
,

1032 &
ayli_
))

1034 
	`gtk__i__
(
ayli_i
,

1035 &
ayli_
);

1040 
	}
}

1051 
GtkWidg
 *
	$rc_ui_livw_g_log_widg
()

1053 if(
ui_log_vw_
==
NULL
)

1054 
	`rc_ui_livw_
();

1055  
	`GTK_WIDGET
(
ui_log_vw_
);

1056 
	}
}

1067 
GtkWidg
 *
	$rc_ui_livw_g_ayli_widg
()

1069 if(
ui_ayli_vw_
==
NULL
)

1070 
	`rc_ui_livw_
();

1071  
	`GTK_WIDGET
(
ui_ayli_vw_
);

1072 
	}
}

1081 
	$rc_ui_livw_log_t_ngo_ibus
(cڡ 
PgoArLi
 *
li
)

1083 
RCUiCogVwPrive
 *
iv
 = 
NULL
;

1084 if(
ui_log_vw_
==
NULL
) ;

1085 
iv
 = 
	`RC_UI_CATALOG_VIEW
(
ui_log_vw_
)->priv;

1086 if(
iv
==
NULL
) ;

1087 
	`g_obje_t
(
iv
->
me_nd
, "ibus", 
li
, 
NULL
);

1088 
	}
}

1097 
	$rc_ui_livw_ayli_t_ngo_ibus
(cڡ 
PgoArLi
 *
li
)

1099 
RCUiPyliVwPrive
 *
iv
 = 
NULL
;

1100 if(
ui_ayli_vw_
==
NULL
) ;

1101 
iv
 = 
	`RC_UI_PLAYLIST_VIEW
(
ui_ayli_vw_
)->priv;

1102 if(
iv
==
NULL
) ;

1103 
	`g_obje_t
(
iv
->
t_nd
, "ibus", 
li
, 
NULL
);

1104 
	`g_obje_t
(
iv
->
ti_nd
, "ibus", 
li
, 
NULL
);

1105 
	`g_obje_t
(
iv
->
bum_nd
, "ibus", 
li
, 
NULL
);

1106 
	`g_obje_t
(
iv
->
acknum_nd
, "ibus", 
li
, 
NULL
);

1107 
	`g_obje_t
(
iv
->
yr_nd
, "ibus", 
li
, 
NULL
);

1108 
	`g_obje_t
(
iv
->
y_nd
, "ibus", 
li
, 
NULL
);

1109 
	`g_obje_t
(
iv
->
ngth_nd
, "ibus", 
li
, 
NULL
);

1110 
	}
}

1119 
	$rc_ui_livw_log_
(
GtkTeIr
 *

)

1121 
GtkTePh
 *
th
;

1122 
GtkTeMod
 *
mod
;

1123 if(

==
NULL
 || 
ui_log_vw_
==NULL) ;

1124 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
ui_log_vw_
));

1125 if(
mod
==
NULL
) ;

1126 
th
 = 
	`gtk__mod_g_th
(
mod
, 

);

1127 if(
th
==
NULL
) ;

1128 
	`gtk__vw_t_curs
(
	`GTK_TREE_VIEW
(
ui_log_vw_
), 
th
,

1129 
NULL
, 
FALSE
);

1130 
	`gtk__th_
(
th
);

1131 
	}
}

1140 
	$rc_ui_livw_ayli_
(
GtkTeIr
 *

)

1142 
GtkTePh
 *
th
;

1143 
GtkTeMod
 *
mod
;

1144 if(

==
NULL
 || 
ui_ayli_vw_
==NULL);

1145 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(

1146 
ui_ayli_vw_
));

1147 if(
mod
==
NULL
) ;

1148 
th
 = 
	`gtk__mod_g_th
(
mod
, 

);

1149 if(
th
==
NULL
) ;

1150 
	`gtk__vw_t_curs
(
	`GTK_TREE_VIEW
(
ui_ayli_vw_
), 
th
,

1151 
NULL
, 
FALSE
);

1152 
	`gtk__th_
(
th
);

1153 
	}
}

1164 
gboޗn
 
	$rc_ui_livw_log_g_curs
(
GtkTeIr
 *

)

1166 
GtkTePh
 *
th
;

1167 
GtkTeMod
 *
mod
;

1168 
gboޗn
 
ag
;

1169 if(

==
NULL
 || 
ui_log_vw_
==NULL 
FALSE
;

1170 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(

1171 
ui_log_vw_
));

1172 if(
mod
==
NULL
 
FALSE
;

1173 
	`gtk__vw_g_curs
(
	`GTK_TREE_VIEW
(
ui_log_vw_
), &
th
,

1174 
NULL
);

1175 if(
th
==
NULL
 
FALSE
;

1176 
ag
 = 
	`gtk__mod_g_
(
mod
, 

, 
th
);

1177 
	`gtk__th_
(
th
);

1178  
ag
;

1179 
	}
}

1190 
gboޗn
 
	$rc_ui_livw_ayli_g_curs
(
GtkTeIr
 *

)

1192 
GtkTePh
 *
th
;

1193 
GtkTeMod
 *
mod
;

1194 
gboޗn
 
ag
;

1195 if(

==
NULL
 || 
ui_ayli_vw_
==NULL 
FALSE
;

1196 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(

1197 
ui_ayli_vw_
));

1198 if(
mod
==
NULL
 
FALSE
;

1199 
	`gtk__vw_g_curs
(
	`GTK_TREE_VIEW
(
ui_ayli_vw_
),

1200 &
th
, 
NULL
);

1201 if(
th
==
NULL
 
FALSE
;

1202 
ag
 = 
	`gtk__mod_g_
(
mod
, 

, 
th
);

1203 
	`gtk__th_
(
th
);

1204  
ag
;

1205 
	}
}

1215 
GtkTeMod
 *
	$rc_ui_livw_log_g_mod
()

1217 if(
ui_log_vw_
==
NULL
)  NULL;

1218  
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
ui_log_vw_
));

1219 
	}
}

1230 
GtkTeMod
 *
	$rc_ui_livw_ayli_g_mod
()

1232 if(
ui_ayli_vw_
==
NULL
)  NULL;

1233  
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
ui_ayli_vw_
));

1234 
	}
}

1242 
	$rc_ui_livw_log_w_ayli
()

1244 
gut
 
i
 = 1;

1245 
GtkTeMod
 *
mod
;

1246 
GtkTeIr
 

, 
w_
;

1247 
GSequIr
 *
log_
;

1248 
gch
 *
w_me
;

1249 if(
ui_log_vw_
==
NULL
) ;

1250 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
ui_log_vw_
));

1251 if(
mod
==
NULL
) ;

1252 
w_me
 = 
	`g_rdup_tf
(
	`_
("Pyli %u"), 
i
);

1253 
i
++;

1254 if(!
	`rc_ui_livw_log_g_curs
(&

))

1256 

.
ur_da
 = 
NULL
;

1258 
log_
 = 
	`rib_db_log_add
(
w_me
, (
GSequIr
 *)

1259 

.
ur_da
, 
RCLIB_DB_CATALOG_TYPE_PLAYLIST
);

1260 
	`g_
(
w_me
);

1261 
	`gtk__mod_g__f
(
mod
, &

);

1262 
w_
.
amp
 = 

.stamp;

1263 
w_
.
ur_da
 = 
log_
;

1264 
	`rc_ui_livw_log_
(&
w_
);

1265 
	`rc_ui_livw_log_me_ayli
();

1266 
	}
}

1274 
	$rc_ui_livw_log_me_ayli
()

1276 
RCUiCogVwPrive
 *
iv
 = 
NULL
;

1277 
GtkTeMod
 *
mod
;

1278 
GtkTeIr
 

;

1279 
GtkTePh
 *
th
;

1280 if(
ui_log_vw_
==
NULL
) ;

1281 
iv
 = 
	`RC_UI_CATALOG_VIEW
(
ui_log_vw_
)->priv;

1282 if(
iv
==
NULL
) ;

1283 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
ui_log_vw_
));

1284 if(
mod
==
NULL
) ;

1285 if(!
	`rc_ui_livw_log_g_curs
(&

)) ;

1286 
th
 = 
	`gtk__mod_g_th
(
mod
, &

);

1287 if(
th
==
NULL
) ;

1288 
	`g_obje_t
(
iv
->
me_nd
, "edab", 
TRUE
, "editable-set",

1289 
TRUE
, 
NULL
);

1290 
	`gtk__vw_t_curs
(
	`GTK_TREE_VIEW
(
ui_log_vw_
), 
th
,

1291 
iv
->
me_cumn
, 
TRUE
);

1292 
	`g_obje_t
(
iv
->
me_nd
, "edab", 
FALSE
, "editable-set",

1293 
FALSE
, 
NULL
);

1294 
	`gtk__th_
(
th
);

1295 
	}
}

1303 
	$rc_ui_livw_log_de_ems
()

1305 
GtkTeSei
 *
i
;

1306 
GLi
 *
th_li
 = 
NULL
;

1307 
GLi
 *
li_fܗch
;

1308 
GtkTeIr
 

;

1309 
GtkTeMod
 *
mod
;

1310 if(
ui_log_vw_
==
NULL
) ;

1311 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
ui_log_vw_
));

1312 if(
mod
==
NULL
) ;

1313 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

1314 
ui_log_vw_
));

1315 if(
i
==
NULL
) ;

1316 
th_li
 = 
	`gtk__i_g_ed_rows
(
i
, 
NULL
);

1317 if(
th_li
==
NULL
) ;

1318 
th_li
 = 
	`g_li_st
թh_li, (
GComFunc
)
gtk__th_com
);

1319 
li_fܗch
=
	`g_li_ϡ
(
th_li
);li_fܗch!=
NULL
;

1320 
li_fܗch
=
	`g_li_evious
(list_foreach))

1322 if(!
	`gtk__mod_g_
(
mod
, &

, 
li_fܗch
->
da
))

1324 if(

.
ur_da
==
NULL
) ;

1325 
	`rib_db_log_de
((
GSequIr
 *)

.
ur_da
);

1327 
	`g_li_fܗch
(
th_li
, (
GFunc
)
gtk__th_
, 
NULL
);

1328 
	`g_li_
(
th_li
);

1329 
	}
}

1337 
	$rc_ui_livw_ayli__l
()

1339 
GtkTeSei
 *
i
;

1340 if(
ui_ayli_vw_
==
NULL
) ;

1341 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

1342 
ui_ayli_vw_
));

1343 
	`gtk__i__l
(
i
);

1344 
	}
}

1352 
	$rc_ui_livw_ayli_de_ems
()

1354 
GtkTeSei
 *
i
;

1355 
GLi
 *
th_li
 = 
NULL
;

1356 
GLi
 *
li_fܗch
;

1357 
GtkTeIr
 

;

1358 
GtkTeMod
 *
mod
;

1359 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(

1360 
ui_ayli_vw_
));

1361 if(
mod
==
NULL
) ;

1362 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

1363 
ui_ayli_vw_
));

1364 if(
i
==
NULL
) ;

1365 
th_li
 = 
	`gtk__i_g_ed_rows
(
i
, 
NULL
);

1366 if(
th_li
==
NULL
) ;

1367 
th_li
 = 
	`g_li_st
թh_li, (
GComFunc
)
gtk__th_com
);

1368 
li_fܗch
=
	`g_li_ϡ
(
th_li
);li_fܗch!=
NULL
;

1369 
li_fܗch
=
	`g_li_evious
(list_foreach))

1371 if(!
	`gtk__mod_g_
(
mod
, &

, 
li_fܗch
->
da
))

1373 if(

.
ur_da
==
NULL
) ;

1374 
	`rib_db_ayli_de
((
GSequIr
 *)

.
ur_da
);

1376 
	`g_li_fܗch
(
th_li
, (
GFunc
)
gtk__th_
, 
NULL
);

1377 
	`g_li_
(
th_li
);

1378 
	}
}

1386 
	$rc_ui_livw_ayli_esh
()

1388 
GtkTeMod
 *
mod
;

1389 
GtkTeIr
 

;

1390 
mod
 = 
	`gtk__vw_g_mod
(
	`GTK_TREE_VIEW
(
ui_log_vw_
));

1391 if(
mod
==
NULL
) ;

1392 if(!
	`rc_ui_livw_log_g_curs
(&

)) ;

1393 if(

.
ur_da
==
NULL
) ;

1394 
	`rib_db_ayli_esh
((
GSequIr
 *)

.
ur_da
);

1395 
	}
}

1406 
	$rc_ui_livw_ayli_t_cumn_diy_mode
(
gboޗn
 
mode
)

1408 
RCUiPyliVwPrive
 *
iv
 = 
NULL
;

1409 if(
ui_ayli_vw_
==
NULL
) ;

1410 
iv
 = 
	`RC_UI_PLAYLIST_VIEW
(
ui_ayli_vw_
)->priv;

1411 if(
iv
==
NULL
) ;

1412 
iv
->
diy_mode
 = 
mode
;

1413 if(
mode
)

1415 
	`g_obje_t
(
ui_ayli_vw_
, "headers-visible",

1416 
TRUE
, 
NULL
);

1417 
	`rc_ui_livw_ayli_t_t_fm
("%TITLE");

1421 
	`g_obje_t
(
ui_ayli_vw_
, "headers-visible",

1422 
FALSE
, 
NULL
);

1423 
	`g_obje_t
(
iv
->
ti_cumn
, "visib", 
FALSE
, 
NULL
);

1424 
	`g_obje_t
(
iv
->
bum_cumn
, "visib", 
FALSE
, 
NULL
);

1425 
	`g_obje_t
(
iv
->
acknum_cumn
, "visib", 
FALSE
, 
NULL
);

1426 
	`g_obje_t
(
iv
->
yr_cumn
, "visib", 
FALSE
, 
NULL
);

1427 
	`g_obje_t
(
iv
->
y_cumn
, "visib", 
FALSE
, 
NULL
);

1428 
	`g_obje_t
(
iv
->
tg_cumn
, "visib", 
FALSE
, 
NULL
);

1430 
	`rc_ui_ma_wdow_ayli_sd_wdow_t_hizڏl_picy
(
mode
);

1431 
	}
}

1441 
gboޗn
 
	$rc_ui_livw_ayli_g_cumn_diy_mode
()

1443 
RCUiPyliVwPrive
 *
iv
 = 
NULL
;

1444 if(
ui_ayli_vw_
==
NULL
 
FALSE
;

1445 
iv
 = 
	`RC_UI_PLAYLIST_VIEW
(
ui_ayli_vw_
)->priv;

1446 if(
iv
==
NULL
 
FALSE
;

1447  
iv
->
diy_mode
;

1448 
	}
}

1460 
	$rc_ui_livw_ayli_t_t_fm
(cڡ 
gch
 *
fm
)

1462 if(
ui_ayli_vw_
==
NULL
) ;

1463 if(
fm
==
NULL
 || 
	`g_rr_n
(format, -1, "%TITLE")==NULL)

1464 
	`rc_ui_li_mod_t_ayli_t_fm
("%TITLE");

1466 
	`rc_ui_li_mod_t_ayli_t_fm
(
fm
);

1467 
	`gtk_widg_queue_dw
(
	`GTK_WIDGET
(
ui_ayli_vw_
));

1468 
	}
}

1480 
	$rc_ui_livw_ayli_t_abd_cumns
(
gut
 
cumn_ags
,

1481 
gut
 
ab_ags
)

1483 
RCUiPyliVwPrive
 *
iv
 = 
NULL
;

1484 if(
ui_ayli_vw_
==
NULL
) ;

1485 
iv
 = 
	`RC_UI_PLAYLIST_VIEW
(
ui_ayli_vw_
)->priv;

1486 if(
iv
==
NULL
) ;

1487 if(!
iv
->
diy_mode
) ;

1488 if(
cumn_ags
==0) ;

1489 if(
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
)

1491 
	`g_obje_t
(
iv
->
ti_cumn
, "visible",

1492 
ab_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
 ?

1493 
TRUE
: 
FALSE
, 
NULL
);

1495 if(
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
)

1497 
	`g_obje_t
(
iv
->
bum_cumn
, "visible",

1498 
ab_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
 ?

1499 
TRUE
: 
FALSE
, 
NULL
);

1501 if(
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
)

1503 
	`g_obje_t
(
iv
->
acknum_cumn
, "visible",

1504 
ab_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
 ?

1505 
TRUE
: 
FALSE
, 
NULL
);

1507 if(
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
)

1509 
	`g_obje_t
(
iv
->
yr_cumn
, "visible",

1510 
ab_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
 ?

1511 
TRUE
: 
FALSE
, 
NULL
);

1513 if(
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
)

1515 
	`g_obje_t
(
iv
->
y_cumn
, "visible",

1516 
ab_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
 ?

1517 
TRUE
: 
FALSE
, 
NULL
);

1519 if(
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
)

1521 
	`g_obje_t
(
iv
->
tg_cumn
, "visible",

1522 
ab_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
 ?

1523 
TRUE
: 
FALSE
, 
NULL
);

1525 
	}
}

1535 
gut
 
	$rc_ui_livw_ayli_g_abd_cumns
()

1537 
RCUiPyliVwPrive
 *
iv
 = 
NULL
;

1538 
gboޗn
 
e
;

1539 
gut
 
ags
 = 0;

1540 if(
ui_ayli_vw_
==
NULL
)  0;

1541 
iv
 = 
	`RC_UI_PLAYLIST_VIEW
(
ui_ayli_vw_
)->priv;

1542 if(
iv
==
NULL
)  0;

1543 
	`g_obje_g
(
ui_ayli_vw_
, "hds-visib", &
e
, 
NULL
);

1544 if(
e
)

1545 
ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
;

1546 
	`g_obje_g
(
iv
->
ti_cumn
, "visib", &
e
, 
NULL
);

1547 if(
e
)

1548 
ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
;

1549 
	`g_obje_g
(
iv
->
acknum_cumn
, "visib", &
e
, 
NULL
);

1550 if(
e
)

1551 
ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
;

1552 
	`g_obje_g
(
iv
->
yr_cumn
, "visib", &
e
, 
NULL
);

1553 if(
e
)

1554 
ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
;

1555 
	`g_obje_g
(
iv
->
y_cumn
, "visib", &
e
, 
NULL
);

1556 if(
e
)

1557 
ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
;

1558 
	`g_obje_g
(
iv
->
tg_cumn
, "visib", &
e
, 
NULL
);

1559 if(
e
)

1560 
ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
;

1561  
ags
;

1562 
	}
}

1570 
	$rc_ui_livw_esh
()

1572 if(
ui_log_vw_
!=
NULL
)

1573 
	`gtk_widg_queue_dw
(
	`GTK_WIDGET
(
ui_log_vw_
));

1574 if(
ui_ayli_vw_
!=
NULL
)

1575 
	`gtk_widg_queue_dw
(
	`GTK_WIDGET
(
ui_ayli_vw_
));

1576 
	}
}

	@ui/rc-ui-listview.h

25 #ide
HAVE_RC_UI_LISTVIEW_H


26 
	#HAVE_RC_UI_LISTVIEW_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<gtk/gtk.h
>

32 
	gG_BEGIN_DECLS


34 
	#RC_UI_TYPE_CATALOG_VIEW
 (
	`rc_ui_log_vw_g_ty
())

	)

35 
	#RC_UI_CATALOG_VIEW
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

36 
RC_UI_TYPE_CATALOG_VIEW
, 
RCUiCogVw
))

	)

37 
	#RC_UI_CATALOG_VIEW_CLASS
(
kss
(
	`G_TYPE_CHECK_CLASS_CAST
((klass), \

38 
RC_UI_TYPE_CATALOG_VIEW
, 
RCUiCogVwCss
))

	)

39 
	#RC_UI_IS_CATALOG_VIEW
(
obj
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((obj), \

40 
RC_UI_TYPE_CATALOG_VIEW
))

	)

41 
	#RC_UI_IS_CATALOG_VIEW_CLASS
(
kss
) \

42 (
	`G_TYPE_CHECK_CLASS_TYPE
((
kss
), 
RC_UI_TYPE_CATALOG_VIEW
))

	)

43 
	#RC_UI_CATALOG_VIEW_GET_CLASS
(
obj
) \

44 (
	`G_TYPE_INSTANCE_GET_CLASS
((
obj
), 
RC_UI_TYPE_CATALOG_VIEW
, \

45 
RCUiCogVw
))

	)

47 
	#RC_UI_TYPE_PLAYLIST_VIEW
 (
	`rc_ui_ayli_vw_g_ty
())

	)

48 
	#RC_UI_PLAYLIST_VIEW
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

49 
RC_UI_TYPE_PLAYLIST_VIEW
, 
RCUiPyliVw
))

	)

50 
	#RC_UI_PLAYLIST_VIEW_CLASS
(
kss
(
	`G_TYPE_CHECK_CLASS_CAST
((klass), \

51 
RC_UI_TYPE_PLAYLIST_VIEW
, 
RCUiPyliVwCss
))

	)

52 
	#RC_UI_IS_PLAYLIST_VIEW
(
obj
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((obj), \

53 
RC_UI_TYPE_PLAYLIST_VIEW
))

	)

54 
	#RC_UI_IS_PLAYLIST_VIEW_CLASS
(
kss
) \

55 (
	`G_TYPE_CHECK_CLASS_TYPE
((
kss
), 
RC_UI_TYPE_PLAYLIST_VIEW
))

	)

56 
	#RC_UI_PLAYLIST_VIEW_GET_CLASS
(
obj
) \

57 (
	`G_TYPE_INSTANCE_GET_CLASS
((
obj
), 
RC_UI_TYPE_PLAYLIST_VIEW
, \

58 
RCUiPyliVw
))

	)

73 
	mRC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
 = 1<<0,

74 
	mRC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
 = 1<<1,

75 
	mRC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
 = 1<<2,

76 
	mRC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
 = 1<<3,

77 
	mRC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
 = 1<<4,

78 
	mRC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
 = 1<<5

79 }
	tRCUiLiVwPyliCumnFgs
;

81 
_RCUiCogVw
 
	tRCUiCogVw
;

82 
_RCUiPyliVw
 
	tRCUiPyliVw
;

83 
_RCUiCogVwCss
 
	tRCUiCogVwCss
;

84 
_RCUiPyliVwCss
 
	tRCUiPyliVwCss
;

85 
_RCUiCogVwPrive
 
	tRCUiCogVwPrive
;

86 
_RCUiPyliVwPrive
 
	tRCUiPyliVwPrive
;

94 
	s_RCUiCogVw
 {

96 
GtkTeVw
 
	m
;

97 
RCUiCogVwPrive
 *
	miv
;

106 
	s_RCUiPyliVw
 {

108 
GtkTeVw
 
	m
;

109 
RCUiPyliVwPrive
 *
	miv
;

118 
	s_RCUiCogVwCss
 {

120 
GtkTeVwCss
 
	m_ass
;

129 
	s_RCUiPyliVwCss
 {

131 
GtkTeVwCss
 
	m_ass
;

135 
GTy
 
rc_ui_log_vw_g_ty
();

136 
GTy
 
rc_ui_ayli_vw_g_ty
();

139 
GtkWidg
 *
rc_ui_livw_g_log_widg
();

140 
GtkWidg
 *
rc_ui_livw_g_ayli_widg
();

141 
rc_ui_livw_log_t_ngo_ibus
(cڡ 
PgoArLi
 *
li
);

142 
rc_ui_livw_ayli_t_ngo_ibus
(cڡ 
PgoArLi
 *
li
);

143 
rc_ui_livw_log_
(
GtkTeIr
 *

);

144 
rc_ui_livw_ayli_
(
GtkTeIr
 *

);

145 
gboޗn
 
rc_ui_livw_log_g_curs
(
GtkTeIr
 *

);

146 
gboޗn
 
rc_ui_livw_ayli_g_curs
(
GtkTeIr
 *

);

147 
GtkTeMod
 *
rc_ui_livw_log_g_mod
();

148 
GtkTeMod
 *
rc_ui_livw_ayli_g_mod
();

149 
rc_ui_livw_log_w_ayli
();

150 
rc_ui_livw_log_me_ayli
();

151 
rc_ui_livw_log_de_ems
();

152 
rc_ui_livw_ayli__l
();

153 
rc_ui_livw_ayli_de_ems
();

154 
rc_ui_livw_ayli_esh
();

155 
rc_ui_livw_ayli_t_cumn_diy_mode
(
gboޗn
 
mode
);

156 
gboޗn
 
rc_ui_livw_ayli_g_cumn_diy_mode
();

157 
rc_ui_livw_ayli_t_t_fm
(cڡ 
gch
 *
fm
);

158 
rc_ui_livw_ayli_t_abd_cumns
(
gut
 
cumn_ags
,

159 
gut
 
ab_ags
);

160 
gut
 
rc_ui_livw_ayli_g_abd_cumns
();

161 
rc_ui_livw_esh
();

163 
	gG_END_DECLS


	@ui/rc-ui-menu.c

26 
	~"rc-ui-mu.h
"

27 
	~"rc-ui-ay.h
"

28 
	~"rc-ui-wdow.h
"

29 
	~"rc-ui-livw.h
"

30 
	~"rc-ui-dlog.h
"

31 
	~"rc-ui-ug.h
"

32 
	~"rc-ui-gs.h
"

33 
	~"rc-ui-ef.h
"

34 
	~"rc-ui-erum.h
"

35 
	~"rc-comm.h
"

48 
	sRCUiMuPrive


50 
GtkUIMag
 *
	mui_mag
;

51 
GtkAiGroup
 *
	mui_ais
;

52 
gulg
 
	me_chged_id
;

53 
gulg
 
	mvume_chged_id
;

54 
gulg
 
	m_mode_chged_id
;

55 
gulg
 
	mndom_mode_chged_id
;

56 }
	tRCUiMuPrive
;

58 
RCUiMuPrive
 
	gui_mu_iv
 = {0};

60 
	$rc_ui_mu_ay_bu_icked_cb
()

62 
GS
 
e
;

63 if(
	`rib_ce_g_e
(&
e
, 
NULL
, 0))

65 if(
e
==
GST_STATE_PLAYING
)

67 
	`rib_ce_u
();

70 if(
e
==
GST_STATE_PAUSED
)

72 
	`rib_ce_ay
();

76 
	`rib_ce_ay
();

78 
	}
}

80 
	$rc_ui_mu__bu_icked_cb
()

82 
	`rib_ce_
();

83 
	}
}

85 
	$rc_ui_mu_ev_bu_icked_cb
()

87 
	`rib_ay_ay_ev
(
FALSE
, 
TRUE
, FALSE);

88 
	}
}

90 
	$rc_ui_mu_xt_bu_icked_cb
()

92 
	`rib_ay_ay_xt
(
FALSE
, 
TRUE
, FALSE);

93 
	}
}

95 
	$rc_ui_mu_backwd_icked_cb
()

97 
gt64
 
time
 = 
	`rib_ce_quy_posi
();

98 
time
 -5 * 
GST_SECOND
;

99 if(
time
<0)ime = 0;

100 
	`rib_ce_t_posi
(
time
);

101 
	}
}

103 
	$rc_ui_mu_fwd_icked_cb
()

105 
gt64
 
time
 = 
	`rib_ce_quy_posi
();

106 
time
 +5 * 
GST_SECOND
;

107 
	`rib_ce_t_posi
(
time
);

108 
	}
}

110 
	$rc_ui_mu_v_up_icked_cb
()

112 
gdoub
 
vue
;

113 if(!
	`rib_ce_g_vume
(&
vue
)) ;

114 
vue
+=0.05;

115 if(
vue
>1.0) value = 1.0;

116 
	`rib_ce_t_vume
(
vue
);

117 
	}
}

119 
	$rc_ui_mu_v_down_icked_cb
()

121 
gdoub
 
vue
;

122 if(!
	`rib_ce_g_vume
(&
vue
)) ;

123 
vue
-=0.05;

124 if(
vue
<0.0) value = 0.0;

125 
	`rib_ce_t_vume
(
vue
);

126 
	}
}

128 
	$rc_ui_mu__icked_cb
(
GtkAi
 *
ai
,

129 
GtkRadioAi
 *
cut
, 
gpor
 
da
)

131 
gt
 
vue
 = 
	`gtk_dio_ai_g_cut_vue
(
cut
);

132 
	`g_sigl_hdrs_block_by_func
(
ai
,

133 
	`G_CALLBACK
(
rc_ui_mu__icked_cb
), 
da
);

134 
	`rib_ay_t__mode
(
vue
);

135 
	`g_sigl_hdrs_unblock_by_func
(
ai
,

136 
	`G_CALLBACK
(
rc_ui_mu__icked_cb
), 
da
);

137 
	}
}

139 
	$rc_ui_mu_ndom_icked_cb
(
GtkAi
 *
ai
,

140 
GtkRadioAi
 *
cut
, 
gpor
 
da
)

142 
gt
 
vue
 = 
	`gtk_dio_ai_g_cut_vue
(
cut
);

143 
	`g_sigl_hdrs_block_by_func
(
ai
,

144 
	`G_CALLBACK
(
rc_ui_mu_ndom_icked_cb
), 
da
);

145 
	`rib_ay_t_ndom_mode
(
vue
);

146 
	`g_sigl_hdrs_unblock_by_func
(
ai
,

147 
	`G_CALLBACK
(
rc_ui_mu_ndom_icked_cb
), 
da
);

148 
	}
}

150 
	$rc_ui_mu_erum_icked_cb
(
GtkAi
 *
ai
,

151 
GtkRadioAi
 *
cut
, 
gpor
 
da
)

153 
gt
 
vue
 = 
	`gtk_dio_ai_g_cut_vue
(
cut
);

154 
	`g_sigl_hdrs_block_by_func
(
ai
,

155 
	`G_CALLBACK
(
rc_ui_mu_erum_icked_cb
), 
da
);

156 
	`rc_ui_ma_wdow_erum_t_y
(
vue
);

157 
	`g_sigl_hdrs_unblock_by_func
(
ai
,

158 
	`G_CALLBACK
(
rc_ui_mu_erum_icked_cb
), 
da
);

159 
	}
}

161 
	$rc_ui_mu_kp_above_icked_cb
(
GtkAi
 *
ai
,

162 
gpor
 
da
)

164 
gboޗn
 
aive
;

165 if(
ai
==
NULL
) ;

166 
aive
 = 
	`gtk_togg_ai_g_aive
(
	`GTK_TOGGLE_ACTION
(
ai
));

167 
	`g_sigl_hdrs_block_by_func
(
ai
,

168 
	`G_CALLBACK
(
rc_ui_mu_kp_above_icked_cb
), 
da
);

169 
	`rc_ui_ma_wdow_t_kp_above_e
(
aive
);

170 
	`g_sigl_hdrs_unblock_by_func
(
ai
,

171 
	`G_CALLBACK
(
rc_ui_mu_kp_above_icked_cb
), 
da
);

172 
	}
}

174 
	$rc_ui_mu_ogss_impt_nl_icked_cb
()

176 
	`rib_db_impt_nl
();

177 
	}
}

179 
	$rc_ui_mu_ogss_esh_nl_icked_cb
()

181 
	`rib_db_esh_nl
();

182 
	}
}

184 
GtkAiEry
 
	gui_mu_s
[] =

186 { "RhythmCMu", 
NULL
, "_RhythmCat" },

187 { "PyliMu", 
NULL
, 
N_
("_Playlist") },

188 { "VwMu", 
NULL
, 
N_
("_View") },

189 { "CڌMu", 
NULL
, 
N_
("_Control") },

190 { "HpMu", 
NULL
, 
N_
("_Help") },

191 { "RtMu", 
NULL
, 
N_
("_Repeat") },

192 { "RdomMu", 
NULL
, 
N_
("Ran_dom") },

193 { "RhythmCOnMusic", 
GTK_STOCK_OPEN
,

194 
N_
("Open _Music"), "<control>O",

195 
N_
("Openndlayhe music file"),

196 
G_CALLBACK
(
rc_ui_dlog_ݒ_music
) },

197 { "RhythmCOnLoti", 
NULL
,

198 
N_
("O_Loti"), 
NULL
,

199 
N_
("Openocationndlay"),

200 
G_CALLBACK
(
rc_ui_dlog_ݒ_loti
) },

201 { "RhythmCPns", 
GTK_STOCK_PREFERENCES
,

202 
N_
("_Preferences"), "F8",

203 
N_
("Configurehelayer"),

204 
G_CALLBACK
(
rc_ui_gs_wdow_show
) },

205 { "RhythmCPlug", 
GTK_STOCK_EXECUTE
,

206 
N_
("Plu_gins"), "F11",

207 
N_
("Configurelugins"),

208 
G_CALLBACK
(
rc_ui_ug_wdow_show
) },

209 { "RhythmCQu", 
GTK_STOCK_QUIT
,

210 
N_
("_Quit"), "<control>Q",

211 
N_
("Quithislayer"),

212 
G_CALLBACK
(
rc_ui_ay_ex
) },

213 { "PyliNewLi", 
GTK_STOCK_NEW
,

214 
N_
("_New Playlist"), "<control>N",

215 
N_
("Createewlaylist"),

216 
G_CALLBACK
(
rc_ui_livw_log_w_ayli
) },

217 { "PyliRameLi", 
GTK_STOCK_EDIT
,

218 
N_
("Re_name Playlist"), "F2",

219 
N_
("Renamehelaylist"),

220 
G_CALLBACK
(
rc_ui_livw_log_me_ayli
) },

221 { "PyliRemoveLi", 
GTK_STOCK_REMOVE
,

222 
N_
("R_emovPyli"), 
NULL
,

223 
N_
("Removehelaylist"),

224 
G_CALLBACK
(
rc_ui_livw_log_de_ems
) },

225 { "PyliExptLi", 
GTK_STOCK_SAVE
,

226 
N_
("_Export Playlist"), "<control>S",

227 
N_
("Export musicolaylist"),

228 
G_CALLBACK
(
rc_ui_dlog_ve_ayli
) },

229 { "PyliExptA", 
GTK_STOCK_SAVE_AS
,

230 
N_
("Exp܈_A Pylis"), 
NULL
,

231 
N_
("Exportlllaylistso folder"),

232 
G_CALLBACK
(
rc_ui_dlog_ve_l_ayli
) },

233 { "PyliImptMusic", 
GTK_STOCK_OPEN
,

234 
N_
("Import _Music"), "<control>I",

235 
N_
("Import music file"),

236 
G_CALLBACK
(
rc_ui_dlog_add_music
) },

237 { "PyliImptLi", 
GTK_STOCK_FILE
,

238 
N_
("Imp܈From _Pyli"), 
NULL
,

239 
N_
("Import music fromlaylist"),

240 
G_CALLBACK
(
rc_ui_dlog_ld_ayli
) },

241 { "PyliImptFd", 
GTK_STOCK_DIRECTORY
,

242 
N_
("Imp܈From _Fd"), 
NULL
,

243 
N_
("Importll music from folder"),

244 
G_CALLBACK
(
rc_ui_dlog_add_dey
) },

245 { "PyliRemoveMusic", 
GTK_STOCK_DELETE
,

246 
N_
("_RemovMusic"), 
NULL
,

247 
N_
("Remove music fromlaylist"),

248 
G_CALLBACK
(
rc_ui_livw_ayli_de_ems
) },

249 { "PyliSeA", 
GTK_STOCK_SELECT_ALL
,

250 
N_
("Select _All"), "<control>A",

251 
N_
("Selectll music inhelaylist"),

252 
G_CALLBACK
(
rc_ui_livw_ayli__l
) },

253 { "PyliReeshLi", 
GTK_STOCK_REFRESH
,

254 
N_
("Re_fresh Playlist"), "F5",

255 
N_
("Refresh music information inhelaylist"),

256 
G_CALLBACK
(
rc_ui_livw_ayli_esh
) },

257 { "PyliBdLyric", 
NULL
,

258 
N_
("Bd _LyriFe"), 
NULL
,

259 
N_
("Bindyric fileohe selected music"),

260 
G_CALLBACK
(
rc_ui_dlog_bd_lyric
) },

261 { "PyliBdAlbum", 
NULL
,

262 
N_
("Bd Al_bum Fe"), 
NULL
,

263 
N_
("Bindlbum fileohe selected music"),

264 
G_CALLBACK
(
rc_ui_dlog_bd_bum
) },

265 { "VwEf", 
NULL
,

266 
N_
("_Audio Effects"), "<control>E",

267 
N_
("Adjustheudioffects"),

268 
G_CALLBACK
(
rc_ui_ef_wdow_show
) },

269 { "CڌPy", 
GTK_STOCK_MEDIA_PLAY
,

270 
N_
("_Play/Pause"), "<control>L",

271 
N_
("Play orausehe music"),

272 
G_CALLBACK
(
rc_ui_mu_ay_bu_icked_cb
) },

273 { "CڌSt", 
GTK_STOCK_MEDIA_STOP
,

274 
N_
("_Stop"), "<control>P",

275 
N_
("Stophe music"),

276 
G_CALLBACK
(
rc_ui_mu__bu_icked_cb
) },

277 { "CڌPv", 
GTK_STOCK_MEDIA_PREVIOUS
,

278 
N_
("Pre_vious"), "<alt>Left",

279 
N_
("Playrevious music"),

280 
G_CALLBACK
(
rc_ui_mu_ev_bu_icked_cb
) },

281 { "CڌNext", 
GTK_STOCK_MEDIA_NEXT
,

282 
N_
("_Next"), "<alt>Right",

283 
N_
("Playext music"),

284 
G_CALLBACK
(
rc_ui_mu_xt_bu_icked_cb
) },

285 { "CڌBackwd", 
GTK_STOCK_MEDIA_REWIND
,

286 
N_
("_Backward"), "<control>Left",

287 
N_
("Backward 5 seconds"),

288 
G_CALLBACK
(
rc_ui_mu_backwd_icked_cb
) },

289 { "CڌFwd", 
GTK_STOCK_MEDIA_FORWARD
,

290 
N_
("_Forward"), "<control>Right",

291 
N_
("Forward 5 seconds"),

292 
G_CALLBACK
(
rc_ui_mu_fwd_icked_cb
) },

293 { "CڌVumeUp", 
GTK_STOCK_GO_UP
,

294 
N_
("_Increase Volume"), "<control>Up",

295 
N_
("Increasehe volume"),

296 
G_CALLBACK
(
rc_ui_mu_v_up_icked_cb
) },

297 { "CڌVumeDown", 
GTK_STOCK_GO_DOWN
,

298 
N_
("_Decrease Volume"), "<control>Down",

299 
N_
("Decreasehe volume"),

300 
G_CALLBACK
(
rc_ui_mu_v_down_icked_cb
) },

301 { "CڌRgLimed", 
NULL
,

302 
N_
("_Cfigu Rg Limed Mode"), 
NULL
,

303 
N_
("Configure Rating Limited Playing Mode"),

304 
G_CALLBACK
(
rc_ui_dlog_tg_limed_ayg
) },

305 { "HpAbout", 
GTK_STOCK_ABOUT
,

306 
N_
("_About"), 
NULL
,

307 
N_
("Abouthislayer"),

308 
G_CALLBACK
(
rc_ui_dlog_about_ay
) },

309 { "HpRt", 
NULL
,

310 
N_
("_Bug Rt"), 
NULL
,

311 
N_
("Report bugs"),

312 
G_CALLBACK
(
NULL
) },

313 { "HpSu܋dFm", 
NULL
,

314 
N_
("_Su܋d Fm"), 
NULL
,

315 
N_
("Checkhe supported music format ofhislayer"),

316 
G_CALLBACK
(
rc_ui_dlog_show_su܋d_fm
) },

317 { "CogNewLi", 
GTK_STOCK_NEW
,

318 
N_
("_New Pyli"), 
NULL
,

319 
N_
("Createewlaylist"),

320 
G_CALLBACK
(
rc_ui_livw_log_w_ayli
) },

321 { "CogRameLi", 
GTK_STOCK_EDIT
,

322 
N_
("Re_mPyli"), 
NULL
,

323 
N_
("Renamehelaylist"),

324 
G_CALLBACK
(
rc_ui_livw_log_me_ayli
) },

325 { "CogRemoveLi", 
GTK_STOCK_REMOVE
,

326 
N_
("R_emovPyli"), 
NULL
,

327 
N_
("Removehelaylist"),

328 
G_CALLBACK
(
rc_ui_livw_log_de_ems
) },

329 { "CogExptLi", 
GTK_STOCK_SAVE
,

330 
N_
("E_xp܈Pyli"), 
NULL
,

331 
N_
("Export musicolaylist"),

332 
G_CALLBACK
(
rc_ui_dlog_ve_ayli
) },

333 { "PyliPImptMusic", 
GTK_STOCK_OPEN
,

334 
N_
("Imp܈_Music"), 
NULL
,

335 
N_
("Import music file"),

336 
G_CALLBACK
(
rc_ui_dlog_add_music
) },

337 { "PyliPImptLi", 
GTK_STOCK_FILE
,

338 
N_
("Imp܈From _Pyli"), 
NULL
,

339 
N_
("Import music fromlaylist"),

340 
G_CALLBACK
(
rc_ui_dlog_ld_ayli
) },

341 { "PyliPSeA", 
GTK_STOCK_SELECT_ALL
,

342 
N_
("Se _A"), 
NULL
,

343 
N_
("Selectll music inhelaylist"),

344 
G_CALLBACK
(
rc_ui_livw_ayli__l
) },

345 { "PyliPBdLyric", 
NULL
,

346 
N_
("Bd _LyriFe"), 
NULL
,

347 
N_
("Bindyric fileohe selected music"),

348 
G_CALLBACK
(
rc_ui_dlog_bd_lyric
) },

349 { "PyliPBdAlbum", 
NULL
,

350 
N_
("Bd Al_bum Fe"), 
NULL
,

351 
N_
("Bindlbum fileohe selected music"),

352 
G_CALLBACK
(
rc_ui_dlog_bd_bum
) },

353 { "PyliPRemoveMusic", 
GTK_STOCK_REMOVE
,

354 
N_
("R_emovMusic"), 
NULL
,

355 
N_
("Remove music fromlaylist"),

356 
G_CALLBACK
(
rc_ui_livw_ayli_de_ems
) },

357 { "PyliPReeshLi", 
GTK_STOCK_REFRESH
,

358 
N_
("Re_esh Pyli"), 
NULL
,

359 
N_
("Refresh music information inhelaylist"),

360 
G_CALLBACK
(
rc_ui_livw_ayli_esh
) },

361 { "AlbumSaveImage", 
GTK_STOCK_SAVE_AS
,

362 
N_
("_SavAlbum ImagAs"), 
NULL
,

363 
N_
("Savehelbum image"),

364 
G_CALLBACK
(
rc_ui_dlog_ve_bum
) },

365 { "ProgssImptStus", 
NULL
,

366 
N_
("Imptg: 0emag"), 
NULL
,

367 
NULL
,

368 
NULL
 },

369 { "ProgssReeshStus", 
NULL
,

370 
N_
("Reeshg: 0emag"), 
NULL
,

371 
NULL
,

372 
NULL
 },

373 { "ProgssImptCl", 
NULL
,

374 
N_
("St _imptg"), 
NULL
,

375 
N_
("Terminateheemaining importing jobs."),

376 
G_CALLBACK
(
rc_ui_mu_ogss_impt_nl_icked_cb
) },

377 { "ProgssReeshCl", 
NULL
,

378 
N_
("St _eshg"), 
NULL
,

379 
N_
("Terminateheemainingefreshing jobs."),

380 
G_CALLBACK
(
rc_ui_mu_ogss_esh_nl_icked_cb
) },

381 { "TyPy", 
GTK_STOCK_MEDIA_PLAY
,

382 
N_
("_Py/Pau"), 
NULL
,

383 
N_
("Play orausehe music"),

384 
G_CALLBACK
(
rc_ui_mu_ay_bu_icked_cb
) },

385 { "TySt", 
GTK_STOCK_MEDIA_STOP
,

386 
N_
("_St"), 
NULL
,

387 
N_
("Stophe music"),

388 
G_CALLBACK
(
rc_ui_mu__bu_icked_cb
) },

389 { "TyPv", 
GTK_STOCK_MEDIA_PREVIOUS
,

390 
N_
("P_vious"), 
NULL
,

391 
N_
("Playrevious music"),

392 
G_CALLBACK
(
rc_ui_mu_ev_bu_icked_cb
) },

393 { "TyNext", 
GTK_STOCK_MEDIA_NEXT
,

394 
N_
("_Next"), 
NULL
,

395 
N_
("Playext music"),

396 
G_CALLBACK
(
rc_ui_mu_xt_bu_icked_cb
) },

397 { "TyShowPy", 
GTK_STOCK_HOME
,

398 
N_
("S_how Py"), 
NULL
,

399 
N_
("Showhe window oflayer"),

400 
G_CALLBACK
(
rc_ui_ma_wdow_e_ma_wdow
) },

401 { "TyAbout", 
GTK_STOCK_ABOUT
,

402 
N_
("_About"), 
NULL
,

403 
N_
("Abouthislayer"),

404 
G_CALLBACK
(
rc_ui_dlog_about_ay
) },

405 { "TyQu", 
GTK_STOCK_QUIT
,

406 
N_
("_Qu"), 
NULL
,

407 
N_
("Quithislayer"),

408 
G_CALLBACK
(
rc_ui_ay_ex
) }

411 
gut
 
	gui_mu_n_s
 = 
G_N_ELEMENTS
(
ui_mu_s
);

413 
GtkRadioAiEry
 
	gui_mu__s
[] =

415 { "RtNoRt", 
NULL
,

416 
N_
("_NRt"), 
NULL
,

417 
N_
("Nػ"), 
RCLIB_PLAYER_REPEAT_NONE
 },

418 { "RtMusicRt", 
NULL
,

419 
N_
("Sg _MusiRt"), 
NULL
,

420 
N_
("Rayg sg music"), 
RCLIB_PLAYER_REPEAT_SINGLE
 },

421 { "RtLiRt", 
NULL
,

422 
N_
("Sg _Pyli Rt"), 
NULL
,

423 
N_
("Rayg sg˅yli"), 
RCLIB_PLAYER_REPEAT_LIST
 },

424 { "RtARt", 
NULL
,

425 
N_
("_A PyliRt"), 
NULL
,

426 
N_
("Rayg΅ylis"), 
RCLIB_PLAYER_REPEAT_ALL
 }

429 
gut
 
	gui_mu__n_s
 = 
G_N_ELEMENTS
(
ui_mu__s
);

431 
GtkRadioAiEry
 
	gui_mu_ndom_s
[] =

433 { "RdomNoRdom", 
NULL
,

434 
N_
("_NRdom"), 
NULL
,

435 
N_
("Nؿndomyg"), 
RCLIB_PLAYER_RANDOM_NONE
 },

436 { "RdomSgRdom", 
NULL
,

437 
N_
("_Sg Pyli Rdom"), 
NULL
,

438 
N_
("Randomlaying music inhelaylist"),

439 
RCLIB_PLAYER_RANDOM_SINGLE
 },

440 { "RdomARdom", 
NULL
,

441 
N_
("_A PyliRdom"), 
NULL
,

442 
N_
("Randomlaying music inlllaylists"),

443 
RCLIB_PLAYER_RANDOM_ALL
 }

446 
gut
 
	gui_mu_ndom_n_s
 = 
G_N_ELEMENTS
(
ui_mu_ndom_s
);

448 
GtkRadioAiEry
 
	gui_mu_erum_s
[] =

450 { "SrumNoSty", 
NULL
,

451 
N_
("_NVisuize"), 
NULL
,

452 
N_
("Dib visuizy"), 
RC_UI_SPECTRUM_STYLE_NONE
 },

453 { "SrumWaveMo", 
NULL
,

454 
N_
("_MWavesce"), 
NULL
,

455 
N_
("Wavescݐwh o chl"), 
RC_UI_SPECTRUM_STYLE_WAVE_MONO
 },

456 { "SrumWaveMui", 
NULL
,

457 
N_
("Mui-_chWavesce"), 
NULL
,

458 
N_
("Wavescݐwh mui-chl"), 
RC_UI_SPECTRUM_STYLE_WAVE_MULTI
 },

459 { "SrumSrum", 
NULL
,

460 
N_
("_Srum"), 
NULL
,

461 
N_
("Srum"), 
RC_UI_SPECTRUM_STYLE_SPECTRUM
 }

464 
gut
 
	gui_mu_erum_n_s
 =

465 
G_N_ELEMENTS
(
ui_mu_erum_s
);

467 
GtkToggAiEry
 
	gui_mu_togg_s
[] =

469 { "VwAlwaysOnT", 
GTK_STOCK_GOTO_TOP
,

470 
N_
("AlwayO_T"), 
NULL
,

471 
N_
("Always onop"),

472 
G_CALLBACK
(
rc_ui_mu_kp_above_icked_cb
), 
FALSE
 },

473 { "TyAlwaysOnT", 
GTK_STOCK_GOTO_TOP
,

474 
N_
("AlwayO_T"), 
NULL
,

475 
N_
("Always onop"),

476 
G_CALLBACK
(
rc_ui_mu_kp_above_icked_cb
), 
FALSE
 }

479 
gut
 
	gui_mu_toog_n_s
 = 
G_N_ELEMENTS
(
ui_mu_togg_s
);

481 cڡ 
gch
 *
	gui_mu_fo
 =

596 
	$rc_ui_mu_ce_e_chged_cb
(
RCLibCe
 *
ce
,

597 
GS
 
e
, 
gpor
 
da
)

599 
RCUiMuPrive
 *
iv
 = (RCUiMuPriv*)
da
;

600 if(
da
==
NULL
) ;

601 if(
e
!=
GST_STATE_PLAYING
 && s!=
GST_STATE_PAUSED
)

603 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

604 "/RC2MuB/CڌMu/CڌBackwd"), 
FALSE
);

605 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

606 "/RC2MuB/CڌMu/CڌFwd"), 
FALSE
);

610 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

611 "/RC2MuB/CڌMu/CڌBackwd"), 
TRUE
);

612 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

613 "/RC2MuB/CڌMu/CڌFwd"), 
TRUE
);

615 if(
e
==
GST_STATE_PLAYING
)

617 
	`g_obje_t
(
	`G_OBJECT
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

619 
GTK_STOCK_MEDIA_PAUSE
, 
NULL
);

620 
	`g_obje_t
(
	`G_OBJECT
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

622 
GTK_STOCK_MEDIA_PAUSE
, 
NULL
);

626 
	`g_obje_t
(
	`G_OBJECT
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

628 
GTK_STOCK_MEDIA_PLAY
, 
NULL
);

629 
	`g_obje_t
(
	`G_OBJECT
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

631 
GTK_STOCK_MEDIA_PLAY
, 
NULL
);

633 
	}
}

635 
	$rc_ui_mu_vume_chged_cb
(
RCLibCe
 *
ce
, 
gdoub
 
vume
,

636 
gpor
 
da
)

638 
RCUiMuPrive
 *
iv
 = (RCUiMuPriv*)
da
;

639 if(
da
==
NULL
) ;

640 if(
vume
>0.9999)

641 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

642 "/RC2MuB/CڌMu/CڌVumeUp"), 
FALSE
);

644 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

645 "/RC2MuB/CڌMu/CڌVumeUp"), 
TRUE
);

646 if(
vume
<0.0001)

647 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

648 "/RC2MuB/CڌMu/CڌVumeDown"), 
FALSE
);

650 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

651 "/RC2MuB/CڌMu/CڌVumeDown"), 
TRUE
);

652 
	}
}

654 
	$rc_ui_mu_ay__mode_chged_cb
(
RCLibPy
 *
ay
,

655 
RCLibPyRtMode
 
mode
, 
gpor
 
da
)

657 
RCUiMuPrive
 *
iv
 = (RCUiMuPriv*)
da
;

658 if(
da
==
NULL
) ;

659 
	`gtk_dio_ai_t_cut_vue
(
	`GTK_RADIO_ACTION
(

660 
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

661 "/RC2MuB/CڌMu/RtMu/RtNoRt")), 
mode
);

662 
	}
}

664 
	$rc_ui_mu_ay_ndom_mode_chged_cb
(
RCLibPy
 *
ay
,

665 
RCLibPyRdomMode
 
mode
, 
gpor
 
da
)

667 
RCUiMuPrive
 *
iv
 = (RCUiMuPriv*)
da
;

668 if(
da
==
NULL
) ;

669 
	`gtk_dio_ai_t_cut_vue
(
	`GTK_RADIO_ACTION
(

670 
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

671 "/RC2MuB/CڌMu/RdomMu/RdomNoRdom")), 
mode
);

672 
	}
}

674 
	$rc_ui_mu_wk_f_cb
(
gpor
 
da
, 
GObje
 *
obje
)

676 
RCUiMuPrive
 *
iv
 = (RCUiMuPriv*)
da
;

677 if(
da
==
NULL
) ;

678 
iv
->
ui_mag
 = 
NULL
;

679 
iv
->
ui_ais
 = 
NULL
;

680 if(
iv
->
e_chged_id
>0)

682 
	`rib_ce_sigl_disc
(
iv
->
e_chged_id
);

683 
iv
->
e_chged_id
 = 0;

685 if(
iv
->
vume_chged_id
>0)

687 
	`rib_ce_sigl_disc
(
iv
->
vume_chged_id
);

688 
iv
->
vume_chged_id
 = 0;

690 if(
iv
->
_mode_chged_id
>0)

692 
	`rib_ay_sigl_disc
(
iv
->
_mode_chged_id
);

693 
iv
->
_mode_chged_id
 = 0;

695 if(
iv
->
ndom_mode_chged_id
>0)

697 
	`rib_ay_sigl_disc
(
iv
->
ndom_mode_chged_id
);

698 
iv
->
ndom_mode_chged_id
 = 0;

700 
	}
}

702 
gboޗn
 
	$rc_ui_mu_
()

704 
RCUiMuPrive
 *
iv
 = &
ui_mu_iv
;

705 
GE
 *
r
 = 
NULL
;

706 
gdoub
 
vume
;

707 
iv
->
ui_mag
 = 
	`gtk_ui_mag_w
();

708 
iv
->
ui_ais
 = 
	`gtk_ai_group_w
("RC2Actions");

709 
	`gtk_ai_group_t_i_doma
(
iv
->
ui_ais
,

710 
GETTEXT_PACKAGE
);

711 
	`gtk_ai_group_add_ais
(
iv
->
ui_ais
, 
ui_mu_s
,

712 
ui_mu_n_s
, 
NULL
);

713 
	`gtk_ai_group_add_dio_ais
(
iv
->
ui_ais
,

714 
ui_mu__s
, 
ui_mu__n_s
, 0,

715 
	`G_CALLBACK
(
rc_ui_mu__icked_cb
), 
NULL
);

716 
	`gtk_ai_group_add_dio_ais
(
iv
->
ui_ais
,

717 
ui_mu_ndom_s
, 
ui_mu_ndom_n_s
, 0,

718 
	`G_CALLBACK
(
rc_ui_mu_ndom_icked_cb
), 
NULL
);

719 
	`gtk_ai_group_add_dio_ais
(
iv
->
ui_ais
,

720 
ui_mu_erum_s
, 
ui_mu_erum_n_s
, 0,

721 
	`G_CALLBACK
(
rc_ui_mu_erum_icked_cb
), 
NULL
);

722 
	`gtk_ai_group_add_togg_ais
(
iv
->
ui_ais
,

723 
ui_mu_togg_s
, 
ui_mu_toog_n_s
, 
NULL
);

724 
	`gtk_ui_mag__ai_group
(
iv
->
ui_mag
,riv->
ui_ais
, 0);

725 
	`g_obje_uef
(
iv
->
ui_ais
);

726 if(!
	`gtk_ui_mag_add_ui_om_rg
(
iv
->
ui_mag
, 
ui_mu_fo
, -1,

727 &
r
))

729 
	`g_wng
("Cnنd mu: %s", 
r
->
mesge
);

730 
	`g_r_
(
r
);

731 
	`g_obje_uef
(
iv
->
ui_mag
);

732 
iv
->
ui_mag
 = 
NULL
;

733  
FALSE
;

735 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

736 "/AlbumPupMu/AlbumSaveImage"), 
FALSE
);

737 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

738 "/ProgssPupMu/ProgssImptStus"), 
FALSE
);

739 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

740 "/ProgssPupMu/ProgssReeshStus"), 
FALSE
);

741 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

742 "/ProgssPupMu/ProgssImptStus"), 
FALSE
);

743 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

744 "/ProgssPupMu/ProgssReeshStus"), 
FALSE
);

745 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

746 "/ProgssPupMu/ProgssImptCl"), 
FALSE
);

747 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

748 "/ProgssPupMu/ProgssReeshCl"), 
FALSE
);

751 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

752 "/RC2MuB/HpMu/HpRt"), 
FALSE
);

754 
	`g_obje_wk_f
(
	`G_OBJECT
(
iv
->
ui_mag
), 
rc_ui_mu_wk_f_cb
,

755 
iv
);

757 
iv
->
e_chged_id
 = 
	`rib_ce_sigl_c
("state-changed",

758 
	`G_CALLBACK
(
rc_ui_mu_ce_e_chged_cb
), 
iv
);

759 
iv
->
vume_chged_id
 = 
	`rib_ce_sigl_c
("volume-changed",

760 
	`G_CALLBACK
(
rc_ui_mu_vume_chged_cb
), 
iv
);

761 
iv
->
_mode_chged_id
 = 
	`rib_ay_sigl_c
(

763 
	`G_CALLBACK
(
rc_ui_mu_ay__mode_chged_cb
), 
iv
);

764 
iv
->
ndom_mode_chged_id
 = 
	`rib_ay_sigl_c
(

766 
	`G_CALLBACK
(
rc_ui_mu_ay_ndom_mode_chged_cb
), 
iv
);

767 if(
	`rib_ce_g_vume
(&
vume
))

768 
	`rc_ui_mu_vume_chged_cb
(
NULL
, 
vume
, 
iv
);

769  
TRUE
;

770 
	}
}

781 
GtkUIMag
 *
	$rc_ui_mu_g_ui_mag
()

783 
RCUiMuPrive
 *
iv
 = &
ui_mu_iv
;

784 if(
iv
->
ui_mag
==
NULL
)

785 if(!
	`rc_ui_mu_
() 
NULL
;

786  
iv
->
ui_mag
;

787 
	}
}

804 
gut
 
	$rc_ui_mu_add_mu_ai
(
GtkAi
 *
ai
, cڡ 
gch
 *
th
,

805 cڡ 
gch
 *
me
, cڡ gch *
ai_me
, 
gboޗn
 
t
)

807 
RCUiMuPrive
 *
iv
 = &
ui_mu_iv
;

808 
gut
 
id
;

809 if(
iv
->
ui_mag
==
NULL
 ||riv->
ui_ais
==NULL || 
ai
==NULL || 
th
==NULL ||

810 
me
==
NULL
)  0;

811 
id
 = 
	`gtk_ui_mag_w_mge_id
(
iv
->
ui_mag
);

812 
	`gtk_ui_mag_add_ui
(
iv
->
ui_mag
, 
id
, 
th
, 
me
, 
ai_me
,

813 
GTK_UI_MANAGER_MENUITEM
, 
t
);

814 
	`gtk_ai_group_add_ai
(
iv
->
ui_ais
, 
ai
);

815  
id
;

816 
	}
}

826 
	$rc_ui_mu_move_mu_ai
(
GtkAi
 *
ai
, 
gut
 
id
)

828 
RCUiMuPrive
 *
iv
 = &
ui_mu_iv
;

829 if(
iv
->
ui_mag
==
NULL
 ||riv->
ui_ais
==NULL) ;

830 if(
ai
==
NULL
) ;

831 if(
id
>0)

832 
	`gtk_ui_mag_move_ui
(
iv
->
ui_mag
, 
id
);

833 
	`gtk_ai_group_move_ai
(
iv
->
ui_ais
, 
ai
);

834 
	}
}

	@ui/rc-ui-menu.h

25 #ide
HAVE_RC_UI_MENU_H


26 
	#HAVE_RC_UI_MENU_H


	)

28 
	~<glib.h
>

29 
	~<gtk/gtk.h
>

30 
	~<rib.h
>

32 
G_BEGIN_DECLS


34 
GtkUIMag
 *
rc_ui_mu_g_ui_mag
();

35 
gut
 
rc_ui_mu_add_mu_ai
(
GtkAi
 *
ai
, cڡ 
gch
 *
th
,

36 cڡ 
gch
 *
me
, cڡ gch *
ai_me
, 
gboޗn
 
t
);

37 
rc_ui_mu_move_mu_ai
(
GtkAi
 *
ai
, 
gut
 
id
);

39 
	gG_END_DECLS


	@ui/rc-ui-no-star-inline.h

3 #ifde
__SUNPRO_C


4 #agm
ign
 4 (
rc_ui_no__le
)

6 #ifde
__GNUC__


7 cڡ 
gut8
 
	grc_ui_no__le
[] 
__ibu__
 ((
__igd__
 (4))) =

9 cڡ 
gut8
 
rc_ui_no__le
[] =

	@ui/rc-ui-player.c

26 
	~"rc-ui-ay.h
"

27 
	~"rc-ui-wdow.h
"

28 
	~"rc-ui-livw.h
"

29 
	~"rc-ui-limod.h
"

30 
	~"rc-ui-mu.h
"

31 
	~"rc-ui-dlog.h
"

32 
	~"rc-ui-ab.h
"

33 
	~"rc-ui-erum.h
"

34 
	~"rc-ui-img-ic.xpm
"

35 
	~"rc-ui-unt--le.h
"

36 
	~"rc-ui-no--le.h
"

37 
	~"rc-ui-t--le.h
"

38 
	~"rc-comm.h
"

50 
	#RC_UI_PLAYER_COVER_IMAGE_SIZE
 160

	)

52 
	s_RCUiPyPrive


54 
GtkAliti
 *
	mp
;

55 
GtkWidg
 *
	mma_wdow
;

56 
GtkUIMag
 *
	mui_mag
;

57 
GtkStusIc
 *
	may_ic
;

58 
GdkPixbuf
 *
	mic_pixbuf
;

63 
	mSIGNAL_READY
,

64 
	mSIGNAL_LAST


67 
GObje
 *
	gui_ay_
 = 
NULL
;

68 
gpor
 
	grc_ui_ay__ass
 = 
NULL
;

69 
gt
 
	gui_ay_sigls
[
SIGNAL_LAST
] = {0};

71 
	$rc_ui_ay_ay_ic_pup
(
GtkStusIc
 *
ic
, 
gut
 
bu
,

72 
gut
 
aive_time
, 
gpor
 
da
)

74 
RCUiPyPrive
 *
iv
 = (RCUiPyPriv*)
da
;

75 if(
da
==
NULL
) ;

76 
	`gtk_mu_pup
(
	`GTK_MENU
(
	`gtk_ui_mag_g_widg
(
iv
->
ui_mag
,

77 "/TyPupMu")), 
NULL
, NULL, 
gtk_us_ic_posi_mu
,

78 
ic
, 3, 
aive_time
);

79 
	}
}

81 
	$rc_ui_ay_ay_ic_aived
(
GtkStusIc
 *
ic
,

82 
gpor
 
da
)

84 
RCUiPyPrive
 *
iv
 = (RCUiPyPriv*)
da
;

85 
gboޗn
 
visib
;

86 if(
iv
==
NULL
) ;

87 if(!
	`rib_gs_g_boޗn
("MaUI", "MimizeToTy", 
NULL
))

89 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
iv
->
ma_wdow
));

92 
	`g_obje_g
(
iv
->
ma_wdow
, "visib", &
visib
, 
NULL
);

93 if(
visib
)

95 
	`gtk_widg_hide
(
iv
->
ma_wdow
);

99 
	`gtk_wdow_t_sk_skb_ht
(
	`GTK_WINDOW
(
iv
->
ma_wdow
),

100 
FALSE
);

101 
	`gtk_wdow_deicify
(
	`GTK_WINDOW
(
iv
->
ma_wdow
));

102 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
iv
->
ma_wdow
));

105 
	}
}

107 
	$rc_ui_ay_fize
(
GObje
 *
obje
)

109 
RCUiPyPrive
 *
iv
 = 
	`RC_UI_PLAYER
(
obje
)->priv;

110 
GLi
 *
wdow_li
 = 
NULL
;

111 if(
iv
->
ma_wdow
!=
NULL
)

112 
	`gtk_widg_deroy
(
iv
->
ma_wdow
);

113 if(
iv
->
ui_mag
!=
NULL
)

114 
	`g_obje_uef
(
iv
->
ui_mag
);

115 if(
iv
->
ay_ic
!=
NULL
)

116 
	`g_obje_uef
(
iv
->
ay_ic
);

117 if(
iv
->
ic_pixbuf
!=
NULL
)

118 
	`g_obje_uef
(
iv
->
ic_pixbuf
);

119 if(
iv
->
p
!=
NULL
)

121 
wdow_li
 = 
	`gtk_iti_g_wdows
(
iv
->
p
);

122 
	`g_li_fܗch
(
wdow_li
, (
GFunc
)
gtk_widg_deroy
, 
NULL
);

123 
	`g_obje_uef
(
iv
->
p
);

126 
	`gtk_ma_qu
();

127 
	`G_OBJECT_CLASS
(
rc_ui_ay__ass
)->
	`fize
(
obje
);

128 
	}
}

130 
GObje
 *
	$rc_ui_ay_cڡru
(
GTy
 
ty
,

131 
gut
 
n_cڡru_ms
, 
GObjeCڡruPam
 *
cڡru_ms
)

133 
GObje
 *
tv
;

134 if(
ui_ay_
!=
NULL
)  ui_player_instance;

135 
tv
 = 
	`G_OBJECT_CLASS
(
rc_ui_ay__ass
)->
	`cڡru
(

136 
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

137 
ui_ay_
 = 
tv
;

138 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
ui_ay_
);

139  
tv
;

140 
	}
}

142 
	$rc_ui_ay_ass_
(
RCUiPyCss
 *
kss
)

144 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

145 
rc_ui_ay__ass
 = 
	`g_ty_ass_ek_
(
kss
);

146 
obje_ass
->
fize
 = 
rc_ui_ay_fize
;

147 
obje_ass
->
cڡru
 = 
rc_ui_ay_cڡru
;

148 
	`g_ty_ass_add_ive
(
kss
, (
RCUiPyPrive
));

156 
ui_ay_sigls
[
SIGNAL_READY
] = 
	`g_sigl_w
("ready",

157 
RC_UI_TYPE_PLAYER
, 
G_SIGNAL_RUN_FIRST
,

158 
	`G_STRUCT_OFFSET
(
RCUiPyCss
, 
ady
), 
NULL
, NULL,

159 
g_cosu_msh_VOID__VOID
, 
G_TYPE_NONE
, 0, G_TYPE_NONE, 
NULL
);

160 
	}
}

162 
	$rc_ui_ay__
(
RCUiPy
 *
ui
)

164 
RCUiPyPrive
 *
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
ui
,

165 
RC_UI_TYPE_PLAYER
, 
RCUiPyPrive
);

166 
ui
->
iv
 =riv;

167 
GdkPixbuf
 *
pixbuf
;

168 
iv
->
ic_pixbuf
 = 
	`gdk_pixbuf_w_om_xpm_da
(

169 (cڡ 
gch
 **)&
ui_image_ic
);

170 
	`gtk_ic_theme_add_but_ic
("RhythmCIc", 128, 
iv
->
ic_pixbuf
);

171 
pixbuf
 = 
	`gdk_pixbuf_w_om_le
(-1, 
rc_ui_unt__le
, 
FALSE
,

172 
NULL
);

173 
	`gtk_ic_theme_add_but_ic
("RCUntSr", 16, 
pixbuf
);

174 
	`g_obje_uef
(
pixbuf
);

175 
pixbuf
 = 
	`gdk_pixbuf_w_om_le
(-1, 
rc_ui_no__le
, 
FALSE
,

176 
NULL
);

177 
	`gtk_ic_theme_add_but_ic
("RCNoSr", 16, 
pixbuf
);

178 
	`g_obje_uef
(
pixbuf
);

179 
pixbuf
 = 
	`gdk_pixbuf_w_om_le
(-1, 
rc_ui_t__le
, 
FALSE
,

180 
NULL
);

181 
	`gtk_ic_theme_add_but_ic
("RCSSr", 16, 
pixbuf
);

182 
	`g_obje_uef
(
pixbuf
);

183 
iv
->
ay_ic
 = 
	`gtk_us_ic_w_om_pixbuf
riv->
ic_pixbuf
);

184 
iv
->
ma_wdow
 = 
	`rc_ui_ma_wdow_g_widg
();

185 
iv
->
ui_mag
 = 
	`rc_ui_mu_g_ui_mag
();

186 
	`g_sigl_c
(
iv
->
ay_ic
, "activate",

187 
	`G_CALLBACK
(
rc_ui_ay_ay_ic_aived
), 
iv
);

188 
	`g_sigl_c
(
iv
->
ay_ic
, "popup-menu",

189 
	`G_CALLBACK
(
rc_ui_ay_ay_ic_pup
), 
iv
);

190 
	`g_sigl_em
(
ui
, 
ui_ay_sigls
[
SIGNAL_READY
], 0);

191 
	}
}

193 
GTy
 
	$rc_ui_ay_g_ty
()

195 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

196 
GTy
 
g_defe_ty_id
;

197 cڡ 
GTyInfo
 
ui_fo
 = {

198 .
ass_size
 = (
RCUiPyCss
),

199 .
ba_
 = 
NULL
,

200 .
ba_fize
 = 
NULL
,

201 .
ass_
 = (
GCssInFunc
)
rc_ui_ay_ass_
,

202 .
ass_fize
 = 
NULL
,

203 .
ass_da
 = 
NULL
,

204 .
_size
 = (
RCUiPy
),

205 .
n_ocs
 = 0,

206 .
_
 = (
GInInFunc
)
rc_ui_ay__


208 if(
	`g___r
(&
g_defe_ty_id__vީe
))

210 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
G_TYPE_OBJECT
,

211 
	`g__ic_rg
("RCUiPy"), &
ui_fo
, 0);

212 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

214  
g_defe_ty_id__vީe
;

215 
	}
}

224 
	$rc_ui_ay_
(
GtkAliti
 *
p
)

226 
RCUiPyPrive
 *
iv
;

227 
	`g_mesge
("Loading main UI....");

228 if(
ui_ay_
!=
NULL
)

230 
	`g_wng
("Main UI islready initialized!");

233 
ui_ay_
 = 
	`g_obje_w
(
RC_UI_TYPE_PLAYER
, 
NULL
);

234 
iv
 = 
	`RC_UI_PLAYER
(
ui_ay_
)->priv;

235 if(
iv
!=
NULL
 && 
p
!=NULL)

237 
iv
->
p
 = 
	`g_obje_f
(app);

238 
	`gtk_wdow_t_iti
(
	`GTK_WINDOW
(
iv
->
ma_wdow
),

239 
iv
->
p
);

241 
	`g_mesge
("Main UIoaded.");

242 
	}
}

250 
	$rc_ui_ay_ex
()

252 if(
ui_ay_
!=
NULL
)

253 
	`g_obje_uef
(
ui_ay_
);

256 
ui_ay_
 = 
NULL
;

257 
	`g_mesge
("Main UIxited.");

258 
	}
}

268 
GObje
 *
	$rc_ui_ay_g_
()

270  
ui_ay_
;

271 
	}
}

285 
gulg
 
	$rc_ui_ay_sigl_c
(cڡ 
gch
 *
me
,

286 
GClback
 
back
, 
gpor
 
da
)

288 if(
ui_ay_
==
NULL
)  0;

289  
	`g_sigl_c
(
ui_ay_
, 
me
, 
back
, 
da
);

290 
	}
}

302 
	$rc_ui_ay_sigl_disc
(
gulg
 
hdr_id
)

304 if(
ui_ay_
==
NULL
) ;

305 
	`g_sigl_hdr_disc
(
ui_ay_
, 
hdr_id
);

306 
	}
}

316 
GtkWidg
 *
	$rc_ui_ay_g_ma_wdow
()

318 
RCUiPyPrive
 *
iv
 = 
NULL
;

319 if(
ui_ay_
==
NULL
)  NULL;

320 
iv
 = 
	`RC_UI_PLAYER
(
ui_ay_
)->priv;

321 if(
iv
==
NULL
)  NULL;

322  
iv
->
ma_wdow
;

323 
	}
}

333 
GdkPixbuf
 *
	$rc_ui_ay_g_ic_image
()

335 
RCUiPyPrive
 *
iv
 = 
NULL
;

336 if(
ui_ay_
==
NULL
)  NULL;

337 
iv
 = 
	`RC_UI_PLAYER
(
ui_ay_
)->priv;

338 if(
iv
==
NULL
)  NULL;

339  
iv
->
ic_pixbuf
;

340 
	}
}

350 
GtkStusIc
 *
	$rc_ui_ay_g_ay_ic
()

352 
RCUiPyPrive
 *
iv
 = 
NULL
;

353 if(
ui_ay_
==
NULL
)  NULL;

354 
iv
 = 
	`RC_UI_PLAYER
(
ui_ay_
)->priv;

355 if(
iv
==
NULL
)  NULL;

356  
iv
->
ay_ic
;

357 
	}
}

	@ui/rc-ui-player.h

25 #ide
HAVE_RC_UI_PLAYER_H


26 
	#HAVE_RC_UI_PLAYER_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<gtk/gtk.h
>

31 
	~<rib.h
>

33 
	gG_BEGIN_DECLS


35 
	#RC_UI_TYPE_PLAYER
 (
	`rc_ui_ay_g_ty
())

	)

36 
	#RC_UI_PLAYER
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

37 
RC_UI_TYPE_PLAYER
, 
RCUiPy
))

	)

38 
	#RC_UI_PLAYER_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_CAST
((k), \

39 
RC_UI_TYPE_PLAYER
, 
RCUiPyCss
))

	)

40 
	#RC_UI_IS_PLAYER
(
o
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((o), \

41 
RC_UI_TYPE_PLAYER
))

	)

42 
	#RC_UI_IS_PLAYER_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_TYPE
((k), \

43 
RC_UI_TYPE_PLAYER
))

	)

44 
	#RC_UI_PLAYER_GET_CLASS
(
o
(
	`G_TYPE_INSTANCE_GET_CLASS
((o), \

45 
RC_UI_TYPE_PLAYER
, 
RCUiPyCss
))

	)

47 
_RCUiPy
 
	tRCUiPy
;

48 
_RCUiPyCss
 
	tRCUiPyCss
;

49 
_RCUiPyPrive
 
	tRCUiPyPrive
;

57 
	s_RCUiPy
 {

59 
GObje
 
	m
;

60 
RCUiPyPrive
 *
	miv
;

69 
	s_RCUiPyCss
 {

71 
GObjeCss
 
	m_ass
;

72 (*
	mady
)(
RCUiPy
 *
	may
);

76 
GTy
 
rc_ui_ay_g_ty
();

79 
rc_ui_ay_
(
GtkAliti
 *
p
);

80 
rc_ui_ay_ex
();

81 
GObje
 *
rc_ui_ay_g_
();

82 
gulg
 
rc_ui_ay_sigl_c
(cڡ 
gch
 *
me
,

83 
GClback
 
back
, 
gpor
 
da
);

84 
rc_ui_ay_sigl_disc
(
gulg
 
hdr_id
);

85 
GtkWidg
 *
rc_ui_ay_g_ma_wdow
();

86 
GdkPixbuf
 *
rc_ui_ay_g_ic_image
();

87 
GtkStusIc
 *
rc_ui_ay_g_ay_ic
();

89 
	gG_END_DECLS


	@ui/rc-ui-plugin.c

26 
	~"rc-ui-ug.h
"

27 
	~"rc-comm.h
"

38 
	sRCUiPlugPrive


40 
GtkWidg
 *
	mug_wdow
;

41 
GtkWidg
 *
	mug_livw
;

42 
GtkWidg
 *
	mabout_bu
;

43 
GtkWidg
 *
	mcfig_bu
;

44 
GtkLiSte
 *
	mug_e
;

45 
gulg
 
	mgied_id
;

46 
gulg
 
	muegied_id
;

47 
gulg
 
	mlded_id
;

48 
gulg
 
	muded_id
;

49 }
	tRCUiPlugPrive
;

53 
	mRC_UI_PLUGIN_STORE_ACTIVATABLE
,

54 
	mRC_UI_PLUGIN_STORE_ENABLED
,

55 
	mRC_UI_PLUGIN_STORE_TYPE
,

56 
	mRC_UI_PLUGIN_STORE_ID
,

57 
	mRC_UI_PLUGIN_STORE_TEXT
,

58 
	mRC_UI_PLUGIN_STORE_LAST


61 
RCUiPlugPrive
 
	gug_iv
 = {0};

63 
	$rc_ui_ug_wdow_deroy_cb
(
GtkWidg
 *
widg
, 
gpor
 
da
)

65 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

66 if(
iv
->
gied_id
>0)

67 
	`rib_ug_sigl_disc
(
iv
->
gied_id
);

68 if(
iv
->
lded_id
>0)

69 
	`rib_ug_sigl_disc
(
iv
->
lded_id
);

70 if(
iv
->
uded_id
>0)

71 
	`rib_ug_sigl_disc
(
iv
->
uded_id
);

72 if(
iv
->
uegied_id
>0)

73 
	`rib_ug_sigl_disc
(
iv
->
uegied_id
);

74 
	`gtk_widg_deroyed
(
iv
->
ug_wdow
, &(priv->plugin_window));

75 
	}
}

77 
	$rc_ui_ug_toggd
(
GtkClRdTogg
 *
nd
,

78 
gch
 *
th_r
, 
gpor
 
da
)

80 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

81 
GtkTeIr
 

;

82 
GtkTePh
 *
th
;

83 
RCLibPlugDa
 *
ug_da
 = 
NULL
;

84 
gch
 *
id
;

85 if(
th_r
==
NULL
) ;

86 
th
 = 
	`gtk__th_w_om_rg
(
th_r
);

87 
	`gtk__mod_g_
(
	`GTK_TREE_MODEL
(
iv
->
ug_e
), &

, 
th
);

88 
	`gtk__th_
(
th
);

89 
	`gtk__mod_g
(
	`GTK_TREE_MODEL
(
iv
->
ug_e
), &

,

90 
RC_UI_PLUGIN_STORE_ID
, &
id
, -1);

91 if(
id
!=
NULL
)

92 
ug_da
 = 
	`rib_ug_lookup
(
id
);

93 
	`g_
(
id
);

94 if(
ug_da
==
NULL
) ;

95 if(!
ug_da
->
lded
)

96 
	`rib_ug_ld
(
ug_da
);

98 
	`rib_ug_ud
(
ug_da
);

99 
	}
}

101 
	$rc_ui_ug_i_chged
(
GtkTeSei
 *
i
,

102 
gpor
 
da
)

104 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

105 
gboޗn
 
ag
;

106 
gch
 *
id
;

107 
GtkTeIr
 

;

108 
RCLibPlugDa
 *
ug_da
 = 
NULL
;

109 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

110 
iv
->
ug_livw
));

111 
ag
 = 
	`gtk__i_g_ed
(
i
, 
NULL
, &

);

112 if(
ag
)

114 
	`g_obje_t
(
iv
->
about_bu
, "nsive", 
TRUE
, 
NULL
);

115 
	`gtk__mod_g
(
	`GTK_TREE_MODEL
(
iv
->
ug_e
), &

,

116 
RC_UI_PLUGIN_STORE_ID
, &
id
, -1);

117 if(
id
!=
NULL
)

118 
ug_da
 = 
	`rib_ug_lookup
(
id
);

119 
	`g_
(
id
);

120 if(
ug_da
!=
NULL
 &&lug_da->
fo
!=NULL &&

121 
ug_da
->
fo
->
cfigu
)

122 
	`g_obje_t
(
iv
->
cfig_bu
, "nsive", 
TRUE
, 
NULL
);

124 
	`g_obje_t
(
iv
->
cfig_bu
, "nsive", 
FALSE
, 
NULL
);

128 
	`g_obje_t
(
iv
->
about_bu
, "nsive", 
FALSE
, 
NULL
);

129 
	`g_obje_t
(
iv
->
cfig_bu
, "nsive", 
FALSE
, 
NULL
);

131 
	}
}

133 
	$rc_ui_ug_about_bu_icked
(
GtkBu
 *
bu
,

134 
gpor
 
da
)

136 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

137 
gch
 *
id
;

138 
GtkTeIr
 

;

139 
GtkWidg
 *
about_dlog
;

140 
GtkTeSei
 *
i
;

141 
gch
 *
auths
[] = {
NULL
, NULL};

142 
RCLibPlugDa
 *
ug_da
 = 
NULL
;

143 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

144 
iv
->
ug_livw
));

145 if(
i
==
NULL
) ;

146 if(!
	`gtk__i_g_ed
(
i
, 
NULL
, &

)) ;

147 
	`gtk__mod_g
(
	`GTK_TREE_MODEL
(
iv
->
ug_e
), &

,

148 
RC_UI_PLUGIN_STORE_ID
, &
id
, -1);

149 if(
id
!=
NULL
)

150 
ug_da
 = 
	`rib_ug_lookup
(
id
);

151 
	`g_
(
id
);

152 if(
ug_da
==
NULL
 ||lug_da->
fo
==NULL) ;

153 
about_dlog
 = 
	`gtk_about_dlog_w
();

154 
auths
[0] = 
ug_da
->
fo
->
auth
;

155 
	`g_obje_t
(
about_dlog
, "ogm-me", 
ug_da
->
fo
->
me
,

156 "auths", 
auths
, "commts", 
ug_da
->
fo
->
desti
,

157 "webse", 
ug_da
->
fo
->
homage
, "version",

158 
ug_da
->
fo
->
vsi
, 
NULL
);

159 
	`gtk_dlog_run
(
	`GTK_DIALOG
(
about_dlog
));

160 
	`gtk_widg_deroy
(
about_dlog
);

161 
	}
}

163 
	$rc_ui_ug_cfig_bu_icked
(
GtkBu
 *
bu
,

164 
gpor
 
da
)

166 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

167 
gch
 *
id
;

168 
GtkTeIr
 

;

169 
GtkTeSei
 *
i
;

170 
RCLibPlugDa
 *
ug_da
 = 
NULL
;

171 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

172 
iv
->
ug_livw
));

173 if(
i
==
NULL
) ;

174 if(!
	`gtk__i_g_ed
(
i
, 
NULL
, &

)) ;

175 
	`gtk__mod_g
(
	`GTK_TREE_MODEL
(
iv
->
ug_e
), &

,

176 
RC_UI_PLUGIN_STORE_ID
, &
id
, -1);

177 if(
id
!=
NULL
)

178 
ug_da
 = 
	`rib_ug_lookup
(
id
);

179 
	`g_
(
id
);

180 if(
ug_da
==
NULL
 ||lug_da->
fo
==NULL ||

181 
ug_da
->
fo
->
cfigu
==
NULL
) ;

182 
ug_da
->
fo
->
	`cfigu
(plugin_data);

183 
	}
}

185 
	$rc_ui_ug_o_bu_icked
(
GtkBu
 *
bu
,

186 
gpor
 
da
)

188 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

189 
	`gtk_widg_deroy
(
iv
->
ug_wdow
);

190 
	}
}

192 
gboޗn
 
	$rc_ui_ug_g__by_id
(cڡ 
gch
 *
id
,

193 
GtkTeIr
 *

)

195 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

196 
GtkTeIr
 
_fܗch
;

197 
gch
 *
da_id
;

198 
gboޗn
 
ag
 = 
FALSE
;

199 if(
id
==
NULL
 
FALSE
;

200 if(!
	`gtk__mod_g__f
(
	`GTK_TREE_MODEL
(
iv
->
ug_e
),

201 &
_fܗch
) 
FALSE
;

204 
	`gtk__mod_g
(
	`GTK_TREE_MODEL
(
iv
->
ug_e
), &
_fܗch
,

205 
RC_UI_PLUGIN_STORE_ID
, &
da_id
, -1);

206 if(
	`g_rcmp0
(
da_id
, 
id
)==0
ag
 = 
TRUE
;

207 
	`g_
(
da_id
);

208 if(
ag
)

210 *

 = 
_fܗch
;

211  
TRUE
;

214 
	`gtk__mod__xt
(
	`GTK_TREE_MODEL
(
iv
->
ug_e
),

215 &
_fܗch
));

216  
FALSE
;

217 
	}
}

219 
	$rc_ui_ug_gied_cb
(
RCLibPlug
 *
ug
,

220 cڡ 
RCLibPlugDa
 *
ug_da
, 
gpor
 
da
)

222 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

223 
GtkTeIr
 

;

224 
gch
 *
xt
;

225 cڡ 
gch
 *
ty_r
 = 
GTK_STOCK_EXECUTE
;

226 
gboޗn
 
aivab
 = 
TRUE
;

227 
gboޗn
 
lded
;

228 if(
ug_da
==
NULL
 ||lug_da->
fo
==NULL) ;

229 
	`gtk_li_e_nd
(
iv
->
ug_e
, &

);

230 
lded
 = 
ug_da
->loaded;

231 if(
ug_da
->
fo
->
ty
==
RCLIB_PLUGIN_TYPE_LOADER
)

233 
ty_r
 = 
GTK_STOCK_PREFERENCES
;

234 
aivab
 = 
FALSE
;

235 
lded
 = 
TRUE
;

237 
xt
 = 
	`g_mkup_tf_esd
("<b>%s</b>\n%s", 
ug_da
->
fo
->
me
,

238 
ug_da
->
fo
->
desti
);

239 
	`gtk_li_e_t
(
iv
->
ug_e
, &

,

240 
RC_UI_PLUGIN_STORE_ACTIVATABLE
, 
aivab
,

241 
RC_UI_PLUGIN_STORE_ENABLED
, 
lded
, 
RC_UI_PLUGIN_STORE_TYPE
,

242 
ty_r
, 
RC_UI_PLUGIN_STORE_ID
, 
ug_da
->
fo
->
id
,

243 
RC_UI_PLUGIN_STORE_TEXT
, 
xt
, -1);

244 
	`g_
(
xt
);

245 
	}
}

247 
	$rc_ui_ug_lded_cb
(
RCLibPlug
 *
ug
,

248 cڡ 
RCLibPlugDa
 *
ug_da
, 
gpor
 
da
)

250 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

251 
GtkTeIr
 

;

252 if(
ug_da
==
NULL
 ||lug_da->
fo
==NULL) ;

253 if(!
	`rc_ui_ug_g__by_id
(
ug_da
->
fo
->
id
, &

))

255 
	`gtk_li_e_t
(
iv
->
ug_e
, &

, 
RC_UI_PLUGIN_STORE_ENABLED
,

256 
ug_da
->
lded
, -1);

257 
	}
}

259 
	$rc_ui_ug_uded_cb
(
RCLibPlug
 *
ug
,

260 cڡ 
RCLibPlugDa
 *
ug_da
, 
gpor
 
da
)

262 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

263 
GtkTeIr
 

;

264 if(
ug_da
==
NULL
 ||lug_da->
fo
==NULL) ;

265 if(!
	`rc_ui_ug_g__by_id
(
ug_da
->
fo
->
id
, &

))

267 
	`gtk_li_e_t
(
iv
->
ug_e
, &

, 
RC_UI_PLUGIN_STORE_ENABLED
,

268 
ug_da
->
lded
, -1);

269 
	}
}

271 
	$rc_ui_ug_uegied_cb
(
RCLibPlug
 *
ug
,

272 cڡ 
gch
 *
id
, 
gpor
 
da
)

274 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

275 
GtkTeIr
 

;

276 if(
id
==
NULL
) ;

277 if(!
	`rc_ui_ug_g__by_id
(
id
, &

))

279 
	`gtk_li_e_move
(
iv
->
ug_e
, &

);

280 
	}
}

282 
	$rc_ui_ug_da_fܗch
(
gpor
 
key
, gpo
vue
,

283 
gpor
 
da
)

285 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

286 
GtkTeIr
 

;

287 
gch
 *
xt
;

288 cڡ 
gch
 *
ty_r
 = 
GTK_STOCK_EXECUTE
;

289 
gboޗn
 
aivab
 = 
TRUE
;

290 
gboޗn
 
lded
;

291 
RCLibPlugDa
 *
ug_da
 = (RCLibPlugD*)
vue
;

292 if(
vue
==
NULL
 || 
ug_da
->
fo
==NULL) ;

293 
	`gtk_li_e_nd
(
iv
->
ug_e
, &

);

294 
lded
 = 
ug_da
->loaded;

295 if(
ug_da
->
fo
->
ty
==
RCLIB_PLUGIN_TYPE_LOADER
)

297 
ty_r
 = 
GTK_STOCK_PREFERENCES
;

298 
aivab
 = 
FALSE
;

299 
lded
 = 
TRUE
;

301 
xt
 = 
	`g_mkup_tf_esd
("<b>%s</b>\n%s", 
ug_da
->
fo
->
me
,

302 
ug_da
->
fo
->
desti
);

303 
	`gtk_li_e_t
(
iv
->
ug_e
, &

,

304 
RC_UI_PLUGIN_STORE_ACTIVATABLE
, 
aivab
,

305 
RC_UI_PLUGIN_STORE_ENABLED
, 
lded
, 
RC_UI_PLUGIN_STORE_TYPE
,

306 
ty_r
, 
RC_UI_PLUGIN_STORE_ID
, 
ug_da
->
fo
->
id
,

307 
RC_UI_PLUGIN_STORE_TEXT
, 
xt
, -1);

308 
	`g_
(
xt
);

309 
	}
}

311 
gboޗn
 
	$rc_ui_ug_wdow_key_ess_cb
(
GtkWidg
 *
widg
,

312 
GdkEvt
 *
evt
, 
gpor
 
da
)

314 
gut
 
keyv
 = 
evt
->
key
.keyval;

315 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

316 if(
keyv
==
GDK_KEY_Es
)

317 
	`gtk_widg_deroy
(
iv
->
ug_wdow
);

318  
FALSE
;

319 
	}
}

321 
le
 
	$rc_ui_ug_wdow_
()

323 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

324 
GtkWidg
 *
ma_grid
;

325 
GtkWidg
 *
li_sdw
;

326 
GtkWidg
 *
ug_bu_hbox
;

327 
GtkWidg
 *
o_bu_hbox
;

328 
GtkWidg
 *
o_bu
;

329 
GtkClRd
 *
ab_nd
;

330 
GtkClRd
 *
xt_nd
;

331 
GtkClRd
 *
ty_nd
;

332 
GtkTeVwCumn
 *
ab_cumn
;

333 
GtkTeVwCumn
 *
ty_cumn
;

334 
GtkTeVwCumn
 *
xt_cumn
;

335 
GtkTeSei
 *
i
;

336 
GdkGeomry
 
wdow_hts
 =

338 .
m_width
 = 300,

339 .
m_height
 = 200,

340 .
ba_width
 = 350,

341 .
ba_height
 = 300

343 if(
iv
->
ug_wdow
!=
NULL
) ;

344 
iv
->
ug_wdow
 = 
	`gtk_wdow_w
(
GTK_WINDOW_TOPLEVEL
);

345 
ma_grid
 = 
	`gtk_grid_w
();

346 
iv
->
about_bu
 = 
	`gtk_bu_w_om_ock
(
GTK_STOCK_ABOUT
);

347 
iv
->
cfig_bu
 = 
	`gtk_bu_w_om_ock
(
GTK_STOCK_PREFERENCES
);

348 
o_bu
 = 
	`gtk_bu_w_om_ock
(
GTK_STOCK_CLOSE
);

349 
li_sdw
 = 
	`gtk_sd_wdow_w
(
NULL
, NULL);

350 
iv
->
ug_e
 = 
	`gtk_li_e_w
(
RC_UI_PLUGIN_STORE_LAST
,

351 
G_TYPE_BOOLEAN
, G_TYPE_BOOLEAN, 
G_TYPE_STRING
, G_TYPE_STRING,

352 
G_TYPE_STRING
, G_TYPE_STRING);

353 
iv
->
ug_livw
 = 
	`gtk__vw_w_wh_mod
(
	`GTK_TREE_MODEL
(

354 
iv
->
ug_e
));

355 
	`g_obje_uef
(
iv
->
ug_e
);

356 
ab_nd
 = 
	`gtk__nd_togg_w
();

357 
xt_nd
 = 
	`gtk__nd_xt_w
();

358 
ty_nd
 = 
	`gtk__nd_pixbuf_w
();

359 
	`g_obje_t
(
xt_nd
, "lsize", 
PANGO_ELLIPSIZE_END
,

360 "lsize-t", 
TRUE
, 
NULL
);

361 
ab_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
(

362 "Ebd", 
ab_nd
, "aive", 
RC_UI_PLUGIN_STORE_ENABLED
,

363 "aivab", 
RC_UI_PLUGIN_STORE_ACTIVATABLE
, 
NULL
);

364 
ty_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
("Type",

365 
ty_nd
, "ock-id", 
RC_UI_PLUGIN_STORE_TYPE
, 
NULL
);

366 
xt_cumn
 = 
	`gtk__vw_cumn_w_wh_ibus
("Information",

367 
xt_nd
, "mkup", 
RC_UI_PLUGIN_STORE_TEXT
, 
NULL
);

368 
	`gtk__vw_cumn_t_exnd
(
xt_cumn
, 
TRUE
);

369 
	`gtk__vw_t_hds_visib
(
	`GTK_TREE_VIEW
(
iv
->
ug_livw
),

370 
FALSE
);

371 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
iv
->
ug_livw
),

372 
ab_cumn
);

373 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
iv
->
ug_livw
),

374 
ty_cumn
);

375 
	`gtk__vw_nd_cumn
(
	`GTK_TREE_VIEW
(
iv
->
ug_livw
),

376 
xt_cumn
);

377 
	`g_obje_t
(
ty_cumn
, "sizg", 
GTK_TREE_VIEW_COLUMN_FIXED
,

378 "fixed-width", 30, "m-width", 30, "max-width", 30, 
NULL
);

379 
	`g_obje_t
(
iv
->
ug_wdow
, "t", 
	`_
("Plug-in Configuration"),

380 "wdow-posi", 
GTK_WIN_POS_CENTER
, "has-size-gr", 
FALSE
,

382 
GTK_STOCK_EXECUTE
, "ty-ht", 
GDK_WINDOW_TYPE_HINT_DIALOG
,

383 
NULL
);

384 
	`gtk_wdow_t_geomry_hts
(
	`GTK_WINDOW
(
iv
->
ug_wdow
),

385 
	`GTK_WIDGET
(
iv
->
ug_wdow
), &
wdow_hts
,

386 
GDK_HINT_MIN_SIZE
);

387 
	`g_obje_t
(
iv
->
ug_livw
, "exnd", 
TRUE
, 
NULL
);

388 
	`gtk_sd_wdow_t_picy
(
	`GTK_SCROLLED_WINDOW
(
li_sdw
),

389 
GTK_POLICY_NEVER
, 
GTK_POLICY_AUTOMATIC
);

390 
	`rib_ug_fܗch
(
rc_ui_ug_da_fܗch
, 
iv
);

391 
ug_bu_hbox
 = 
	`gtk_bu_box_w
(
GTK_ORIENTATION_HORIZONTAL
);

392 
	`g_obje_t
(
ug_bu_hbox
, "yout-y", 
GTK_BUTTONBOX_END
,

393 "hexnd-t", 
TRUE
, "hexpand", TRUE, "spacing", 4,

395 "mg-btom", 4, 
NULL
);

396 
o_bu_hbox
 = 
	`gtk_bu_box_w
(
GTK_ORIENTATION_HORIZONTAL
);

397 
	`g_obje_t
(
o_bu_hbox
, "yout-y", 
GTK_BUTTONBOX_END
,

398 "hexnd-t", 
TRUE
, "hexpand", TRUE, "spacing", 4,

400 "mg-btom", 4, 
NULL
);

401 
	`g_obje_t
(
iv
->
about_bu
, "nsive", 
FALSE
, 
NULL
);

402 
	`g_obje_t
(
iv
->
cfig_bu
, "nsive", 
FALSE
, 
NULL
);

403 
	`gtk_box_ck_t
(
	`GTK_BOX
(
ug_bu_hbox
), 
iv
->
about_bu
,

404 
FALSE
, FALSE, 2);

405 
	`gtk_box_ck_t
(
	`GTK_BOX
(
ug_bu_hbox
), 
iv
->
cfig_bu
,

406 
FALSE
, FALSE, 2);

407 
	`gtk_box_ck_t
(
	`GTK_BOX
(
o_bu_hbox
), 
o_bu
, 
FALSE
,

408 
FALSE
, 2);

409 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
li_sdw
), 
iv
->
ug_livw
);

410 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
li_sdw
, 0, 0, 1, 1);

411 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
ug_bu_hbox
, 0, 1, 1, 1);

412 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
o_bu_hbox
, 0, 2, 1, 1);

413 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
ug_wdow
), 
ma_grid
);

414 
i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

415 
iv
->
ug_livw
));

416 
	`g_sigl_c
(
ab_nd
, "toggled",

417 
	`G_CALLBACK
(
rc_ui_ug_toggd
), 
NULL
);

418 
	`g_sigl_c
(
i
, "changed",

419 
	`G_CALLBACK
(
rc_ui_ug_i_chged
), 
NULL
);

420 
	`g_sigl_c
(
iv
->
about_bu
, "clicked",

421 
	`G_CALLBACK
(
rc_ui_ug_about_bu_icked
), 
NULL
);

422 
	`g_sigl_c
(
iv
->
cfig_bu
, "clicked",

423 
	`G_CALLBACK
(
rc_ui_ug_cfig_bu_icked
), 
NULL
);

424 
	`g_sigl_c
(
o_bu
, "clicked",

425 
	`G_CALLBACK
(
rc_ui_ug_o_bu_icked
), 
NULL
);

426 
	`g_sigl_c
(
iv
->
ug_wdow
, "key-press-event",

427 
	`G_CALLBACK
(
rc_ui_ug_wdow_key_ess_cb
), 
NULL
);

428 
	`g_sigl_c
(
	`G_OBJECT
(
iv
->
ug_wdow
), "destroy",

429 
	`G_CALLBACK
(
rc_ui_ug_wdow_deroy_cb
), 
NULL
);

430 
iv
->
gied_id
 = 
	`rib_ug_sigl_c
("registered",

431 
	`G_CALLBACK
(
rc_ui_ug_gied_cb
), 
NULL
);

432 
iv
->
lded_id
 = 
	`rib_ug_sigl_c
("loaded",

433 
	`G_CALLBACK
(
rc_ui_ug_lded_cb
), 
NULL
);

434 
iv
->
uded_id
 = 
	`rib_ug_sigl_c
("unloaded",

435 
	`G_CALLBACK
(
rc_ui_ug_uded_cb
), 
NULL
);

436 
iv
->
uegied_id
 = 
	`rib_ug_sigl_c
("unregistered",

437 
	`G_CALLBACK
(
rc_ui_ug_uegied_cb
), 
NULL
);

438 
	`gtk_widg_show_l
(
iv
->
ug_wdow
);

439 
	}
}

448 
	$rc_ui_ug_wdow_show
()

450 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

451 if(
iv
->
ug_wdow
==
NULL
)

452 
	`rc_ui_ug_wdow_
();

454 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
iv
->
ug_wdow
));

455 
	}
}

463 
	$rc_ui_ug_wdow_deroy
()

465 
RCUiPlugPrive
 *
iv
 = &
ug_iv
;

466 if(
iv
->
ug_wdow
!=
NULL
)

467 
	`gtk_widg_deroy
(
iv
->
ug_wdow
);

468 
	}
}

	@ui/rc-ui-plugin.h

25 #ide
HAVE_RC_UI_PLUGIN_H


26 
	#HAVE_RC_UI_PLUGIN_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<gtk/gtk.h
>

31 
	~<rib.h
>

33 
G_BEGIN_DECLS


35 
rc_ui_ug_wdow_show
();

36 
rc_ui_ug_wdow_deroy
();

38 
	gG_END_DECLS


	@ui/rc-ui-resources.c

1 
	~<gio/gio.h
>

3 #i
defed
 (
__ELF__
&& ( 
__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 6))

4 
	#SECTION
 
	`__ibu__
 ((
	`i
 (".gsour.rc_ui_sours"), 
	`igd
 (8)))

	)

6 
	#SECTION


	)

9 cڡ 
SECTION
 uni { cڡ 
gut8
 
	mda
[10040]; cڡ 
	mignmt
; * cڡ 
	mr
;} 
	grc_ui_sours_sour_da
 = { {

1267 
GSticResour
 
	gic_sour
 = { 
rc_ui_sours_sour_da
.
da
,  (rc_ui_resources_resource_data.data) };

1268 
GResour
 *
rc_ui_sours_g_sour
 ();

1269 
GResour
 *
	$rc_ui_sours_g_sour
 ()

1271  
	`g_ic_sour_g_sour
 (&
ic_sour
);

1272 
	}
}

1291 #i 
__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 7)

1293 
	#G_HAS_CONSTRUCTORS
 1

	)

1295 
	#G_DEFINE_CONSTRUCTOR
(
_func

	`__ibu__
((
cڡru
)
	`_func
 ();

	)

1296 
	#G_DEFINE_DESTRUCTOR
(
_func

	`__ibu__
((
deru
)
	`_func
 ();

	)

1298 #i
defed
 (
_MSC_VER
) && (_MSC_VER >= 1500)

1301 
	#G_HAS_CONSTRUCTORS
 1

	)

1303 
	#G_DEFINE_CONSTRUCTOR
(
_func
) \

1304 
	`_func
(); \

1305 
_func
 ## 
	`_w
({ 
	`_func
();  0; } \

1306 
	`__agma
(
	`i
(".CRT$XCU",
ad
)) \

1307 
	`__deec
(
	`lo
(".CRT$XCU")(* 
_y
 ## 
_func
)(_fun## 
_w
;

	)

1309 
	#G_DEFINE_DESTRUCTOR
(
_func
) \

1310 
	`_func
(); \

1311 
_func
 ## 
	`_cڡru
({ 
	`ex
 (_func);  0; } \

1312 
	`__agma
(
	`i
(".CRT$XCU",
ad
)) \

1313 
	`__deec
(
	`lo
(".CRT$XCU")(* 
_y
 ## 
_func
)(_fun## 
_cڡru
;

	)

1315 #i
defed
 (
_MSC_VER
)

1317 
	#G_HAS_CONSTRUCTORS
 1

	)

1320 
	#G_DEFINE_CONSTRUCTOR_NEEDS_PRAGMA
 1

	)

1321 
	#G_DEFINE_DESTRUCTOR_NEEDS_PRAGMA
 1

	)

1323 
	#G_DEFINE_CONSTRUCTOR_PRAGMA_ARGS
(
_func
) \

1324 
	`i
(".CRT$XCU",
ad
)

	)

1325 
	#G_DEFINE_CONSTRUCTOR
(
_func
) \

1326 
	`_func
(); \

1327 
_func
 ## 
	`_w
({ 
	`_func
();  0; } \

1328 
	`__deec
(
	`lo
(".CRT$XCU")(*
p
)(
_func
 ## 
_w
;

	)

1330 
	#G_DEFINE_DESTRUCTOR_PRAGMA_ARGS
(
_func
) \

1331 
	`i
(".CRT$XCU",
ad
)

	)

1332 
	#G_DEFINE_DESTRUCTOR
(
_func
) \

1333 
	`_func
(); \

1334 
_func
 ## 
	`_cڡru
({ 
	`ex
 (_func);  0; } \

1335 
	`__deec
(
	`lo
(".CRT$XCU")(* 
_y
 ## 
_func
)(_fun## 
_cڡru
;

	)

1337 #i
defed
(
__SUNPRO_C
)

1343 
	#G_HAS_CONSTRUCTORS
 1

	)

1345 
	#G_DEFINE_CONSTRUCTOR_NEEDS_PRAGMA
 1

	)

1346 
	#G_DEFINE_DESTRUCTOR_NEEDS_PRAGMA
 1

	)

1348 
	#G_DEFINE_CONSTRUCTOR_PRAGMA_ARGS
(
_func
) \

1349 
	`
(
_func
)

	)

1350 
	#G_DEFINE_CONSTRUCTOR
(
_func
) \

1351 
	`_func
();

	)

1353 
	#G_DEFINE_DESTRUCTOR_PRAGMA_ARGS
(
_func
) \

1354 
	`fi
(
_func
)

	)

1355 
	#G_DEFINE_DESTRUCTOR
(
_func
) \

1356 
	`_func
();

	)

1365 #ifde
G_HAS_CONSTRUCTORS


1367 #ifde
G_DEFINE_CONSTRUCTOR_NEEDS_PRAGMA


1368 #agm
G_DEFINE_CONSTRUCTOR_PRAGMA_ARGS
(
sour_cڡru
)

1370 
	$G_DEFINE_CONSTRUCTOR
(
sour_cڡru
)

1371 #ifde
G_DEFINE_DESTRUCTOR_NEEDS_PRAGMA


1372 #agm
	`G_DEFINE_DESTRUCTOR_PRAGMA_ARGS
(
sour_deru
)

1374 
	$G_DEFINE_DESTRUCTOR
(
sour_deru
)

1380 
	$sour_cڡru
 ()

1382 
	`g_ic_sour_
 (&
ic_sour
);

1383 
	}
}

1385 
	$sour_deru
 ()

1387 
	`g_ic_sour_fi
 (&
ic_sour
);

1388 
	}
}

	@ui/rc-ui-resources.h

1 #ide
__RESOURCE_rc_ui_sours_H__


2 
	#__RESOURCE_rc_ui_sours_H__


	)

4 
	~<gio/gio.h
>

6 
GResour
 *
rc_ui_sours_g_sour
 ();

	@ui/rc-ui-set-star-inline.h

3 #ifde
__SUNPRO_C


4 #agm
ign
 4 (
rc_ui_t__le
)

6 #ifde
__GNUC__


7 cڡ 
gut8
 
	grc_ui_t__le
[] 
__ibu__
 ((
__igd__
 (4))) =

9 cڡ 
gut8
 
rc_ui_t__le
[] =

	@ui/rc-ui-settings.c

26 
	~"rc-ui-gs.h
"

27 
	~"rc-comm.h
"

28 
	~"rc-ui-y.h
"

29 
	~"rc-ui-ay.h
"

30 
	~"rc-ui-limod.h
"

31 
	~"rc-ui-livw.h
"

32 
	~"rc-ui-wdow.h
"

33 
	~"rc-ui-dlog.h
"

44 
	sRCUiStgsPrive


46 
GtkWidg
 *
	mgs_wdow
;

47 
GtkWidg
 *
	mgs_nebook
;

48 
GtkWidg
 *
	mg_auty_check_bu
;

49 
GtkWidg
 *
	mg_ldϡ_check_bu
;

50 
GtkWidg
 *
	mg_may_check_bu
;

51 
GtkWidg
 *
	mg_mo_check_bu
;

52 
GtkWidg
 *
	m_autnc_check_bu
;

53 
GtkWidg
 *
	m_id3c_y
;

54 
GtkWidg
 *
	m_nc_y
;

55 
GtkWidg
 *
	m_ldlgc_bu
;

56 
GtkWidg
 *
	mr_dihm_check_bu
;

57 
GtkWidg
 *
	mr_theme_combo_box
;

58 
GtkWidg
 *
	mif_hidecovimg_check_bu
;

59 
GtkWidg
 *
	mif_hidrc_check_bu
;

60 
GtkWidg
 *
	mif_hider_check_bu
;

61 
GtkWidg
 *
	mif_muicumn_check_bu
;

62 
GtkWidg
 *
	mif_tfm_y
;

63 
GtkWidg
 *
	mif_tfm_grid
;

64 
GtkWidg
 *
	mif_showcumn_ame
;

65 
GtkWidg
 *
	mif_showcumn_check_bu
;

66 
GtkWidg
 *
	mif_showcumn_check_bu
;

67 
GtkWidg
 *
	mif_showcumn_check_bu
;

68 
GtkWidg
 *
	mif_showyecumn_check_bu
;

69 
GtkWidg
 *
	mif_showcumn_check_bu
;

70 
GtkWidg
 *
	mif_showcumn_check_bu
;

71 }
	tRCUiStgsPrive
;

73 
RCUiStgsPrive
 
	ggs_iv
 = {0};

75 
	$rc_ui_gs_o_bu_icked
(
GtkBu
 *
bu
,

76 
gpor
 
da
)

78 
RCUiStgsPrive
 *
iv
 = &
gs_iv
;

79 
	`gtk_widg_deroy
(
iv
->
gs_wdow
);

80 
	}
}

82 
	$rc_ui_gs_wdow_deroy_cb
(
GtkWidg
 *
widg
, 
gpor
 
da
)

84 
RCUiStgsPrive
 *
iv
 = &
gs_iv
;

85 
	`gtk_widg_deroyed
(
iv
->
gs_wdow
, &(priv->settings_window));

86 
	}
}

88 
	$rc_ui_gs_g_auty_toggd
(
GtkToggBu
 *
bu
,

89 
gpor
 
da
)

91 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

92 
	`rib_gs_t_boޗn
("Py", "AutoPyWhSup", 
ag
);

93 
	}
}

95 
	$rc_ui_gs_g_ldϡ_toggd
(
GtkToggBu
 *
bu
,

96 
gpor
 
da
)

98 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

99 
	`rib_gs_t_boޗn
("Py", "LdLaPosi", 
ag
);

100 
	}
}

102 
	$rc_ui_gs_g_may_toggd
(
GtkToggBu
 *
bu
,

103 
gpor
 
da
)

105 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

106 
	`rib_gs_t_boޗn
("MaUI", "MimizeToTy", 
ag
);

107 
	}
}

109 
	$rc_ui_gs_g_mo_toggd
(
GtkToggBu
 *
bu
,

110 
gpor
 
da
)

112 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

113 
	`rib_gs_t_boޗn
("MaUI", "MimizeWhClo", 
ag
);

114 
	}
}

116 
le
 
GtkWidg
 *
	$rc_ui_gs_g_bud
(

117 
RCUiStgsPrive
 *
iv
)

119 
GtkWidg
 *
g_grid
;

120 
GtkWidg
 *
ame_b
;

121 
GtkWidg
 *
g_ame
;

122 
GtkWidg
 *
g_ame_grid
;

123 
g_grid
 = 
	`gtk_grid_w
();

124 
iv
->
g_auty_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

125 
	`_
("_Autolay on startup"));

126 
iv
->
g_ldϡ_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

127 
	`_
("_Loadheastlayingosition"));

128 
iv
->
g_may_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

129 
	`_
("Minimizeo _tray"));

130 
iv
->
g_mo_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

131 
	`_
("Minimizehe window ifhe _close button is clicked"));

132 
g_ame
 = 
	`gtk_ame_w
(
NULL
);

133 
ame_b
 = 
	`gtk_b_w
(
NULL
);

134 
	`gtk_b_t_mkup
(
	`GTK_LABEL
(
ame_b
), 
	`_
("<b>General</b>"));

135 
	`g_obje_t
(
g_ame
, "b-widg", 
ame_b
, "shadow-type",

136 
GTK_SHADOW_NONE
, "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

137 
g_ame_grid
 = 
	`gtk_grid_w
();

138 
	`g_obje_t
(
iv
->
g_auty_check_bu
, "active",

139 
	`rib_gs_g_boޗn
("Py", "AutoPyWhSup", 
NULL
),

140 
NULL
);

141 
	`g_obje_t
(
iv
->
g_ldϡ_check_bu
, "active",

142 
	`rib_gs_g_boޗn
("Py", "LdLaPosi", 
NULL
),

143 
NULL
);

144 
	`g_obje_t
(
iv
->
g_may_check_bu
, "active",

145 
	`rib_gs_g_boޗn
("MaUI", "MimizeToTy", 
NULL
),

146 
NULL
);

147 
	`g_obje_t
(
iv
->
g_mo_check_bu
, "active",

148 
	`rib_gs_g_boޗn
("MaUI", "MimizeWhClo", 
NULL
),

149 
NULL
);

150 
	`gtk_grid_ch
(
	`GTK_GRID
(
g_ame_grid
),

151 
iv
->
g_auty_check_bu
, 0, 0, 1, 1);

152 
	`gtk_grid_ch
(
	`GTK_GRID
(
g_ame_grid
),

153 
iv
->
g_ldϡ_check_bu
, 0, 1, 1, 1);

154 
	`gtk_grid_ch
(
	`GTK_GRID
(
g_ame_grid
),

155 
iv
->
g_may_check_bu
, 0, 2, 1, 1);

156 
	`gtk_grid_ch
(
	`GTK_GRID
(
g_ame_grid
),

157 
iv
->
g_mo_check_bu
, 0, 3, 1, 1);

158 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
g_ame
), 
g_ame_grid
);

159 
	`gtk_grid_ch
(
	`GTK_GRID
(
g_grid
), 
g_ame
, 0, 0,

161 
	`g_sigl_c
(
iv
->
g_auty_check_bu
, "toggled",

162 
	`G_CALLBACK
(
rc_ui_gs_g_auty_toggd
), 
NULL
);

163 
	`g_sigl_c
(
iv
->
g_ldϡ_check_bu
, "toggled",

164 
	`G_CALLBACK
(
rc_ui_gs_g_ldϡ_toggd
), 
NULL
);

165 
	`g_sigl_c
(
iv
->
g_may_check_bu
, "toggled",

166 
	`G_CALLBACK
(
rc_ui_gs_g_may_toggd
), 
NULL
);

167 
	`g_sigl_c
(
iv
->
g_mo_check_bu
, "toggled",

168 
	`G_CALLBACK
(
rc_ui_gs_g_mo_toggd
), 
NULL
);

169  
g_grid
;

170 
	}
}

172 
	$rc_ui_gs__autnc_toggd
(
GtkToggBu
 *
bu
,

173 
gpor
 
da
)

175 
RCUiStgsPrive
 *
iv
 = &
gs_iv
;

176 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

177 
gch
 *
codg
, *
id3_codg
;

178 
	`rib_gs_t_boޗn
("Mada", "AutoDeEncodg", 
ag
);

179 
	`g_obje_t
(
iv
->
_id3c_y
, "nsive", !
ag
, 
NULL
);

180 
	`g_obje_t
(
iv
->
_nc_y
, "nsive", !
ag
, 
NULL
);

181 if(
ag
)

183 
codg
 = 
	`rib_ut_de_codg_by_lo
();

184 if(
codg
!=
NULL
 && 
	`
(encoding)>0)

186 
id3_codg
 = 
	`g_rdup_tf
("%s:UTF-8", 
codg
);

187 
	`rib_lyric_t_back_codg
(
codg
);

188 
	`rib_gs_t_rg
("Mada", "LyricEncodg", 
codg
);

189 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
_nc_y
), 
codg
);

190 
	`rib_g_t_back_codg
(
id3_codg
);

191 
	`rib_gs_t_rg
("Metadata", "ID3Encoding",

192 
id3_codg
);

193 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
_id3c_y
),

194 
id3_codg
);

195 
	`g_
(
id3_codg
);

197 
	`g_
(
codg
);

199 
	}
}

201 
	$rc_ui_gs__id3c_chged
(
GtkEdab
 *
edab
,

202 
gpor
 
da
)

204 cڡ 
gch
 *
xt
;

205 
xt
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
edab
));

206 
	`rib_gs_t_rg
("Mada", "ID3Encodg", 
xt
);

207 
	}
}

209 
	$rc_ui_gs__nc_chged
(
GtkEdab
 *
edab
,

210 
gpor
 
da
)

212 cڡ 
gch
 *
xt
;

213 
xt
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
edab
));

214 
	`rib_gs_t_rg
("Mada", "LyricEncodg", 
xt
);

215 
	}
}

217 
le
 
GtkWidg
 *
	$rc_ui_gs_ayli_bud
(

218 
RCUiStgsPrive
 *
iv
)

220 
GtkWidg
 *
ayli_grid
;

221 
GtkWidg
 *
ame_b
;

222 
GtkWidg
 *
mada_ame
;

223 
GtkWidg
 *
mada_ame_grid
;

224 
GtkWidg
 *
mada_id3c_b
;

225 
GtkWidg
 *
mada_nc_b
;

226 
GtkWidg
 *
gacy_ame
;

227 
GtkWidg
 *
gacy_ame_grid
;

228 
GtkWidg
 *
gacy_bu_box
;

229 
gch
 *
rg
;

230 
ayli_grid
 = 
	`gtk_grid_w
();

231 
iv
->
_autnc_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

232 
	`_
("_Autoncoding detect (use systemanguage settings)"));

233 
iv
->
_id3c_y
 = 
	`gtk_y_w
();

234 
iv
->
_nc_y
 = 
	`gtk_y_w
();

235 
iv
->
_ldlgc_bu
 = 
	`gtk_bu_w_wh_mmic
(

236 
	`_
("Loadlaylist from _legacy version"));

237 
mada_id3c_b
 = 
	`gtk_b_w
(

238 
	`_
("ID3 Tag fallback characterncodings"));

239 
mada_nc_b
 = 
	`gtk_b_w
(

240 
	`_
("Lyricext fallback characterncodings"));

241 
mada_ame
 = 
	`gtk_ame_w
(
NULL
);

242 
ame_b
 = 
	`gtk_b_w
(
NULL
);

243 
	`gtk_b_t_mkup
(
	`GTK_LABEL
(
ame_b
), 
	`_
("<b>Metadata</b>"));

244 
	`g_obje_t
(
mada_ame
, "b-widg", 
ame_b
, "shadow-type",

245 
GTK_SHADOW_NONE
, "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

246 
mada_ame_grid
 = 
	`gtk_grid_w
();

247 
	`g_obje_t
(
iv
->
_id3c_y
, "margin-left", 2, "margin-right",

248 2, "mg-t", 2, "mg-btom", 2, "hexnd-t", 
TRUE
,

249 "hexnd", 
TRUE
, 
NULL
);

250 
	`g_obje_t
(
iv
->
_nc_y
, "margin-left", 2, "margin-right",

251 2, "mg-t", 2, "mg-btom", 2, "hexnd-t", 
TRUE
,

252 "hexnd", 
TRUE
, 
NULL
);

253 
gacy_ame
 = 
	`gtk_ame_w
(
NULL
);

254 
ame_b
 = 
	`gtk_b_w
(
NULL
);

255 
	`gtk_b_t_mkup
(
	`GTK_LABEL
(
ame_b
), 
	`_
("<b>Legacy Support</b>"));

256 
	`g_obje_t
(
gacy_ame
, "b-widg", 
ame_b
, "shadow-type",

257 
GTK_SHADOW_NONE
, "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

258 
gacy_ame_grid
 = 
	`gtk_grid_w
();

259 
gacy_bu_box
 = 
	`gtk_bu_box_w
(
GTK_ORIENTATION_HORIZONTAL
);

260 
	`g_obje_t
(
gacy_bu_box
, "margin-left", 2, "margin-right",

261 2, "mg-t", 2, "mg-btom", 2, "hexnd-t", 
TRUE
,

262 "hexnd", 
TRUE
, 
NULL
, "yout-y", 
GTK_BUTTONBOX_CENTER
,

263 "acg", 5, 
NULL
);

264 if(
	`rib_gs_g_boޗn
("Mada", "AutoDeEncodg", 
NULL
))

266 
	`g_obje_t
(
iv
->
_autnc_check_bu
, "aive", 
TRUE
, 
NULL
);

267 
	`g_obje_t
(
iv
->
_id3c_y
, "nsive", 
FALSE
, 
NULL
);

268 
	`g_obje_t
(
iv
->
_nc_y
, "nsive", 
FALSE
, 
NULL
);

270 
rg
 = 
	`rib_gs_g_rg
("Mada", "ID3Encodg", 
NULL
);

271 if(
rg
!=
NULL
)

272 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
_id3c_y
), 
rg
);

273 
	`g_
(
rg
);

274 
rg
 = 
	`rib_gs_g_rg
("Mada", "LyricEncodg", 
NULL
);

275 if(
rg
!=
NULL
)

276 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
_nc_y
), 
rg
);

277 
	`g_
(
rg
);

278 
	`gtk_grid_ch
(
	`GTK_GRID
(
mada_ame_grid
),

279 
iv
->
_autnc_check_bu
, 0, 0, 2, 1);

280 
	`gtk_grid_ch
(
	`GTK_GRID
(
mada_ame_grid
),

281 
mada_id3c_b
, 0, 1, 1, 1);

282 
	`gtk_grid_ch
(
	`GTK_GRID
(
mada_ame_grid
),

283 
iv
->
_id3c_y
, 1, 1, 1, 1);

284 
	`gtk_grid_ch
(
	`GTK_GRID
(
mada_ame_grid
),

285 
mada_nc_b
, 0, 2, 1, 1);

286 
	`gtk_grid_ch
(
	`GTK_GRID
(
mada_ame_grid
),

287 
iv
->
_nc_y
, 1, 2, 1, 1);

288 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
mada_ame
), 
mada_ame_grid
);

289 
	`gtk_box_ck_t
(
	`GTK_BOX
(
gacy_bu_box
), 
iv
->
_ldlgc_bu
,

290 
FALSE
, FALSE, 2);

291 
	`gtk_grid_ch
(
	`GTK_GRID
(
gacy_ame_grid
), 
gacy_bu_box
,

293 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
gacy_ame
), 
gacy_ame_grid
);

294 
	`gtk_grid_ch
(
	`GTK_GRID
(
ayli_grid
), 
mada_ame
, 0, 0,

296 
	`gtk_grid_ch
(
	`GTK_GRID
(
ayli_grid
), 
gacy_ame
, 0, 1,

298 
	`g_sigl_c
(
iv
->
_autnc_check_bu
, "toggled",

299 
	`G_CALLBACK
(
rc_ui_gs__autnc_toggd
), 
NULL
);

300 
	`g_sigl_c
(
iv
->
_id3c_y
, "changed",

301 
	`G_CALLBACK
(
rc_ui_gs__id3c_chged
), 
NULL
);

302 
	`g_sigl_c
(
iv
->
_nc_y
, "changed",

303 
	`G_CALLBACK
(
rc_ui_gs__nc_chged
), 
NULL
);

304 
	`g_sigl_c
(
iv
->
_ldlgc_bu
, "clicked",

305 
	`G_CALLBACK
(
rc_ui_dlog_show_ld_gacy
), 
NULL
);

306  
ayli_grid
;

307 
	}
}

309 
	$rc_ui_gs_r_theme_chged
(
GtkComboBox
 *
widg
,

310 
gpor
 
da
)

312 
GtkTeMod
 *
mod
;

313 
GtkTeIr
 

;

314 
gch
 *
theme
;

315 
gch
 *
theme_gs
;

316 
gch
 *
theme_fe
;

317 
gboޗn
 
embedded_ag
;

318 
gboޗn
 
theme_ag
 = 
FALSE
;

319 
mod
 = 
	`gtk_combo_box_g_mod
(
widg
);

320 if(
mod
==
NULL
) ;

321 if(!
	`gtk_combo_box_g_aive_
(
widg
, &

)) ;

322 
	`gtk__mod_g
(
mod
, &

, 1, &
embedded_ag
, 2, &
theme
, -1);

323 if(
embedded_ag
)

325 
theme_gs
 = 
	`g_rdup_tf
("embedded-theme:%s", 
theme
);

326 
theme_ag
 = 
	`rc_ui_y_embedded_theme_t_by_me
(
theme
);

327 if(
theme_ag
)

328 
	`rib_gs_t_rg
("MaUI", "Theme", 
theme_gs
);

329 
	`g_
(
theme_gs
);

333 
theme_fe
 = 
	`g_bud_fame
(
theme
, "gtk3.css", 
NULL
);

334 
theme_ag
 = 
	`rc_ui_y_css_t_fe
(
theme_fe
);

335 
	`g_
(
theme_fe
);

336 if(
theme_ag
)

337 
	`rib_gs_t_rg
("MaUI", "Theme", 
theme
);

339 
	`g_
(
theme
);

341 
	}
}

343 
	$rc_ui_gs_r_dihm_toggd
(
GtkToggBu
 *
bu
,

344 
gpor
 
da
)

346 
RCUiStgsPrive
 *
iv
 = &
gs_iv
;

347 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

348 
	`rib_gs_t_boޗn
("MaUI", "DibTheme", 
ag
);

349 
	`g_obje_t
(
iv
->
r_theme_combo_box
, "nsive", !
ag
, 
NULL
);

350 
	}
}

352 
le
 
GtkWidg
 *
	$rc_ui_gs__bud
(

353 
RCUiStgsPrive
 *
iv
)

355 
GtkWidg
 *
_grid
;

356 
GtkWidg
 *
ame_b
;

357 
GtkWidg
 *
theme_ame
;

358 
GtkWidg
 *
theme_ame_grid
;

359 
GtkLiSte
 *
e
;

360 
GtkClRd
 *
nd
;

361 
GtkTeIr
 

;

362 
GSLi
 *
theme_li
, *
fܗch
;

363 cڡ 
gch
 *
embedded_theme_me
;

364 
gut
 
theme_numb
;

365 
gut
 
i
;

366 cڡ 
gch
 *
th
;

367 
gch
 *
theme_me
;

368 
gch
 *
theme_gs
;

369 
gboޗn
 
theme_embedded_ag
 = 
FALSE
;

370 
_grid
 = 
	`gtk_grid_w
();

371 
theme_ame
 = 
	`gtk_ame_w
(
NULL
);

372 
ame_b
 = 
	`gtk_b_w
(
NULL
);

373 
e
 = 
	`gtk_li_e_w
(3, 
G_TYPE_STRING
, 
G_TYPE_BOOLEAN
, G_TYPE_STRING);

374 
nd
 = 
	`gtk__nd_xt_w
();

375 
iv
->
r_dihm_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

376 
	`_
("Disableheme (needoestarthelayer)"));

377 
iv
->
r_theme_combo_box
 = 
	`gtk_combo_box_w_wh_mod
(
	`GTK_TREE_MODEL
(
e
));

378 
	`g_obje_uef
(
e
);

379 
	`gtk__yout_ck_t
(
	`GTK_CELL_LAYOUT
(
iv
->
r_theme_combo_box
),

380 
nd
, 
TRUE
);

381 
	`gtk__yout_t_ibus
(
	`GTK_CELL_LAYOUT
(
iv
->
r_theme_combo_box
),

382 
nd
, "xt", 0, 
NULL
);

383 
	`gtk_b_t_mkup
(
	`GTK_LABEL
(
ame_b
), 
	`_
("<b>Theme</b>"));

384 
	`g_obje_t
(
theme_ame
, "b-widg", 
ame_b
, "shadow-type",

385 
GTK_SHADOW_NONE
, "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

386 
theme_ame_grid
 = 
	`gtk_grid_w
();

387 
	`g_obje_t
(
iv
->
r_theme_combo_box
, "margin-left", 2, "margin-right",

388 2, "mg-t", 2, "mg-btom", 2, "hexnd-t", 
TRUE
,

389 "hexnd", 
TRUE
, 
NULL
);

390 
theme_gs
 = 
	`rib_gs_g_rg
("MaUI", "Theme", 
NULL
);

391 if(
theme_gs
!=
NULL
)

393 
theme_embedded_ag
 = 
	`g_r_has_efix
(
theme_gs
,

396 
theme_numb
 = 
	`rc_ui_y_embedded_theme_g_ngth
();

397 
i
=0;i<
theme_numb
;i++)

399 
embedded_theme_me
 = 
	`rc_ui_y_embedded_theme_g_me
(
i
);

400 
theme_me
 = 
	`g_rdup_tf
(
	`_
("%s (Embedded)"),

401 
embedded_theme_me
);

402 
	`gtk_li_e_nd
(
e
, &

);

403 
	`gtk_li_e_t
(
e
, &

, 0, 
theme_me
, 1, 
TRUE
, 2,

404 
embedded_theme_me
, -1);

405 
	`g_
(
theme_me
);

406 if(
theme_embedded_ag
)

408 if(
	`g_rcmp0
(
theme_gs
+14, 
embedded_theme_me
)==0)

410 
	`gtk_combo_box_t_aive_
(
	`GTK_COMBO_BOX
(

411 
iv
->
r_theme_combo_box
), &

);

415 
theme_li
 = 
	`rc_ui_y_ch_theme_ths
();

416 
fܗch
=
theme_li
;fܗch!=
NULL
;fܗch=
	`g_i_xt
(foreach))

418 
th
 = 
fܗch
->
da
;

419 if(
th
==
NULL
) ;

420 
theme_me
 = 
	`g_th_g_bame
(
th
);

421 
	`gtk_li_e_nd
(
e
, &

);

422 
	`gtk_li_e_t
(
e
, &

, 0, 
theme_me
, 1, 
FALSE
, 2, 
th
,

424 
	`g_
(
theme_me
);

425 if(
	`g_rcmp0
(
theme_gs
, 
th
)==0)

427 
	`gtk_combo_box_t_aive_
(
	`GTK_COMBO_BOX
(

428 
iv
->
r_theme_combo_box
), &

);

431 if(
theme_li
!=
NULL
)

432 
	`g_i__fu
(
theme_li
, 
g_
);

433 
	`g_
(
theme_gs
);

434 if(
	`gtk_combo_box_g_aive
(
	`GTK_COMBO_BOX
(
iv
->
r_theme_combo_box
))<0)

435 
	`gtk_combo_box_t_aive
(
	`GTK_COMBO_BOX
(
iv
->
r_theme_combo_box
), 0);

436 if(
	`rib_gs_g_boޗn
("MaUI", "DibTheme", 
NULL
))

438 
	`g_obje_t
(
iv
->
r_theme_combo_box
, "nsive", 
FALSE
, 
NULL
);

439 
	`g_obje_t
(
iv
->
r_dihm_check_bu
, "aive", 
TRUE
, 
NULL
);

441 
	`gtk_grid_ch
(
	`GTK_GRID
(
theme_ame_grid
),

442 
iv
->
r_dihm_check_bu
, 0, 0, 1, 1);

443 
	`gtk_grid_ch
(
	`GTK_GRID
(
theme_ame_grid
),

444 
iv
->
r_theme_combo_box
, 0, 1, 1, 1);

445 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
theme_ame
), 
theme_ame_grid
);

446 
	`gtk_grid_ch
(
	`GTK_GRID
(
_grid
), 
theme_ame
, 0, 0,

448 
	`g_sigl_c
(
iv
->
r_theme_combo_box
, "changed",

449 
	`G_CALLBACK
(
rc_ui_gs_r_theme_chged
), 
NULL
);

450 
	`g_sigl_c
(
iv
->
r_dihm_check_bu
, "toggled",

451 
	`G_CALLBACK
(
rc_ui_gs_r_dihm_toggd
), 
NULL
);

452  
_grid
;

453 
	}
}

455 
	$rc_ui_gs_if_hidecovimg_toggd
(
GtkToggBu
 *
bu
,

456 
gpor
 
da
)

458 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

459 
	`rib_gs_t_boޗn
("MaUI", "HideCovImage", 
ag
);

460 
	`rc_ui_ma_wdow_cov_image_t_visib
(!
ag
);

461 
	}
}

463 
	$rc_ui_gs_if_hidrc_toggd
(
GtkToggBu
 *
bu
,

464 
gpor
 
da
)

466 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

467 
	`rib_gs_t_boޗn
("MaUI", "HideLyricLabs", 
ag
);

468 
	`rc_ui_ma_wdow_lyric_bs_t_visib
(!
ag
);

469 
	}
}

471 
	$rc_ui_gs_if_hider_toggd
(
GtkToggBu
 *
bu
,

472 
gpor
 
da
)

474 
gboޗn
 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

475 
	`rib_gs_t_boޗn
("MaUI", "HideSrumWidg", 
ag
);

476 
	`rc_ui_ma_wdow_erum_t_visib
(!
ag
);

477 
	}
}

479 
	$rc_ui_gs_if_muicumn_toggd
(
GtkToggBu
 *
bu
,

480 
gpor
 
da
)

482 
RCUiStgsPrive
 *
iv
 = (RCUiStgsPriv*)
da
;

483 
gboޗn
 
ag
;

484 
gboޗn
 
cumn_ag
;

485 
gut
 
cumn_ags
 = 0;

486 
gch
 *
rg
;

487 if(
da
==
NULL
) ;

488 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

489 
	`rc_ui_livw_ayli_t_cumn_diy_mode
(
ag
);

490 
	`rib_gs_t_boޗn
("MaUI", "UMuiCumns", 
ag
);

491 if(
ag
)

493 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

494 "PyliCumnAiEbd", 
NULL
);

495 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

496 
cumn_ag
, 
NULL
);

497 if(
cumn_ag
)

498 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
;

499 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

500 "PyliCumnAlbumEbd", 
NULL
);

501 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

502 
cumn_ag
, 
NULL
);

503 if(
cumn_ag
)

504 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
;

505 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

506 "PyliCumnTckNumbEbd", 
NULL
);

507 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

508 
cumn_ag
, 
NULL
);

509 if(
cumn_ag
)

510 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
;

511 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

512 "PyliCumnYrEbd", 
NULL
);

513 
	`g_obje_t
(
iv
->
if_showyecumn_check_bu
, "active",

514 
cumn_ag
, 
NULL
);

515 if(
cumn_ag
)

516 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
;

517 
cumn_ag
 = 
	`rib_gs_g_boޗn
("MainUI",

518 "PyliCumnFeTyEbd", 
NULL
);

519 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

520 
cumn_ag
, 
NULL
);

521 if(
cumn_ag
)

522 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
;

523 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

524 
cumn_ag
, 
NULL
);

525 if(
cumn_ag
)

526 
cumn_ags
 |
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
;

527 
	`rc_ui_livw_ayli_t_abd_cumns
(

528 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
 |

529 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
 |

530 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
 |

531 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
 |

532 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
 |

533 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
,

534 
cumn_ags
);

535 
	`g_obje_t
(
iv
->
if_muicumn_check_bu
, "aive", 
TRUE
,

536 
NULL
);

537 
	`g_obje_t
(
iv
->
if_tfm_grid
, "visib", 
FALSE
, 
NULL
);

538 
	`g_obje_t
(
iv
->
if_showcumn_ame
, "visib", 
TRUE
, 
NULL
);

542 
rg
 = 
	`rib_gs_g_rg
("MainUI", "PlaylistTitleFormat",

543 
NULL
);

544 if(
rg
!=
NULL
 && 
	`g_rr_n
(string, -1, "%TITLE")!=NULL)

546 
	`rc_ui_livw_ayli_t_t_fm
(
rg
);

547 
	`gtk_y_t_xt
(
	`GTK_ENTRY
(
iv
->
if_tfm_y
),

548 
rg
);

550 
	`g_
(
rg
);

551 
	`g_obje_t
(
iv
->
if_tfm_grid
, "visib", 
TRUE
, 
NULL
);

552 
	`g_obje_t
(
iv
->
if_showcumn_ame
, "visib", 
FALSE
, 
NULL
);

554 
	}
}

556 
	$rc_ui_gs_if_tfm_chged
(
GtkEdab
 *
edab
,

557 
gpor
 
da
)

559 cڡ 
gch
 *
xt
;

560 if(
	`rc_ui_livw_ayli_g_cumn_diy_mode
()) ;

561 
xt
 = 
	`gtk_y_g_xt
(
	`GTK_ENTRY
(
edab
));

562 if(
xt
==
NULL
 || 
	`g_rr_n
(text, -1, "%TITLE")==NULL) ;

563 
	`rc_ui_livw_ayli_t_t_fm
(
xt
);

564 
	`rib_gs_t_rg
("MaUI", "PyliTFm", 
xt
);

565 
	}
}

567 
	$rc_ui_gs_if_showcumn_toggd
(
GtkToggBu
 *
bu
,

568 
gpor
 
da
)

570 
RCUiStgsPrive
 *
iv
 = (RCUiStgsPriv*)
da
;

571 
gboޗn
 
ag
;

572 
gut
 
cumn_ags
;

573 if(
da
==
NULL
) ;

574 if(!
	`rc_ui_livw_ayli_g_cumn_diy_mode
()) ;

575 
ag
 = 
	`gtk_togg_bu_g_aive
(
bu
);

576 if(
bu
==(
GtkToggBu
 *)
iv
->
if_showcumn_check_bu
)

578 if(
ag
)

579 
cumn_ags
 = 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
;

581 
cumn_ags
 = 0;

582 
	`rc_ui_livw_ayli_t_abd_cumns
(

583 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
, 
cumn_ags
);

584 
	`rib_gs_t_boޗn
("MainUI", "PlaylistColumnArtistEnabled",

585 
ag
);

587 if(
bu
==(
GtkToggBu
 *)
iv
->
if_showcumn_check_bu
)

589 if(
ag
)

590 
cumn_ags
 = 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
;

592 
cumn_ags
 = 0;

593 
	`rc_ui_livw_ayli_t_abd_cumns
(

594 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
, 
cumn_ags
);

595 
	`rib_gs_t_boޗn
("MainUI", "PlaylistColumnAlbumEnabled",

596 
ag
);

598 if(
bu
==(
GtkToggBu
 *)
iv
->
if_showcumn_check_bu
)

600 if(
ag
)

601 
cumn_ags
 = 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
;

603 
cumn_ags
 = 0;

604 
	`rc_ui_livw_ayli_t_abd_cumns
(

605 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
, 
cumn_ags
);

606 
	`rib_gs_t_boޗn
("MainUI",

607 "PyliCumnTckNumbEbd", 
ag
);

609 if(
bu
==(
GtkToggBu
 *)
iv
->
if_showyecumn_check_bu
)

611 if(
ag
)

612 
cumn_ags
 = 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
;

614 
cumn_ags
 = 0;

615 
	`rc_ui_livw_ayli_t_abd_cumns
(

616 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
, 
cumn_ags
);

617 
	`rib_gs_t_boޗn
("MainUI", "PlaylistColumnYearEnabled",

618 
ag
);

620 if(
bu
==(
GtkToggBu
 *)
iv
->
if_showcumn_check_bu
)

622 if(
ag
)

623 
cumn_ags
 = 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
;

625 
cumn_ags
 = 0;

626 
	`rc_ui_livw_ayli_t_abd_cumns
(

627 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
, 
cumn_ags
);

628 
	`rib_gs_t_boޗn
("MainUI",

629 "PyliCumnFeTyEbd", 
ag
);

631 if(
bu
==(
GtkToggBu
 *)
iv
->
if_showcumn_check_bu
)

633 if(
ag
)

634 
cumn_ags
 = 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
;

636 
cumn_ags
 = 0;

637 
	`rc_ui_livw_ayli_t_abd_cumns
(

638 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
, 
cumn_ags
);

639 
	`rib_gs_t_boޗn
("MainUI",

640 "PyliCumnRgEbd", 
ag
);

642 
	}
}

644 
le
 
GtkWidg
 *
	$rc_ui_gs_r_bud
(

645 
RCUiStgsPrive
 *
iv
)

647 
GtkWidg
 *
r_grid
;

648 
GtkWidg
 *
ame_b
;

649 
GtkWidg
 *
maw_ame
;

650 
GtkWidg
 *
maw_ame_grid
;

651 
GtkWidg
 *
livw_ame
;

652 
GtkWidg
 *
livw_ame_grid
;

653 
GtkWidg
 *
tfm_b
;

654 
GtkWidg
 *
ne_b
;

655 
GtkWidg
 *
showcumn_ame_grid
;

656 
gut
 
cumn_ags
;

657 
r_grid
 = 
	`gtk_grid_w
();

658 
iv
->
if_hidecovimg_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

659 
	`_
("Hide cover _image"));

660 
iv
->
if_hidrc_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

661 
	`_
("Hide _lyricabels"));

662 
iv
->
if_hider_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

663 
	`_
("Hide _spectrum show"));

664 
iv
->
if_muicumn_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

665 
	`_
("Show _metadata in multi-columns"));

666 
iv
->
if_tfm_y
 = 
	`gtk_y_w
();

667 
iv
->
if_showcumn_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

668 
	`_
("Artist"));

669 
iv
->
if_showcumn_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

670 
	`_
("Album"));

671 
iv
->
if_showcumn_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

672 
	`_
("Track"));

673 
iv
->
if_showyecumn_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

674 
	`_
("Year"));

675 
iv
->
if_showcumn_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

676 
	`_
("Format"));

677 
iv
->
if_showcumn_check_bu
 = 
	`gtk_check_bu_w_wh_mmic
(

678 
	`_
("Rating"));

679 
iv
->
if_tfm_grid
 = 
	`gtk_grid_w
();

680 
showcumn_ame_grid
 = 
	`gtk_grid_w
();

681 
iv
->
if_showcumn_ame
 = 
	`gtk_ame_w
(
NULL
);

682 
ame_b
 = 
	`gtk_b_w
(
NULL
);

683 
	`gtk_b_t_mkup
(
	`GTK_LABEL
(
ame_b
), 
	`_
("<b>Visible Columns</b>"));

684 
	`g_obje_t
(
iv
->
if_showcumn_ame
, "b-widg", 
ame_b
,

685 "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

686 
tfm_b
 = 
	`gtk_b_w
(
	`_
("Title column format: "));

687 
ne_b
 = 
	`gtk_b_w
(
NULL
);

688 
	`gtk_b_t_mkup
(
	`GTK_LABEL
(
ne_b
), 
	`_
("<b>Hint</b>: Use "

692 
	`g_obje_t
(
ne_b
, "wp", 
TRUE
, "wp-mode", 
PANGO_WRAP_WORD_CHAR
,

693 "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

694 
	`g_obje_t
(
iv
->
if_tfm_y
, "hexnd-t", 
TRUE
, "hexpand",

695 
TRUE
, 
NULL
);

696 
	`g_obje_t
(
iv
->
if_tfm_grid
, "hexnd-t", 
TRUE
, "hexpand",

697 
TRUE
, 
NULL
);

698 
	`g_obje_t
(
iv
->
if_showcumn_ame
, "hexnd-t", 
TRUE
, "hexpand",

699 
TRUE
, 
NULL
);

700 
	`gtk_grid_ch
(
	`GTK_GRID
(
iv
->
if_tfm_grid
), 
tfm_b
,

702 
	`gtk_grid_ch
(
	`GTK_GRID
(
iv
->
if_tfm_grid
),

703 
iv
->
if_tfm_y
, 1, 0, 1, 1);

704 
	`gtk_grid_ch
(
	`GTK_GRID
(
iv
->
if_tfm_grid
), 
ne_b
,

706 
	`gtk_grid_ch
(
	`GTK_GRID
(
showcumn_ame_grid
),

707 
iv
->
if_showcumn_check_bu
, 0, 0, 1, 1);

708 
	`gtk_grid_ch
(
	`GTK_GRID
(
showcumn_ame_grid
),

709 
iv
->
if_showcumn_check_bu
, 1, 0, 1, 1);

710 
	`gtk_grid_ch
(
	`GTK_GRID
(
showcumn_ame_grid
),

711 
iv
->
if_showcumn_check_bu
, 2, 0, 1, 1);

712 
	`gtk_grid_ch
(
	`GTK_GRID
(
showcumn_ame_grid
),

713 
iv
->
if_showyecumn_check_bu
, 0, 1, 1, 1);

714 
	`gtk_grid_ch
(
	`GTK_GRID
(
showcumn_ame_grid
),

715 
iv
->
if_showcumn_check_bu
, 1, 1, 1, 1);

716 
	`gtk_grid_ch
(
	`GTK_GRID
(
showcumn_ame_grid
),

717 
iv
->
if_showcumn_check_bu
, 2, 1, 1, 1);

718 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
if_showcumn_ame
),

719 
showcumn_ame_grid
);

720 
	`gtk_widg_show_l
(
iv
->
if_tfm_grid
);

721 
	`gtk_widg_show_l
(
iv
->
if_showcumn_ame
);

722 
	`gtk_widg_t_no_show_l
(
iv
->
if_tfm_grid
, 
TRUE
);

723 
	`gtk_widg_t_no_show_l
(
iv
->
if_showcumn_ame
, 
TRUE
);

724 
maw_ame
 = 
	`gtk_ame_w
(
NULL
);

725 
ame_b
 = 
	`gtk_b_w
(
NULL
);

726 
	`gtk_b_t_mkup
(
	`GTK_LABEL
(
ame_b
), 
	`_
("<b>Main Window</b>"));

727 
	`g_obje_t
(
maw_ame
, "b-widg", 
ame_b
, "shadow-type",

728 
GTK_SHADOW_NONE
, "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

729 
maw_ame_grid
 = 
	`gtk_grid_w
();

730 
livw_ame
 = 
	`gtk_ame_w
(
NULL
);

731 
ame_b
 = 
	`gtk_b_w
(
NULL
);

732 
	`gtk_b_t_mkup
(
	`GTK_LABEL
(
ame_b
), 
	`_
("<b>List Views</b>"));

733 
	`g_obje_t
(
livw_ame
, "b-widg", 
ame_b
, "shadow-type",

734 
GTK_SHADOW_NONE
, "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

735 
livw_ame_grid
 = 
	`gtk_grid_w
();

736 
	`g_obje_t
(
iv
->
if_hidecovimg_check_bu
, "active",

737 
	`rib_gs_g_boޗn
("MaUI", "HideCovImage", 
NULL
),

738 
NULL
);

739 
	`g_obje_t
(
iv
->
if_hidrc_check_bu
, "active",

740 
	`rib_gs_g_boޗn
("MaUI", "HideLyricLabs", 
NULL
),

741 
NULL
);

742 
	`g_obje_t
(
iv
->
if_hider_check_bu
, "active",

743 
	`rib_gs_g_boޗn
("MaUI", "HideSrumWidg", 
NULL
),

744 
NULL
);

745 
	`g_obje_t
(
iv
->
if_tfm_y
, "text",

746 
	`rc_ui_li_mod_g_ayli_t_fm
(), 
NULL
);

747 
cumn_ags
 = 
	`rc_ui_livw_ayli_g_abd_cumns
();

748 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

749 
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ARTIST
 ? 
TRUE
: 
FALSE
,

750 
NULL
);

751 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

752 
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_ALBUM
 ? 
TRUE
: 
FALSE
,

753 
NULL
);

754 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

755 
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_TRACK
 ? 
TRUE
: 
FALSE
,

756 
NULL
);

757 
	`g_obje_t
(
iv
->
if_showyecumn_check_bu
, "active",

758 
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_YEAR
 ? 
TRUE
: 
FALSE
,

759 
NULL
);

760 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

761 
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_FTYPE
 ? 
TRUE
: 
FALSE
,

762 
NULL
);

763 
	`g_obje_t
(
iv
->
if_showcumn_check_bu
, "active",

764 
cumn_ags
 & 
RC_UI_LISTVIEW_PLAYLIST_COLUMN_RATING
 ? 
TRUE
: 
FALSE
,

765 
NULL
);

766 if(
	`rc_ui_livw_ayli_g_cumn_diy_mode
())

768 
	`g_obje_t
(
iv
->
if_muicumn_check_bu
, "aive", 
TRUE
,

769 
NULL
);

770 
	`g_obje_t
(
iv
->
if_tfm_grid
, "visib", 
FALSE
, 
NULL
);

774 
	`g_obje_t
(
iv
->
if_showcumn_ame
, "visib", 
FALSE
, 
NULL
);

776 
	`gtk_grid_ch
(
	`GTK_GRID
(
maw_ame_grid
),

777 
iv
->
if_hidecovimg_check_bu
, 0, 0, 1, 1);

778 
	`gtk_grid_ch
(
	`GTK_GRID
(
maw_ame_grid
),

779 
iv
->
if_hidrc_check_bu
, 0, 1, 1, 1);

780 
	`gtk_grid_ch
(
	`GTK_GRID
(
maw_ame_grid
),

781 
iv
->
if_hider_check_bu
, 0, 2, 1, 1);

782 
	`gtk_grid_ch
(
	`GTK_GRID
(
livw_ame_grid
),

783 
iv
->
if_muicumn_check_bu
, 0, 0, 1, 1);

784 
	`gtk_grid_ch
(
	`GTK_GRID
(
livw_ame_grid
),

785 
iv
->
if_tfm_grid
, 0, 1, 1, 1);

786 
	`gtk_grid_ch
(
	`GTK_GRID
(
livw_ame_grid
),

787 
iv
->
if_showcumn_ame
, 0, 2, 1, 1);

788 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
maw_ame
), 
maw_ame_grid
);

789 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
livw_ame
), 
livw_ame_grid
);

790 
	`gtk_grid_ch
(
	`GTK_GRID
(
r_grid
), 
maw_ame
, 0, 0,

792 
	`gtk_grid_ch
(
	`GTK_GRID
(
r_grid
), 
livw_ame
, 0, 1,

794 
	`g_sigl_c
(
iv
->
if_hidecovimg_check_bu
, "toggled",

795 
	`G_CALLBACK
(
rc_ui_gs_if_hidecovimg_toggd
), 
NULL
);

796 
	`g_sigl_c
(
iv
->
if_hidrc_check_bu
, "toggled",

797 
	`G_CALLBACK
(
rc_ui_gs_if_hidrc_toggd
), 
NULL
);

798 
	`g_sigl_c
(
iv
->
if_hider_check_bu
, "toggled",

799 
	`G_CALLBACK
(
rc_ui_gs_if_hider_toggd
), 
NULL
);

800 
	`g_sigl_c
(
iv
->
if_muicumn_check_bu
, "toggled",

801 
	`G_CALLBACK
(
rc_ui_gs_if_muicumn_toggd
), 
iv
);

802 
	`g_sigl_c
(
iv
->
if_tfm_y
, "changed",

803 
	`G_CALLBACK
(
rc_ui_gs_if_tfm_chged
), 
iv
);

804 
	`g_sigl_c
(
iv
->
if_showcumn_check_bu
, "toggled",

805 
	`G_CALLBACK
(
rc_ui_gs_if_showcumn_toggd
), 
iv
);

806 
	`g_sigl_c
(
iv
->
if_showcumn_check_bu
, "toggled",

807 
	`G_CALLBACK
(
rc_ui_gs_if_showcumn_toggd
), 
iv
);

808 
	`g_sigl_c
(
iv
->
if_showcumn_check_bu
, "toggled",

809 
	`G_CALLBACK
(
rc_ui_gs_if_showcumn_toggd
), 
iv
);

810 
	`g_sigl_c
(
iv
->
if_showyecumn_check_bu
, "toggled",

811 
	`G_CALLBACK
(
rc_ui_gs_if_showcumn_toggd
), 
iv
);

812 
	`g_sigl_c
(
iv
->
if_showcumn_check_bu
, "toggled",

813 
	`G_CALLBACK
(
rc_ui_gs_if_showcumn_toggd
), 
iv
);

814 
	`g_sigl_c
(
iv
->
if_showcumn_check_bu
, "toggled",

815 
	`G_CALLBACK
(
rc_ui_gs_if_showcumn_toggd
), 
iv
);

816  
r_grid
;

817 
	}
}

819 
gboޗn
 
	$rc_ui_gs_wdow_key_ess_cb
(
GtkWidg
 *
widg
,

820 
GdkEvt
 *
evt
, 
gpor
 
da
)

822 
gut
 
keyv
 = 
evt
->
key
.keyval;

823 
RCUiStgsPrive
 *
iv
 = &
gs_iv
;

824 if(
keyv
==
GDK_KEY_Es
)

825 
	`gtk_widg_deroy
(
iv
->
gs_wdow
);

826  
FALSE
;

827 
	}
}

829 
le
 
	$rc_ui_gs_wdow_
()

831 
RCUiStgsPrive
 *
iv
 = &
gs_iv
;

832 
GtkWidg
 *
o_bu
;

833 
GtkWidg
 *
ma_grid
;

834 
GtkWidg
 *
g_b
;

835 
GtkWidg
 *
ayli_b
;

836 
GtkWidg
 *
_b
;

837 
GtkWidg
 *
r_b
;

838 
GtkWidg
 *
bu_hbox
;

839 
iv
->
gs_wdow
 = 
	`gtk_wdow_w
(
GTK_WINDOW_TOPLEVEL
);

840 
ma_grid
 = 
	`gtk_grid_w
();

841 
iv
->
gs_nebook
 = 
	`gtk_nebook_w
();

842 
o_bu
 = 
	`gtk_bu_w_om_ock
(
GTK_STOCK_CLOSE
);

843 
g_b
 = 
	`gtk_b_w
(
	`_
("General"));

844 
ayli_b
 = 
	`gtk_b_w
(
	`_
("Playlist"));

845 
_b
 = 
	`gtk_b_w
(
	`_
("Appearance"));

846 
r_b
 = 
	`gtk_b_w
(
	`_
("Interface"));

847 
bu_hbox
 = 
	`gtk_bu_box_w
(
GTK_ORIENTATION_HORIZONTAL
);

848 
	`g_obje_t
(
iv
->
gs_wdow
, "t", 
	`_
("Player Preferences"),

849 "wdow-posi", 
GTK_WIN_POS_CENTER
, "has-size-gr", 
FALSE
,

851 
GTK_STOCK_PREFERENCES
, "ty-ht", 
GDK_WINDOW_TYPE_HINT_DIALOG
,

852 
NULL
);

853 
	`g_obje_t
(
iv
->
gs_nebook
, "margin-left", 2, "margin-right",

854 2, "mg-t", 4, "mg-btom", 4, "b-pos", 
GTK_POS_LEFT
,

855 "exnd", 
TRUE
, 
NULL
);

856 
	`g_obje_t
(
bu_hbox
, "yout-y", 
GTK_BUTTONBOX_END
,

857 "hexnd-t", 
TRUE
, "hexpand", TRUE, "spacing", 4,

859 "mg-btom", 4, 
NULL
);

860 
	`gtk_nebook_nd_ge
(
	`GTK_NOTEBOOK
(
iv
->
gs_nebook
),

861 
	`rc_ui_gs_g_bud
(
iv
), 
g_b
);

862 
	`gtk_nebook_nd_ge
(
	`GTK_NOTEBOOK
(
iv
->
gs_nebook
),

863 
	`rc_ui_gs_ayli_bud
(
iv
), 
ayli_b
);

864 
	`gtk_nebook_nd_ge
(
	`GTK_NOTEBOOK
(
iv
->
gs_nebook
),

865 
	`rc_ui_gs__bud
(
iv
), 
_b
);

866 
	`gtk_nebook_nd_ge
(
	`GTK_NOTEBOOK
(
iv
->
gs_nebook
),

867 
	`rc_ui_gs_r_bud
(
iv
), 
r_b
);

868 
	`gtk_box_ck_t
(
	`GTK_BOX
(
bu_hbox
), 
o_bu
, 
FALSE
, FALSE, 2);

869 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
iv
->
gs_nebook
, 0, 0,

871 
	`gtk_grid_ch
(
	`GTK_GRID
(
ma_grid
), 
bu_hbox
, 0, 1, 1, 1);

872 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
gs_wdow
), 
ma_grid
);

873 
	`g_sigl_c
(
o_bu
, "clicked",

874 
	`G_CALLBACK
(
rc_ui_gs_o_bu_icked
), 
NULL
);

875 
	`g_sigl_c
(
iv
->
gs_wdow
, "key-press-event",

876 
	`G_CALLBACK
(
rc_ui_gs_wdow_key_ess_cb
), 
NULL
);

877 
	`g_sigl_c
(
iv
->
gs_wdow
, "destroy",

878 
	`G_CALLBACK
(
rc_ui_gs_wdow_deroy_cb
), 
NULL
);

879 
	`gtk_widg_show_l
(
iv
->
gs_wdow
);

880 
	}
}

888 
	$rc_ui_gs_wdow_show
()

890 
RCUiStgsPrive
 *
iv
 = &
gs_iv
;

891 if(
iv
->
gs_wdow
==
NULL
)

892 
	`rc_ui_gs_wdow_
();

894 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
iv
->
gs_wdow
));

895 
	}
}

903 
	$rc_ui_gs_wdow_deroy
()

905 
RCUiStgsPrive
 *
iv
 = &
gs_iv
;

906 if(
iv
->
gs_wdow
!=
NULL
)

907 
	`gtk_widg_deroy
(
iv
->
gs_wdow
);

908 
	}
}

	@ui/rc-ui-settings.h

25 #ide
HAVE_RC_UI_SETTINGS_H


26 
	#HAVE_RC_UI_SETTINGS_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<gtk/gtk.h
>

31 
	~<rib.h
>

33 
G_BEGIN_DECLS


35 
rc_ui_gs_wdow_show
();

36 
rc_ui_gs_wdow_deroy
();

38 
	gG_END_DECLS


	@ui/rc-ui-slabel.c

26 
	~"rc-ui-ab.h
"

37 
	s_RCUiSbLabPrive


39 
gch
 *
	mxt
;

40 
PgoArLi
 *
	ms
;

41 
gdoub
 
	mr
;

42 
PgoLayout
 *
	myout
;

43 
gt
 
	mcut_x
;

48 
	mPROP_O
,

49 
	mPROP_TEXT
,

50 
	mPROP_ATTRS
,

51 
	mPROP_PERCENT


54 
gpor
 
	grc_ui_sb_b__ass
 = 
NULL
;

56 
	$rc_ui_sb_b_t_ݔty
(
GObje
 *
obje
,

57 
gut
 
_id
, cڡ 
GVue
 *
vue
, 
GPamSc
 *
pec
)

59 
RCUiSbLab
 *
xt
 = 
	`RC_UI_SCROLLABLE_LABEL
(
obje
);

60 
_id
)

62 
PROP_TEXT
:

63 
	`rc_ui_sb_b_t_xt
(
xt
,

64 
	`g_vue_g_rg
(
vue
));

66 
PROP_ATTRS
:

67 
	`rc_ui_sb_b_t_ibus
(
xt
,

68 
	`g_vue_g_boxed
(
vue
));

70 
PROP_PERCENT
:

71 
	`rc_ui_sb_b_t_r
(
xt
,

72 
	`g_vue_g_doub
(
vue
));

75 
	`G_OBJECT_WARN_INVALID_PROPERTY_ID
(
obje
, 
_id
, 
pec
);

78 
	}
}

80 
	$rc_ui_sb_b_g_ݔty
(
GObje
 *
obje
,

81 
gut
 
_id
, 
GVue
 *
vue
, 
GPamSc
 *
pec
)

83 
RCUiSbLab
 *
xt
 = 
	`RC_UI_SCROLLABLE_LABEL
(
obje
);

84 
RCUiSbLabPrive
 *
iv
 = 
xt
->priv;

85 
_id
)

87 
PROP_TEXT
:

88 
	`g_vue_t_rg
(
vue
, 
iv
->
xt
);

90 
PROP_ATTRS
:

91 
	`g_vue_t_boxed
(
vue
, 
iv
->
s
);

93 
PROP_PERCENT
:

94 
	`g_vue_t_doub
(
vue
, 
iv
->
r
);

97 
	`G_OBJECT_WARN_INVALID_PROPERTY_ID
(
obje
, 
_id
, 
pec
);

100 
	}
}

102 
	$rc_ui_sb_b_ize
(
GtkWidg
 *
widg
)

104 
RCUiSbLab
 *
b
;

105 
GdkWdowAr
 
ibus
;

106 
GtkAoti
 
loti
;

107 
GdkWdow
 *
wdow
, *

;

108 
gt
 
_mask
;

109 
GtkStyCڋxt
 *
cڋxt
;

110 
	`g_tu_if_
(
widg
!=
NULL
);

111 
	`g_tu_if_
(
	`RC_UI_IS_SCROLLABLE_LABEL
(
widg
));

112 
b
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
);

113 
	`gtk_widg_t_ized
(
widg
, 
TRUE
);

114 
	`gtk_widg_g_loti
(
widg
, &
loti
);

115 
ibus
.
x
 = 
loti
.x;

116 
ibus
.
y
 = 
loti
.y;

117 
ibus
.
width
 = 
loti
.width;

118 
ibus
.
height
 = 
loti
.height;

119 
ibus
.
wass
 = 
GDK_INPUT_OUTPUT
;

120 
ibus
.
wdow_ty
 = 
GDK_WINDOW_CHILD
;

121 
ibus
.
evt_mask
 = 
	`gtk_widg_g_evts
(
widg
);

122 
ibus
.
evt_mask
 |(
GDK_EXPOSURE_MASK
);

123 
ibus
.
visu
 = 
	`gtk_widg_g_visu
(
widg
);

124 
_mask
 = 
GDK_WA_X
 | 
GDK_WA_Y
 | 
GDK_WA_VISUAL
;

125 
	`gtk_widg_t_has_wdow
(
widg
, 
TRUE
);

126 

 = 
	`gtk_widg_g__wdow
(
widg
);

127 
wdow
 = 
	`gdk_wdow_w
(

, &
ibus
, 
_mask
);

128 
	`gtk_widg_t_wdow
(
widg
, 
wdow
);

129 
	`gdk_wdow_t_ur_da
(
wdow
, 
b
);

130 
	`gdk_wdow_t_background_n
(
wdow
, 
NULL
);

131 
cڋxt
 = 
	`gtk_widg_g_y_cڋxt
(
widg
);

132 
	`gtk_y_cڋxt_t_background
(
cڋxt
, 
wdow
);

133 
	`gdk_wdow_show
(
wdow
);

134 
	}
}

136 
	$rc_ui_sb_b_size_lo
(
GtkWidg
 *
widg
,

137 
GtkAoti
 *
loti
)

139 
GdkWdow
 *
wdow
;

140 
	`g_tu_if_
(
widg
!=
NULL
);

141 
	`g_tu_if_
(
	`RC_UI_IS_SCROLLABLE_LABEL
(
widg
));

142 
	`gtk_widg_t_loti
(
widg
, 
loti
);

143 
wdow
 = 
	`gtk_widg_g_wdow
(
widg
);

144 if(
	`gtk_widg_g_ized
(
widg
))

146 
	`gdk_wdow_move_size
(
wdow
, 
loti
->
x
,oti->
y
,

147 
loti
->
width
,oti->
height
);

149 
	}
}

151 
	$rc_ui_sb_b_g_eed_height
(
GtkWidg
 *
widg
,

152 
gt
 *
m_height
, g*
t_height
)

154 
RCUiSbLabPrive
 *
iv
;

155 
PgoFtMrics
 *
mrics
;

156 
PgoCڋxt
 *
cڋxt
;

157 
gt
 
as
, 
des
;

158 
gt
 
height
;

159 if(
widg
==
NULL
) ;

160 
iv
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
)->priv;

161 if(
iv
==
NULL
) ;

162 
cڋxt
 = 
	`ngo_yout_g_cڋxt
(
iv
->
yout
);

163 if(
cڋxt
==
NULL
) ;

164 
mrics
 = 
	`ngo_cڋxt_g_mrics
(
cڋxt
,

165 
	`ngo_yout_g_ft_desti
(
iv
->
yout
), 
NULL
);

166 
as
 = 
	`ngo_ft_mrics_g_as
(
mrics
);

167 
des
 = 
	`ngo_ft_mrics_g_des
(
mrics
);

168 
	`ngo_ft_mrics_uef
(
mrics
);

169 
height
 = 
	`PANGO_PIXELS
(
as
 + 
des
);

170 *
m_height
 = 
height
;

171 *
t_height
 = 
height
;

172 
	}
}

174 
gboޗn
 
	$rc_ui_sb_b_dw
(
GtkWidg
 *
widg
, 
o_t
 *

)

176 
RCUiSbLab
 *
b
;

177 
RCUiSbLabPrive
 *
iv
;

178 
GtkAoti
 
loti
;

179 
gt
 
width
, 
height
;

180 
GtkStyCڋxt
 *
y_cڋxt
;

181 
	`g_tu_v_if_
(
widg
!=
NULL
 || 

!=NULL, 
FALSE
);

182 
	`g_tu_v_if_
(
	`RC_UI_IS_SCROLLABLE_LABEL
(
widg
), 
FALSE
);

183 
b
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
);

184 
iv
 = 
b
->priv;

185 
y_cڋxt
 = 
	`gtk_widg_g_y_cڋxt
(
widg
);

186 
	`ngo_yout_g_pix_size
(
iv
->
yout
, &
width
, &
height
);

187 
	`gtk_widg_g_loti
(
widg
, &
loti
);

188 if(
width
 > 
loti
.width)

189 
iv
->
cut_x
 = (
gt
)((
gdoub
)(
loti
.
width
 -

190 
width
* 
iv
->
r
);

192 
iv
->
cut_x
 = 0;

193 
	`gtk_nd_yout
(
y_cڋxt
, 

, 
iv
->
cut_x
,

194 (
loti
.
height
 - height/ 2, 
iv
->
yout
);

195  
TRUE
;

196 
	}
}

198 
	$rc_ui_sb_b_
(
RCUiSbLab
 *
b
)

200 
RCUiSbLabPrive
 *
iv
;

201 cڡ 
PgoFtDesti
 *
fd
;

202 
GtkStyCڋxt
 *
y_cڋxt
;

203 
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
b
, 
RC_UI_TYPE_SCROLLABLE_LABEL
,

204 
RCUiSbLabPrive
);

205 
b
->
iv
 =riv;

206 
iv
->
r
 = 0.0;

207 
iv
->
xt
 = 
NULL
;

208 
iv
->
s
 = 
NULL
;

209 
iv
->
yout
 = 
	`gtk_widg__ngo_yout
(
	`GTK_WIDGET
(
b
), 
NULL
);

210 
iv
->
cut_x
 = 0;

211 
y_cڋxt
 = 
	`gtk_widg_g_y_cڋxt
(
	`GTK_WIDGET
(
b
));

212 
fd
 = 
	`gtk_y_cڋxt_g_ft
(
y_cڋxt
, 
GTK_STATE_FLAG_NORMAL
);

213 
	`ngo_yout_t_ft_desti
(
iv
->
yout
, 
fd
);

214 
	}
}

216 
	$rc_ui_sb_b_fize
(
GObje
 *
obje
)

218 
RCUiSbLab
 *
b
 = 
	`RC_UI_SCROLLABLE_LABEL
(
obje
);

219 
RCUiSbLabPrive
 *
iv
;

220 
iv
 = 
b
->priv;

221 if(
iv
->
xt
!=
NULL

	`g_
(priv->text);

222 if(
iv
->
yout
!=
NULL

	`g_obje_uef
(priv->layout);

223 if(
iv
->
s
!=
NULL

	`ngo__li_uef
(priv->attrs);

224 
	`G_OBJECT_CLASS
(
rc_ui_sb_b__ass
)->
	`fize
(
obje
);

225 
	}
}

227 
	$rc_ui_sb_b_ass_
(
RCUiSbLabCss
 *
kss
)

229 
GObjeCss
 *
obje_ass
;

230 
GtkWidgCss
 *
widg_ass
;

231 
rc_ui_sb_b__ass
 = 
	`g_ty_ass_ek_
(
kss
);

232 
obje_ass
 = (
GObjeCss
 *)
kss
;

233 
widg_ass
 = (
GtkWidgCss
 *)
kss
;

234 
obje_ass
->
t_ݔty
 = 
rc_ui_sb_b_t_ݔty
;

235 
obje_ass
->
g_ݔty
 = 
rc_ui_sb_b_g_ݔty
;

236 
obje_ass
->
fize
 = 
rc_ui_sb_b_fize
;

237 
widg_ass
->
ize
 = 
rc_ui_sb_b_ize
;

238 
widg_ass
->
size_lo
 = 
rc_ui_sb_b_size_lo
;

239 
widg_ass
->
dw
 = 
rc_ui_sb_b_dw
;

240 
widg_ass
->
g_eed_height
 =

241 
rc_ui_sb_b_g_eed_height
;

242 
	`g_ty_ass_add_ive
(
kss
, (
RCUiSbLabPrive
));

250 
	`g_obje_ass_l_ݔty
(
obje_ass
, 
PROP_TEXT
,

251 
	`g_m_ec_rg
("text", "Scrollable Text",

252 "Thxtshow iwidg", 
NULL
, 
G_PARAM_READWRITE
));

260 
	`g_obje_ass_l_ݔty
(
obje_ass
, 
PROP_ATTRS
,

261 
	`g_m_ec_boxed
("attributes", "Textttributes",

263 
PANGO_TYPE_ATTR_LIST
, 
G_PARAM_READWRITE
));

270 
	`g_obje_ass_l_ݔty
(
obje_ass
, 
PROP_PERCENT
,

271 
	`g_m_ec_doub
("percent", "Percentage of movement",

272 "Thragoxmovemt", 0.0, 1.0, 0.0, 
G_PARAM_READWRITE
));

273 
	}
}

283 
GTy
 
	$rc_ui_sb_b_g_ty
()

285 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

286 
GTy
 
g_defe_ty_id
;

287 cڡ 
GTyInfo
 
obje_fo
 = {

288 .
ass_size
 = (
RCUiSbLabCss
),

289 .
ba_
 = 
NULL
,

290 .
ba_fize
 = 
NULL
,

291 .
ass_
 = (
GCssInFunc
)
rc_ui_sb_b_ass_
,

292 .
ass_fize
 = 
NULL
,

293 .
ass_da
 = 
NULL
,

294 .
_size
 = (
RCUiSbLab
),

295 .
n_ocs
 = 0,

296 .
_
 = (
GInInFunc
)
rc_ui_sb_b_


298 if(
	`g___r
(&
g_defe_ty_id__vީe
))

300 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
GTK_TYPE_WIDGET
,

301 
	`g__ic_rg
("RCUiSbLab"), &
obje_fo
, 0);

302 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

304  
g_defe_ty_id__vީe
;

305 
	}
}

315 
GtkWidg
 *
	$rc_ui_sb_b_w
()

317  
	`GTK_WIDGET
(
	`g_obje_w
(
	`rc_ui_sb_b_g_ty
(),

318 
NULL
));

319 
	}
}

329 
	$rc_ui_sb_b_t_xt
(
RCUiSbLab
 *
widg
,

330 cڡ 
gch
 *
xt
)

332 
RCUiSbLabPrive
 *
iv
;

333 if(
widg
==
NULL
) ;

334 
iv
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
)->priv;

335 if(
iv
==
NULL
) ;

336 if(
iv
->
xt
!=
NULL
)

338 if(
	`g_rcmp0
(
iv
->
xt
,ext)==0) ;

339 
	`g_
(
iv
->
xt
);

340 
iv
->
xt
 = 
NULL
;

342 if(
xt
!=
NULL
)

344 
iv
->
xt
 = 
	`g_rdup
(text);

345 
	`ngo_yout_t_xt
(
iv
->
yout
, 
xt
, -1);

348 
	`ngo_yout_t_xt
(
iv
->
yout
, "", -1);

349 
	`gtk_widg_queue_dw
(
	`GTK_WIDGET
(
widg
));

350 
	}
}

361 cڡ 
gch
 *
	$rc_ui_sb_b_g_xt
(
RCUiSbLab
 *
widg
)

363 
RCUiSbLabPrive
 *
iv
;

364 if(
widg
==
NULL
)  NULL;

365 
iv
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
)->priv;

366 if(
iv
==
NULL
)  NULL;

367  
iv
->
xt
;

368 
	}
}

379 
	$rc_ui_sb_b_t_ibus
(
RCUiSbLab
 *
widg
,

380 
PgoArLi
 *
s
)

382 
RCUiSbLabPrive
 *
iv
;

383 if(
widg
==
NULL
) ;

384 
iv
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
)->priv;

385 if(
iv
==
NULL
) ;

386 if(
iv
->
s
!=
NULL
)

387 
	`ngo__li_uef
(
iv
->
s
);

388 
iv
->
s
 = 
NULL
;

389 if(
s
!=
NULL
)

391 
iv
->
s
 =ttrs;

392 
	`ngo__li_f
(
iv
->
s
);

394 
	`ngo_yout_t_ibus
(
iv
->
yout
, 
s
);

395 
	`gtk_widg_queue_dw
(
	`GTK_WIDGET
(
widg
));

396 
	}
}

408 
PgoArLi
 *
	$rc_ui_sb_b_g_ibus
(

409 
RCUiSbLab
 *
widg
)

411 
RCUiSbLabPrive
 *
iv
;

412 if(
widg
==
NULL
)  NULL;

413 
iv
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
)->priv;

414 if(
iv
==
NULL
)  NULL;

415  
iv
->
s
;

416 
	}
}

428 
	$rc_ui_sb_b_t_r
(
RCUiSbLab
 *
widg
,

429 
gdoub
 
r
)

431 
RCUiSbLabPrive
 *
iv
;

432 if(
widg
==
NULL
) ;

433 
iv
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
)->priv;

434 if(
iv
==
NULL
) ;

435 if(
r
>=0.0 &&ercent<=1.0)

436 
iv
->
r
 =ercent;

437 if(
r
>1.0)

438 
iv
->
r
 = 1.0;

440 
iv
->
r
 = 0.0;

441 
	`gtk_widg_queue_dw
(
	`GTK_WIDGET
(
widg
));

442 
	}
}

453 
gdoub
 
	$rc_ui_sb_b_g_r
(
RCUiSbLab
 *
widg
)

455 
RCUiSbLabPrive
 *
iv
;

456 if(
widg
==
NULL
)  0.0;

457 
iv
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
)->priv;

458 if(
iv
==
NULL
)  0.0;

459  
iv
->
r
;

460 
	}
}

471 
gt
 
	$rc_ui_sb_b_g_width
(
RCUiSbLab
 *
widg
)

473 
RCUiSbLabPrive
 *
iv
;

474 
gt
 
width
 = 0;

475 if(
widg
==
NULL
)  0;

476 
iv
 = 
	`RC_UI_SCROLLABLE_LABEL
(
widg
)->priv;

477 if(
iv
==
NULL
 ||riv->
yout
==NULL)  0;

478 
	`ngo_yout_g_pix_size
(
iv
->
yout
, &
width
, 
NULL
);

479  
width
;

480 
	}
}

	@ui/rc-ui-slabel.h

26 #ide
HAVE_RC_UI_SCROLLABLE_LABEL_H


27 
	#HAVE_RC_UI_SCROLLABLE_LABEL_H


	)

29 
	~<rg.h
>

30 
	~<glib.h
>

31 
	~<glib-obje.h
>

32 
	~<gdk/gdk.h
>

33 
	~<gtk/gtk.h
>

35 
	gG_BEGIN_DECLS


37 
	#RC_UI_TYPE_SCROLLABLE_LABEL
 (
	`rc_ui_sb_b_g_ty
())

	)

38 
	#RC_UI_SCROLLABLE_LABEL
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
 ((obj), \

39 
RC_UI_TYPE_SCROLLABLE_LABEL
, 
RCUiSbLab
))

	)

41 
	#RC_UI_SCROLLABLE_LABEL_CLASS
(
kss
) \

42 (
	`G_TYPE_CHECK_CLASS_CAST
((
kss
), 
RC_UI_TYPE_SCROLLABLE_LABEL
, \

43 
RCUiSbLabCss
))

	)

44 
	#RC_UI_IS_SCROLLABLE_LABEL
(
obj
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((obj), \

45 
RC_UI_TYPE_SCROLLABLE_LABEL
))

	)

46 
	#RC_UI_IS_SCROLLABLE_LABEL_CLASS
(
kss
) \

47 (
	`G_TYPE_CHECK_CLASS_TYPE
((
kss
), 
RC_UI_TYPE_SCROLLABLE_LABEL
))

	)

49 
_RCUiSbLab
 
	tRCUiSbLab
;

50 
_RCUiSbLabCss
 
	tRCUiSbLabCss
;

51 
_RCUiSbLabPrive
 
	tRCUiSbLabPrive
;

59 
	s_RCUiSbLab
 {

61 
GtkWidg
 
	mwidg
;

62 
RCUiSbLabPrive
 *
	miv
;

71 
	s_RCUiSbLabCss
 {

73 
GtkWidgCss
 
	m_ass
;

77 
GTy
 
rc_ui_sb_b_g_ty
();

80 
GtkWidg
 *
rc_ui_sb_b_w
();

81 
rc_ui_sb_b_t_xt
(
RCUiSbLab
 *
widg
,

82 cڡ 
gch
 *
xt
);

83 cڡ 
gch
 *
rc_ui_sb_b_g_xt
(
RCUiSbLab
 *
widg
);

84 
rc_ui_sb_b_t_ibus
(
RCUiSbLab
 *
widg
,

85 
PgoArLi
 *
s
);

86 
PgoArLi
 *
rc_ui_sb_b_g_ibus
(

87 
RCUiSbLab
 *
widg
);

88 
rc_ui_sb_b_t_r
(
RCUiSbLab
 *
widg
,

89 
gdoub
 
r
);

90 
gdoub
 
rc_ui_sb_b_g_r
(
RCUiSbLab
 *
widg
);

91 
gt
 
rc_ui_sb_b_g_width
(
RCUiSbLab
 *
widg
);

93 
	gG_END_DECLS


	@ui/rc-ui-spectrum.c

26 
	~"rc-ui-erum.h
"

37 
	#RC_UI_SPECTRUM_STYLE_PARAM_READABLE
 
G_PARAM_READABLE
 | \

38 
G_PARAM_STATIC_NAME
 | 
G_PARAM_STATIC_NICK
 | 
G_PARAM_STATIC_BLURB


	)

40 
	#RC_UI_SPECTRUM_BANDS
 4096

	)

42 
	sRCUiSrumChl


44 
gt
 *
	mput
;

45 
gt
 *
	mput_tmp
;

46 
GFFTF32Comex
 *
	meqda
;

47 
gt
 *
	me_magnude
;

48 
GFFTF32
 *
	mf_x
;

49 }
	tRCUiSrumChl
;

51 
	s_RCUiSrumWidgPrive


53 
gut
 
	ms
;

54 
RCUiSrumSty
 
	my
;

55 
GBufr
 *
	mbufr
;

56 
GMux
 
	mbufr_mux
;

57 
gut64
 
	merum_num_ames
;

58 
gut64
 
	merum_num_f
;

59 
gut64
 
	merum_accumuϋd_r
;

60 
RCUiSrumChl
 *
	merum_chl_da
;

61 
gut
 
	merum_
;

62 
gt
 
	merum_thshd
;

63 
gt
 *
	merum_da
;

64 
gt
 *
	merum_bd_da
;

65 
gut
 
	merum_da_size
;

66 
gut32
 *
	mwave_vda
;

67 
gut
 
	mwave_vda_size
;

68 
gut
 
	mtimeout_id
;

69 
gulg
 
	mbufr_obe_id
;

72 
gpor
 
	grc_ui_erum_widg__ass
 = 
NULL
;

74 
	#rc_ui_erum_dw_d
(
_vd
, 
_s
, 
_x
, 
_y
, 
_
, 
_c
) \

75 
G_STMT_START
 { \

76 
gut
 
p
 = (
_y
 * 
_
+ 
_x
; \

77 if(
p
>=
_s
/(
gut32
)) ; \

78 
_vd
[
p
] = 
_c
; \

79 } 
G_STMT_END


	)

81 
	#rc_ui_erum_dw_d_
(
_vd
, 
_s
, 
_x
, 
_y
, 
_
, 
_c
, 
_f
, 
_bc
) \

82 
G_STMT_START
 { \

83 
gut32
 
_oc
, 
_c1
, 
_c2
, 
_c3
; \

84 
gut
 
p
 = (
_y
 * 
_
+ 
_x
; \

85 if(
p
>=
_s
/(
gut32
)) ; \

86 
_oc
 = 
_vd
[
p
]; \

87 if(
_oc
==
_bc
) \

89 
_vd
[
p
] = 
_c
; \

92 
_c3
 = (
_oc
 & 0xff+ ((
_c
 & 0xff* 
_f
); \

93 
_c3
 = 
	`MIN
(_c3, 255); \

94 
_c2
 = ((
_oc
 & 0xff00>> 8+ (((
_c
 & 0xff00>> 8* 
_f
); \

95 
_c2
 = 
	`MIN
(_c2, 255); \

96 
_c1
 = ((
_oc
 & 0xff0000>> 16+ (((
_c
 & 0xff0000>> 16* 
_f
); \

97 
_c1
 = 
	`MIN
(_c1, 255); \

98 
_vd
[
p
] = (
_c1
 << 16| (
_c2
 << 8| 
_c3
; \

99 } 
G_STMT_END


	)

101 
	#rc_ui_erum_dw_le
(
_vd
, 
_s
, 
_x1
, 
_x2
, 
_y1
, 
_y2
, 
_
, 
_c
) \

102 
G_STMT_START
 { \

103 
gut
 
_i
, 
_j
, 
_x
, 
_y
; \

104 
gt
 
_dx
 = 
_x2
 - 
_x1
, 
_dy
 = 
_y2
 - 
_y1
; \

105 
gt
 
_f
; \

106 
_j
 = 
	`abs
 (
_dx
>b(
_dy
) ?bs (_dx) :bs (_dy); \

107 
_i
 = 0; _< 
_j
; _i++) \

109 
_f
 = (
gt

_i
 / (gt
_j
; \

110 
_x
 = 
_x1
 + 
_dx
 * 
_f
; \

111 
_y
 = 
_y1
 + 
_dy
 * 
_f
; \

112 
	`rc_ui_erum_dw_d
(
_vd
, 
_s
, 
_x
, 
_y
, 
_
, 
_c
); \

114 } 
G_STMT_END


	)

116 
	#rc_ui_erum_dw_le_
(
_vd
, 
_s
, 
_x1
, 
_x2
, 
_y1
, 
_y2
, 
_
, 
_c
, \

117 
_bc
) \

118 
G_STMT_START
 { \

119 
gut
 
_i
, 
_j
, 
_x
, 
_y
; \

120 
gt
 
_dx
 = 
_x2
 - 
_x1
, 
_dy
 = 
_y2
 - 
_y1
; \

121 
gt
 
_f
, 
_rx
, 
_ry
, 
_fx
, 
_fy
; \

122 
_j
 = 
	`abs
 (
_dx
>b(
_dy
) ?bs (_dx) :bs (_dy); \

123 
_i
 = 0; _< 
_j
; _i++) \

125 
_f
 = (
gt

_i
 / (gt
_j
; \

126 
_rx
 = 
_x1
 + 
_dx
 * 
_f
; \

127 
_ry
 = 
_y1
 + 
_dy
 * 
_f
; \

128 
_x
 = (
gut
)
_rx
; \

129 
_y
 = (
gut
)
_ry
; \

130 
_fx
 = 
_rx
 - (
gt
)
_x
; \

131 
_fy
 = 
_ry
 - (
gt
)
_y
; \

132 
_f
 = ((1.0 - 
_fx
+ (1.0 - 
_fy
)) / 2.0; \

133 
	`rc_ui_erum_dw_d_
(
_vd
, 
_s
, 
_x
, 
_y
, 
_
, 
_c
, 
_f
, 
_bc
); \

134 
_f
 = (
_fx
 + (1.0 - 
_fy
)) / 2.0; \

135 
	`rc_ui_erum_dw_d_
 (
_vd
, 
_s
, (
_x
 + 1), 
_y
, 
_
, 
_c
, 
_f
, \

136 
_bc
); \

137 
_f
 = ((1.0 - 
_fx
+ 
_fy
) / 2.0; \

138 
	`rc_ui_erum_dw_d_
 (
_vd
, 
_s
, 
_x
, (
_y
 + 1), 
_
, 
_c
, 
_f
, \

139 
_bc
); \

140 
_f
 = (
_fx
 + 
_fy
) / 2.0; \

141 
	`rc_ui_erum_dw_d_
 (
_vd
, 
_s
, (
_x
 + 1), (
_y
 + 1), 
_
, \

142 
_c
, 
_f
, 
_bc
); \

144 } 
G_STMT_END


	)

146 
le
 
	$rc_ui_erum_ush
(
RCUiSrumWidgPrive
 *
iv
)

148 
iv
->
erum_num_ames
 = 0;

149 
iv
->
erum_num_f
 = 0;

150 
iv
->
erum_accumuϋd_r
 = 0;

151 
	}
}

153 
le
 
	$rc_ui_erum_loc_chl_da
(

154 
RCUiSrumWidgPrive
 *
iv
, 
gut
 
bds
)

156 
RCUiSrumChl
 *
cd
;

157 
gut
 
nf
 = 2 * 
bds
 - 2;

158 if(
iv
->
erum_chl_da
!=
NULL
) ;

159 
iv
->
erum_chl_da
 = 
	`g_w
(
RCUiSrumChl
, 1);

160 
cd
 = 
iv
->
erum_chl_da
;

161 
cd
->
f_x
 = 
	`g_f_f32_w
(
nf
, 
FALSE
);

162 
cd
->
put
 = 
	`g_w0
(
gt
, 
nf
);

163 
cd
->
put_tmp
 = 
	`g_w0
(
gt
, 
nf
);

164 
cd
->
eqda
 = 
	`g_w0
(
GFFTF32Comex
, 
bds
);

165 
cd
->
e_magnude
 = 
	`g_w0
(
gt
, 
bds
);

166 
	}
}

168 
le
 
	$rc_ui_erum__chl_da
(

169 
RCUiSrumWidgPrive
 *
iv
)

171 
RCUiSrumChl
 *
cd
;

172 if(
iv
->
erum_chl_da
==
NULL
) ;

173 
cd
 = 
iv
->
erum_chl_da
;

174 if(
cd
->
f_x
!=
NULL
)

175 
	`g_f_f32_
(
cd
->
f_x
);

176 
	`g_
(
cd
->
put
);

177 
	`g_
(
cd
->
put_tmp
);

178 
	`g_
(
cd
->
eqda
);

179 
	`g_
(
cd
->
e_magnude
);

180 
	`g_
(
iv
->
erum_chl_da
);

181 
iv
->
erum_chl_da
 = 
NULL
;

182 
	}
}

184 
le
 
	$rc_ui_erum_t_e
(

185 
RCUiSrumWidgPrive
 *
iv
)

187 
	`rc_ui_erum__chl_da
(
iv
);

188 
	`rc_ui_erum_ush
(
iv
);

189 
	}
}

191 
le
 
	$rc_ui_erum_put_da_mixed_t
(

192 cڡ 
gut8
 *
_
, 
gt
 *
out
, 
gut
 
n
, gu
chls
,

193 
gt
 
max_vue
, 
gut
 

, gu
nf
)

195 
gut
 
i
, 
j
, 

 = 0;

196 
gt
 
v
;

197 
gt
 *

 = (g߈*)
_
;

198 
j
=0;j<
n
;j++)

200 
v
 = 

[

++];

201 
i
=1;i<
chls
;i++)

202 
v
+=

[

++];

203 
out
[

] = 
v
 / 
chls
;

204 

 = ( + 1)%
nf
;

206 
	}
}

208 
le
 
	$rc_ui_erum_put_da_mixed_doub
(

209 cڡ 
gut8
 *
_
, 
gt
 *
out
, 
gut
 
n
, gu
chls
,

210 
gt
 
max_vue
, 
gut
 

, gu
nf
)

212 
gut
 
i
, 
j
, 

 = 0;

213 
gt
 
v
;

214 
gdoub
 *

 = (gdoub *)
_
;

215 
j
=0;j<
n
;j++)

217 
v
 = 

[

++];

218 
i
=1;i<
chls
;i++)

219 
v
+=

[

++];

220 
out
[

] = 
v
 / 
chls
;

221 

 = ( + 1)%
nf
;

223 
	}
}

225 
le
 
	$rc_ui_erum_put_da_mixed_t32
(

226 cڡ 
gut8
 *
_
, 
gt
 *
out
, 
gut
 
n
, gu
chls
,

227 
gt
 
max_vue
, 
gut
 

, gu
nf
)

229 
gut
 
i
, 
j
, 

 = 0;

230 
gt32
 *

 = (gt32 *)
_
;

231 
gt
 
v
;

232 
j
=0;j<
n
;j++)

234 
v
 = 

[

++] * 2 + 1;

235 
i
=1;i<
chls
;i++)

236 
v
 +

[

++] * 2 + 1;

237 
out
[

] = 
v
 / 
chls
;

238 

 = ( + 1)%
nf
;

240 
	}
}

242 
le
 
	$rc_ui_erum_put_da_mixed_t32_max
(

243 cڡ 
gut8
 *
_
, 
gt
 *
out
, 
gut
 
n
, gu
chls
,

244 
gt
 
max_vue
, 
gut
 

, gu
nf
)

246 
gut
 
i
, 
j
, 

 = 0;

247 
gt32
 *

 = (gt32 *
_
;

248 
gt
 
v
;

249 
j
=0;j<
n
;j++)

251 
v
 = 

[

++] / 
max_vue
;

252 
i
=1;i<
chls
;i++)

253 
v
 +

[

++] / 
max_vue
;

254 
out
[

] = 
v
 / 
chls
;

255 

 = ( + 1% 
nf
;

257 
	}
}

259 
le
 
	$rc_ui_erum_put_da_mixed_t24
(

260 cڡ 
gut8
 *
_
, 
gt
 *
out
, 
gut
 
n
, gu
chls
,

261 
gt
 
max_vue
, 
gut
 

, gu
nf
)

263 
gut
 
i
, 
j
;

264 
gt
 
v
 = 0.0;

265 
gt32
 
vue
;

266 
j
=0;j<
n
;j++)

268 
i
=0;i<
chls
;i++)

270 #i
G_BYTE_ORDER
==
G_BIG_ENDIAN


271 
vue
 = 
	`GST_READ_UINT24_BE
 (
_
);

273 
vue
 = 
	`GST_READ_UINT24_LE
 (
_
);

275 if(
vue
 & 0x00800000)

276 
vue
 |= 0xff000000;

277 
v
 +
vue
 * 2 + 1;

278 
_
 += 3;

280 
out
[

] = 
v
 / 
chls
;

281 

 = ( + 1)%
nf
;

283 
	}
}

285 
le
 
	$rc_ui_erum_put_da_mixed_t24_max
(

286 cڡ 
gut8
 * 
_
, 
gt
 *
out
, 
gut
 
n
, gu
chls
,

287 
gt
 
max_vue
, 
gut
 

, gu
nf
)

289 
gut
 
i
, 
j
;

290 
gt
 
v
 = 0.0;

291 
gt32
 
vue
;

292 
j
=0;j<
n
;j++)

294 
i
=0;i< 
chls
;i++)

296 #i
G_BYTE_ORDER
==
G_BIG_ENDIAN


297 
vue
 = 
	`GST_READ_UINT24_BE
 (
_
);

299 
vue
 = 
	`GST_READ_UINT24_LE
 (
_
);

301 if(
vue
 & 0x00800000)

302 
vue
 |= 0xff000000;

303 
v
 +
vue
 / 
max_vue
;

304 
_
 += 3;

306 
out
[

] = 
v
 / 
chls
;

307 

 = ( + 1% 
nf
;

309 
	}
}

311 
le
 
	$rc_ui_erum_put_da_mixed_t16
(

312 cڡ 
gut8
 *
_
, 
gt
 *
out
, 
gut
 
n
, gu
chls
,

313 
gt
 
max_vue
, 
gut
 

, gu
nf
)

315 
gut
 
i
, 
j
, 

 = 0;

316 
gt16
 *

 = (gt16 *)
_
;

317 
gt
 
v
;

318 
j
=0;j<
n
;j++)

320 
v
 = 

[

++] * 2 + 1;

321 
i
=1;i<
chls
;i++)

322 
v
 +

[

++] * 2 + 1;

323 
out
[

] = 
v
 / 
chls
;

324 

 = ( + 1)%
nf
;

326 
	}
}

328 
	$rc_ui_erum_put_da_mixed_t16_max
(

329 cڡ 
gut8
 *
_
, 
gt
 *
out
, 
gut
 
n
, gu
chls
,

330 
gt
 
max_vue
, 
gut
 

, gu
nf
)

332 
gut
 
i
, 
j
, 

 = 0;

333 
gt16
 *

 = (gt16 *)
_
;

334 
gt
 
v
;

335 
j
=0;j<
n
;j++)

337 
v
 = 

[

++] / 
max_vue
;

338 
i
=1;i<
chls
;i++)

339 
v
 +

[

++] / 
max_vue
;

340 
out
[

] = 
v
 / 
chls
;

341 

 = ( + 1)%
nf
;

343 
	}
}

345 
le
 
	$rc_ui_erum_put_da
(cڡ 
gch
 *
mimy
,

346 
gt
 
width
, g
dth
, cڡ 
gut8
 *

, 
gt
 *
out
, 
gut
 
n
,

347 
gut
 
chls
, 
gt
 
_max_vue
, gu

, gu
nf
)

349 
gboޗn
 
is_t
 = 
FALSE
;

350 
gut
 
max_vue
 = (1UL << (
dth
 - 1)) - 1;

351 if(
	`g_rcmp0
(
mimy
, "audio/x-raw-float")==0)

352 
is_t
 = 
TRUE
;

353 if(
is_t
)

355 if(
width
==4)

356 
	`rc_ui_erum_put_da_mixed_t
(

, 
out
, 
n
,

357 
chls
, 
_max_vue
, 

, 
nf
);

358 if(
width
==8)

359 
	`rc_ui_erum_put_da_mixed_doub
(

, 
out
, 
n
,

360 
chls
, 
_max_vue
, 

, 
nf
);

364 if(
width
==4)

366 if(
max_vue
)

367 
	`rc_ui_erum_put_da_mixed_t32_max
(

, 
out
, 
n
,

368 
chls
, 
_max_vue
, 

, 
nf
);

370 
	`rc_ui_erum_put_da_mixed_t32
(

, 
out
, 
n
,

371 
chls
, 
_max_vue
, 

, 
nf
);

373 if(
width
==3)

375 if(
max_vue
)

376 
	`rc_ui_erum_put_da_mixed_t24_max
(

, 
out
, 
n
,

377 
chls
, 
_max_vue
, 

, 
nf
);

379 
	`rc_ui_erum_put_da_mixed_t24
(

, 
out
, 
n
,

380 
chls
, 
_max_vue
, 

, 
nf
);

382 if(
width
==2)

384 if(
max_vue
)

385 
	`rc_ui_erum_put_da_mixed_t16_max
(

, 
out
, 
n
,

386 
chls
, 
_max_vue
, 

, 
nf
);

388 
	`rc_ui_erum_put_da_mixed_t16
(

, 
out
, 
n
,

389 
chls
, 
_max_vue
, 

, 
nf
);

392 
	}
}

394 
le
 
	$rc_ui_erum_run_f
(
RCUiSrumChl
 *
cd
,

395 
gut
 
bds
, 
gt
 
thshd
, gu
put_pos
)

397 
gut
 
i
;

398 
gut
 
nf
 = 2 * 
bds
 - 2;

399 
gdoub
 
v
;

400 
gt
 *
put
 = 
cd
->input;

401 
gt
 *
put_tmp
 = 
cd
->input_tmp;

402 
gt
 *
e_magnude
 = 
cd
->spect_magnitude;

403 
GFFTF32Comex
 *
eqda
 = 
cd
->freqdata;

404 
GFFTF32
 *
f_x
 = 
cd
->fft_ctx;

405 
i
=0;i<
nf
;i++)

406 
put_tmp
[
i
] = 
put
[(
put_pos
 + i% 
nf
];

407 
	`g_f_f32_wdow
(
f_x
, 
put_tmp
, 
GST_FFT_WINDOW_HAMMING
);

408 
	`g_f_f32_f
(
f_x
, 
put_tmp
, 
eqda
);

409 
i
=0;i<
bds
;i++)

411 
v
 = 
eqda
[
i
].
r
 * freqdata[i].r;

412 
v
 +
eqda
[
i
].i * freqdata[i].i;

413 
v
 /
nf
 *fft;

414 
v
 = 10.0 * 
	`log10
 (val);

415 i(
v
 < 
thshd
)

416 
v
 = 
thshd
;

417 
e_magnude
[
i
] +
v
;

419 
	}
}

421 
le
 
	$rc_ui_erum_run
(
RCUiSrumWidg
 *
erum
,

422 
GBufr
 *
buf
, cڡ 
gch
 *
mimy
, 
gt
 

, g
chls
,

423 
gt
 
width
, g
dth
)

425 
RCUiSrumWidgPrive
 *
iv
;

426 
gut
 
erum_put_pos
 = 0;

427 
gut64
 
erum_r_r_rv
 = 0;

428 
gut64
 
erum_ames_r_rv
 = 0;

429 
gut64
 
erum_ames_todo
 = 0;

430 
gt
 
i
;

431 
RCUiSrumChl
 *
cd
;

432 cڡ 
gut8
 *
buf_da
 = 
	`GST_BUFFER_DATA
(
buf
);

433 
gt
 
max_vue
;

434 
gt
 
thshd
 = -60;

435 
gut
 
bds
;

436 
gut
 
nf
;

437 
gut
 
size
 = 
	`GST_BUFFER_SIZE
(
buf
);

438 
gt64
 
rv
 = 
GST_SECOND
 / 10;

439 
gt
 
ame_size
;

440 
gt
 *
put
;

441 
gut
 
put_pos
;

442 
gut
 
f_todo
, 
msg_todo
, 
block_size
;

443 
gboޗn
 
have_fu_rv
;

444 if(
erum
==
NULL
) ;

445 
iv
 = 
erum
->priv;

446 if(
iv
==
NULL
) ;

447 
width
 = width / 8;

448 
ame_size
 = 
width
 * 
chls
;

449 
max_vue
 = (1UL << (
dth
 - 1)) - 1;

450 
bds
 = 
RC_UI_SPECTRUM_BANDS
;

451 
nf
 = 2*
bds
 - 2;

452 if(
	`GST_BUFFER_IS_DISCONT
(
buf
))

453 
	`rc_ui_erum_ush
(
iv
);

454 if(
iv
->
erum_chl_da
==
NULL
)

456 
	`rc_ui_erum_loc_chl_da
(
iv
, 
bds
);

457 
erum_ames_r_rv
 = 
	`g_ut_ut64_s
(
rv
,

458 

, 
GST_SECOND
);

459 
erum_ames_todo
 = 
erum_ames_r_rv
;

460 
erum_r_r_rv
 = (
rv
 * 

% 
GST_SECOND
;

461 if(
erum_ames_r_rv
==0)

462 
erum_ames_r_rv
 = 1;

463 
erum_put_pos
 = 0;

464 
	`rc_ui_erum_ush
(
iv
);

466 
put_pos
 = 
erum_put_pos
;

467 
size
>=
ame_size
)

469 
f_todo
 = 
nf
 - (
iv
->
erum_num_ames
 %fft);

470 
msg_todo
 = 
erum_ames_todo
 - 
iv
->
erum_num_ames
;

471 
block_size
 = 
msg_todo
;

472 if(
block_size
 > (
size
 / 
ame_size
))

473 
block_size
 = (
size
 / 
ame_size
);

474 if(
block_size
 > 
f_todo
)

475 
block_size
 = 
f_todo
;

476 
cd
 = 
iv
->
erum_chl_da
;

477 
put
 = 
cd
->input;

478 
	`rc_ui_erum_put_da
(
mimy
, 
width
, 
dth
,

479 (cڡ 
gut8
 *)
buf_da
, 
put
, 
block_size
, 
chls
,

480 
max_vue
, 
put_pos
, 
nf
);

481 
buf_da
 +
block_size
 * 
ame_size
;

482 
size
 -
block_size
 * 
ame_size
;

483 
put_pos
 = (put_po+ 
block_size
% 
nf
;

484 
iv
->
erum_num_ames
 +
block_size
;

485 
have_fu_rv
 = (
iv
->
erum_num_ames
 ==

486 
erum_ames_todo
);

487 if((
iv
->
erum_num_ames
 % 
nf
 == 0) ||

488 (
have_fu_rv
 && !
iv
->
erum_num_f
))

490 
cd
 = 
iv
->
erum_chl_da
;

491 
	`rc_ui_erum_run_f
(
cd
, 
bds
, 
thshd
, 
put_pos
);

492 
iv
->
erum_num_f
++;

494 if(
have_fu_rv
)

496 
erum_ames_todo
 = 
erum_ames_r_rv
;

497 if(
iv
->
erum_accumuϋd_r
 >
GST_SECOND
)

499 
iv
->
erum_accumuϋd_r
 -
GST_SECOND
;

500 
erum_ames_todo
++;

502 
iv
->
erum_accumuϋd_r
 +=

503 
erum_r_r_rv
;

504 
cd
 = 
iv
->
erum_chl_da
;

505 
i
=0;i<
bds
;i++)

507 
cd
->
e_magnude
[
i
] /
iv
->
erum_num_f
;

508 
iv
->
erum_bd_da
[
i
] = 
cd
->
e_magnude
[i];

510 
iv
->
erum_
 = 

;

511 
iv
->
erum_thshd
 = 
thshd
;

512 
cd
 = 
iv
->
erum_chl_da
;

513 
	`memt
(
cd
->
e_magnude
, 0, 
bds
*(
gt
));

514 
iv
->
erum_num_ames
 = 0;

515 
iv
->
erum_num_f
 = 0;

518 
erum_put_pos
 = 
put_pos
;

519 
	}
}

521 
le
 
gt
 
	$rc_ui_erum_wave_g_un_da
(cڡ 
gut8
 *
ada
,

522 
gut
 
asize
, gu
s
, 
gboޗn
 
is_t
, 
gt
 
width
)

524 
gt
 
t
 = 0.0;

525 if(
s
*
width
 > 
asize
)  0.0;

526 if(
is_t
)

528 if(
width
==8)

529 
t
 = (
gt
)((
gdoub
 *)
ada
)[
s
];

530 if(
width
==4)

531 
t
 = (
gt
)((g߈*)
ada
)[
s
];

535 
width
)

538 
t
 = (
gt
)((
gt32
 *)
ada
)[
s
];

542 
gt32
 
tmp
 = 0.0;

543 #i
G_BYTE_ORDER
==
G_BIG_ENDIAN


544 
tmp
 = 
	`GST_READ_UINT24_BE
(
ada
+
s
*3);

546 
tmp
 = 
	`GST_READ_UINT24_LE
(
ada
+
s
*3);

548 if(
tmp
 & 0x00800000)

549 
tmp
 |= 0xFF000000;

550 
t
 = (
gt
)
tmp
;

554 
t
 = (
gt
)((
gt16
 *)
ada
)[
s
];

557 
t
 = (
gt
)((
gut8
 *)
ada
)[
s
] - 128;

563  
t
;

564 
	}
}

566 
le
 
	$rc_ui_erum_erum_lcuϋ
(
gt
 *
sda
,

567 
gut
 
ssize
, 
gt
 *
bds
, gu
bsize
, 
gt
 

, g߈
thshd
)

569 cڡ 
gdoub
 
maxeq
 = 20000;

570 cڡ 
gdoub
 
mideq
 = 1000;

571 
gdoub
 
midlog
;

572 
gdoub
 
v
;

573 
gdoub
 
low
, 
u
, 
mid
;

574 
gdoub
 
eq1
, 
eq2
;

575 
gt
 
i
, 
j
;

576 
gut
 
l
, 
u
;

577 
gt
 
vue
;

578 
midlog
 = 
	`log2
(
maxeq
/
mideq
);

579 
v
 = 2 * 
midlog
 / (
ssize
);

580 
i
=0;i<
ssize
;i++
sda
[i] = 
thshd
;

581 
i
=0;i<
ssize
;i++)

583 if(
i
==0)

584 
low
 = 0;

586 
low
 = 
maxeq
 / 
	`pow
(2, (
v
 * (
ssize
 - 
i
)));

587 
u
 = 
maxeq
 / 
	`pow
(2, (
v
 * (
ssize
 - 
i
 - 1)));

588 
l
 = (
low
/

*2* 
bsize
;

589 
u
 = (
u
/

*2* 
bsize
;

590 if(
l
>=
bsize
) ;

591 
vue
 = 0.0;

592 if(
u
-
l
>1)

594 
vue
 = 
bds
[
l
];

595 
j
=
l
;j<
u
;j++)

597 if(
j
>=
bsize
) ;

598 
vue
 = 
	`MAX
(vue, 
bds
[
j
]);

603 
mid
 = (
low
 + 
u
) / 2;

604 
eq1
 = 
l
 * 

 / 2 / 
bsize
;

605 
eq2
 = (
l
+1* 

 / 2 /
bsize
;

606 
eq1
 = 
	`ABS
(eq1 - 
mid
);

607 
eq2
 = 
	`ABS
(eq2 - 
mid
);

608 if(
l
+1<
bsize
)

610 
vue
 = 
bds
[
l
] * 
eq2
 / (
eq1
+freq2) +

611 
bds
[
l
+1] * 
eq1
 / (eq1+
eq2
);

614 
vue
 = 
bds
[
l
];

616 
sda
[
i
] = 
vue
;

618 
	}
}

620 
le
 
	$rc_ui_erum_wave_nd_les
(
gut32
 *
vda
,

621 
gut
 
vsize
, gu
vwidth
, gu
vheight
, cڡ 
gut8
 *
ada
,

622 
gut
 
asize
, cڡ 
gch
 *
mimy
, gu
num_mes
, 
gt
 
chls
,

623 
gt
 
awidth
, g
adth
, 
gut32
 
bg_c
, gut32 
fg_c1
,

624 
gut32
 
fg_c2
, 
gboޗn
 
mui_chl
)

626 
gut
 
i
, 
c
, 
s
, 
x
 = 0, 
y
 = 0, 
oy
;

627 
gt
 
dx
, 
dy
;

628 
gt
 
x2
 = 0, 
y2
 = 0;

629 
gut
 
tsize
;

630 
gut32
 
fg_c
;

631 
gboޗn
 
is_t
 = 
FALSE
;

632 
gt
 
max_vue
 = (1UL << (
adth
));

633 
tsize
 = 
vwidth
 * 
vheight
;

634 
i
=0;i<
tsize
;i++)

635 
vda
[
i
] = 
bg_c
;

636 if(
	`g_rcmp0
(
mimy
, "audio/x-raw-float")==0)

638 
is_t
 = 
TRUE
;

639 
max_vue
 = 2.0;

641 if(
num_mes
>=4096)

642 
num_mes
 /= 8;

643 if(
num_mes
>=2048)

644 
num_mes
 /= 4;

645 if(
num_mes
>=1024)

646 
num_mes
 /= 2;

647 
dx
 = (
gt
(
vwidth
 - 1/ (gt
num_mes
;

648 
dy
 = (
vheight
 - 1/ 
max_vue
;

649 
oy
 = (
vheight
 - 1) / 2;

650 
awidth
 =width / 8;

651 if(
mui_chl
)

653 
c
=0;c<
chls
;c++)

655 
s
 = 
c
;

656 
x2
 = 0;

657 
y2
 = (
gut
)(
oy
 + 
	`rc_ui_erum_wave_g_un_da
(
ada
, 
asize
,

658 
s
, 
is_t
, 
awidth
* 
dy
);

659 if(
c
%2==1)

660 
fg_c
 = 
fg_c2
;

662 
fg_c
 = 
fg_c1
;

663 
i
=1;i<
num_mes
;i++)

665 
x
 = (
gut
)((
gt

i
 * 
dx
);

666 
y
 = (
gut
)(
oy
 + 
	`rc_ui_erum_wave_g_un_da
(
ada
,

667 
asize
, 
s
, 
is_t
, 
awidth
* 
dy
);

668 
s
 +
chls
;

669 
x
 = 
	`CLAMP
(x, 0, 
vwidth
-1);

670 
y
 = 
	`CLAMP
(y, 0, 
vheight
-1);

671 
x2
 = 
	`CLAMP
(x2, 0, 
vwidth
-1);

672 
y2
 = 
	`CLAMP
(y2, 0, 
vheight
-1);

673 
	`rc_ui_erum_dw_le_
(
vda
, 
vsize
, 
x2
, 
x
, 
y2
, 
y
, 
vwidth
,

674 
fg_c
, 
bg_c
);

675 
x2
 = 
x
;

676 
y2
 = 
y
;

682 
s
 = 0;

683 
x2
 = 0;

684 
y2
 = 0;

685 
c
=0;c<
chls
;c++)

687 
y2
 +(
gut
)(
oy
 + 
	`rc_ui_erum_wave_g_un_da
(
ada
, 
asize
,

688 
s
+
c
, 
is_t
, 
awidth
* 
dy
);

690 
y2
 = y2 / 
chls
;

691 
i
=1;i<
num_mes
;i++)

693 
x
 = (
gut
)((
gt

i
 * 
dx
);

694 
y
 = 0;

695 
c
=0;c<
chls
;c++)

697 
y
 +(
gut
)(
oy
 + 
	`rc_ui_erum_wave_g_un_da
(
ada
,

698 
asize
, 
s
+
c
, 
is_t
, 
awidth
* 
dy
);

700 
y
 = y / 
chls
;

701 
s
 +
chls
;

702 
x
 = 
	`CLAMP
(x, 0, 
vwidth
-1);

703 
y
 = 
	`CLAMP
(y, 0, 
vheight
-1);

704 
x2
 = 
	`CLAMP
(x2, 0, 
vwidth
-1);

705 
y2
 = 
	`CLAMP
(y2, 0, 
vheight
-1);

706 
	`rc_ui_erum_dw_le_
(
vda
, 
vsize
, 
x2
, 
x
, 
y2
, 
y
, 
vwidth
,

707 
fg_c1
, 
bg_c
);

708 
x2
 = 
x
;

709 
y2
 = 
y
;

712 
	}
}

714 
	$rc_ui_erum_bufr_obe_cb
(
RCLibCe
 *
ce
, 
GBufr
 *
buf
,

715 
gpor
 
da
)

718 
RCUiSrumWidg
 *
erum
;

719 
RCUiSrumWidgPrive
 *
iv
;

720 
gt
 

 = 0;

721 
gt
 
chls
 = 0;

722 
gt
 
width
 = 0;

723 
gt
 
dth
 = 0;

724 cڡ 
gch
 *
mimy
;

725 
GCs
 *
ps
;

726 
GSuu
 *
ruu
;

727 if(
da
==
NULL
) ;

728 
erum
 = 
	`RC_UI_SPECTRUM_WIDGET
(
da
);

729 if(
erum
==
NULL
) ;

730 
iv
 = 
erum
->priv;

731 if(
iv
==
NULL
) ;

732 if(
buf
==
NULL
) ;

733 
	`g_mux_lock
(&(
iv
->
bufr_mux
));

734 
	`g_bufr_a
(&(
iv
->
bufr
), 
buf
);

735 
	`g_mux_uock
(&(
iv
->
bufr_mux
));

736 if(
iv
->
y
==
RC_UI_SPECTRUM_STYLE_SPECTRUM
)

738 
ps
 = 
	`g_bufr_g_ps
(
buf
);

739 if(
ps
==
NULL
) ;

740 
ruu
 = 
	`g_ps_g_ruu
(
ps
, 0);

741 
mimy
 = 
	`g_ruu_g_me
(
ruu
);

742 
	`g_ruu_g_t
(
ruu
, "", &

);

743 
	`g_ruu_g_t
(
ruu
, "chls", &
chls
);

744 
	`g_ruu_g_t
(
ruu
, "width", &
width
);

745 
	`g_ruu_g_t
(
ruu
, "dth", &
dth
);

746 
	`g_ps_uef
(
ps
);

747 if(
dth
==0dth = 
width
;

748 if(

==0 || 
width
==0 || 
chls
==0) ;

749 
	`rc_ui_erum_run
(
erum
, 
buf
, 
mimy
, 

, 
chls
,

750 
width
, 
dth
);

752 
	}
}

754 
	$rc_ui_erum_widg_ize
(
GtkWidg
 *
widg
)

756 
RCUiSrumWidg
 *
erum
;

757 
GdkWdowAr
 
ibus
;

758 
GtkAoti
 
loti
;

759 
GdkWdow
 *
wdow
, *

;

760 
gt
 
_mask
;

761 
GtkStyCڋxt
 *
cڋxt
;

762 
	`g_tu_if_
(
widg
!=
NULL
);

763 
	`g_tu_if_
(
	`IS_RC_UI_SPECTRUM_WIDGET
(
widg
));

764 
erum
 = 
	`RC_UI_SPECTRUM_WIDGET
(
widg
);

765 
	`gtk_widg_t_ized
(
widg
, 
TRUE
);

766 
	`gtk_widg_g_loti
(
widg
, &
loti
);

767 
ibus
.
x
 = 
loti
.x;

768 
ibus
.
y
 = 
loti
.y;

769 
ibus
.
width
 = 
loti
.width;

770 
ibus
.
height
 = 
loti
.height;

771 
ibus
.
wass
 = 
GDK_INPUT_OUTPUT
;

772 
ibus
.
wdow_ty
 = 
GDK_WINDOW_CHILD
;

773 
ibus
.
evt_mask
 = 
	`gtk_widg_g_evts
(
widg
);

774 
ibus
.
evt_mask
 |(
GDK_EXPOSURE_MASK
);

775 
ibus
.
visu
 = 
	`gtk_widg_g_visu
(
widg
);

776 
_mask
 = 
GDK_WA_X
 | 
GDK_WA_Y
 | 
GDK_WA_VISUAL
;

777 
	`gtk_widg_t_has_wdow
(
widg
, 
TRUE
);

778 

 = 
	`gtk_widg_g__wdow
(
widg
);

779 
wdow
 = 
	`gdk_wdow_w
(

, &
ibus
, 
_mask
);

780 
	`gtk_widg_t_wdow
(
widg
, 
wdow
);

781 
	`gdk_wdow_t_ur_da
(
wdow
, 
erum
);

782 
	`gdk_wdow_t_background_n
(
wdow
, 
NULL
);

783 
cڋxt
 = 
	`gtk_widg_g_y_cڋxt
(
widg
);

784 
	`gtk_y_cڋxt_t_background
(
cڋxt
, 
wdow
);

785 
	`gdk_wdow_show
(
wdow
);

786 
	}
}

788 
	$rc_ui_erum_widg_size_lo
(
GtkWidg
 *
widg
,

789 
GtkAoti
 *
loti
)

791 
GdkWdow
 *
wdow
;

792 
	`g_tu_if_
(
widg
!=
NULL
);

793 
	`g_tu_if_
(
	`IS_RC_UI_SPECTRUM_WIDGET
(
widg
));

794 
	`gtk_widg_t_loti
(
widg
, 
loti
);

795 
wdow
 = 
	`gtk_widg_g_wdow
(
widg
);

796 if(
	`gtk_widg_g_ized
(
widg
))

798 
	`gdk_wdow_move_size
(
wdow
, 
loti
->
x
,oti->
y
,

799 
loti
->
width
,oti->
height
);

801 
	}
}

803 
	$rc_ui_erum_widg_g_eed_height
(
GtkWidg
 *
widg
,

804 
gt
 *
m_height
, g*
t_height
)

806 *
m_height
 = 15;

807 *
t_height
 = 24;

808 
	}
}

810 
gboޗn
 
	$rc_ui_erum_widg_dw
(
GtkWidg
 *
widg
, 
o_t
 *

)

812 
RCUiSrumWidg
 *
erum
;

813 
RCUiSrumWidgPrive
 *
iv
;

814 
GCs
 *
ps
;

815 
GSuu
 *
ruu
;

816 
GtkAoti
 
loti
;

817 
GBufr
 *
bufr
 = 
NULL
;

818 cڡ 
gut8
 *
ada
;

819 
gut
 
asize
;

820 
gut
 
num_mes
 = 0;

821 
gt
 

 = 0, 
chls
 = 0, 
width
 = 0, 
dth
 = 0;

822 cڡ 
gch
 *
mimy
 = 
NULL
;

823 
gt
 
r
;

824 
gt
 
i
;

825 
GdkRGBA
 
c
;

826 
GdkRGBA
 
bg_c
;

827 
GdkC
 *
wave_chl_c1
 = 
NULL
;

828 
GdkC
 *
wave_chl_c2
 = 
NULL
;

829 
GtkStyCڋxt
 *
y_cڋxt
;

830 
	`g_tu_v_if_
(
widg
!=
NULL
 || 

!=NULL, 
FALSE
);

831 
	`g_tu_v_if_
(
	`IS_RC_UI_SPECTRUM_WIDGET
(
widg
), 
FALSE
);

832 
erum
 = 
	`RC_UI_SPECTRUM_WIDGET
(
widg
);

833 
iv
 = 
erum
->priv;

834 if(
iv
==
NULL
 
FALSE
;

835 
	`gtk_widg_g_loti
(
widg
, &
loti
);

836 if(
loti
.
width
<=0 ||oti.
height
<=0 
FALSE
;

837 
y_cڋxt
 = 
	`gtk_widg_g_y_cڋxt
(
widg
);

838 
	`gtk_y_cڋxt_g_c
(
y_cڋxt
, 
GTK_STATE_FLAG_NORMAL
,

839 &
c
);

840 
	`gtk_y_cڋxt_g_background_c
(
y_cڋxt
,

841 
GTK_STATE_FLAG_NORMAL
, &
bg_c
);

842 
	`g_mux_lock
(&(
iv
->
bufr_mux
));

843 if(
iv
->
bufr
!=
NULL
)

844 
bufr
 = 
	`g_bufr_f
(
iv
->buffer);

845 
	`g_mux_uock
(&(
iv
->
bufr_mux
));

846 
G_STMT_START


848 if(
bufr
==
NULL
) ;

849 
ps
 = 
	`g_bufr_g_ps
(
bufr
);

850 if(
ps
==
NULL
) ;

851 
ruu
 = 
	`g_ps_g_ruu
(
ps
, 0);

852 if(
ruu
==
NULL
)

854 
	`g_ps_uef
(
ps
);

857 
mimy
 = 
	`g_ruu_g_me
(
ruu
);

858 
	`g_ruu_g_t
(
ruu
, "", &

);

859 
	`g_ruu_g_t
(
ruu
, "chls", &
chls
);

860 
	`g_ruu_g_t
(
ruu
, "width", &
width
);

861 
	`g_ruu_g_t
(
ruu
, "dth", &
dth
);

862 
	`g_ps_uef
(
ps
);

863 if(
dth
==0dth = 
width
;

864 if(

==0 || 
width
==0 || 
chls
==0) ;

865 
ada
 = 
	`GST_BUFFER_DATA
(
bufr
);

866 
asize
 = 
	`GST_BUFFER_SIZE
(
bufr
);

867 
num_mes
 = 
	`GST_BUFFER_SIZE
(
bufr
/ (
chls
 * 
width
 / 8);

868 
iv
->
y
)

870 
RC_UI_SPECTRUM_STYLE_NONE
:

872 
RC_UI_SPECTRUM_STYLE_WAVE_MONO
:

873 
RC_UI_SPECTRUM_STYLE_WAVE_MULTI
:

875 
gut
 
vsize
;

876 
gut32
 
bg_ic
;

877 
gboޗn
 
mui_chl
;

878 
gut32
 
c1_ic
 = 0xFF00FF00, 
c2_ic
 = 0xFFFF0000;

879 
o_sur_t
 *
sur
;

880 
vsize
 = (
gut32
* 
loti
.
width
 *

881 
loti
.
height
;

882 if(
iv
->
wave_vda
==
NULL
)

884 
iv
->
wave_vda
 = 
	`g_w
(
gut32
, 
vsize
/(guint32));

885 
iv
->
wave_vda_size
 = 
vsize
;

887 if(
iv
->
wave_vda_size
!=
vsize
)

889 
iv
->
wave_vda
 = 
	`g_w
(
gut32
,riv->wave_vdata,

890 
vsize
/(
gut32
));

891 
iv
->
wave_vda_size
 = 
vsize
;

893 
bg_ic
 = 0xFF000000 +

894 ((
gut32
)(0xFF * 
bg_c
.
d
)<<16) +

895 ((
gut32
)(0xFF * 
bg_c
.
g
)<<8) +

896 (
gut32
)(0xFF * 
bg_c
.
blue
);

897 
	`gtk_widg_y_g
(
widg
, "wave-channel1-color",

898 &
wave_chl_c1
, "wave-channel2-color",

899 &
wave_chl_c2
, 
NULL
);

900 if(
wave_chl_c1
!=
NULL
)

902 
c1_ic
 = 0xFF000000 +

903 ((
gut32
)(
wave_chl_c1
->
d
>>8)<<16) +

904 ((
gut32
)(
wave_chl_c1
->
g
>>8)<<8) +

905 (
gut32
)(
wave_chl_c1
->
blue
>>8);

906 
	`gdk_c_
(
wave_chl_c1
);

908 if(
wave_chl_c2
!=
NULL
)

910 
c2_ic
 = 0xFF000000 +

911 ((
gut32
)(
wave_chl_c2
->
d
>>8)<<16) +

912 ((
gut32
)(
wave_chl_c2
->
g
>>8)<<8) +

913 (
gut32
)(
wave_chl_c2
->
blue
>>8);

914 
	`gdk_c_
(
wave_chl_c2
);

916 
mui_chl
 =

917 (
iv
->
y
==
RC_UI_SPECTRUM_STYLE_WAVE_MULTI
);

918 
	`rc_ui_erum_wave_nd_les
(
iv
->
wave_vda
, 
vsize
,

919 
loti
.
width
,oti.
height
, 
ada
, 
asize
,

920 
mimy
, 
num_mes
, 
chls
, 
width
, 
dth
,

921 
bg_ic
, 
c1_ic
, 
c2_ic
, 
mui_chl
);

922 
sur
 = 
	`o_image_sur__f_da
(

923 (
guch
 *)
iv
->
wave_vda
, 
CAIRO_FORMAT_ARGB32
,

924 
loti
.
width
,oti.
height
,

925 
	`o_fm_ride_f_width
(
CAIRO_FORMAT_ARGB32
,

926 
loti
.
width
));

927 
	`o_t_sour_sur
(

, 
sur
, 0, 0);

928 
	`o_t_ݔ
(

, 
CAIRO_OPERATOR_SOURCE
);

929 
	`o_t
(

);

930 
	`o_sur_deroy
(
sur
);

933 
RC_UI_SPECTRUM_STYLE_SPECTRUM
:

935 
gut
 
num
;

936 
gut
 
swidth
 = 4;

937 
gut
 
sheight
;

938 
gut
 
a
 = 1;

939 
num
 = 
loti
.
width
 / (
swidth
 + 
a
);

940 
	`o_t_sour_rgba
(

, 
c
.
d
, c.
g
,

941 
c
.
blue
, c.
pha
);

942 if(
iv
->
erum_bd_da
==
NULL
) ;

943 if(
iv
->
erum_da
==
NULL
)

945 
iv
->
erum_da
 = 
	`g_w0
(
gt
, 
num
);

946 
iv
->
erum_da_size
 = 
num
;

948 if(
iv
->
erum_da_size
!=
num
)

950 
iv
->
erum_da
 = 
	`g_w
(
gt
,

951 
iv
->
erum_da
, 
num
);

952 
iv
->
erum_da_size
 = 
num
;

954 
	`rc_ui_erum_erum_lcuϋ
(
iv
->
erum_da
, 
num
,

955 
iv
->
erum_bd_da
, 
RC_UI_SPECTRUM_BANDS
,

956 
iv
->
erum_
,riv->
erum_thshd
);

957 
i
=0;i<
num
;i++)

959 
r
 = (
iv
->
erum_da
[
i
] -

960 
iv
->
erum_thshd
)/30;

961 if(
r
>1)ercent = 1.0;

962 
sheight
 = (
gt
)
loti
.
height
 * 
r
;

963 
	`o_g
(

, (
swidth
+
a
)*
i
,

964 
loti
.
height
-
sheight
, 
swidth
, sheight);

965 
	`o_fl
(

);

973 
G_STMT_END
;

974 if(
bufr
!=
NULL

	`g_bufr_uef
(buffer);

975  
TRUE
;

976 
	}
}

978 
gboޗn
 
	$rc_ui_erum_dw_timeout_cb
(
gpor
 
da
)

980 
RCUiSrumWidg
 *
widg
 = (RCUiSrumWidg *)
da
;

981 if(
da
==
NULL
 
FALSE
;

982 
	`gtk_widg_queue_dw
(
	`GTK_WIDGET
(
widg
));

983  
TRUE
;

984 
	}
}

986 
	$rc_ui_erum_widg_
(
RCUiSrumWidg
 *
erum
)

988 
RCUiSrumWidgPrive
 *
iv
;

989 
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
erum
, 
RC_UI_SPECTRUM_WIDGET_TYPE
,

990 
RCUiSrumWidgPrive
);

991 
erum
->
iv
 =riv;

992 
iv
->
s
 = 10;

993 
iv
->
y
 = 
RC_UI_SPECTRUM_STYLE_WAVE_MULTI
;

994 
iv
->
erum_bd_da
 = 
	`g_w
(
gt
, 
RC_UI_SPECTRUM_BANDS
);

995 
	`g_mux_
(&(
iv
->
bufr_mux
));

996 
iv
->
timeout_id
 = 
	`g_timeout_add
(1000/iv->
s
, (
GSourFunc
)

997 
rc_ui_erum_dw_timeout_cb
, 
erum
);

998 
iv
->
bufr_obe_id
 = 
	`rib_ce_sigl_c
("buffer-probe",

999 
	`G_CALLBACK
(
rc_ui_erum_bufr_obe_cb
), 
erum
);

1000 
	}
}

1002 
	$rc_ui_erum_widg_fize
(
GObje
 *
obje
)

1004 
RCUiSrumWidg
 *
erum
 = 
	`RC_UI_SPECTRUM_WIDGET
(
obje
);

1005 
RCUiSrumWidgPrive
 *
iv
;

1006 
iv
 = 
erum
->priv;

1007 
erum
->
iv
 = 
NULL
;

1008 
	`rc_ui_erum_t_e
(
iv
);

1009 if(
iv
->
bufr_obe_id
>0)

1010 
	`rib_ce_sigl_disc
(
iv
->
bufr_obe_id
);

1011 
	`g_mux_lock
(&(
iv
->
bufr_mux
));

1012 if(
iv
->
bufr
!=
NULL
)

1013 
	`g_bufr_uef
(
iv
->
bufr
);

1014 
	`g_mux_uock
(&(
iv
->
bufr_mux
));

1015 
	`g_mux_r
(&(
iv
->
bufr_mux
));

1016 if(
iv
->
timeout_id
>0)

1017 
	`g_sour_move
(
iv
->
timeout_id
);

1018 
	`g_
(
iv
->
wave_vda
);

1019 
	`g_
(
iv
->
erum_bd_da
);

1020 
	`G_OBJECT_CLASS
(
rc_ui_erum_widg__ass
)->
	`fize
(
obje
);

1021 
	}
}

1023 
	$rc_ui_erum_widg_ass_
(
RCUiSrumWidgCss
 *
kss
)

1025 
GObjeCss
 *
obje_ass
;

1026 
GtkWidgCss
 *
widg_ass
;

1027 
rc_ui_erum_widg__ass
 = 
	`g_ty_ass_ek_
(
kss
);

1028 
obje_ass
 = (
GObjeCss
 *)
kss
;

1029 
widg_ass
 = (
GtkWidgCss
 *)
kss
;

1030 
obje_ass
->
t_ݔty
 = 
NULL
;

1031 
obje_ass
->
g_ݔty
 = 
NULL
;

1032 
obje_ass
->
fize
 = 
rc_ui_erum_widg_fize
;

1033 
widg_ass
->
ize
 = 
rc_ui_erum_widg_ize
;

1034 
widg_ass
->
size_lo
 = 
rc_ui_erum_widg_size_lo
;

1035 
widg_ass
->
dw
 = 
rc_ui_erum_widg_dw
;

1036 
widg_ass
->
g_eed_height
 =

1037 
rc_ui_erum_widg_g_eed_height
;

1038 
	`g_ty_ass_add_ive
(
kss
, (
RCUiSrumWidgPrive
));

1039 
	`gtk_widg_ass_l_y_ݔty
(
widg_ass
,

1040 
	`g_m_ec_boxed
("wave-channel1-color",

1043 
GDK_TYPE_COLOR
, 
RC_UI_SPECTRUM_STYLE_PARAM_READABLE
));

1044 
	`gtk_widg_ass_l_y_ݔty
(
widg_ass
,

1045 
	`g_m_ec_boxed
("wave-channel2-color",

1048 
GDK_TYPE_COLOR
, 
RC_UI_SPECTRUM_STYLE_PARAM_READABLE
));

1049 
	}
}

1051 
GTy
 
	$rc_ui_erum_widg_g_ty
()

1053 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

1054 
GTy
 
g_defe_ty_id
;

1055 cڡ 
GTyInfo
 
obje_fo
 = {

1056 .
ass_size
 = (
RCUiSrumWidgCss
),

1057 .
ba_
 = 
NULL
,

1058 .
ba_fize
 = 
NULL
,

1059 .
ass_
 = (
GCssInFunc
)
rc_ui_erum_widg_ass_
,

1060 .
ass_fize
 = 
NULL
,

1061 .
ass_da
 = 
NULL
,

1062 .
_size
 = (
RCUiSrumWidg
),

1063 .
n_ocs
 = 0,

1064 .
_
 = (
GInInFunc
)
rc_ui_erum_widg_


1066 if(
	`g___r
(&
g_defe_ty_id__vީe
))

1068 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
GTK_TYPE_WIDGET
,

1069 
	`g__ic_rg
("RCUiSrumWidg"), &
obje_fo
, 0);

1070 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

1072  
g_defe_ty_id__vީe
;

1073 
	}
}

1083 
GtkWidg
 *
	$rc_ui_erum_widg_w
()

1085  
	`GTK_WIDGET
(
	`g_obje_w
(
	`rc_ui_erum_widg_g_ty
(),

1086 
NULL
));

1087 
	}
}

1097 
	$rc_ui_erum_widg_t_s
(
RCUiSrumWidg
 *
erum
, 
gut
 
s
)

1099 
RCUiSrumWidgPrive
 *
iv
;

1100 if(
erum
==
NULL
 || 
s
<10 || fps>60) ;

1101 
iv
 = 
	`RC_UI_SPECTRUM_WIDGET
(
erum
)->priv;

1102 if(
iv
==
NULL
) ;

1103 if(
iv
->
timeout_id
>0)

1104 
	`g_sour_move
(
iv
->
timeout_id
);

1105 
iv
->
s
 = fps;

1106 
iv
->
timeout_id
 = 
	`g_timeout_add
(1000/
s
, (
GSourFunc
)

1107 
rc_ui_erum_dw_timeout_cb
, 
erum
);

1108 
	}
}

1118 
	$rc_ui_erum_widg_t_y
(
RCUiSrumWidg
 *
erum
,

1119 
RCUiSrumSty
 
y
)

1121 
RCUiSrumWidgPrive
 *
iv
;

1122 
iv
 = 
	`RC_UI_SPECTRUM_WIDGET
(
erum
)->priv;

1123 if(
iv
==
NULL
) ;

1124 
iv
->
y
 = style;

1125 
	`rc_ui_erum_widg_n
(
erum
);

1126 
	}
}

1137 
gut
 
	$rc_ui_erum_widg_g_s
(
RCUiSrumWidg
 *
erum
)

1139 
RCUiSrumWidgPrive
 *
iv
;

1140 if(
erum
==
NULL
)  0;

1141 
iv
 = 
	`RC_UI_SPECTRUM_WIDGET
(
erum
)->priv;

1142 if(
iv
==
NULL
)  0;

1143  
iv
->
s
;

1144 
	}
}

1155 
RCUiSrumSty
 
	$rc_ui_erum_widg_g_y
(

1156 
RCUiSrumWidg
 *
erum
)

1158 
RCUiSrumWidgPrive
 *
iv
;

1159 if(
erum
==
NULL
 
RC_UI_SPECTRUM_STYLE_NONE
;

1160 
iv
 = 
	`RC_UI_SPECTRUM_WIDGET
(
erum
)->priv;

1161 if(
iv
==
NULL
 
RC_UI_SPECTRUM_STYLE_NONE
;

1162  
iv
->
y
;

1163 
	}
}

1172 
	$rc_ui_erum_widg_n
(
RCUiSrumWidg
 *
erum
)

1174 
RCUiSrumWidgPrive
 *
iv
;

1175 if(
erum
==
NULL
) ;

1176 
GBufr
 *
bufr
;

1177 
iv
 = 
	`RC_UI_SPECTRUM_WIDGET
(
erum
)->priv;

1178 if(
iv
==
NULL
) ;

1179 
	`g_mux_lock
(&(
iv
->
bufr_mux
));

1180 
bufr
 = 
iv
->buffer;

1181 
iv
->
bufr
 = 
NULL
;

1182 if(
bufr
!=
NULL
)

1183 
	`g_bufr_uef
(
bufr
);

1184 
	`g_mux_uock
(&(
iv
->
bufr_mux
));

1185 
	`g_
(
iv
->
wave_vda
);

1186 
	`g_
(
iv
->
erum_da
);

1187 
iv
->
wave_vda
 = 
NULL
;

1188 
iv
->
erum_da
 = 
NULL
;

1189 
iv
->
wave_vda_size
 = 0;

1190 
iv
->
erum_da_size
 = 0;

1191 
	`gtk_widg_queue_dw
(
	`GTK_WIDGET
(
erum
));

1192 
	}
}

	@ui/rc-ui-spectrum.h

25 #ide
HAVE_RC_UI_SPECTRUM_H


26 
	#HAVE_RC_UI_SPECTRUM_H


	)

28 
	~<mh.h
>

29 
	~<rib.h
>

30 
	~<glib.h
>

31 
	~<glib-obje.h
>

32 
	~<g/g.h
>

33 
	~<gdk/gdk.h
>

34 
	~<gtk/gtk.h
>

36 
	gG_BEGIN_DECLS


38 
	#RC_UI_SPECTRUM_WIDGET_TYPE
 (
	`rc_ui_erum_widg_g_ty
())

	)

39 
	#RC_UI_SPECTRUM_WIDGET
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
 ((obj), \

40 
RC_UI_SPECTRUM_WIDGET_TYPE
, 
RCUiSrumWidg
))

	)

42 
	#RC_UI_SPECTRUM_WIDGET_CLASS
(
kss
) \

43 (
	`G_TYPE_CHECK_CLASS_CAST
((
kss
), 
RC_UI_SPECTRUM_WIDGET_TYPE
, \

44 
RCUiSrumWidgCss
))

	)

45 
	#IS_RC_UI_SPECTRUM_WIDGET
(
obj
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((obj), \

46 
RC_UI_SPECTRUM_WIDGET_TYPE
))

	)

47 
	#IS_RC_UI_SPECTRUM_WIDGET_CLASS
(
kss
) \

48 (
	`G_TYPE_CHECK_CLASS_TYPE
((
kss
), 
RC_UI_SPECTRUM_WIDGET_TYPE
))

	)

63 
	mRC_UI_SPECTRUM_STYLE_NONE
,

64 
	mRC_UI_SPECTRUM_STYLE_WAVE_MONO
,

65 
	mRC_UI_SPECTRUM_STYLE_WAVE_MULTI
,

66 
	mRC_UI_SPECTRUM_STYLE_SPECTRUM
,

67 }
	tRCUiSrumSty
;

69 
_RCUiSrumWidg
 
	tRCUiSrumWidg
;

70 
_RCUiSrumWidgCss
 
	tRCUiSrumWidgCss
;

71 
_RCUiSrumWidgPrive
 
	tRCUiSrumWidgPrive
;

79 
	s_RCUiSrumWidg
 {

81 
GtkWidg
 
	mwidg
;

82 
RCUiSrumWidgPrive
 *
	miv
;

91 
	s_RCUiSrumWidgCss
 {

93 
GtkWidgCss
 
	m_ass
;

98 
GTy
 
rc_ui_erum_widg_g_ty
();

101 
GtkWidg
 *
rc_ui_erum_widg_w
();

102 
rc_ui_erum_widg_t_s
(
RCUiSrumWidg
 *
erum
, 
gut
 
s
);

103 
rc_ui_erum_widg_t_y
(
RCUiSrumWidg
 *
erum
,

104 
RCUiSrumSty
 
y
);

105 
gut
 
rc_ui_erum_widg_g_s
(
RCUiSrumWidg
 *
erum
);

106 
RCUiSrumSty
 
rc_ui_erum_widg_g_y
(

107 
RCUiSrumWidg
 *
erum
);

108 
rc_ui_erum_widg_n
(
RCUiSrumWidg
 *
erum
);

110 
	gG_END_DECLS


	@ui/rc-ui-style.c

26 
	~"rc-ui-y.h
"

27 
	~"rc-ui-sours.h
"

28 
	~"rc-ma.h
"

29 
	~"rc-comm.h
"

42 
	sRCUiStyEmbeddedTheme


44 cڡ 
gch
 *
	mme
;

45 cڡ 
gch
 *
	mth
;

46 }
	tRCUiStyEmbeddedTheme
;

48 
GtkCssProvid
 *
	gy_css_ovid
 = 
NULL
;

49 
RCUiStyEmbeddedTheme
 
	gy_embedded_themes
[] =

52 .
me
 = "Monochrome",

53 .
	gth
 = "/org/RhythmCat2/ui/resources/themes/Monochrome/"

67 
gboޗn
 
	$rc_ui_y_css_t_fe
(cڡ 
gch
 *
fame
)

69 
GFe
 *
fe
;

70 
GE
 *
r
 = 
NULL
;

71 
GdkSn
 *
sn
 = 
	`gdk_sn_g_deu
();

72 if(
fame
==
NULL
)

74 
	`g_wng
("Invalid CSS Style fileame!");

75  
FALSE
;

77 
fe
 = 
	`g_fe_w_f_th
(
fame
);

78 
	`g_mesge
("Loading CSS Style: %s",

79 
fame
);

80 if(
fe
==
NULL
)

82 
	`g_wng
("Cn oCSS Sty: %s", 
fame
);

83  
FALSE
;

85 if(
y_css_ovid
==
NULL
)

86 
y_css_ovid
 = 
	`gtk_css_ovid_w
();

87 if(!
	`gtk_css_ovid_ld_om_fe
(
y_css_ovid
, 
fe
,

88 &
r
))

90 
	`g_wng
("Cn oCSS Sty: %s", 
r
->
mesge
);

91 
	`g_r_
(
r
);

92 
	`g_obje_uef
(
fe
);

93  
FALSE
;

95 
	`g_obje_uef
(
fe
);

96 
	`gtk_y_cڋxt_add_ovid_f_sn
(
sn
,

97 
	`GTK_STYLE_PROVIDER
(
y_css_ovid
),

98 
GTK_STYLE_PROVIDER_PRIORITY_USER
);

99 
	`gtk_y_cڋxt_t_widgs
(
sn
);

100 
	`g_mesge
("Loadedew CSS Style.");

101  
TRUE
;

102 
	}
}

114 
gboޗn
 
	$rc_ui_y_css_t_da
(cڡ 
gch
 *
da
, 
gssize
 
ngth
)

116 
GE
 *
r
 = 
NULL
;

117 
GdkSn
 *
sn
 = 
	`gdk_sn_g_deu
();

118 if(
da
==
NULL
)

120 
	`g_wng
("Invalid CSS Style data!");

121  
FALSE
;

123 if(
y_css_ovid
==
NULL
)

124 
y_css_ovid
 = 
	`gtk_css_ovid_w
();

125 if(!
	`gtk_css_ovid_ld_om_da
(
y_css_ovid
, 
da
, 
ngth
,

126 &
r
))

128 
	`g_wng
("Cn oCSS Sty: %s", 
r
->
mesge
);

129 
	`g_r_
(
r
);

130  
FALSE
;

132 
	`gtk_y_cڋxt_add_ovid_f_sn
(
sn
,

133 
	`GTK_STYLE_PROVIDER
(
y_css_ovid
),

134 
GTK_STYLE_PROVIDER_PRIORITY_USER
);

135 
	`gtk_y_cڋxt_t_widgs
(
sn
);

136 
	`g_mesge
("Loadedew CSS Style.");

137  
TRUE
;

138 
	}
}

149 
gboޗn
 
	$rc_ui_y_css_t_sour
(cڡ 
gch
 *
sour_th
)

151 
GFe
 *
fe
;

152 
GE
 *
r
 = 
NULL
;

153 
gch
 *
uri
, *
tmp
;

154 
GdkSn
 *
sn
 = 
	`gdk_sn_g_deu
();

155 if(
sour_th
==
NULL
)

157 
	`g_wng
("Invalid CSS Style fileame!");

158  
FALSE
;

160 
tmp
 = 
	`g_uri_es_rg
(
sour_th
,

161 
G_URI_RESERVED_CHARS_ALLOWED_IN_PATH
, 
FALSE
);

162 
uri
 = 
	`g_rct
("sour://", 
tmp
, 
NULL
);

163 
	`g_
(
tmp
);

164 
fe
 = 
	`g_fe_w_f_uri
(
uri
);

165 
	`g_
(
uri
);

166 
	`g_mesge
("Ldg CSS Sty fromesour: %s", 
sour_th
);

167 if(
fe
==
NULL
)

169 
	`g_wng
("Cannot open CSS Style fromesourceath: %s",

170 
sour_th
);

171  
FALSE
;

173 if(
y_css_ovid
==
NULL
)

174 
y_css_ovid
 = 
	`gtk_css_ovid_w
();

175 if(!
	`gtk_css_ovid_ld_om_fe
(
y_css_ovid
, 
fe
,

176 &
r
))

178 
	`g_wng
("Cn oCSS Sty: %s", 
r
->
mesge
);

179 
	`g_r_
(
r
);

180 
	`g_obje_uef
(
fe
);

181  
FALSE
;

183 
	`g_obje_uef
(
fe
);

184 
	`gtk_y_cڋxt_add_ovid_f_sn
(
sn
,

185 
	`GTK_STYLE_PROVIDER
(
y_css_ovid
),

186 
GTK_STYLE_PROVIDER_PRIORITY_USER
);

187 
	`gtk_y_cڋxt_t_widgs
(
sn
);

188 
	`g_mesge
("Loadedew CSS Style.");

189  
TRUE
;

190 
	}
}

198 
	$rc_ui_y_css_unt
()

200 
GdkSn
 *
sn
 = 
	`gdk_sn_g_deu
();

201 if(
y_css_ovid
!=
NULL
)

203 
	`gtk_y_cڋxt_move_ovid_f_sn
(
sn
,

204 
	`GTK_STYLE_PROVIDER
(
y_css_ovid
));

205 
	`g_obje_uef
(
y_css_ovid
);

206 
y_css_ovid
 = 
NULL
;

208 
	`gtk_y_cڋxt_t_widgs
(
sn
);

209 
	`g_mesge
("Custom CSS Style has beenemoved.");

210 
	}
}

221 
gboޗn
 
	$rc_ui_y_embedded_theme_t_by_me
(cڡ 
gch
 *
me
)

223 
gut
 
ngth
;

224 
gut
 
i
;

225 
gboޗn
 
ag
 = 
FALSE
;

226 
ngth
 = (
y_embedded_themes
)/(
RCUiStyEmbeddedTheme
);

227 
i
=0;i<
ngth
;i++)

229 if(
	`g_rcmp0
(
me
, 
y_embedded_themes
[
i
].name)==0)

231 
ag
 = 
	`rc_ui_y_css_t_sour
(

232 
y_embedded_themes
[
i
].
th
);

233 if(
ag
) ;

236  
ag
;

237 
	}
}

248 
gboޗn
 
	$rc_ui_y_embedded_theme_t_by_dex
(
gut
 
dex
)

250 
gut
 
ngth
;

251 
ngth
 = (
y_embedded_themes
)/(
RCUiStyEmbeddedTheme
);

252 if(
dex
>=
ngth
 
FALSE
;

253  
	`rc_ui_y_css_t_sour
(
y_embedded_themes
[
dex
].
th
);

254 
	}
}

264 
gboޗn
 
	$rc_ui_y_embedded_theme_t_deu
()

266  
	`rc_ui_y_css_t_sour
(
y_embedded_themes
[0].
th
);

267 
	}
}

277 
gut
 
	$rc_ui_y_embedded_theme_g_ngth
()

279  (
y_embedded_themes
)/(
RCUiStyEmbeddedTheme
);

280 
	}
}

292 cڡ 
gch
 *
	$rc_ui_y_embedded_theme_g_me
(
gut
 
dex
)

294 
gut
 
ngth
;

295 
ngth
 = (
y_embedded_themes
)/(
RCUiStyEmbeddedTheme
);

296 if(
dex
>=
ngth
 
NULL
;

297  
y_embedded_themes
[
dex
].
me
;

298 
	}
}

308 
GSLi
 *
	$rc_ui_y_ch_theme_ths
()

310 
GSLi
 *
li
 = 
NULL
;

311 
gch
 *
th
 = 
NULL
;

312 
GD
 *
d
 = 
NULL
;

313 cڡ 
gch
 *
th_me
 = 
NULL
;

314 
gch
 *
theme_th
 = 
NULL
;

315 
gch
 *
theme_fe
 = 
NULL
;

316 
th
 = 
	`g_bud_fame
(
	`rc_ma_g_da_d
(), "themes", 
NULL
);

317 
d
 = 
	`g_d_ݒ
(
th
, 0, 
NULL
);

318 if(
d
!=
NULL
)

320 
th_me
 = 
	`g_d_ad_me
(
d
);

321 
th_me
!=
NULL
)

323 
theme_th
 = 
	`g_bud_fame
(
th
, 
th_me
, 
NULL
);

324 if(
	`g_fe_
(
theme_th
, 
G_FILE_TEST_IS_DIR
))

325 
li
 = 
	`g_i_nd
i, 
theme_th
);

327 
	`g_
(
theme_th
);

328 
th_me
 = 
	`g_d_ad_me
(
d
);

330 
	`g_d_o
(
d
);

332 
	`g_
(
th
);

333 
th
 = 
	`g_bud_fame
(
	`rc_ma_g_ur_d
(), "Themes", 
NULL
);

334 
d
 = 
	`g_d_ݒ
(
th
, 0, 
NULL
);

335 if(
d
!=
NULL
)

337 
th_me
 = 
	`g_d_ad_me
(
d
);

338 
th_me
!=
NULL
)

340 
theme_th
 = 
	`g_bud_fame
(
th
, 
th_me
, 
NULL
);

341 
theme_fe
 = 
	`g_bud_fame
(
theme_th
, "gtk3.css", 
NULL
);

342 if(
	`g_fe_
(
theme_th
, 
G_FILE_TEST_IS_DIR
) &&

343 
	`g_fe_
(
theme_fe
, 
G_FILE_TEST_IS_REGULAR
))

345 
li
 = 
	`g_i_nd
i, 
theme_th
);

348 
	`g_
(
theme_th
);

349 
	`g_
(
theme_fe
);

350 
th_me
 = 
	`g_d_ad_me
(
d
);

352 
	`g_d_o
(
d
);

354 
	`g_
(
th
);

355  
li
;

356 
	}
}

	@ui/rc-ui-style.h

25 #ide
HAVE_RC_UI_STYLE_H


26 
	#HAVE_RC_UI_STYLE_H


	)

28 
	~<glib.h
>

29 
	~<gtk/gtk.h
>

30 
	~<rib.h
>

32 
G_BEGIN_DECLS


34 
gboޗn
 
rc_ui_y_css_t_fe
(cڡ 
gch
 *
fame
);

35 
gboޗn
 
rc_ui_y_css_t_da
(cڡ 
gch
 *
da
, 
gssize
 
ngth
);

36 
gboޗn
 
rc_ui_y_css_t_sour
(cڡ 
gch
 *
sour_th
);

37 
rc_ui_y_css_unt
();

38 
gboޗn
 
rc_ui_y_embedded_theme_t_by_me
(cڡ 
gch
 *
me
);

39 
gboޗn
 
rc_ui_y_embedded_theme_t_by_dex
(
gut
 
dex
);

40 
gboޗn
 
rc_ui_y_embedded_theme_t_deu
();

41 
gut
 
rc_ui_y_embedded_theme_g_ngth
();

42 cڡ 
gch
 *
rc_ui_y_embedded_theme_g_me
(
gut
 
dex
);

43 
GSLi
 *
rc_ui_y_ch_theme_ths
();

45 
	gG_END_DECLS


	@ui/rc-ui-unset-star-inline.h

3 #ifde
__SUNPRO_C


4 #agm
ign
 4 (
rc_ui_unt__le
)

6 #ifde
__GNUC__


7 cڡ 
gut8
 
	grc_ui_unt__le
[] 
__ibu__
 ((
__igd__
 (4))) =

9 cڡ 
gut8
 
rc_ui_unt__le
[] =

	@ui/rc-ui-window.c

26 
	~"rc-ui-wdow.h
"

27 
	~"rc-ui-livw.h
"

28 
	~"rc-ui-limod.h
"

29 
	~"rc-ui-mu.h
"

30 
	~"rc-ui-dlog.h
"

31 
	~"rc-ui-ab.h
"

32 
	~"rc-ui-erum.h
"

33 
	~"rc-ui-img-ic.xpm
"

34 
	~"rc-ui-img-nocov.xpm
"

35 
	~"rc-ui-ay.h
"

36 
	~"rc-comm.h
"

48 
	#RC_UI_MAIN_WINDOW_COVER_IMAGE_SIZE
 160

	)

50 
	s_RCUiMaWdowPrive


52 
GtkUIMag
 *
	mui_mag
;

53 
GtkWidg
 *
	mma_grid
;

54 
GtkWidg
 *
	mt_b
;

55 
GtkWidg
 *
	mti_b
;

56 
GtkWidg
 *
	mbum_b
;

57 
GtkWidg
 *
	mtime_b
;

58 
GtkWidg
 *
	mngth_b
;

59 
GtkWidg
 *
	mfo_b
;

60 
GtkWidg
 *
	mbum_image
;

61 
GtkWidg
 *
	mbum_evtbox
;

62 
GtkWidg
 *
	mbum_ame
;

63 
GtkWidg
 *
	mlyric1_ab
;

64 
GtkWidg
 *
	mlyric2_ab
;

65 
GtkWidg
 *
	merum_widg
;

66 
GtkWidg
 *
	m_ay_image
;

67 
GtkWidg
 *
	m__image
;

68 
GtkWidg
 *
	m_ev_image
;

69 
GtkWidg
 *
	m_xt_image
;

70 
GtkWidg
 *
	m_ݒ_image
;

71 
GtkWidg
 *
	m_ay_bu
;

72 
GtkWidg
 *
	m__bu
;

73 
GtkWidg
 *
	m_ev_bu
;

74 
GtkWidg
 *
	m_xt_bu
;

75 
GtkWidg
 *
	m_ݒ_bu
;

76 
GtkWidg
 *
	mvume_bu
;

77 
GtkWidg
 *
	mtime_s
;

78 
GtkWidg
 *
	mlog_livw
;

79 
GtkWidg
 *
	mayli_livw
;

80 
GtkWidg
 *
	mlog_s_wdow
;

81 
GtkWidg
 *
	mayli_s_wdow
;

82 
GtkWidg
 *
	mli_d
;

83 
GtkWidg
 *
	mogss_r
;

84 
GtkWidg
 *
	mogss_evtbox
;

85 
GdkPixbuf
 *
	mcov_deu_pixbuf
;

86 
GdkPixbuf
 *
	mcov_usg_pixbuf
;

87 
gch
 *
	mcov_fe_th
;

88 
GtkStusIc
 *
	may_ic
;

89 
gut
 
	mcov_image_width
;

90 
gut
 
	mcov_image_height
;

91 
gboޗn
 
	mcov_t_ag
;

92 
gboޗn
 
	mupde_ek_s
;

93 
gboޗn
 
	mimpt_wk_ag
;

94 
gboޗn
 
	mesh_wk_ag
;

95 
gut
 
	mupde_timeout
;

96 
gulg
 
	mg_found_id
;

97 
gulg
 
	mw_duti_id
;

98 
gulg
 
	me_chged_id
;

99 
gulg
 
	muri_chged_id
;

100 
gulg
 
	mvume_chged_id
;

101 
gulg
 
	mbufrg_id
;

102 
gulg
 
	mlyric_tim_id
;

103 
gulg
 
	mimpt_upded_id
;

104 
gulg
 
	mesh_upded_id
;

105 
gulg
 
	mbum_found_id
;

106 
gulg
 
	mbum_ne_id
;

111 
	mSIGNAL_KEEP_ABOVE_CHANGED
,

112 
	mSIGNAL_LAST


115 
GObje
 *
	gui_ma_wdow_
 = 
NULL
;

116 
gpor
 
	grc_ui_ma_wdow__ass
 = 
NULL
;

117 
gt
 
	gui_ma_wdow_sigls
[
SIGNAL_LAST
] = {0};

119 
le
 
	$rc_ui_ma_wdow_t_b_t_vue
(

120 
RCUiMaWdowPrive
 *
iv
, cڡ 
gch
 *
uri
, cڡ gch *
t
)

122 
gch
 *

 = 
NULL
;

123 if(
t
!=
NULL
 && 
	`
(title)>0)

125 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
t_b
), 
t
);

129 

 = 
	`rib_g_g_me_om_uri
(
uri
);

130 if(

!=
NULL
)

132 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
t_b
), 

);

133 
	`g_
(

);

136 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
t_b
),

137 
	`_
("Unknown Title"));

139 
	}
}

141 
le
 
	$rc_ui_ma_wdow_ti_b_t_vue
(

142 
RCUiMaWdowPrive
 *
iv
, cڡ 
gch
 *
ti
)

144 if(
ti
!=
NULL
 && 
	`
(artist)>0)

145 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
ti_b
), 
ti
);

147 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
ti_b
),

148 
	`_
("Unknown Artist"));

149 
	}
}

151 
le
 
	$rc_ui_ma_wdow_bum_b_t_vue
(

152 
RCUiMaWdowPrive
 *
iv
, cڡ 
gch
 *
bum
)

154 if(
bum
!=
NULL
 && 
	`
(album)>0)

155 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
bum_b
), 
bum
);

157 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
bum_b
),

158 
	`_
("Unknown Album"));

159 
	}
}

161 
le
 
	$rc_ui_ma_wdow_time_b_t_vue
(

162 
RCUiMaWdowPrive
 *
iv
, 
gt64
 
pos
)

164 
gt
 
m
, 
c
;

165 
gch
 *
rg
;

166 if(
iv
==
NULL
) ;

167 if(
pos
>=0)

169 
c
 = (
gt
)(
pos
 / 
GST_SECOND
);

170 
m
 = 
c
 / 60;

171 
c
 = sec % 60;

172 
rg
 = 
	`g_rdup_tf
("%02d:%02d", 
m
, 
c
);

173 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
time_b
), 
rg
);

174 
	`g_
(
rg
);

177 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
time_b
), "--:--");

178 
	}
}

181 
le
 
	$rc_ui_ma_wdow_fo_b_t_vue
(

182 
RCUiMaWdowPrive
 *
iv
, cڡ 
gch
 *
fm
, 
gt
 
b
,

183 
gt
 
me_
, g
chls
)

185 
GSg
 *
fo
;

186 
fo
 = 
	`g_rg_w
(
NULL
);

187 if(
fm
!=
NULL
 && 
	`
(format)>0)

188 
	`g_rg_tf
(
fo
, "%", 
fm
);

190 
	`g_rg_tf
(
fo
, "%", 
	`_
("Unknown Format"));

191 if(
b
>0)

192 
	`g_rg_nd_tf
(
fo
, 
	`_
("%d kbps "),

193 
b
 / 1000);

194 if(
me_
>0)

195 
	`g_rg_nd_tf
(
fo
, 
	`_
("%d Hz "), 
me_
);

196 
chls
)

199 
	`g_rg_nd
(
fo
, 
	`_
("Mono"));

202 
	`g_rg_nd
(
fo
, 
	`_
("Stereo"));

207 
	`g_rg_nd_tf
(
fo
, 
	`_
("%d channels"),

208 
chls
);

211 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
fo_b
), 
fo
->
r
);

212 
	`g_rg_
(
fo
, 
TRUE
);

213 
	}
}

215 
gboޗn
 
	$rc_ui_ma_wdow_cov_image_t_pixbuf
(
RCUiMaWdowPrive
 *
iv
,

216 cڡ 
GdkPixbuf
 *
pixbuf
)

218 
GdkPixbuf
 *
bum_w_pixbuf
;

219 if(
iv
==
NULL
 
FALSE
;

220 
bum_w_pixbuf
 = 
	`gdk_pixbuf_s_sime
(
pixbuf
,

221 
iv
->
cov_image_width
,riv->
cov_image_height
,

222 
GDK_INTERP_HYPER
);

223 if(
bum_w_pixbuf
==
NULL
)

225 
	`g_wng
("Cannot convertixbuf for cover image!");

226  
FALSE
;

228 
	`gtk_image_t_om_pixbuf
(
	`GTK_IMAGE
(
iv
->
bum_image
),

229 
bum_w_pixbuf
);

230 
	`g_obje_uef
(
bum_w_pixbuf
);

231  
TRUE
;

232 
	}
}

234 
gboޗn
 
	$rc_ui_ma_wdow_cov_image_t_g_bufr
(

235 
RCUiMaWdowPrive
 *
iv
, cڡ 
GBufr
 *
buf
)

237 
GdkPixbufLd
 *
ld
;

238 
GdkPixbuf
 *
pixbuf
;

239 
gboޗn
 
ag
;

240 
GE
 *
r
 = 
NULL
;

241 if(
iv
==
NULL
 || 
buf
==NULL 
FALSE
;;

242 
ld
 = 
	`gdk_pixbuf_ld_w
();

243 if(!
	`gdk_pixbuf_ld_wre
(
ld
, 
buf
->
da
, buf->
size
, &
r
))

245 
	`g_wng
("Cannotoad cover image from GstBuffer: %s",

246 
r
->
mesge
);

247 
	`g_r_
(
r
);

248 
	`g_obje_uef
(
ld
);

249  
FALSE
;

251 
pixbuf
 = 
	`gdk_pixbuf_ld_g_pixbuf
(
ld
);

252 if(
pixbuf
!=
NULL

	`g_obje_f
(pixbuf);

253 
	`gdk_pixbuf_ld_o
(
ld
, 
NULL
);

254 
	`g_obje_uef
(
ld
);

255 if(
pixbuf
==
NULL
 
FALSE
;

256 if(
iv
->
cov_usg_pixbuf
!=
NULL
)

257 
	`g_obje_uef
(
iv
->
cov_usg_pixbuf
);

258 
iv
->
cov_usg_pixbuf
 = 
	`g_obje_f
(
pixbuf
);

259 
ag
 = 
	`rc_ui_ma_wdow_cov_image_t_pixbuf
(
iv
, 
pixbuf
);

260 
	`g_obje_uef
(
pixbuf
);

261  
ag
;

262 
	}
}

264 
gboޗn
 
	$rc_ui_ma_wdow_cov_image_t_fe
(
RCUiMaWdowPrive
 *
iv
,

265 cڡ 
gch
 *
fe
)

267 
gboޗn
 
ag
;

268 
GdkPixbuf
 *
pixbuf
;

269 if(
iv
==
NULL
 || 
fe
==NULL 
FALSE
;

270 if(!
	`g_fe_
(
fe
, 
G_FILE_TEST_EXISTS
) 
FALSE
;

271 
pixbuf
 = 
	`gdk_pixbuf_w_om_fe
(
fe
, 
NULL
);

272 if(
pixbuf
==
NULL
 
FALSE
;

273 
	`g_
(
iv
->
cov_fe_th
);

274 
iv
->
cov_fe_th
 = 
	`g_rdup
(
fe
);

275 
ag
 = 
	`rc_ui_ma_wdow_cov_image_t_pixbuf
(
iv
, 
pixbuf
);

276 
	`g_obje_uef
(
pixbuf
);

277  
ag
;

278 
	}
}

280 
	$rc_ui_ma_wdow_w_duti_cb
(
RCLibCe
 *
ce
, 
gt64
 
duti
,

281 
gpor
 
da
)

283 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

284 
gch
 *
ngth
;

285 
gt
 
m
, 
c
;

286 if(
da
==
NULL
 || 
duti
<0) ;

287 
c
 = (
gt
)(
duti
 / 
GST_SECOND
);

288 
m
 = 
c
 / 60;

289 
c
 = sec % 60;

290 
ngth
 = 
	`g_rdup_tf
("%02d:%02d", 
m
, 
c
);

291 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
ngth_b
), 
ngth
);

292 
	`g_
(
ngth
);

293 
	}
}

295 
	$rc_ui_ma_wdow_g_found_cb
(
RCLibCe
 *
ce
,

296 cڡ 
RCLibCeMada
 *
mada
, cڡ 
gch
 *
uri
, 
gpor
 
da
)

298 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

299 
RCLibCeSourTy
 
ty
;

300 
gt
 
t
;

301 
RCLibDbPyliDa
 *
ayli_da
;

302 
GSequIr
 *

 = 
	`rib_ce_g_db_n
();

303 if(
da
==
NULL
 || 
mada
==NULL || 
uri
==NULL) ;

304 if(

!=
NULL
 && 
	`rib_db_ayli_is_vid_
(iter))

306 
ayli_da
 = 
	`g_qu_g
(

);

307 
ty
 = 
	`rib_ce_g_sour_ty
();

308 
t
 = 
	`g_rcmp0
(
uri
, 
ayli_da
->uri);

309 if(
ty
==
RCLIB_CORE_SOURCE_NORMAL
 && 
t
!=0) ;

311 
	`rc_ui_ma_wdow_t_b_t_vue
(
iv
, 
uri
, 
mada
->
t
);

312 
	`rc_ui_ma_wdow_ti_b_t_vue
(
iv
, 
mada
->
ti
);

313 
	`rc_ui_ma_wdow_bum_b_t_vue
(
iv
, 
mada
->
bum
);

314 if(
mada
->
duti
>0)

316 
	`rc_ui_ma_wdow_w_duti_cb
(
ce
, 
mada
->
duti
,

317 
da
);

319 
	`rc_ui_ma_wdow_fo_b_t_vue
(
iv
, 
mada
->
y
,

320 
mada
->
b
, 
	`rib_ce_quy_me_
(),

321 
	`rib_ce_quy_chls
());

322 
	}
}

324 
	$rc_ui_ma_wdow_uri_chged_cb
(
RCLibCe
 *
ce
, cڡ 
gch
 *
uri
,

325 
gpor
 
da
)

327 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

328 
GSequIr
 *
n
;

329 
RCLibDbPyliDa
 *
ayli_da
 = 
NULL
;

330 if(
da
==
NULL
) ;

331 
n
 = 
	`rib_ce_g_db_n
();

332 if(
iv
->
cov_usg_pixbuf
!=
NULL
)

333 
	`g_obje_uef
(
iv
->
cov_usg_pixbuf
);

334 if(
iv
->
cov_fe_th
!=
NULL
)

335 
	`g_
(
iv
->
cov_fe_th
);

336 
iv
->
cov_usg_pixbuf
 = 
NULL
;

337 
iv
->
cov_fe_th
 = 
NULL
;

338 
iv
->
cov_t_ag
 = 
FALSE
;

339 if(
n
!=
NULL
)

340 
ayli_da
 = 
	`g_qu_g
(
n
);

341 if(
ayli_da
!=
NULL
)

343 
ayli_da
 = 
	`g_qu_g
(
n
);

344 if(
ayli_da
!=
NULL
)

346 
	`rc_ui_ma_wdow_t_b_t_vue
(
iv
, 
uri
,

347 
ayli_da
->
t
);

348 
	`rc_ui_ma_wdow_ti_b_t_vue
(
iv
,

349 
ayli_da
->
ti
);

350 
	`rc_ui_ma_wdow_bum_b_t_vue
(
iv
,

351 
ayli_da
->
bum
);

356 
	`rc_ui_ma_wdow_t_b_t_vue
(
iv
, 
uri
, 
NULL
);

357 
	`rc_ui_ma_wdow_ti_b_t_vue
(
iv
, 
NULL
);

358 
	`rc_ui_ma_wdow_bum_b_t_vue
(
iv
, 
NULL
);

359 
	`gtk_b_t_xt
(
	`GTK_LABEL
(
iv
->
fo_b
),

360 
	`_
("Unknown Format"));

362 
	}
}

364 
gboޗn
 
	$rc_ui_ma_wdow_bum_found_cb
(
RCLibAlbum
 *
bum
, 
gut
 
ty
,

365 
gpor
 
bum_da
, gpo
da
)

367 cڡ 
gch
 *
fame
;

368 cڡ 
GBufr
 *
bufr
;

369 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

370 if(
da
==
NULL
 
FALSE
;

371 if(
ty
==
RCLIB_ALBUM_TYPE_BUFFER
)

373 
bufr
 = (cڡ 
GBufr
 *)
bum_da
;

374 if(
	`rc_ui_ma_wdow_cov_image_t_g_bufr
(
iv
, 
bufr
))

376 
iv
->
cov_t_ag
 = 
TRUE
;

377 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(

378 
iv
->
ui_mag
, "/AlbumPupMu/AlbumSaveImage"), 
TRUE
);

379  
TRUE
;

383 
iv
->
cov_t_ag
 = 
FALSE
;

384 
	`gtk_image_t_om_pixbuf
(
	`GTK_IMAGE
(
iv
->
bum_image
),

385 
iv
->
cov_deu_pixbuf
);

386 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(

387 
iv
->
ui_mag
, "/AlbumPupMu/AlbumSaveImage"), 
FALSE
);

390 if(
ty
==
RCLIB_ALBUM_TYPE_FILENAME
)

392 
fame
 = (cڡ 
gch
 *)
bum_da
;

393 if(
	`rc_ui_ma_wdow_cov_image_t_fe
(
iv
, 
fame
))

395 
iv
->
cov_t_ag
 = 
TRUE
;

396 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(

397 
iv
->
ui_mag
, "/AlbumPupMu/AlbumSaveImage"), 
TRUE
);

398  
TRUE
;

402 
iv
->
cov_t_ag
 = 
FALSE
;

403 
	`gtk_image_t_om_pixbuf
(
	`GTK_IMAGE
(
iv
->
bum_image
),

404 
iv
->
cov_deu_pixbuf
);

405 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(

406 
iv
->
ui_mag
, "/AlbumPupMu/AlbumSaveImage"), 
FALSE
);

409  
FALSE
;

410 
	}
}

412 
	$rc_ui_ma_wdow_bum_ne_cb
(
RCLibAlbum
 *
bum
, 
gpor
 
da
)

414 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

415 if(
da
==
NULL
) ;

416 
iv
->
cov_t_ag
 = 
FALSE
;

417 
	`gtk_image_t_om_pixbuf
(
	`GTK_IMAGE
(
iv
->
bum_image
),

418 
iv
->
cov_deu_pixbuf
);

419 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

420 "/AlbumPupMu/AlbumSaveImage"), 
FALSE
);

421 
	}
}

423 
gboޗn
 
	$rc_ui_ma_wdow_ay_bu_icked_cb
()

425 
GS
 
e
;

426 if(
	`rib_ce_g_e
(&
e
, 
NULL
, 0))

428 if(
e
==
GST_STATE_PLAYING
)

430 
	`rib_ce_u
();

431  
FALSE
;

433 if(
e
==
GST_STATE_PAUSED
)

435 
	`rib_ce_ay
();

436  
FALSE
;

439 
	`rib_ce_ay
();

440  
FALSE
;

441 
	}
}

443 
gboޗn
 
	$rc_ui_ma_wdow__bu_icked_cb
()

445 
	`rib_ce_
();

446  
FALSE
;

447 
	}
}

449 
gboޗn
 
	$rc_ui_ma_wdow_ev_bu_icked_cb
()

451 
	`rib_ay_ay_ev
(
FALSE
, 
TRUE
, FALSE);

452  
FALSE
;

453 
	}
}

455 
gboޗn
 
	$rc_ui_ma_wdow_xt_bu_icked_cb
()

457 
	`rib_ay_ay_xt
(
FALSE
, 
TRUE
, FALSE);

458  
FALSE
;

459 
	}
}

461 
gboޗn
 
	$rc_ui_ma_wdow_ݒ_bu_icked_cb
()

463 
	`rc_ui_dlog_add_music
();

464  
FALSE
;

465 
	}
}

467 
gboޗn
 
	$rc_ui_ma_wdow_adju_vume
(
GtkSBu
 *
widg
,

468 
gdoub
 
vume
, 
gpor
 
da
)

470 
	`g_sigl_hdrs_block_by_func
(
widg
,

471 
	`G_CALLBACK
(
rc_ui_ma_wdow_adju_vume
), 
da
);

472 
	`rib_ce_t_vume
(
vume
);

473 
	`g_sigl_hdrs_unblock_by_func
(
widg
,

474 
	`G_CALLBACK
(
rc_ui_ma_wdow_adju_vume
), 
da
);

475  
FALSE
;

476 
	}
}

478 
	$rc_ui_ma_wdow_ce_e_chged_cb
(
RCLibCe
 *
ce
,

479 
GS
 
e
, 
gpor
 
da
)

481 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

482 cڡ 
RCLibCeMada
 *
mada
;

483 if(
da
==
NULL
) ;

484 if(
e
==
GST_STATE_PLAYING
)

486 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(
iv
->
_ay_image
),

487 
GTK_STOCK_MEDIA_PAUSE
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

488 
	`g_obje_t
(
iv
->
time_s
, "fl-v", 100.0, 
NULL
);

492 
	`gtk_image_t_om_ock
(
	`GTK_IMAGE
(
iv
->
_ay_image
),

493 
GTK_STOCK_MEDIA_PLAY
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

494 
	`g_obje_t
(
iv
->
time_s
, "fl-v", 100.0, 
NULL
);

496 if(
e
!=
GST_STATE_PLAYING
 && s!=
GST_STATE_PAUSED
)

498 
	`gtk_widg_t_nsive
(
iv
->
time_s
, 
FALSE
);

499 
	`rc_ui_ma_wdow_time_b_t_vue
(
iv
, -1);

500 
	`g_obje_t
(
iv
->
time_s
, "fl-v", 0.0, 
NULL
);

501 
	`rc_ui_sb_b_t_xt
(
	`RC_UI_SCROLLABLE_LABEL
(

502 
iv
->
lyric1_ab
), 
NULL
);

503 
	`rc_ui_sb_b_t_xt
(
	`RC_UI_SCROLLABLE_LABEL
(

504 
iv
->
lyric2_ab
), 
NULL
);

505 
	`rc_ui_erum_widg_n
(
	`RC_UI_SPECTRUM_WIDGET
(

506 
iv
->
erum_widg
));

510 
	`gtk_widg_t_nsive
(
iv
->
time_s
, 
TRUE
);

511 
mada
 = 
	`rib_ce_g_mada
();

512 if(
mada
!=
NULL
)

514 
	`rc_ui_ma_wdow_fo_b_t_vue
(
iv
, 
mada
->
y
,

515 
mada
->
b
, 
	`rib_ce_quy_me_
(),

516 
	`rib_ce_quy_chls
());

519 
	`gtk_widg_queue_dw
(
iv
->
log_livw
);

520 
	`gtk_widg_queue_dw
(
iv
->
ayli_livw
);

521 
	}
}

523 
	$rc_ui_ma_wdow_vume_chged_cb
(
RCLibCe
 *
ce
, 
gdoub
 
vume
,

524 
gpor
 
da
)

526 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

527 if(
da
==
NULL
 || 
iv
==NULL) ;

528 
	`gtk_s_bu_t_vue
(
	`GTK_SCALE_BUTTON
(
iv
->
vume_bu
),

529 
vume
);

530 
	}
}

532 
	$rc_ui_ma_wdow_bufrg_cb
(
RCLibCe
 *
ce
, 
gt
 
r
,

533 
gpor
 
da
)

535 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

536 if(
da
==
NULL
 || 
iv
==NULL) ;

537 if(
r
>100)ercent = 100;

538 if(
r
<0)ercent = 0;

539 
	`g_obje_t
(
iv
->
time_s
, "fl-v", (
gdoub
)
r
, 
NULL
);

540 
	}
}

542 
	$rc_ui_ma_wdow_lyric_tim_cb
(
RCLibLyric
 *
lyric
, 
gut
 
dex
,

543 
gt64
 
pos
, cڡ 
RCLibLyricDa
 *
lyric_da
, gt64 
offt
,

544 
gpor
 
da
)

546 
gt64
 
sd
 = 0, 
n
 = 0;

547 
gt
 
r
 = 0.0;

548 
gt
 
xt_r
 = 0.0;

549 
gt
 
low
, 
high
;

550 
GtkWidg
 *
lyric_ab
;

551 
gt
 
width
;

552 
GtkAoti
 
loti
;

553 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

554 if(
da
==
NULL
 || 
iv
==NULL) ;

555 if(
lyric_da
==
NULL
)

557 if(
dex
==0)

558 
	`rc_ui_sb_b_t_xt
(
	`RC_UI_SCROLLABLE_LABEL
(

559 
iv
->
lyric1_ab
), 
NULL
);

561 
	`rc_ui_sb_b_t_xt
(
	`RC_UI_SCROLLABLE_LABEL
(

562 
iv
->
lyric2_ab
), 
NULL
);

565 if(
lyric_da
->
ngth
>0)

566 
n
 = 
lyric_da
->
ngth
;

569 
n
 = 
	`rib_ce_quy_duti
();

570 if(
n
>0- (
lyric_da
->
time
+
offt
);

572 
sd
 = 
pos
 - (
lyric_da
->
time
+
offt
);

573 if(
n
>0
r
 = (
gt
)
sd
 /en;

574 if(
dex
==0)

575 
lyric_ab
 = 
iv
->
lyric1_ab
;

577 
lyric_ab
 = 
iv
->
lyric2_ab
;

578 
	`rc_ui_sb_b_t_xt
(
	`RC_UI_SCROLLABLE_LABEL
(
lyric_ab
),

579 
lyric_da
->
xt
);

580 
width
 = 
	`rc_ui_sb_b_g_width
(
	`RC_UI_SCROLLABLE_LABEL
(

581 
lyric_ab
));

582 
	`gtk_widg_g_loti
(
lyric_ab
, &
loti
);

583 if(
width
>
loti
.width)

585 
low
 = (
gt
)
loti
.
width
 / width /2;

586 
high
 = 1.0 - 
low
;

587 if(
r
<=
low
)

588 
xt_r
 = 0.0;

589 if(
r
<
high
)

590 
xt_r
 = (
r
-
low
/ (
high
-low);

592 
xt_r
 = 1.0;

595 
xt_r
 = 0.0;

596 
	`rc_ui_sb_b_t_r
(
	`RC_UI_SCROLLABLE_LABEL
(
lyric_ab
),

597 
xt_r
);

598 
	}
}

600 
gboޗn
 
	$rc_ui_ma_wdow_ek_s_bu_esd
(
GtkWidg
 *
widg
,

601 
GdkEvtBu
 *
evt
, 
gpor
 
da
)

603 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

604 if(
da
==
NULL
 
FALSE
;

605 if(
evt
->
bu
==3 
TRUE
;

606 
iv
->
upde_ek_s
 = 
FALSE
;

613 
evt
->
bu
 = 2;

614  
FALSE
;

615 
	}
}

617 
gboޗn
 
	$rc_ui_ma_wdow_ek_s_bu_ad
(
GtkWidg
 *
widg
,

618 
GdkEvtBu
 *
evt
, 
gpor
 
da
)

620 
gdoub
 
r
;

621 
gt64
 
pos
, 
duti
;

622 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

623 if(
da
==
NULL
 
FALSE
;

624 
duti
 = 
	`rib_ce_quy_duti
();

625 
r
 = 
	`gtk_nge_g_vue
(
	`GTK_RANGE
(
widg
));

628 
evt
->
bu
 = 2;

629 
iv
->
upde_ek_s
 = 
TRUE
;

630 
pos
 = (
gdoub
)
duti
 * (
r
/100);

631 
	`rib_ce_t_posi
(
pos
);

632  
FALSE
;

633 
	}
}

635 
	$rc_ui_ma_wdow_ek_s_vue_chged
(
GtkRge
 *
nge
,

636 
gpor
 
da
)

638 
gdoub
 
r
;

639 
gt64
 
pos
, 
duti
;

640 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

641 if(
da
==
NULL
) ;

642 if(!
iv
->
upde_ek_s
)

644 
r
 = 
	`gtk_nge_g_vue
(
nge
);

645 
duti
 = 
	`rib_ce_quy_duti
();

646 
pos
 = (
gdoub
)
duti
 * (
r
/100);

647 
	`rc_ui_ma_wdow_time_b_t_vue
(
iv
, 
pos
);

649 
	}
}

651 
gboޗn
 
	$rc_ui_ma_wdow_upde_time_fo
(
gpor
 
da
)

653 
gdoub
 
r
;

654 
gt64
 
pos
, 
duti
;

655 
GS
 
e
;

656 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

657 if(
da
==
NULL
 
TRUE
;

658 
	`rib_ce_g_e
(&
e
, 
NULL
, 0);

659 
e
)

661 
GST_STATE_PLAYING
:

662 if(!
iv
->
upde_ek_s
) ;

663 
duti
 = 
	`rib_ce_quy_duti
();

664 
pos
 = 
	`rib_ce_quy_posi
();

665 
	`rc_ui_ma_wdow_time_b_t_vue
(
iv
, 
pos
);

666 if(
duti
>0)

667 
r
 = (
gdoub
)
pos
 / 
duti
 * 100;

669 
r
 = 0.0;

670 
	`g_sigl_hdrs_block_by_func
(
iv
->
time_s
,

671 
	`G_CALLBACK
(
rc_ui_ma_wdow_ek_s_vue_chged
), 
da
);

672 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
time_s
),

673 
r
);

674 
	`g_sigl_hdrs_unblock_by_func
(
iv
->
time_s
,

675 
	`G_CALLBACK
(
rc_ui_ma_wdow_ek_s_vue_chged
), 
da
);

677 
GST_STATE_PAUSED
:

680 
	`rc_ui_ma_wdow_time_b_t_vue
(
iv
, -1);

681 
	`gtk_nge_t_vue
(
	`GTK_RANGE
(
iv
->
time_s
), 0.0);

684  
TRUE
;

685 
	}
}

687 
	$rc_ui_ma_wdow_impt_upded_cb
(
RCLibDb
 *
db
, 
gt
 
mag
,

688 
gpor
 
da
)

690 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

691 
gboޗn
 
aive
;

692 if(
da
==
NULL
) ;

693 
gch
 *
xt
;

694 
	`g_obje_g
(
iv
->
ogss_r
, "aive", &
aive
, 
NULL
);

695 if(
mag
>0)

697 
iv
->
impt_wk_ag
 = 
TRUE
;

698 
	`gtk_widg_t_visib
(
iv
->
ogss_evtbox
, 
TRUE
);

699 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

700 "/ProgssPupMu/ProgssImptCl"), 
TRUE
);

701 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

702 "/ProgssPupMu/ProgssImptStus"), 
TRUE
);

703 
xt
 = 
	`g_rdup_tf
(
	`_
("Imptg: %demag"), 
mag
);

704 
	`gtk_ai_t_b
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

705 "/ProgssPupMu/ProgssImptStus"), 
xt
);

706 
	`g_
(
xt
);

707 if(!
aive

	`gtk_r_t
(
	`GTK_SPINNER
(
iv
->
ogss_r
));

711 
iv
->
impt_wk_ag
 = 
FALSE
;

712 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

713 "/ProgssPupMu/ProgssImptCl"), 
FALSE
);

714 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

715 "/ProgssPupMu/ProgssImptStus"), 
FALSE
);

716 
	`gtk_ai_t_b
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

718 
	`_
("Importing: 0emaining"));

719 if(!
iv
->
esh_wk_ag
)

721 
	`gtk_widg_t_visib
(
iv
->
ogss_evtbox
, 
FALSE
);

722 if(
aive

	`gtk_r_
(
	`GTK_SPINNER
(
iv
->
ogss_r
));

725 
	}
}

727 
	$rc_ui_ma_wdow_esh_upded_cb
(
RCLibDb
 *
db
, 
gt
 
mag
,

728 
gpor
 
da
)

730 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

731 
gboޗn
 
aive
;

732 
gch
 *
xt
;

733 if(
da
==
NULL
) ;

734 
	`g_obje_g
(
iv
->
ogss_r
, "aive", &
aive
, 
NULL
);

735 if(
mag
>0)

737 
iv
->
esh_wk_ag
 = 
TRUE
;

738 
	`gtk_widg_t_visib
(
iv
->
ogss_evtbox
, 
TRUE
);

739 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

740 "/ProgssPupMu/ProgssReeshCl"), 
TRUE
);

741 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

742 "/ProgssPupMu/ProgssReeshStus"), 
TRUE
);

743 
xt
 = 
	`g_rdup_tf
(
	`_
("Reeshg: %demag"), 
mag
);

744 
	`gtk_ai_t_b
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

745 "/ProgssPupMu/ProgssReeshStus"), 
xt
);

746 
	`g_
(
xt
);

747 if(!
aive

	`gtk_r_t
(
	`GTK_SPINNER
(
iv
->
ogss_r
));

751 
iv
->
esh_wk_ag
 = 
FALSE
;

752 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

753 "/ProgssPupMu/ProgssReeshCl"), 
FALSE
);

754 
	`gtk_ai_t_visib
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

755 "/ProgssPupMu/ProgssReeshStus"), 
FALSE
);

756 
	`gtk_ai_t_b
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

758 
	`_
("Refreshing: 0emaining"));

759 if(!
iv
->
impt_wk_ag
)

761 
	`gtk_widg_t_visib
(
iv
->
ogss_evtbox
, 
FALSE
);

762 if(
aive

	`gtk_r_
(
	`GTK_SPINNER
(
iv
->
ogss_r
));

765 
	}
}

767 
	$rc_ui_ma_wdow_ogss_pup_mu_posi_func
(
GtkMu
 *
mu
,

768 
gt
 *
x
, g*
y
, 
gboޗn
 *
push_
, 
gpor
 
da
)

770 
GtkWidg
 *
widg
;

771 
GdkWdow
 *
wdow
;

772 
GtkAoti
 
loti
, 
mu_loti
;

773 
gt
 
wx
, 
wy
;

774 
widg
 = 
	`GTK_WIDGET
(
da
);

775 if(
widg
==
NULL
) ;

776 
wdow
 = 
	`gtk_widg_g_wdow
(
widg
);

777 
	`gtk_widg_g_loti
(
widg
, &
loti
);

778 
	`gtk_widg_g_loti
(
	`GTK_WIDGET
(
mu
), &
mu_loti
);

779 
	`gdk_wdow_g_ig
(
wdow
, &
wx
, &
wy
);

780 *
x
 = 
wx
 + 
loti
.
width
 - 
mu_loti
.width;

781 *
y
 = 
wy
 - 
mu_loti
.
height
;

782 *
push_
 = 
TRUE
;

783 
	}
}

785 
gboޗn
 
	$rc_ui_ma_wdow_bum_mu_pup
(
GtkWidg
 *
widg
,

786 
GdkEvtBu
 *
evt
, 
gpor
 
da
)

788 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

789 if(
da
==
NULL
 
FALSE
;

790 if(
evt
->
bu
!=3 
FALSE
;

791 
	`gtk_mu_pup
(
	`GTK_MENU
(
	`gtk_ui_mag_g_widg
(
iv
->
ui_mag
,

792 "/AlbumPupMu")), 
NULL
, NULL, NULL, 
widg
, 3, 
evt
->
time
);

793  
FALSE
;

794 
	}
}

796 
gboޗn
 
	$rc_ui_ma_wdow_erum_mu_pup
(
GtkWidg
 *
widg
,

797 
GdkEvtBu
 *
evt
, 
gpor
 
da
)

799 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

800 if(
da
==
NULL
 
FALSE
;

801 if(
evt
->
bu
!=3 
FALSE
;

802 
	`gtk_mu_pup
(
	`GTK_MENU
(
	`gtk_ui_mag_g_widg
(
iv
->
ui_mag
,

803 "/SrumPupMu")), 
NULL
, NULL, NULL, 
widg
, 1,

804 
evt
->
time
);

805  
FALSE
;

806 
	}
}

808 
gboޗn
 
	$rc_ui_ma_wdow_ogss_mu_pup
(
GtkWidg
 *
widg
,

809 
GdkEvtBu
 *
evt
, 
gpor
 
da
)

811 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

812 if(
da
==
NULL
 
FALSE
;

813 
	`gtk_mu_pup
(
	`GTK_MENU
(
	`gtk_ui_mag_g_widg
(
iv
->
ui_mag
,

814 "/ProgssPupMu")), 
NULL
, NULL,

815 
rc_ui_ma_wdow_ogss_pup_mu_posi_func
, 
widg
, 1,

816 
evt
->
time
);

817  
FALSE
;

818 
	}
}

820 
gboޗn
 
	$rc_ui_ma_wdow_wdow_e_evt_cb
(
GtkWidg
 *
widg
,

821 
GdkEvt
 *
evt
, 
gpor
 
da
)

823 
GdkEvtWdowS
 *
wdow_e
;

824 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

825 if(
da
==
NULL
 
FALSE
;

826 if(
evt
->
ty
!=
GDK_WINDOW_STATE
 
FALSE
;

827 
wdow_e
 = &(
evt
->window_state);

828 if(
wdow_e
->
w_wdow_e
 & 
GDK_WINDOW_STATE_ABOVE
)

830 
	`gtk_togg_ai_t_aive
(
	`GTK_TOGGLE_ACTION
(

831 
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

832 "/RC2MuB/VwMu/VwAlwaysOnT")), 
TRUE
);

833 
	`gtk_togg_ai_t_aive
(
	`GTK_TOGGLE_ACTION
(

834 
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

835 "/TyPupMu/TyAlwaysOnT")), 
TRUE
);

836 
	`g_sigl_em
(
ui_ma_wdow_
,

837 
ui_ma_wdow_sigls
[
SIGNAL_KEEP_ABOVE_CHANGED
], 0, 
TRUE
);

841 
	`gtk_togg_ai_t_aive
(
	`GTK_TOGGLE_ACTION
(

842 
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

843 "/RC2MuB/VwMu/VwAlwaysOnT")), 
FALSE
);

844 
	`gtk_togg_ai_t_aive
(
	`GTK_TOGGLE_ACTION
(

845 
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

846 "/TyPupMu/TyAlwaysOnT")), 
FALSE
);

847 
	`g_sigl_em
(
ui_ma_wdow_
,

848 
ui_ma_wdow_sigls
[
SIGNAL_KEEP_ABOVE_CHANGED
], 0, 
FALSE
);

850 if(
	`rib_gs_g_boޗn
("MaUI", "MimizeToTy", 
NULL
))

852 if(
wdow_e
->
chged_mask
==
GDK_WINDOW_STATE_ICONIFIED
 &&

853 
wdow_e
->
w_wdow_e
==
GDK_WINDOW_STATE_ICONIFIED
)

855 
	`gtk_wdow_t_sk_skb_ht
(
	`GTK_WINDOW
(
widg
),

856 
TRUE
);

857 
	`gtk_widg_hide
(
widg
);

860  
FALSE
;

861 
	}
}

863 
gboޗn
 
	$rc_ui_ma_wdow_wdow_de_evt_cb
(
GtkWidg
 *
widg
,

864 
GdkEvt
 *
evt
, 
gpor
 
da
)

866 if(
	`rib_gs_g_boޗn
("MaUI", "MimizeWhClo", 
NULL
))

867 
	`gtk_wdow_icify
(
	`GTK_WINDOW
(
widg
));

869 
	`rc_ui_ay_ex
();

870  
TRUE
;

871 
	}
}

873 
	$rc_ui_ma_wdow_log_livw_i_chged_cb
(

874 
GtkTeSei
 *
i
, 
gpor
 
da
)

876 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

877 
gt
 
vue
 = 
	`gtk__i_cou_ed_rows
(
i
);

878 if(
da
==
NULL
) ;

879 if(
vue
>0)

881 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

882 "/RC2MuB/PyliMu/PyliRemoveLi"), 
TRUE
);

883 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

884 "/CogPupMu/CogRemoveLi"), 
TRUE
);

888 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

889 "/RC2MuB/PyliMu/PyliRemoveLi"), 
FALSE
);

890 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

891 "/CogPupMu/CogRemoveLi"), 
FALSE
);

893 if(
vue
==1)

895 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

896 "/RC2MuB/PyliMu/PyliImptMusic"), 
TRUE
);

897 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

898 "/RC2MuB/PyliMu/PyliImptLi"), 
TRUE
);

899 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

900 "/RC2MuB/PyliMu/PyliImptFd"), 
TRUE
);

901 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

902 "/RC2MuB/PyliMu/PyliExptLi"), 
TRUE
);

903 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

904 "/RC2MuB/PyliMu/PyliRameLi"), 
TRUE
);

905 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

906 "/RC2MuB/PyliMu/PyliSeA"), 
TRUE
);

907 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

908 "/RC2MuB/PyliMu/PyliReeshLi"), 
TRUE
);

909 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

910 "/CogPupMu/CogRameLi"), 
TRUE
);

911 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

912 "/CogPupMu/CogExptLi"), 
TRUE
);

913 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

914 "/PyliPupMu/PyliPImptMusic"), 
TRUE
);

915 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

916 "/PyliPupMu/PyliPImptLi"), 
TRUE
);

917 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

918 "/PyliPupMu/PyliPReeshLi"), 
TRUE
);

919 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

920 "/PyliPupMu/PyliPSeA"), 
TRUE
);

924 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

925 "/RC2MuB/PyliMu/PyliImptMusic"), 
FALSE
);

926 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

927 "/RC2MuB/PyliMu/PyliImptLi"), 
FALSE
);

928 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

929 "/RC2MuB/PyliMu/PyliImptFd"), 
FALSE
);

930 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

931 "/RC2MuB/PyliMu/PyliExptLi"), 
FALSE
);

932 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

933 "/RC2MuB/PyliMu/PyliRameLi"), 
FALSE
);

934 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

935 "/RC2MuB/PyliMu/PyliSeA"), 
FALSE
);

936 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

937 "/RC2MuB/PyliMu/PyliReeshLi"), 
FALSE
);

938 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

939 "/CogPupMu/CogRameLi"), 
FALSE
);

940 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

941 "/CogPupMu/CogExptLi"), 
FALSE
);

942 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

943 "/PyliPupMu/PyliPImptMusic"), 
FALSE
);

944 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

945 "/PyliPupMu/PyliPImptLi"), 
FALSE
);

946 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

947 "/PyliPupMu/PyliPReeshLi"), 
FALSE
);

948 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

949 "/PyliPupMu/PyliPSeA"), 
FALSE
);

951 
	}
}

953 
	$rc_ui_ma_wdow_ayli_livw_i_chged_cb
(

954 
GtkTeSei
 *
i
, 
gpor
 
da
)

956 
RCUiMaWdowPrive
 *
iv
 = (RCUiMaWdowPriv*)
da
;

957 
gt
 
vue
 = 
	`gtk__i_cou_ed_rows
(
i
);

958 if(
da
==
NULL
) ;

959 if(
vue
>0)

961 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

962 "/RC2MuB/PyliMu/PyliRemoveMusic"), 
TRUE
);

963 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

964 "/PyliPupMu/PyliPRemoveMusic"), 
TRUE
);

968 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

969 "/RC2MuB/PyliMu/PyliRemoveMusic"), 
FALSE
);

970 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

971 "/PyliPupMu/PyliPRemoveMusic"), 
FALSE
);

973 if(
vue
==1)

975 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

976 "/RC2MuB/PyliMu/PyliBdLyric"), 
TRUE
);

977 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

978 "/RC2MuB/PyliMu/PyliBdAlbum"), 
TRUE
);

979 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

980 "/PyliPupMu/PyliPBdLyric"), 
TRUE
);

981 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

982 "/PyliPupMu/PyliPBdAlbum"), 
TRUE
);

986 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

987 "/RC2MuB/PyliMu/PyliBdLyric"), 
FALSE
);

988 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

989 "/RC2MuB/PyliMu/PyliBdAlbum"), 
FALSE
);

990 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

991 "/PyliPupMu/PyliPBdLyric"), 
FALSE
);

992 
	`gtk_ai_t_nsive
(
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

993 "/PyliPupMu/PyliPBdAlbum"), 
FALSE
);

995 
	}
}

997 
	$rc_ui_ma_wdow_t_deu_y
(
RCUiMaWdowPrive
 *
iv
)

999 
PgoArLi
 *
t__li
, *
ti__li
, *
bum__li
;

1000 
PgoArLi
 *
time__li
, *
ngth__li
, *
fo__li
;

1001 
PgoArLi
 *
log__li
, *
ayli__li
;

1002 
PgoArLi
 *
lyric__li
;

1003 
PgoAribu
 *
t_
[2], *
ti_
[2], *
bum_
[2];

1004 
PgoAribu
 *
time_
[2], *
ngth_
[2], *
fo_
[2];

1005 
PgoAribu
 *
log_
[2], *
ayli_
[2], *
lyric_
[2];

1006 
t__li
 = 
	`ngo__li_w
();

1007 
ti__li
 = 
	`ngo__li_w
();

1008 
bum__li
 = 
	`ngo__li_w
();

1009 
time__li
 = 
	`ngo__li_w
();

1010 
ngth__li
 = 
	`ngo__li_w
();

1011 
fo__li
 = 
	`ngo__li_w
();

1012 
log__li
 = 
	`ngo__li_w
();

1013 
ayli__li
 = 
	`ngo__li_w
();

1014 
lyric__li
 = 
	`ngo__li_w
();

1015 
t_
[0] = 
	`ngo__size_w_absu
(17 * 
PANGO_SCALE
);

1016 
t_
[1] = 
	`ngo__weight_w
(
PANGO_WEIGHT_BOLD
);

1017 
ti_
[0] = 
	`ngo__size_w_absu
(14 * 
PANGO_SCALE
);

1018 
ti_
[1] = 
	`ngo__weight_w
(
PANGO_WEIGHT_NORMAL
);

1019 
bum_
[0] = 
	`ngo__size_w_absu
(14 * 
PANGO_SCALE
);

1020 
bum_
[1] = 
	`ngo__y_w
(
PANGO_STYLE_ITALIC
);

1021 
time_
[0] = 
	`ngo__size_w_absu
(26 * 
PANGO_SCALE
);

1022 
time_
[1] = 
	`ngo__weight_w
(
PANGO_WEIGHT_NORMAL
);

1023 
ngth_
[0] = 
	`ngo__size_w_absu
(15 * 
PANGO_SCALE
);

1024 
ngth_
[1] = 
	`ngo__weight_w
(
PANGO_WEIGHT_NORMAL
);

1025 
fo_
[0] = 
	`ngo__size_w_absu
(12 * 
PANGO_SCALE
);

1026 
fo_
[1] = 
	`ngo__weight_w
(
PANGO_WEIGHT_NORMAL
);

1027 
log_
[0] = 
	`ngo__size_w_absu
(13 * 
PANGO_SCALE
);

1028 
log_
[1] = 
	`ngo__weight_w
(
PANGO_WEIGHT_NORMAL
);

1029 
ayli_
[0] = 
	`ngo__size_w_absu
(13 * 
PANGO_SCALE
);

1030 
ayli_
[1] = 
	`ngo__weight_w
(
PANGO_WEIGHT_NORMAL
);

1031 
lyric_
[0] = 
	`ngo__size_w_absu
(13 * 
PANGO_SCALE
);

1032 
lyric_
[1] = 
	`ngo__weight_w
(
PANGO_WEIGHT_NORMAL
);

1033 
	`ngo__li_
(
t__li
, 
t_
[0]);

1034 
	`ngo__li_
(
t__li
, 
t_
[1]);

1035 
	`ngo__li_
(
ti__li
, 
ti_
[0]);

1036 
	`ngo__li_
(
ti__li
, 
ti_
[1]);

1037 
	`ngo__li_
(
bum__li
, 
bum_
[0]);

1038 
	`ngo__li_
(
bum__li
, 
bum_
[1]);

1039 
	`ngo__li_
(
time__li
, 
time_
[0]);

1040 
	`ngo__li_
(
time__li
, 
time_
[1]);

1041 
	`ngo__li_
(
fo__li
, 
fo_
[0]);

1042 
	`ngo__li_
(
fo__li
, 
fo_
[1]);

1043 
	`ngo__li_
(
ngth__li
, 
ngth_
[0]);

1044 
	`ngo__li_
(
ngth__li
, 
ngth_
[1]);

1045 
	`ngo__li_
(
log__li
, 
log_
[0]);

1046 
	`ngo__li_
(
log__li
, 
log_
[1]);

1047 
	`ngo__li_
(
ayli__li
, 
ayli_
[0]);

1048 
	`ngo__li_
(
ayli__li
, 
ayli_
[1]);

1049 
	`ngo__li_
(
lyric__li
, 
lyric_
[0]);

1050 
	`ngo__li_
(
lyric__li
, 
lyric_
[1]);

1051 
	`gtk_b_t_ibus
(
	`GTK_LABEL
(
iv
->
t_b
),

1052 
t__li
);

1053 
	`ngo__li_uef
(
t__li
);

1054 
	`gtk_b_t_ibus
(
	`GTK_LABEL
(
iv
->
ti_b
),

1055 
ti__li
);

1056 
	`ngo__li_uef
(
ti__li
);

1057 
	`gtk_b_t_ibus
(
	`GTK_LABEL
(
iv
->
bum_b
),

1058 
bum__li
);

1059 
	`ngo__li_uef
(
bum__li
);

1060 
	`gtk_b_t_ibus
(
	`GTK_LABEL
(
iv
->
fo_b
),

1061 
fo__li
);

1062 
	`ngo__li_uef
(
fo__li
);

1063 
	`gtk_b_t_ibus
(
	`GTK_LABEL
(
iv
->
time_b
),

1064 
time__li
);

1065 
	`ngo__li_uef
(
time__li
);

1066 
	`gtk_b_t_ibus
(
	`GTK_LABEL
(
iv
->
ngth_b
),

1067 
ngth__li
);

1068 
	`ngo__li_uef
(
ngth__li
);

1069 
	`rc_ui_livw_log_t_ngo_ibus
(
log__li
);

1070 
	`rc_ui_livw_ayli_t_ngo_ibus
(
ayli__li
);

1071 
	`ngo__li_uef
(
log__li
);

1072 
	`ngo__li_uef
(
ayli__li
);

1073 
	`rc_ui_sb_b_t_ibus
(
	`RC_UI_SCROLLABLE_LABEL
(

1074 
iv
->
lyric1_ab
), 
lyric__li
);

1075 
	`rc_ui_sb_b_t_ibus
(
	`RC_UI_SCROLLABLE_LABEL
(

1076 
iv
->
lyric2_ab
), 
lyric__li
);

1077 
	`ngo__li_uef
(
lyric__li
);

1078 
	`gtk_widg_t_size_que
(
iv
->
time_s
, -1, 20);

1079 
	`gtk_widg_t_size_que
(
	`gtk_sd_wdow_g_vslb
(

1080 
	`GTK_SCROLLED_WINDOW
(
iv
->
log_s_wdow
)), 15, -1);

1081 
	`gtk_widg_t_size_que
(
	`gtk_sd_wdow_g_vslb
(

1082 
	`GTK_SCROLLED_WINDOW
(
iv
->
ayli_s_wdow
)), 15, -1);

1083 
	}
}

1085 
	$rc_ui_ma_wdow_yout_
(
RCUiMaWdow
 *
wdow
)

1087 
RCUiMaWdowPrive
 *
iv
 = 
wdow
->priv;

1088 
GtkWidg
 *
l_grid
;

1089 
GtkWidg
 *
l_right_grid
;

1090 
GtkWidg
 *
fo_grid
;

1091 
GtkWidg
 *
mmd_grid
;

1092 
GtkWidg
 *
time_grid
;

1093 
GtkWidg
 *
lyric_grid
;

1094 
GtkWidg
 *
_bu_grid
;

1095 
GtkWidg
 *
ay_grid
;

1096 
ay_grid
 = 
	`gtk_grid_w
();

1097 
l_grid
 = 
	`gtk_grid_w
();

1098 
l_right_grid
 = 
	`gtk_grid_w
();

1099 
mmd_grid
 = 
	`gtk_grid_w
();

1100 
time_grid
 = 
	`gtk_grid_w
();

1101 
lyric_grid
 = 
	`gtk_grid_w
();

1102 
fo_grid
 = 
	`gtk_grid_w
();

1103 
_bu_grid
 = 
	`gtk_grid_w
();

1104 
	`g_obje_t
(
iv
->
bum_ame
, "margin-left", 1, "margin-right", 0,

1105 
NULL
);

1106 
	`g_obje_t
(
fo_grid
, "cumn-acg", 2, 
NULL
);

1107 
	`g_obje_t
(
mmd_grid
, "row-acg", 2, "hexnd-t", 
TRUE
,

1108 "hexnd", 
TRUE
, "vexnd-t", TRUE, "vexnd", 
FALSE
, 
NULL
);

1109 
	`g_obje_t
(
time_grid
, "row-acg", 2, 
NULL
);

1110 
	`g_obje_t
(
lyric_grid
, "mg-t", 2, "mg-btom", 2, 
NULL
);

1111 
	`g_obje_t
(
l_grid
, "hexnd-t", 
TRUE
, "hexnd", TRUE, 
NULL
);

1112 
	`g_obje_t
(
ay_grid
, "exnd", 
TRUE
, 
NULL
);

1113 
	`g_obje_t
(
l_right_grid
, "hexnd-t", 
TRUE
, "hexpand", TRUE,

1114 "vexnd-t", 
TRUE
, "vexnd", 
FALSE
, "margin-left", 4,

1115 "mg-right", 2, 
NULL
);

1116 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
log_s_wdow
),

1117 
iv
->
log_livw
);

1118 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
ayli_s_wdow
),

1119 
iv
->
ayli_livw
);

1120 
	`gtk_d_ck1
(
	`GTK_PANED
(
iv
->
li_d
),riv->
log_s_wdow
,

1121 
TRUE
, 
FALSE
);

1122 
	`gtk_d_ck2
(
	`GTK_PANED
(
iv
->
li_d
),riv->
ayli_s_wdow
,

1123 
TRUE
, 
FALSE
);

1124 
	`gtk_cڏ_chd_t
(
	`GTK_CONTAINER
(
iv
->
li_d
),

1125 
iv
->
log_s_wdow
, "size", 
FALSE
, "shrk", FALSE, 
NULL
);

1126 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
bum_evtbox
),riv->
bum_image
);

1127 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
bum_ame
),riv->
bum_evtbox
);

1128 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
ogss_evtbox
),

1129 
iv
->
ogss_r
);

1130 
	`gtk_grid_ch
(
	`GTK_GRID
(
mmd_grid
), 
iv
->
t_b
, 0, 0, 1, 1);

1131 
	`gtk_grid_ch
(
	`GTK_GRID
(
mmd_grid
), 
iv
->
ti_b
, 0, 1, 1, 1);

1132 
	`gtk_grid_ch
(
	`GTK_GRID
(
mmd_grid
), 
iv
->
bum_b
, 0, 2, 1, 1);

1133 
	`gtk_grid_ch
(
	`GTK_GRID
(
mmd_grid
), 
iv
->
fo_b
, 0, 3, 1, 1);

1134 
	`gtk_grid_ch
(
	`GTK_GRID
(
time_grid
), 
iv
->
time_b
, 0, 0, 1, 1);

1135 
	`gtk_grid_ch
(
	`GTK_GRID
(
time_grid
), 
iv
->
ngth_b
, 0, 1, 1, 1);

1136 
	`gtk_grid_ch
(
	`GTK_GRID
(
_bu_grid
), 
iv
->
_ev_bu
,

1138 
	`gtk_grid_ch
(
	`GTK_GRID
(
_bu_grid
), 
iv
->
_ay_bu
,

1140 
	`gtk_grid_ch
(
	`GTK_GRID
(
_bu_grid
), 
iv
->
__bu
,

1142 
	`gtk_grid_ch
(
	`GTK_GRID
(
_bu_grid
), 
iv
->
_xt_bu
,

1144 
	`gtk_grid_ch
(
	`GTK_GRID
(
_bu_grid
), 
iv
->
time_s
,

1146 
	`gtk_grid_ch
(
	`GTK_GRID
(
_bu_grid
), 
iv
->
ogss_evtbox
,

1148 
	`gtk_grid_ch
(
	`GTK_GRID
(
_bu_grid
), 
iv
->
vume_bu
,

1150 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
mmd_grid
, 0, 0, 1, 1);

1151 
	`gtk_grid_ch
(
	`GTK_GRID
(
fo_grid
), 
time_grid
, 1, 0, 1, 1);

1152 
	`gtk_grid_ch
(
	`GTK_GRID
(
lyric_grid
), 
iv
->
lyric1_ab
, 0, 0, 1, 1);

1153 
	`gtk_grid_ch
(
	`GTK_GRID
(
lyric_grid
), 
iv
->
lyric2_ab
, 0, 1, 1, 1);

1154 
	`gtk_grid_ch
(
	`GTK_GRID
(
l_right_grid
), 
fo_grid
, 0, 0, 1, 1);

1155 
	`gtk_grid_ch
(
	`GTK_GRID
(
l_right_grid
), 
lyric_grid
, 0, 1, 1, 1);

1156 
	`gtk_grid_ch
(
	`GTK_GRID
(
l_right_grid
), 
iv
->
erum_widg
, 0, 2,

1158 
	`gtk_grid_ch
(
	`GTK_GRID
(
l_grid
), 
iv
->
bum_ame
, 0, 0, 1, 1);

1159 
	`gtk_grid_ch
(
	`GTK_GRID
(
l_grid
), 
l_right_grid
, 1, 0, 1, 1);

1160 
	`gtk_grid_ch
(
	`GTK_GRID
(
ay_grid
), 
l_grid
, 0, 0, 1, 1);

1161 
	`gtk_grid_ch
(
	`GTK_GRID
(
ay_grid
), 
_bu_grid
, 0, 1, 1, 1);

1162 
	`gtk_grid_ch
(
	`GTK_GRID
(
ay_grid
), 
iv
->
li_d
, 0, 2, 1, 1);

1163 
	`gtk_grid_ch
(
	`GTK_GRID
(
iv
->
ma_grid
), 
	`gtk_ui_mag_g_widg
(

1164 
iv
->
ui_mag
, "/RC2MenuBar"), 0, 0, 1, 1);

1165 
	`gtk_grid_ch
(
	`GTK_GRID
(
iv
->
ma_grid
), 
ay_grid
, 0, 1, 1, 1);

1166 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
wdow
), 
iv
->
ma_grid
);

1167 
	}
}

1169 
	$rc_ui_ma_wdow_sigl_bd
(
RCUiMaWdow
 *
wdow
)

1171 
RCUiMaWdowPrive
 *
iv
 = 
wdow
->priv;

1172 
GtkTeSei
 *
log_i
, *
ayli_i
;

1173 
log_i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

1174 
iv
->
log_livw
));

1175 
ayli_i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

1176 
iv
->
ayli_livw
));

1177 
iv
->
upde_timeout
 = 
	`g_timeout_add
(250, (
GSourFunc
)

1178 
rc_ui_ma_wdow_upde_time_fo
, 
iv
);

1179 
	`g_sigl_c
(
iv
->
_ay_bu
, "clicked",

1180 
	`G_CALLBACK
(
rc_ui_ma_wdow_ay_bu_icked_cb
), 
iv
);

1181 
	`g_sigl_c
(
iv
->
__bu
, "clicked",

1182 
	`G_CALLBACK
(
rc_ui_ma_wdow__bu_icked_cb
), 
iv
);

1183 
	`g_sigl_c
(
iv
->
_ev_bu
, "clicked",

1184 
	`G_CALLBACK
(
rc_ui_ma_wdow_ev_bu_icked_cb
), 
iv
);

1185 
	`g_sigl_c
(
iv
->
_xt_bu
, "clicked",

1186 
	`G_CALLBACK
(
rc_ui_ma_wdow_xt_bu_icked_cb
), 
iv
);

1187 
	`g_sigl_c
(
iv
->
_ݒ_bu
, "clicked",

1188 
	`G_CALLBACK
(
rc_ui_ma_wdow_ݒ_bu_icked_cb
), 
iv
);

1189 
	`g_sigl_c
(
iv
->
bum_evtbox
, "button-press-event",

1190 
	`G_CALLBACK
(
rc_ui_ma_wdow_bum_mu_pup
), 
iv
);

1191 
	`g_sigl_c
(
iv
->
erum_widg
, "button-press-event",

1192 
	`G_CALLBACK
(
rc_ui_ma_wdow_erum_mu_pup
), 
iv
);

1193 
	`g_sigl_c
(
iv
->
ogss_evtbox
, "button-press-event",

1194 
	`G_CALLBACK
(
rc_ui_ma_wdow_ogss_mu_pup
), 
iv
);

1195 
	`g_sigl_c
(
iv
->
vume_bu
, "value-changed",

1196 
	`G_CALLBACK
(
rc_ui_ma_wdow_adju_vume
), 
iv
);

1197 
	`g_sigl_c
(
iv
->
time_s
, "button-press-event",

1198 
	`G_CALLBACK
(
rc_ui_ma_wdow_ek_s_bu_esd
), 
iv
);

1199 
	`g_sigl_c
(
iv
->
time_s
, "button-release-event",

1200 
	`G_CALLBACK
(
rc_ui_ma_wdow_ek_s_bu_ad
), 
iv
);

1201 
	`g_sigl_c
(
iv
->
time_s
, "scroll-event",

1202 
	`G_CALLBACK
(
gtk_ue
), 
iv
);

1203 
	`g_sigl_c
(
iv
->
time_s
, "value-changed",

1204 
	`G_CALLBACK
(
rc_ui_ma_wdow_ek_s_vue_chged
), 
iv
);

1205 
	`g_sigl_c
(
log_i
, "changed",

1206 
	`G_CALLBACK
(
rc_ui_ma_wdow_log_livw_i_chged_cb
),

1207 
iv
);

1208 
	`g_sigl_c
(
ayli_i
, "changed",

1209 
	`G_CALLBACK
(
rc_ui_ma_wdow_ayli_livw_i_chged_cb
),

1210 
iv
);

1211 
	`g_sigl_c
(
wdow
, "window-state-event",

1212 
	`G_CALLBACK
(
rc_ui_ma_wdow_wdow_e_evt_cb
), 
iv
);

1213 
	`g_sigl_c
(
wdow
, "delete-event",

1214 
	`G_CALLBACK
(
rc_ui_ma_wdow_wdow_de_evt_cb
), 
iv
);

1215 
iv
->
g_found_id
 = 
	`rib_ce_sigl_c
("tag-found",

1216 
	`G_CALLBACK
(
rc_ui_ma_wdow_g_found_cb
), 
iv
);

1217 
iv
->
w_duti_id
 = 
	`rib_ce_sigl_c
("new-duration",

1218 
	`G_CALLBACK
(
rc_ui_ma_wdow_w_duti_cb
), 
iv
);

1219 
iv
->
e_chged_id
 = 
	`rib_ce_sigl_c
("state-changed",

1220 
	`G_CALLBACK
(
rc_ui_ma_wdow_ce_e_chged_cb
), 
iv
);

1221 
iv
->
uri_chged_id
 = 
	`rib_ce_sigl_c
("uri-changed",

1222 
	`G_CALLBACK
(
rc_ui_ma_wdow_uri_chged_cb
), 
iv
);

1223 
iv
->
vume_chged_id
 = 
	`rib_ce_sigl_c
("volume-changed",

1224 
	`G_CALLBACK
(
rc_ui_ma_wdow_vume_chged_cb
), 
iv
);

1225 
iv
->
bufrg_id
 = 
	`rib_ce_sigl_c
("buffering",

1226 
	`G_CALLBACK
(
rc_ui_ma_wdow_bufrg_cb
), 
iv
);

1227 
iv
->
lyric_tim_id
 = 
	`rib_lyric_sigl_c
("lyric-timer",

1228 
	`G_CALLBACK
(
rc_ui_ma_wdow_lyric_tim_cb
), 
iv
);

1229 
iv
->
impt_upded_id
 = 
	`rib_db_sigl_c
("import-updated",

1230 
	`G_CALLBACK
(
rc_ui_ma_wdow_impt_upded_cb
), 
iv
);

1231 
iv
->
esh_upded_id
 = 
	`rib_db_sigl_c
("refresh-updated",

1232 
	`G_CALLBACK
(
rc_ui_ma_wdow_esh_upded_cb
), 
iv
);

1233 
iv
->
bum_found_id
 = 
	`rib_bum_sigl_c
("album-found",

1234 
	`G_CALLBACK
(
rc_ui_ma_wdow_bum_found_cb
), 
iv
);

1235 
iv
->
bum_ne_id
 = 
	`rib_bum_sigl_c
("album-none",

1236 
	`G_CALLBACK
(
rc_ui_ma_wdow_bum_ne_cb
), 
iv
);

1237 
	}
}

1239 
	$rc_ui_ma_wdow_fize
(
GObje
 *
obje
)

1241 
RCUiMaWdowPrive
 *
iv
 = 
	`RC_UI_MAIN_WINDOW
(
obje
)->priv;

1242 if(
iv
->
upde_timeout
>0)

1243 
	`g_sour_move
(
iv
->
upde_timeout
);

1244 if(
iv
->
g_found_id
>0)

1245 
	`rib_ce_sigl_disc
(
iv
->
g_found_id
);

1246 if(
iv
->
w_duti_id
>0)

1247 
	`rib_ce_sigl_disc
(
iv
->
w_duti_id
);

1248 if(
iv
->
e_chged_id
>0)

1249 
	`rib_ce_sigl_disc
(
iv
->
e_chged_id
);

1250 if(
iv
->
uri_chged_id
>0)

1251 
	`rib_ce_sigl_disc
(
iv
->
uri_chged_id
);

1252 if(
iv
->
vume_chged_id
>0)

1253 
	`rib_ce_sigl_disc
(
iv
->
vume_chged_id
);

1254 if(
iv
->
bufrg_id
>0)

1255 
	`rib_ce_sigl_disc
(
iv
->
bufrg_id
);

1256 if(
iv
->
lyric_tim_id
>0)

1257 
	`rib_lyric_sigl_disc
(
iv
->
lyric_tim_id
);

1258 if(
iv
->
impt_upded_id
>0)

1259 
	`rib_db_sigl_disc
(
iv
->
impt_upded_id
);

1260 if(
iv
->
esh_upded_id
>0)

1261 
	`rib_db_sigl_disc
(
iv
->
esh_upded_id
);

1262 if(
iv
->
bum_found_id
>0)

1263 
	`rib_bum_sigl_disc
(
iv
->
bum_found_id
);

1264 if(
iv
->
bum_ne_id
>0)

1265 
	`rib_bum_sigl_disc
(
iv
->
bum_ne_id
);

1266 
	`G_OBJECT_CLASS
(
rc_ui_ma_wdow__ass
)->
	`fize
(
obje
);

1267 
	}
}

1269 
GObje
 *
	$rc_ui_ma_wdow_cڡru
(
GTy
 
ty
,

1270 
gut
 
n_cڡru_ms
, 
GObjeCڡruPam
 *
cڡru_ms
)

1272 
GObje
 *
tv
;

1273 if(
ui_ma_wdow_
!=
NULL
)  ui_main_window_instance;

1274 
tv
 = 
	`G_OBJECT_CLASS
(
rc_ui_ma_wdow__ass
)->
	`cڡru
(

1275 
ty
, 
n_cڡru_ms
, 
cڡru_ms
);

1276 
ui_ma_wdow_
 = 
tv
;

1277 
	`g_obje_add_wk_por
(
tv
, (
gpor
)&
ui_ma_wdow_
);

1278  
tv
;

1279 
	}
}

1281 
	$rc_ui_ma_wdow_ass_
(
RCUiMaWdowCss
 *
kss
)

1283 
GObjeCss
 *
obje_ass
 = (GObjeCs*)
kss
;

1284 
rc_ui_ma_wdow__ass
 = 
	`g_ty_ass_ek_
(
kss
);

1285 
obje_ass
->
fize
 = 
rc_ui_ma_wdow_fize
;

1286 
obje_ass
->
cڡru
 = 
rc_ui_ma_wdow_cڡru
;

1287 
	`g_ty_ass_add_ive
(
kss
, (
RCUiMaWdowPrive
));

1297 
ui_ma_wdow_sigls
[
SIGNAL_KEEP_ABOVE_CHANGED
] = 
	`g_sigl_w
(

1298 "kp-above-chged", 
RC_UI_TYPE_MAIN_WINDOW
, 
G_SIGNAL_RUN_FIRST
,

1299 
	`G_STRUCT_OFFSET
(
RCUiMaWdowCss
, 
kp_above_chged
), 
NULL
, NULL,

1300 
g_cosu_msh_VOID__BOOLEAN
, 
G_TYPE_NONE
, 1, 
G_TYPE_BOOLEAN
,

1301 
NULL
);

1302 
	}
}

1304 
	$rc_ui_ma_wdow__
(
RCUiMaWdow
 *
wdow
)

1306 
RCUiMaWdowPrive
 *
iv
 = 
	`G_TYPE_INSTANCE_GET_PRIVATE
(
wdow
,

1307 
RC_UI_TYPE_MAIN_WINDOW
, 
RCUiMaWdowPrive
);

1308 
wdow
->
iv
 =riv;

1309 
GdkPixbuf
 *
ic_pixbuf
;

1310 
GdkGeomry
 
ma_wdow_hts
 =

1312 .
m_width
 = 500,

1313 .
m_height
 = 360,

1314 .
ba_width
 = 600,

1315 .
ba_height
 = 400

1317 
GtkAdjumt
 *
posi_adjumt
;

1318 
gdoub
 
vume
 = 1.0;

1319 
GtkTeSei
 *
log_i
, *
ayli_i
;

1320 
iv
->
cov_t_ag
 = 
FALSE
;

1321 
iv
->
upde_ek_s
 = 
TRUE
;

1322 
iv
->
cov_image_width
 = 
RC_UI_MAIN_WINDOW_COVER_IMAGE_SIZE
;

1323 
iv
->
cov_image_height
 = 
RC_UI_MAIN_WINDOW_COVER_IMAGE_SIZE
;

1324 
iv
->
cov_deu_pixbuf
 = 
	`gdk_pixbuf_w_om_xpm_da
(

1325 (cڡ 
gch
 **)&
ui_image_deu_cov
);

1326 
ic_pixbuf
 = 
	`gdk_pixbuf_w_om_xpm_da
(

1327 (cڡ 
gch
 **)&
ui_image_ic
);

1328 
posi_adjumt
 = 
	`gtk_adjumt_w
(0.0, 0.0, 100.0, 1.0, 2.0, 0.0);

1329 
iv
->
t_b
 = 
	`gtk_b_w
(
	`_
("Unknown Title"));

1330 
iv
->
ti_b
 = 
	`gtk_b_w
(
	`_
("Unknown Artist"));

1331 
iv
->
bum_b
 = 
	`gtk_b_w
(
	`_
("Unknown Album"));

1332 
iv
->
fo_b
 = 
	`gtk_b_w
(
	`_
("Unknown Format"));

1333 
iv
->
time_b
 = 
	`gtk_b_w
("--:--");

1334 
iv
->
ngth_b
 = 
	`gtk_b_w
("00:00");

1335 
iv
->
bum_image
 = 
	`gtk_image_w_om_pixbuf
riv->
cov_deu_pixbuf
);

1336 
iv
->
bum_evtbox
 = 
	`gtk_evt_box_w
();

1337 
iv
->
bum_ame
 = 
	`gtk_ame_w
(
NULL
);

1338 
iv
->
lyric1_ab
 = 
	`rc_ui_sb_b_w
();

1339 
iv
->
lyric2_ab
 = 
	`rc_ui_sb_b_w
();

1340 
iv
->
erum_widg
 = 
	`rc_ui_erum_widg_w
();

1341 
iv
->
vume_bu
 = 
	`gtk_vume_bu_w
();

1342 
iv
->
ogss_r
 = 
	`gtk_r_w
();

1343 
iv
->
_ev_image
 = 
	`gtk_image_w_om_ock
(

1344 
GTK_STOCK_MEDIA_PREVIOUS
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

1345 
iv
->
_ay_image
 = 
	`gtk_image_w_om_ock
(

1346 
GTK_STOCK_MEDIA_PLAY
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

1347 
iv
->
__image
 = 
	`gtk_image_w_om_ock
(

1348 
GTK_STOCK_MEDIA_STOP
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

1349 
iv
->
_xt_image
 = 
	`gtk_image_w_om_ock
(

1350 
GTK_STOCK_MEDIA_NEXT
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

1351 
iv
->
_ݒ_image
 = 
	`gtk_image_w_om_ock
(

1352 
GTK_STOCK_OPEN
, 
GTK_ICON_SIZE_SMALL_TOOLBAR
);

1353 
iv
->
_ay_bu
 = 
	`gtk_bu_w
();

1354 
iv
->
__bu
 = 
	`gtk_bu_w
();

1355 
iv
->
_ev_bu
 = 
	`gtk_bu_w
();

1356 
iv
->
_xt_bu
 = 
	`gtk_bu_w
();

1357 
iv
->
_ݒ_bu
 = 
	`gtk_bu_w
();

1358 
iv
->
ogss_evtbox
 = 
	`gtk_evt_box_w
();

1359 
iv
->
time_s
 = 
	`gtk_s_w
(
GTK_ORIENTATION_HORIZONTAL
,

1360 
posi_adjumt
);

1361 
iv
->
log_livw
 = 
	`rc_ui_livw_g_log_widg
();

1362 
iv
->
ayli_livw
 = 
	`rc_ui_livw_g_ayli_widg
();

1363 
iv
->
log_s_wdow
 = 
	`gtk_sd_wdow_w
(
NULL
, NULL);

1364 
iv
->
ayli_s_wdow
 = 
	`gtk_sd_wdow_w
(
NULL
, NULL);

1365 
iv
->
ui_mag
 = 
	`rc_ui_mu_g_ui_mag
();

1366 
	`gtk_wdow_add_acl_group
(
	`GTK_WINDOW
(
wdow
),

1367 
	`gtk_ui_mag_g_acl_group
(
iv
->
ui_mag
));

1368 
iv
->
li_d
 = 
	`gtk_d_w
(
GTK_ORIENTATION_HORIZONTAL
);

1369 
iv
->
ma_grid
 = 
	`gtk_grid_w
();

1370 
	`g_obje_t
(
wdow
, "name", "RC2MainWindow", "title",

1371 "RhythmC2 MusiPy", "ic", 
ic_pixbuf
,

1372 "wdow-posi", 
GTK_WIN_POS_CENTER
, "default-width", 600,

1373 "deu-height", 400, "has-size-gr", 
FALSE
,

1375 "RhythmC2", "hide-tb-wh-maximized", 
TRUE
, 
NULL
);

1376 
	`gtk_wdow_t_geomry_hts
(
	`GTK_WINDOW
(
wdow
), 
	`GTK_WIDGET
(window),

1377 &
ma_wdow_hts
, 
GDK_HINT_MIN_SIZE
);

1378 
	`g_obje_t
(
iv
->
t_b
, "name", "RC2TitleLabel", "xalign", 0.0,

1379 "yign", 0.5, "lsize", 
PANGO_ELLIPSIZE_END
, "hexnd-t", 
TRUE
,

1380 "hexnd", 
TRUE
, "vexnd-t", TRUE, "vexnd", 
FALSE
, 
NULL
);

1381 
	`g_obje_t
(
iv
->
ti_b
, "name", "RC2ArtistLabel", "xalign", 0.0,

1382 "yign", 0.5, "lsize", 
PANGO_ELLIPSIZE_END
, "hexnd-t", 
TRUE
,

1383 "hexnd", 
TRUE
, "vexnd-t", TRUE, "vexnd", 
FALSE
, 
NULL
);

1384 
	`g_obje_t
(
iv
->
bum_b
, "name", "RC2AlbumLabel", "xalign", 0.0,

1385 "yign", 0.5, "lsize", 
PANGO_ELLIPSIZE_END
, "hexnd-t", 
TRUE
,

1386 "hexnd", 
TRUE
, "vexnd-t", TRUE, "vexnd", 
FALSE
, 
NULL
);

1387 
	`g_obje_t
(
iv
->
fo_b
, "name", "RC2InfoLabel", "xalign", 0.0,

1388 "yign", 0.5, "lsize", 
PANGO_ELLIPSIZE_END
, "hexnd-t", 
TRUE
,

1389 "hexnd", 
TRUE
, "vexnd-t", TRUE, "vexnd", 
FALSE
, 
NULL
);

1390 
	`g_obje_t
(
iv
->
time_b
, "name", "RC2TimeLabel", "xalign", 1.0,

1391 "yign", 0.5, "juify", 
GTK_JUSTIFY_RIGHT
, 
NULL
);

1392 
	`g_obje_t
(
iv
->
ngth_b
, "name", "RC2LengthLabel", "xalign", 1.0,

1393 "yign", 0.5, "juify", 
GTK_JUSTIFY_RIGHT
, 
NULL
);

1394 
	`g_obje_t
(
iv
->
lyric1_ab
, "name", "RC2Lyric1ScrollableLabel",

1395 "hexnd-t", 
TRUE
, "hexpand", TRUE, "vexpand-set", TRUE, "vexpand",

1396 
FALSE
, 
NULL
);

1397 
	`g_obje_t
(
iv
->
lyric2_ab
, "name", "RC2Lyric2ScrollableLabel",

1398 "hexnd-t", 
TRUE
, "hexpand", TRUE, "vexpand-set", TRUE, "vexpand",

1399 
FALSE
, 
NULL
);

1400 
	`g_obje_t
(
iv
->
erum_widg
, "name", "RC2SpectrumWidget",

1401 "exnd", 
TRUE
, "mg-t", 4, 
NULL
);

1402 
	`g_obje_t
(
iv
->
bum_image
, "me", "RC2AlbumImage", 
NULL
);

1403 
	`g_obje_t
(
iv
->
ogss_r
, "me", "RC2ProgssSpr", 
NULL
);

1404 
	`g_obje_t
(
iv
->
time_s
, "name", "RC2TimeScale", "show-fill-level",

1405 
TRUE
, "ri-to-fl-v", 
FALSE
, "fill-level", 0.0,

1406 "n-focus", 
FALSE
, "dw-vue", FALSE, "hexnd-t", 
TRUE
, "hexpand",

1407 
TRUE
, "mg-", 3, "mg-right", 2, 
NULL
);

1408 
	`g_obje_t
(
iv
->
_ay_bu
, "name", "RC2ControlButton",

1409 "lf", 
GTK_RELIEF_NONE
, "n-focus", 
FALSE
, 
NULL
);

1410 
	`g_obje_t
(
iv
->
__bu
, "name", "RC2ControlButton",

1411 "lf", 
GTK_RELIEF_NONE
, "n-focus", 
FALSE
, 
NULL
);

1412 
	`g_obje_t
(
iv
->
_ev_bu
, "name", "RC2ControlButton",

1413 "lf", 
GTK_RELIEF_NONE
, "n-focus", 
FALSE
, 
NULL
);

1414 
	`g_obje_t
(
iv
->
_xt_bu
, "name", "RC2ControlButton",

1415 "lf", 
GTK_RELIEF_NONE
, "n-focus", 
FALSE
, 
NULL
);

1416 
	`g_obje_t
(
iv
->
_ݒ_bu
, "name", "RC2ControlButton",

1417 "lf", 
GTK_RELIEF_NONE
, "n-focus", 
FALSE
, 
NULL
);

1418 if(!
	`rib_ce_g_vume
(&
vume
)) volume = 1.0;

1419 
	`g_obje_t
(
iv
->
vume_bu
, "name", "RC2VolumeButton", "can-focus",

1420 
FALSE
, "size", 
GTK_ICON_SIZE_SMALL_TOOLBAR
, "relief",

1421 
GTK_RELIEF_NONE
, "u-symbic", 
TRUE
, "vue", 
vume
, 
NULL
);

1422 
	`g_obje_t
(
iv
->
log_s_wdow
, "name", "RC2CatalogScrolledWindow",

1423 "hslb-picy", 
GTK_POLICY_NEVER
, "vscrollbar-policy",

1424 
GTK_POLICY_AUTOMATIC
, 
NULL
);

1425 
	`g_obje_t
(
iv
->
ayli_s_wdow
, "name", "RC2PlaylistScrolledWindow",

1426 "hslb-picy", 
GTK_POLICY_NEVER
, "vscrollbar-policy",

1427 
GTK_POLICY_AUTOMATIC
, 
NULL
);

1428 
	`g_obje_t
(
iv
->
li_d
, "name", "RC2ListPaned", "border-width", 0,

1429 "posi-t", 
TRUE
, "posi", 160, "exnd", TRUE, 
NULL
);

1430 
	`g_obje_t
(
iv
->
ogss_evtbox
, "name", "RC2ProgressEventbox",

1431 "mg-", 6, "mg-right", 6, 
NULL
);

1432 
	`gtk_widg_t_size_que
(
iv
->
bum_image
,riv->
cov_image_width
,

1433 
iv
->
cov_image_height
);

1434 
	`gtk_widg_add_evts
(
iv
->
erum_widg
, 
GDK_BUTTON_PRESS_MASK
);

1435 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
_ay_bu
),

1436 
iv
->
_ay_image
);

1437 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
__bu
),

1438 
iv
->
__image
);

1439 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
_ev_bu
),

1440 
iv
->
_ev_image
);

1441 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
_xt_bu
),

1442 
iv
->
_xt_image
);

1443 
	`gtk_cڏ_add
(
	`GTK_CONTAINER
(
iv
->
_ݒ_bu
),

1444 
iv
->
_ݒ_image
);

1445 
log_i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

1446 
iv
->
log_livw
));

1447 
ayli_i
 = 
	`gtk__vw_g_i
(
	`GTK_TREE_VIEW
(

1448 
iv
->
ayli_livw
));

1449 
	`rc_ui_ma_wdow_yout_
(
wdow
);

1450 
	`rc_ui_ma_wdow_t_deu_y
(
iv
);

1451 
	`rc_ui_ma_wdow_sigl_bd
(
wdow
);

1452 
	`gtk_widg_show_l
(
iv
->
ogss_evtbox
);

1453 
	`gtk_widg_t_visib
(
iv
->
ogss_evtbox
, 
FALSE
);

1454 
	`gtk_widg_t_no_show_l
(
iv
->
ogss_evtbox
, 
TRUE
);

1455 
	`gtk_widg_show_l
(
iv
->
ma_grid
);

1456 
	`rc_ui_ma_wdow_log_livw_i_chged_cb
(

1457 
log_i
, 
NULL
);

1458 
	`rc_ui_ma_wdow_ayli_livw_i_chged_cb
(

1459 
ayli_i
, 
NULL
);

1460 
	`g_obje_uef
(
ic_pixbuf
);

1461 
	}
}

1463 
GTy
 
	$rc_ui_ma_wdow_g_ty
()

1465 vީ
gsize
 
g_defe_ty_id__vީe
 = 0;

1466 
GTy
 
g_defe_ty_id
;

1467 cڡ 
GTyInfo
 
wdow_fo
 = {

1468 .
ass_size
 = (
RCUiMaWdowCss
),

1469 .
ba_
 = 
NULL
,

1470 .
ba_fize
 = 
NULL
,

1471 .
ass_
 = (
GCssInFunc
)
rc_ui_ma_wdow_ass_
,

1472 .
ass_fize
 = 
NULL
,

1473 .
ass_da
 = 
NULL
,

1474 .
_size
 = (
RCUiMaWdow
),

1475 .
n_ocs
 = 0,

1476 .
_
 = (
GInInFunc
)
rc_ui_ma_wdow__


1478 if(
	`g___r
(&
g_defe_ty_id__vީe
))

1480 
g_defe_ty_id
 = 
	`g_ty_gi_ic
(
GTK_TYPE_WINDOW
,

1481 
	`g__ic_rg
("RCUiMaWdow"), &
wdow_fo
, 0);

1482 
	`g___ave
(&
g_defe_ty_id__vީe
, 
g_defe_ty_id
);

1484  
g_defe_ty_id__vީe
;

1485 
	}
}

1487 
	$rc_ui_ma_wdow_
()

1489 
ui_ma_wdow_
 = 
	`g_obje_w
(
RC_UI_TYPE_MAIN_WINDOW
, 
NULL
);

1491 
	}
}

1502 
GtkWidg
 *
	$rc_ui_ma_wdow_g_widg
()

1504 if(
ui_ma_wdow_
==
NULL
)

1505 
	`rc_ui_ma_wdow_
();

1506  
	`GTK_WIDGET
(
ui_ma_wdow_
);

1507 
	}
}

1515 
	$rc_ui_ma_wdow_show
()

1517 if(
ui_ma_wdow_
==
NULL
) ;

1518 
	`gtk_widg_show_l
(
	`GTK_WIDGET
(
ui_ma_wdow_
));

1519 
	}
}

1529 
GdkPixbuf
 *
	$rc_ui_ma_wdow_g_deu_cov_image
()

1531 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1532 if(
ui_ma_wdow_
==
NULL
)  NULL;

1533 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1534 if(
iv
==
NULL
)  NULL;

1535  
iv
->
cov_deu_pixbuf
;

1536 
	}
}

1544 
	$rc_ui_ma_wdow_e_ma_wdow
()

1546 if(
ui_ma_wdow_
==
NULL
) ;

1547 
	`gtk_wdow_e
(
	`GTK_WINDOW
(
ui_ma_wdow_
));

1548 
	}
}

1559 
	$rc_ui_ma_wdow_t_kp_above_e
(
gboޗn
 
e
)

1561 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1562 if(
ui_ma_wdow_
==
NULL
) ;

1563 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1564 if(
iv
==
NULL
) ;

1565 
	`gtk_wdow_t_kp_above
(
	`GTK_WINDOW
(
ui_ma_wdow_
), 
e
);

1566 
	`gtk_togg_ai_t_aive
(
	`GTK_TOGGLE_ACTION
(

1567 
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

1568 "/RC2MuB/VwMu/VwAlwaysOnT")), 
e
);

1569 
	`gtk_togg_ai_t_aive
(
	`GTK_TOGGLE_ACTION
(

1570 
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

1571 "/TyPupMu/TyAlwaysOnT")), 
e
);

1572 
	`g_sigl_em
(
ui_ma_wdow_
,

1573 
ui_ma_wdow_sigls
[
SIGNAL_KEEP_ABOVE_CHANGED
], 0, 
e
);

1574 
	}
}

1583 
	$rc_ui_ma_wdow_cov_image_t_visib
(
gboޗn
 
visib
)

1585 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1586 if(
ui_ma_wdow_
==
NULL
) ;

1587 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1588 if(
iv
==
NULL
 ||riv->
bum_ame
==NULL) ;

1589 
	`gtk_widg_t_visib
(
iv
->
bum_ame
, 
visib
);

1590 
	}
}

1600 
gboޗn
 
	$rc_ui_ma_wdow_cov_image_g_visib
()

1602 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1603 if(
ui_ma_wdow_
==
NULL
 
FALSE
;

1604 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1605 if(
iv
==
NULL
 ||riv->
bum_ame
==NULL 
FALSE
;

1606  
	`gtk_widg_g_visib
(
iv
->
bum_ame
);

1607 
	}
}

1616 
	$rc_ui_ma_wdow_lyric_bs_t_visib
(
gboޗn
 
visib
)

1618 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1619 if(
ui_ma_wdow_
==
NULL
) ;

1620 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1621 if(
iv
==
NULL
 ||riv->
lyric1_ab
==NULL ||riv->
lyric2_ab
==NULL)

1623 
	`gtk_widg_t_visib
(
iv
->
lyric1_ab
, 
visib
);

1624 
	`gtk_widg_t_visib
(
iv
->
lyric2_ab
, 
visib
);

1625 
	}
}

1635 
gboޗn
 
	$rc_ui_ma_wdow_lyric_bs_g_visib
()

1637 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1638 if(
ui_ma_wdow_
==
NULL
 
FALSE
;

1639 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1640 if(
iv
==
NULL
 ||riv->
lyric1_ab
==NULL ||riv->
lyric2_ab
==NULL)

1641  
FALSE
;

1642  
	`gtk_widg_g_visib
(
iv
->
lyric1_ab
) &&

1643 
	`gtk_widg_g_visib
(
iv
->
lyric2_ab
);

1644 
	}
}

1653 
	$rc_ui_ma_wdow_erum_t_visib
(
gboޗn
 
visib
)

1655 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1656 if(
ui_ma_wdow_
==
NULL
) ;

1657 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1658 if(
iv
==
NULL
 ||riv->
erum_widg
==NULL) ;

1659 
	`gtk_widg_t_visib
(
iv
->
erum_widg
, 
visib
);

1660 
	}
}

1670 
gboޗn
 
	$rc_ui_ma_wdow_erum_g_visib
()

1672 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1673 if(
ui_ma_wdow_
==
NULL
 
FALSE
;

1674 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1675 if(
iv
==
NULL
 ||riv->
erum_widg
==NULL 
FALSE
;

1676  
	`gtk_widg_g_visib
(
iv
->
erum_widg
);

1677 
	}
}

1686 
	$rc_ui_ma_wdow_ayli_sd_wdow_t_hizڏl_picy
(

1687 
gboޗn
 
e
)

1689 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1690 
GtkPicyTy
 
ty
;

1691 if(
ui_ma_wdow_
==
NULL
) ;

1692 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1693 if(
iv
==
NULL
 ||riv->
bum_ame
==NULL) ;

1694 if(
e
)

1695 
ty
 = 
GTK_POLICY_AUTOMATIC
;

1697 
ty
 = 
GTK_POLICY_NEVER
;

1698 
	`g_obje_t
(
iv
->
ayli_s_wdow
, "hslb-picy", 
ty
, 
NULL
);

1699 
	}
}

1708 
	$rc_ui_ma_wdow_erum_t_y
(
gut
 
y
)

1710 
RCUiMaWdowPrive
 *
iv
 = 
NULL
;

1711 if(
ui_ma_wdow_
==
NULL
) ;

1712 
iv
 = 
	`RC_UI_MAIN_WINDOW
(
ui_ma_wdow_
)->priv;

1713 if(
iv
==
NULL
 ||riv->
erum_widg
==NULL) ;

1714 
	`rc_ui_erum_widg_t_y
(
	`RC_UI_SPECTRUM_WIDGET
(

1715 
iv
->
erum_widg
), 
y
);

1716 
	`gtk_dio_ai_t_cut_vue
(
	`GTK_RADIO_ACTION
(

1717 
	`gtk_ui_mag_g_ai
(
iv
->
ui_mag
,

1718 "/SrumPupMu/SrumNoSty")), 
y
);

1719 
	`rib_gs_t_g
("MaUI", "SrumSty", 
y
);

1720 
	}
}

	@ui/rc-ui-window.h

25 #ide
HAVE_RC_UI_WINDOW_H


26 
	#HAVE_RC_UI_WINDOW_H


	)

28 
	~<glib.h
>

29 
	~<glib-obje.h
>

30 
	~<gtk/gtk.h
>

31 
	~<rib.h
>

33 
	gG_BEGIN_DECLS


35 
	#RC_UI_TYPE_MAIN_WINDOW
 (
	`rc_ui_ma_wdow_g_ty
())

	)

36 
	#RC_UI_MAIN_WINDOW
(
obj
(
	`G_TYPE_CHECK_INSTANCE_CAST
((obj), \

37 
RC_UI_TYPE_MAIN_WINDOW
, 
RCUiMaWdow
))

	)

38 
	#RC_UI_MAIN_WINDOW_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_CAST
((k), \

39 
RC_UI_TYPE_MAIN_WINDOW
, 
RCUiMaWdowCss
))

	)

40 
	#RC_UI_IS_MAIN_WINDOW
(
o
(
	`G_TYPE_CHECK_INSTANCE_TYPE
((o), \

41 
RC_UI_TYPE_MAIN_WINDOW
))

	)

42 
	#RC_UI_IS_MAIN_WINDOW_CLASS
(
k
(
	`G_TYPE_CHECK_CLASS_TYPE
((k), \

43 
RC_UI_TYPE_MAIN_WINDOW
))

	)

44 
	#RC_UI_MAIN_WINDOW_GET_CLASS
(
o
(
	`G_TYPE_INSTANCE_GET_CLASS
((o), \

45 
RC_UI_TYPE_MAIN_WINDOW
, 
RCUiMaWdowCss
))

	)

47 
_RCUiMaWdow
 
	tRCUiMaWdow
;

48 
_RCUiMaWdowCss
 
	tRCUiMaWdowCss
;

49 
_RCUiMaWdowPrive
 
	tRCUiMaWdowPrive
;

57 
	s_RCUiMaWdow
 {

59 
GtkWdow
 
	m
;

60 
RCUiMaWdowPrive
 *
	miv
;

69 
	s_RCUiMaWdowCss
 {

71 
GtkWdowCss
 
	m_ass
;

72 (*
	mkp_above_chged
)(
RCUiMaWdow
 *
	mwdow
, 
gboޗn
 
	me
);

76 
GTy
 
rc_ui_ma_wdow_g_ty
();

79 
GtkWidg
 *
rc_ui_ma_wdow_g_widg
();

80 
rc_ui_ma_wdow_show
();

81 
GdkPixbuf
 *
rc_ui_ma_wdow_g_deu_cov_image
();

82 
rc_ui_ma_wdow_e_ma_wdow
();

83 
rc_ui_ma_wdow_t_kp_above_e
(
gboޗn
 
e
);

84 
rc_ui_ma_wdow_cov_image_t_visib
(
gboޗn
 
visib
);

85 
gboޗn
 
rc_ui_ma_wdow_cov_image_g_visib
();

86 
rc_ui_ma_wdow_lyric_bs_t_visib
(
gboޗn
 
visib
);

87 
gboޗn
 
rc_ui_ma_wdow_lyric_bs_g_visib
();

88 
rc_ui_ma_wdow_erum_t_visib
(
gboޗn
 
visib
);

89 
gboޗn
 
rc_ui_ma_wdow_erum_g_visib
();

90 
rc_ui_ma_wdow_ayli_sd_wdow_t_hizڏl_picy
(

91 
gboޗn
 
e
);

92 
rc_ui_ma_wdow_erum_t_y
(
gut
 
y
);

94 
	gG_END_DECLS


	@
1
.
0
82
1646
config.h
gettext.h
lib/rclib-album.c
lib/rclib-album.h
lib/rclib-common.h
lib/rclib-core.c
lib/rclib-core.h
lib/rclib-cue.c
lib/rclib-cue.h
lib/rclib-db-library.c
lib/rclib-db-playlist.c
lib/rclib-db-priv.h
lib/rclib-db.c
lib/rclib-db.h
lib/rclib-lyric.c
lib/rclib-lyric.h
lib/rclib-marshal.c
lib/rclib-marshal.h
lib/rclib-player.c
lib/rclib-player.h
lib/rclib-plugin.c
lib/rclib-plugin.h
lib/rclib-settings.c
lib/rclib-settings.h
lib/rclib-tag.c
lib/rclib-tag.h
lib/rclib-util.c
lib/rclib-util.h
lib/rclib.c
lib/rclib.h
plugins/base/desklrc.c
plugins/base/lyricshow.c
plugins/base/mediakey.c
plugins/base/mpris2.c
plugins/base/notify.c
plugins/devel/karamixer.c
plugins/devel/python3.c
plugins/extra/echoeffect.c
plugins/extra/karaeffect.c
plugins/extra/lrccrawler-common.c
plugins/extra/lrccrawler-common.h
plugins/extra/lrccrawler-lrc123.c
plugins/extra/lrccrawler.c
plugins/restricted/lrccrawler-ttplayer.c
test/db-converter.c
ui/main.c
ui/rc-common.h
ui/rc-main.c
ui/rc-main.h
ui/rc-marshal.c
ui/rc-marshal.h
ui/rc-ui-cell-renderer-rating.c
ui/rc-ui-cell-renderer-rating.h
ui/rc-ui-dialog.c
ui/rc-ui-dialog.h
ui/rc-ui-effect.c
ui/rc-ui-effect.h
ui/rc-ui-listmodel.c
ui/rc-ui-listmodel.h
ui/rc-ui-listview.c
ui/rc-ui-listview.h
ui/rc-ui-menu.c
ui/rc-ui-menu.h
ui/rc-ui-no-star-inline.h
ui/rc-ui-player.c
ui/rc-ui-player.h
ui/rc-ui-plugin.c
ui/rc-ui-plugin.h
ui/rc-ui-resources.c
ui/rc-ui-resources.h
ui/rc-ui-set-star-inline.h
ui/rc-ui-settings.c
ui/rc-ui-settings.h
ui/rc-ui-slabel.c
ui/rc-ui-slabel.h
ui/rc-ui-spectrum.c
ui/rc-ui-spectrum.h
ui/rc-ui-style.c
ui/rc-ui-style.h
ui/rc-ui-unset-star-inline.h
ui/rc-ui-window.c
ui/rc-ui-window.h
